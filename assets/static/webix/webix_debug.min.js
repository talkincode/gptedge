webix_debug.js:11924: WARNING - [JSC_USELESS_CODE] Suspicious code. This code lacks side-effects. Is there a bug?
			if (this._make_full_copy){
			^^^^^^^^^^^^^^^^^^^^^^^^^^

webix_debug.js:19728: WARNING - [JSC_USELESS_CODE] Suspicious code. This code lacks side-effects. Is there a bug?
		for (start; start<i; start++) 
		     ^^^^^

0 error(s), 2 warning(s)
/*
 suggestions navigation: up/down buttons move selection
 @param e
  event object
 create textarea or returns existing
 set text into buffer
 select text in textarea
 checks document selection
 process ctrl+V pressing
 gets header from first table row
 gets hash of html-element attributes
 counts how many occurances substring in string * gets list of referencies in formula
 constructor
 attaching onStoreUpdated event
 process updates list to POST and GET params according dataprocessor protocol
 @param updates
  list of objects { id: "item id", data: "data hash", operation: "type of operation"}
 @return
  object { post: { hash of post params as name: value }, get: { hash of get params as name: value } }
 send dataprocessor query to server
 and attach event to process result
 @param url
  server url
 @param get
  hash of get params
 @param post
  hash of post params
 @mode
  'post' or 'get'
 if it's defined escape function - call it
 @param value
  value to escape
 @return
  escaped value
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(p){return!1}}function c(){}function d(a){var b=typeof a;return"object"===b&&null!==a||"function"===b}function e(a){if(!$jscomp.owns(a,g)){var b=new c;$jscomp.defineProperty(a,g,{value:b})}}function f(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
c)return a;e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var g="$jscomp_hidden_"+Math.random();f("freeze");f("preventExtensions");f("seal");var h=0,k=function(a){this.id_=(h+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,b){if(!d(a))throw Error("Invalid WeakMap key");e(a);if(!$jscomp.owns(a,g))throw Error("WeakMap key fail: "+
a);a[g][this.id_]=b;return this};k.prototype.get=function(a){return d(a)&&$jscomp.owns(a,g)?a[g][this.id_]:void 0};k.prototype.has=function(a){return d(a)&&$jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)};k.prototype.delete=function(a){return d(a)&&$jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)?delete a[g][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++h,c.set(b,d)):d="p_"+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return c},"es6","es3");
$jscomp.polyfill("WeakSet",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),f=new a([b]);if(!f.has(b)||f.has(c))return!1;f.delete(b);f.add(c);return!f.has(b)&&f.has(c)}catch(g){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var c=function(a){this.map_=new WeakMap;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}};c.prototype.add=function(a){this.map_.set(a,
!0);return this};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.delete=function(a){return this.map_.delete(a)};return c},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");window.webix||(webix={});webix.assert=function(a,b){a||webix.assert_error(b)};
webix.assert_config=function(a){if(a=a.cells||a.rows||a.elements||a.cols)for(var b=0;b<a.length;b++)null!==a[b]&&"undefined"!==typeof a[b]||webix.assert_error("You have trailing comma or Null element in collection's configuration")};webix.assert_error=function(a){webix.log("error",a);webix.message&&"string"==typeof a&&webix.message({type:"debug",text:a,expire:-1});if(!1!==webix.debug)debugger};webix.assert_core_ready=function(){window.webix_on_core_ready&&window.webix_on_core_ready()};
webix.assert_level=0;webix.assert_level_in=function(){webix.assert_level++;100==webix.assert_level&&webix.assert_error("Attempt to copy object with self reference")};webix.assert_level_out=function(){webix.assert_level--};webix.version="5.1.6";webix.codebase="./";webix.name="core";webix.cdn="//cdn.webix.com";webix.clone=function(a){var b=webix.clone._function;b.prototype=a;return new b};webix.clone._function=function(){};
webix.extend=function(a,b,c){webix.assert(a,"Invalid mixing target");webix.assert(b,"Invalid mixing source");if(a.$protoWait)return webix.PowerArray.insertAt.call(a.$protoWait,b,1),a;for(var d in b)d in a&&!c||(a[d]=b[d]);b.defaults&&webix.extend(a.defaults,b.defaults);b.$init&&b.$init.call(a);return a};
webix.copy=function(a){webix.assert(a,"Invalid mixing target");webix.assert_level_in();if(1<arguments.length){var b=arguments[0];a=arguments[1]}else b=webix.isArray(a)?[]:{};for(var c in a){var d=a[c];!d||"object"!=typeof d||d instanceof RegExp?b[c]=d:webix.isDate(d)?b[c]=new Date(d):webix.env.esModern&&(d instanceof Map||d instanceof Set||d instanceof WeakMap||d instanceof WeakSet)?b[c]=d:(b[c]=webix.isArray(d)?[]:{},webix.copy(b[c],d))}webix.assert_level_out();return b};
webix.single=function(a){var b=null;return function(c){b||(b=new a({}));b._reinit&&b._reinit.apply(b,arguments);return b}};
webix.protoUI=function(){webix.debug_proto&&webix.log("UI registered: "+arguments[0].name);var a=arguments[0].name,b=function(c){if(!b)return webix.ui[a].prototype;var d=b.$protoWait;if(d){for(var e=[d[0]],f=1;f<d.length;f++)e[f]=d[f],e[f].$protoWait&&(e[f]=e[f].call(webix,e[f].name)),e[f].prototype&&e[f].prototype.name&&(webix.ui[e[f].prototype.name]=e[f]);webix.ui[a]=webix.proto.apply(webix,e);if(b._webix_type_wait)for(f=0;f<b._webix_type_wait.length;f++)webix.type(webix.ui[a],b._webix_type_wait[f]);
b=null}return this!=webix?new webix.ui[a](c):webix.ui[a]};b.$protoWait=Array.prototype.slice.call(arguments,0);return webix.ui[a]=b};
webix.proto=function(){webix.debug_proto&&webix.log("Proto chain:"+arguments[0].name+"["+arguments.length+"]");var a=arguments,b=a[0],c=!!b.$init,d=[];webix.assert(b,"Invalid mixing target");for(var e=a.length-1;0<e;e--){webix.assert(a[e],"Invalid mixing source");"function"==typeof a[e]&&(a[e]=a[e].prototype);a[e].$init&&d.push(a[e].$init);if(a[e].defaults){var f=a[e].defaults;b.defaults||(b.defaults={});for(var g in f)webix.isUndefined(b.defaults[g])&&(b.defaults[g]=f[g])}if(a[e].type&&b.type)for(g in a[e].type)b.type[g]||
(b.type[g]=a[e].type[g]);for(var h in a[e])b[h]||!1===b[h]||(b[h]=a[e][h])}c&&d.push(b.$init);b.$init=function(){for(var a=0;a<d.length;a++)d[a].apply(this,arguments)};b.$skin&&b.$skin();c=function(a){this.$ready=[];webix.assert(this.$init,"object without init method");this.$init(a);this._parseSettings&&this._parseSettings(a,this.defaults);for(a=0;a<this.$ready.length;a++)this.$ready[a].call(this)};c.prototype=b;b=a=null;return c};webix.bind=function(a,b){return function(){return a.apply(b,arguments)}};
webix.require=function(a,b,c){var d=webix.promise.defer();b&&!0!==b&&(d=d.then(function(){b.call(c||this)}));if(webix.require.disabled)return d.resolve(),d;if("string"!=typeof a){var e=a.length||0;if(e)g=function(){e?(e--,webix.require(a[a.length-e-1],g,c)):d.resolve()},g();else{for(var f in a)e++;var g=function(){e--;0===e&&d.resolve()};for(f in a)webix.require(f,g,c)}}else{if(!0!==webix._modules[a]){f=a;a.toString().match(/^([a-z]+:)*\/\//i)||(f=webix.codebase+a);if(".css"==a.substr(a.length-4))return f=
webix.html.create("LINK",{type:"text/css",rel:"stylesheet",href:f}),document.getElementsByTagName("head")[0].appendChild(f),d.resolve(),d;!0===b?(webix.exec(webix.ajax().sync().get(f).responseText),webix._modules[a]=!0):webix._modules[a]?webix._modules[a].push(d):(webix._modules[a]=[d],webix.ajax(f,function(b){webix.exec(b);b=webix._modules[a];webix._modules[a]=!0;for(var c=0;c<b.length;c++)b[c].resolve()}))}else d.resolve();return d}};webix._modules={};
webix.exec=function(a){window.execScript?window.execScript(a):window.eval(a)};webix.wrap=function(a,b){return a?function(){var c=a.apply(this,arguments);b.apply(this,arguments);return c}:b};webix.isUndefined=function(a){return"undefined"==typeof a};webix.delay=function(a,b,c,d){return window.setTimeout(function(){if(!b||!b.$destructed){var d=a.apply(b,c||[]);a=b=c=null;return d}},d||1)};webix.once=function(a){var b=!0;return function(){b&&(b=!1,a.apply(this,arguments))}};
webix.uid=function(){this._seed||(this._seed=(new Date).valueOf());this._seed++;return this._seed};webix.toNode=function(a){return"string"==typeof a?document.getElementById(a):a};webix.toArray=function(a){return webix.extend(a||[],webix.PowerArray,!0)};webix.toFunctor=function(a,b){if("string"==typeof a){var c=a.replace("()","");return b&&b[c]?b[c]:window[c]||eval(a)}return a};webix.isArray=function(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)};
webix.isDate=function(a){return a instanceof Date};webix.stringify=function(a){var b=Date.prototype.toJSON;Date.prototype.toJSON=function(){return webix.i18n.parseFormatStr(this)};a=a instanceof Date?a.toJSON():JSON.stringify(a);Date.prototype.toJSON=b;return a};webix._events={};webix._event=function(a,b,c,d){d=d||{};d.inner=!0;webix.event(a,b,c,d)};
webix.event=function(a,b,c,d){d=d||{};a=webix.toNode(a);webix.assert(a,"Invalid node as target for webix.event");var e=d.id||webix.uid();d.bind&&(c=webix.bind(c,d.bind));var f=[a,b,c,d.capture];d.inner||(webix._events[e]=f);a.addEventListener?a.addEventListener(b,c,!!d.capture):a.attachEvent&&a.attachEvent("on"+b,f[2]=function(){return c.apply(a,arguments)});return e};
webix.eventRemove=function(a){if(a){webix.assert(this._events[a],"Removing non-existing event");var b=webix._events[a];b[0].removeEventListener?b[0].removeEventListener(b[1],b[2],!!b[3]):b[0].detachEvent&&b[0].detachEvent("on"+b[1],b[2]);delete this._events[a]}};webix.log=function(a,b,c){1==arguments.length&&(b=a,a="log");if(window.console&&window.console.log){a=a.toLowerCase();if(window.console[a])window.console[a](b||"unknown error");else window.console.log(a+": "+b);c&&window.console.log(c)}};
webix.log_full_time=function(a){webix._start_time_log=new Date;webix.log("Timing start ["+a+"]");window.setTimeout(function(){webix.log("Timing end ["+a+"]:"+((new Date).valueOf()-webix._start_time_log.valueOf())/1E3+"s")},1)};webix.log_time=function(a){var b="_start_time_log"+a;webix[b]?(webix.log("Info","Timing end ["+a+"]:"+((new Date).valueOf()-webix[b].valueOf())/1E3+"s"),webix[b]=null):(webix[b]=new Date,webix.log("Info","Timing start ["+a+"]"))};webix.debug_code=function(a){a.call(webix)};
webix.EventSystem={$init:function(){this._evs_events||(this._evs_events={},this._evs_handlers={},this._evs_map={})},blockEvent:function(){this._evs_events._block=!0},unblockEvent:function(){this._evs_events._block=!1},mapEvent:function(a){webix.extend(this._evs_map,a,!0)},on_setter:function(a){if(a)for(var b in a){var c=webix.toFunctor(a[b],this.$scope),d=b.indexOf("->");-1!==d?this[b.substr(0,d)].attachEvent(b.substr(d+2),webix.bind(c,this)):this.attachEvent(b,c)}},callEvent:function(a,b){if(this._evs_events._block)return!0;
a=a.toLowerCase();var c=this._evs_events[a.toLowerCase()],d=!0;webix.log&&(!webix.debug&&!this.debug||webix.debug_blacklist[a]||webix.log("info","["+this.name+"@"+(this._settings||{}).id+"] event:"+a,b));if(c)for(var e=0;e<c.length;e++)!1===c[e].apply(this,b||[])&&(d=!1);this._evs_map[a]&&(c=this._evs_map[a],c.$eventSource=this,c.callEvent(a,b)||(d=!1),c.$eventSource=null);return d},attachEvent:function(a,b,c,d){webix.assert(b,"Invalid event handler for "+a);a=a.toLowerCase();c=c||webix.uid();b=webix.toFunctor(b,
this.$scope);var e=this._evs_events[a]||webix.toArray();d?e.unshift(b):e.push(b);this._evs_events[a]=e;this._evs_handlers[c]={f:b,t:a};return c},detachEvent:function(a){this._evs_handlers[a]?(this._evs_events[this._evs_handlers[a].t].remove(this._evs_handlers[a].f),delete this._evs_handlers[a]):(a=(a+"").toLowerCase(),this._evs_events[a]&&(this._evs_events[a]=webix.toArray()))},hasEvent:function(a){a=a.toLowerCase();var b=this._evs_events[a];return b&&b.length?!0:(b=this._evs_map[a])?b.hasEvent(a):
!1}};webix.extend(webix,webix.EventSystem,!0);
webix.PowerArray={removeAt:function(a,b){0<=a&&this.splice(a,b||1)},remove:function(a){this.removeAt(this.find(a))},insertAt:function(a,b){if(b||0===b){var c=this.splice(b,this.length-b);this[b]=a;this.push.apply(this,c)}else this.push(a)},find:function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1},each:function(a,b){for(var c=0;c<this.length;c++)a.call(b||this,this[c])},map:function(a,b){for(var c=0;c<this.length;c++)this[c]=a.call(b||this,this[c]);return this},filter:function(a,
b){for(var c=0;c<this.length;c++)a.call(b||this,this[c])||(this.splice(c,1),c--);return this}};webix.env={};
(function(){webix.env.strict=!!window.webix_strict;webix.env.https="https:"===document.location.protocol;webix.env.esModern=!!Object.assign;var a=navigator.userAgent;if(-1!=a.indexOf("Mobile")||-1!=a.indexOf("Windows Phone"))webix.env.mobile=!0;if(webix.env.mobile||-1!=a.indexOf("iPad")||-1!=a.indexOf("Android"))webix.env.touch=!0;if(-1!=a.indexOf("Opera"))webix.env.isOpera=!0;else{webix.env.isIE=!!document.all||-1!==a.indexOf("Trident");webix.env.isIE&&8==parseFloat(navigator.appVersion.split("MSIE")[1])&&
(webix.env.isIE8=!0);webix.env.isEdge=-1!=a.indexOf("Edge");webix.env.isFF=-1!=a.indexOf("Firefox");webix.env.isWebKit=-1!=a.indexOf("KHTML");webix.env.isSafari=webix.env.isWebKit&&-1!=a.indexOf("Mac")&&-1==a.indexOf("Chrome");if(webix.env.isIE||webix.env.isEdge||webix.env.isFF)webix.env.maxHTMLElementSize=1E7;webix.env.isSafari&&(webix.env.maxHTMLElementSize=1E8)}-1!=a.toLowerCase().indexOf("android")&&(webix.env.isAndroid=!0,-1!=a.toLowerCase().indexOf("trident")&&(webix.env.isAndroid=!1,webix.env.isIEMobile=
!0));webix.env.transform=!1;webix.env.transition=!1;for(var b=-1,c=["","webkit","Moz","O","ms"],d=["","-webkit-","-Moz-","-o-","-ms-"],e=document.createElement("DIV"),f=0;f<c.length;f++)if("undefined"!=typeof e.style[c[f]?c[f]+"Transform":"transform"]){b=f;break}-1<b&&(webix.env.cssPrefix=d[b],b=webix.env.jsPrefix=c[b],webix.env.transform=b?b+"Transform":"transform",webix.env.transition=b?b+"Transition":"transition",webix.env.transitionDuration=b?b+"TransitionDuration":"transitionDuration",e.style[webix.env.transform]=
"translate3d(0,0,0)",webix.env.translate=e.style[webix.env.transform]?"translate3d":"translate",webix.env.transitionEnd="-Moz-"==webix.env.cssPrefix?"transitionend":b?b+"TransitionEnd":"transitionend");webix.env.pointerevents=!webix.env.isIE||null!==/Trident\/.*rv:11/.exec(a)})();webix.env.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}();
webix.env.svganimation=function(){return document.implementation.hasFeature("https://www.w3.org/TR/SVG11/feature#SVG-animation","1.1")}();
webix.html={_native_on_selectstart:0,_style_element:{},denySelect:function(){webix._native_on_selectstart||(webix._native_on_selectstart=document.onselectstart);document.onselectstart=webix.html.stopEvent},allowSelect:function(){0!==webix._native_on_selectstart&&(document.onselectstart=webix._native_on_selectstart||null);webix._native_on_selectstart=0},index:function(a){for(var b=0;a=a.previousSibling;)b++;return b},_style_cache:{},createCss:function(a,b){var c="";b=b||"";for(var d in a)c+=d+":"+
a[d]+";";a=this._style_cache[c+b];a||(a="s"+webix.uid(),this.addStyle("."+a+(b||"")+"{"+c+"}"),this._style_cache[c+b]=a);return a},addStyle:function(a,b){var c=b?this._style_element[b]:this._style_element["default"];c||(c=document.createElement("style"),c.setAttribute("type","text/css"),c.setAttribute("media","screen,print"),document.getElementsByTagName("head")[0].appendChild(c),b?this._style_element[b]=c:this._style_element["default"]=c);c.styleSheet?c.styleSheet.cssText+=a:c.appendChild(document.createTextNode(a))},
removeStyle:function(a){if(a=this._style_element[a||"default"])a.innerHTML=""},create:function(a,b,c){b=b||{};a=document.createElement(a);for(var d in b)a.setAttribute(d,b[d]);b.style&&(a.style.cssText=b.style);b["class"]&&(a.className=b["class"]);c&&(a.innerHTML=c);return a},getValue:function(a){return(a=webix.toNode(a))?webix.isUndefined(a.value)?a.innerHTML:a.value:""},remove:function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)this.remove(a[b]);else a&&a.parentNode&&a.parentNode.removeChild(a)},
insertBefore:function(a,b,c){a&&(b&&b.parentNode?b.parentNode.insertBefore(a,b):c.appendChild(a))},locate:function(a,b){a.tagName||(a=a||event,a=a.target||a.srcElement);for(;a;){if(a.getAttribute){var c=a.getAttribute(b);if(c)return c}a=a.parentNode}return null},offset:function(a){if(a.getBoundingClientRect){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=b.top+(window.pageYOffset||d.scrollTop||c.scrollTop)-(d.clientTop||c.clientTop||0);b=b.left+(window.pageXOffset||d.scrollLeft||
c.scrollLeft)-(d.clientLeft||c.clientLeft||0);return{y:Math.round(e),x:Math.round(b),width:a.offsetWidth,height:a.offsetHeight}}for(b=e=0;a;)e+=parseInt(a.offsetTop,10),b+=parseInt(a.offsetLeft,10),a=a.offsetParent;return{y:e,x:b,width:a.offsetHeight,height:a.offsetWidth}},posRelative:function(a){a=a||event;return webix.isUndefined(a.offsetX)?{x:a.layerX,y:a.layerY}:{x:a.offsetX,y:a.offsetY}},pos:function(a){a=a||event;a.touches&&a.touches[0]&&(a=a.touches[0]);if(a.pageX||a.pageY)return{x:a.pageX,
y:a.pageY};var b=webix.env.isIE&&"BackCompat"!=document.compatMode?document.documentElement:document.body;return{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}},preventEvent:function(a){a&&a.preventDefault&&a.preventDefault();a&&(a.returnValue=!1);return webix.html.stopEvent(a)},stopEvent:function(a){a=a||event;a.stopPropagation&&a.stopPropagation();a.cancelBubble=!0;return!1},triggerEvent:function(a,b,c){document.createEventObject?(b=document.createEventObject(),a.fireEvent&&
a.fireEvent("on"+c,b)):(b=document.createEvent(b),b.initEvent(c,!0,!0),a.dispatchEvent&&a.dispatchEvent(b))},addCss:function(a,b,c){c&&-1!==a.className.indexOf(b)||(a.className+=" "+b)},removeCss:function(a,b){a.className=a.className.replace(RegExp(" "+b,"g"),"")},getTextSize:function(a,b,c){b=webix.html.create("DIV",{"class":"webix_view webix_measure_size "+(b||"")},"");b.style.cssText="height:auto;visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;"+(c?"width:"+c+"px;":"width:auto;white-space:nowrap;");
document.body.appendChild(b);a="object"!==typeof a?[a]:a;for(var d=c=0,e=0;e<a.length;e++)b.innerHTML=a[e],c=Math.max(c,b.offsetWidth),d=Math.max(d,b.offsetHeight);webix.html.remove(b);return{width:c,height:d}},download:function(a,b){var c=!1;if("object"==typeof a){if(window.navigator.msSaveBlob)return window.navigator.msSaveBlob(a,b);a=window.URL.createObjectURL(a);c=!0}var d=document.createElement("a");d.href=a;d.download=b;document.body.appendChild(d);d.click();webix.delay(function(){c&&window.URL.revokeObjectURL(a);
document.body.removeChild(d);d.remove()})},_getClassName:function(a){if(!a)return"";a=a.className||"";a.baseVal&&(a=a.baseVal);a.indexOf||(a="");return a},setSelectionRange:function(a,b,c){b=b||0;c=c||b;a.focus();a.setSelectionRange?a.setSelectionRange(b,c):(a=a.createTextRange(),a.collapse(!0),a.moveEnd("character",c),a.moveStart("character",b),a.select())},getSelectionRange:function(a){if("selectionStart"in a)return{start:a.selectionStart||0,end:a.selectionEnd||0};a.focus();var b=document.selection.createRange().getBookmark(),
c=a.createTextRange();c.moveToBookmark(b);b=c.text.length;c.collapse(!0);c.moveStart("character",-a.value.length);a=c.text.length;return{start:a,end:a+b}}};webix.ready=function(a){this._ready?a.call():this._ready_code.push(a)};webix.debug_ready=webix.ready;webix._ready_code=[];
(function(){var a=document.getElementsByTagName("SCRIPT");webix.assert(a.length,"Can't locate codebase");a.length&&(a=(a[a.length-1].getAttribute("src")||"").split("/"),a.splice(a.length-1,1),webix.codebase=a.slice(0,a.length).join("/")+"/");a=function(){webix.env.isIE&&(document.body.className+=" webix_ie");webix.callEvent("onReady",[])};var b=function(){webix._ready=!0;window.webix_ready&&webix.isArray(webix_ready)&&(webix._ready_code=webix_ready.concat(webix._ready_code));for(var a=0;a<webix._ready_code.length;a++)webix._ready_code[a].call();
webix._ready_code=[]};webix.attachEvent("onReady",function(a){a?b():webix.delay(b)});"complete"==document.readyState?a():webix.event(window,"load",a)})();webix.locale=webix.locale||{};webix.assert_core_ready();webix.ready(function(){webix.event(document.body,"click",function(a){webix.callEvent("onClick",[a||event])})});webix.editStop=function(){webix.callEvent("onEditEnd",[])};webix.debug_blacklist={onmousemoving:1};
(function(a){function b(a){d.setImmediate?setImmediate(a):d.importScripts||!d.addEventListener?setTimeout(a):(e++,f[e]=a,d.postMessage(e,"*"))}function c(a){function d(a,b,c,d){if(2==g)return d();if("object"!=typeof h&&"function"!=typeof h||"function"!=typeof a)d();else try{var e=0;a.call(h,function(a){e++||(h=a,b())},function(a){e++||(h=a,c())})}catch(B){h=B,c()}}function e(){try{var a=h&&h.then}catch(y){return h=y,g=2,e()}d(a,function(){g=1;e()},function(){g=2;e()},function(){try{1==g&&"function"==
typeof r?h=r(h):2==g&&"function"==typeof v&&(h=v(h),g=1)}catch(y){return h=y,t()}h==f?(h=TypeError(),t()):d(a,function(){t(3)},t,function(){t(1==g&&3)})})}if("function"!=typeof a&&void 0!=a)throw TypeError();if("object"!=typeof this||this&&this.then)throw TypeError();var f=this,g=0,h=0,q=[],r,v;f.promise=f;f.resolve=function(a){r=f.fn;v=f.er;g||(h=a,g=1,b(e));return f};f.reject=function(a){r=f.fn;v=f.er;g||(h=a,g=2,b(e));return f};f._d=1;f.then=function(a,b){if(1!=this._d)throw TypeError();var d=
new c;d.fn=a;d.er=b;3==g?d.resolve(h):4==g?d.reject(h):q.push(d);return d};f["catch"]=function(a){return f.then(null,a)};f.fail=function(a){return f.then(null,a)};var t=function(a){g=a||4;for(a=0;a<q.length;a++){var b=q[a];3==g&&b.resolve(h)||b.reject(h)}};try{"function"==typeof a&&a(f.resolve,f.reject)}catch(u){f.reject(u)}return f}var d=this,e=1,f={},g=!1;!d.setImmediate&&d.addEventListener&&d.addEventListener("message",function(a){if(a.source==d)if(g)b(f[a.data]);else{g=!0;try{f[a.data]()}catch(k){}delete f[a.data];
g=!1}});c.resolve=function(a){if(1!=this._d)throw TypeError();return a instanceof c?a:new c(function(b){b(a)})};c.reject=function(a){if(1!=this._d)throw TypeError();return new c(function(b,c){c(a)})};c.all=function(a){function b(c,e){if(e)return d.resolve(e);if(c)return d.reject(c);0==a.reduce(function(a,b){return b&&b.then?a+1:a},0)&&d.resolve(a);a.map(function(c,d){c&&c.then&&c.then(function(c){a[d]=c;b();return c},b)})}if(1!=this._d)throw TypeError();if(!(a instanceof Array))return c.reject(TypeError());
var d=new c;b();return d};c.race=function(a){function b(c,e){if(e)return d.resolve(e);if(c)return d.reject(c);0==a.reduce(function(a,b){return b&&b.then?a+1:a},0)&&d.resolve(a);a.map(function(a,c){a&&a.then&&a.then(function(a){b(null,a)},b)})}if(1!=this._d)throw TypeError();if(!(a instanceof Array))return c.reject(TypeError());if(0==a.length)return new c;var d=new c;b();return d};c._d=1;c.defer=function(){return new c(null)};a.promise=c})(webix);
(function(){function a(a,c){this._proxy={};this._queue=[];this._url=a;this._key="";c?this._process(c):this._ready=webix.ajax(a).then(function(a){return a.text()}).then(webix.bind(function(a){a=a.split("/*api*/")[1];this._process(JSON.parse(a));return this._proxy},this))}a.prototype={_process:function(a){a.$key&&(this._key=a.$key);if(a.$vars)for(var b in a.$vars)this._proxy[b]=a.$vars[b];this._parse(a,this._proxy,"")},_parse:function(a,c,d){for(var b in a)if("$key"!==b&&"$vars"!==b){var f=a[b];if("object"==
typeof f){var g=c[b]={};this._parse(f,g,d+b+".")}else c[b]=this._proxy_call(this,d+b)}},_call:function(a,c){a=this._deffer(this,a,c);this._queue.push(a);this._start_queue();return a},_start_queue:function(){this._timer||(this._timer=setTimeout(webix.bind(this._run_queue,this),1))},_run_queue:function(){for(var a=[],c=this._queue,d=0;d<this._queue.length;d++){var e=this._queue[d];e.$sync?(c.splice(d,1),d--):a.push({name:e.$name,args:e.$args})}c.length&&(d=webix.ajax(),a=this._pack(a),webix.callEvent("onBeforeRemoteCall",
[d,a,{}]),a=d.post(this._url,a).then(function(a){for(var b=a.json().data,d=0;d<b.length;d++){a=b[d];var e=b[d]&&b[d].__webix_remote_error;e?(webix.callEvent("onRemoteError",[e]),c[d].reject(e)):c[d].resolve(a)}},function(a){for(var b=0;b<c.length;b++)c[b].reject(a);throw a;}),webix.callEvent("onAfterRemoteCall",[a]));this._queue=[];this._timer=null},_sync:function(){var a=null;this.$sync=!0;var c=[{name:this.$name,args:this.$args}];try{var d=webix.ajax(),e=this.$context._pack(c);webix.callEvent("onBeforeRemoteCall",
[d,e,{sync:!0}]);var f=d.sync().post(this.$context._url,e);webix.callEvent("onAfterRemoteCall",[null]);a=JSON.parse(f.responseText).data[0];a.__webix_remote_error&&(a=null)}catch(g){}return a},_deffer:function(a,c,d){var b=webix.promise.defer();b.sync=a._sync;b.$name=c;b.$args=d;b.$context=this;return b},_proxy_call:function(a,c){return function(){return a._call(c,[].slice.call(arguments))}},_getProxy:function(){return this._ready||this._proxy},_pack:function(a){return{key:this._key,payload:a}}};
webix.remote=function(b,c){if("object"===typeof b){var d=document.getElementsByTagName("script");c=b;b=d[d.length-1].src;webix.remote=(new a(b,c))._getProxy()}else return(new a(b,c))._getProxy()}})();webix.skin={};
webix.skin.air={topLayout:"wide",barHeight:34,tabbarHeight:36,rowHeight:34,toolbarHeight:22,listItemHeight:28,inputHeight:34,inputPadding:2,menuHeight:34,menuMargin:0,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:13,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:0,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};
webix.skin.aircompact={topLayout:"wide",barHeight:24,tabbarHeight:26,rowHeight:26,toolbarHeight:22,listItemHeight:28,inputHeight:29,inputPadding:2,menuHeight:25,menuMargin:0,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:12,sliderPadding:10,sliderBorder:1,vSliderPadding:12.5,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:0,popupPadding:8,calendarHeight:70,padding:0,
optionHeight:23};
webix.skin.web={name:"web",topLayout:"space",barHeight:28,tabbarHeight:30,rowHeight:30,toolbarHeight:22,listItemHeight:28,inputHeight:28,inputPadding:2,menuMargin:0,menuHeight:27,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:11,sliderPadding:10,sliderBorder:1,vSliderPadding:10,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8,accordion:0},tabMargin:3,tabTopOffset:3,
popupPadding:8,calendarHeight:70,padding:0,optionHeight:22};
webix.skin.clouds={topLayout:"wide",barHeight:36,tabbarHeight:46,rowHeight:34,toolbarHeight:22,listItemHeight:32,inputHeight:30,inputPadding:2,menuHeight:34,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:12,sliderPadding:10,sliderBorder:1,vSliderPadding:11,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:2,tabOffset:0,tabBottomOffset:10,popupPadding:8,calendarHeight:70,
padding:0};
webix.skin.terrace={topLayout:"space",barHeight:37,tabbarHeight:39,rowHeight:38,toolbarHeight:22,listItemHeight:28,inputHeight:30,inputPadding:2,menuMargin:0,menuHeight:32,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:14,vSliderHeight:100,layoutMargin:{space:20,wide:20,clean:0,head:4,line:-1,toolbar:4,form:8},layoutPadding:{space:20,wide:0,clean:0,head:0,line:0,toolbar:4,form:8},tabMargin:2,tabOffset:0,popupPadding:8,calendarHeight:70,
padding:17,optionHeight:24};
webix.skin.metro={topLayout:"space",barHeight:36,tabbarHeight:46,rowHeight:34,toolbarHeight:36,listItemHeight:32,inputHeight:30,buttonHeight:45,inputPadding:2,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:13,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:0,form:8,accordion:0},tabMargin:2,tabOffset:0,tabBottomOffset:10,
popupPadding:8,calendarHeight:70,padding:0,optionHeight:23};
webix.skin.light={topLayout:"space",barHeight:36,tabbarHeight:46,rowHeight:32,toolbarHeight:36,listItemHeight:32,inputHeight:34,buttonHeight:45,inputPadding:3,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:13,vSliderHeight:100,layoutMargin:{space:15,wide:15,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:15,wide:0,clean:0,head:0,line:0,toolbar:0,form:8,accordion:0},tabMargin:2,tabOffset:0,
tabBottomOffset:10,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};
webix.skin.glamour={topLayout:"space",barHeight:39,tabbarHeight:39,rowHeight:32,toolbarHeight:39,listItemHeight:32,inputHeight:34,buttonHeight:34,inputPadding:3,menuHeight:36,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:13,sliderPadding:10,sliderBorder:1,vSliderPadding:13,vSliderHeight:100,layoutMargin:{space:15,wide:15,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:15,wide:0,clean:0,head:0,line:0,toolbar:3,form:8,accordion:0},tabMargin:1,tabOffset:0,
tabBottomOffset:1,popupPadding:8,calendarHeight:70,padding:0,optionHeight:27};
webix.skin.touch={topLayout:"space",barHeight:42,tabbarHeight:50,rowHeight:42,toolbarHeight:42,listItemHeight:42,inputHeight:42,inputPadding:4,menuHeight:42,labelTopHeight:24,unitHeaderHeight:34,inputSpacing:4,borderWidth:1,sliderHandleWidth:18,sliderPadding:10,sliderBorder:1,vSliderPadding:17,vSliderHeight:100,layoutMargin:{space:10,wide:4,clean:0,head:4,line:-1,toolbar:0,form:0,accordion:9},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:8,accordion:0},tabMargin:2,tabOffset:0,
tabBottomOffset:10,calendar:{headerHeight:70,timepickerHeight:35,height:310,width:300},padding:0,customCheckbox:!0,customRadio:!0,popupPadding:8,optionHeight:32};
webix.skin.flat={topLayout:"space",barHeight:46,tabbarHeight:46,rowHeight:34,toolbarHeight:46,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:3,menuHeight:34,labelTopHeight:22,propertyItemHeight:28,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:15,vSliderHeight:100,layoutMargin:{space:10,wide:10,clean:0,head:4,line:-1,toolbar:4,form:8,accordion:10},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:17,accordion:0},tabMargin:4,
tabOffset:0,tabBottomOffset:6,tabTopOffset:1,customCheckbox:!0,customRadio:!0,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:32};
webix.skin.compact={topLayout:"space",barHeight:34,tabbarHeight:34,rowHeight:24,toolbarHeight:34,listItemHeight:28,inputHeight:30,buttonHeight:30,inputPadding:3,menuHeight:28,labelTopHeight:16,inputSpacing:4,borderWidth:1,sliderHandleWidth:12,sliderPadding:10,sliderBorder:1,vSliderPadding:13,vSliderHeight:100,layoutMargin:{space:5,wide:5,clean:0,head:4,line:-1,toolbar:4,form:4,accordion:5},layoutPadding:{space:5,wide:0,clean:0,head:0,line:0,toolbar:2,form:12,accordion:0},tabMargin:3,tabOffset:0,tabBottomOffset:3,
tabTopOffset:1,customCheckbox:!0,customRadio:!0,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:23};
webix.skin.material={topLayout:"space",barHeight:45,tabbarHeight:47,rowHeight:38,toolbarHeight:22,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:2,menuMargin:0,menuHeight:34,labelTopHeight:16,propertyItemHeight:34,inputSpacing:4,borderWidth:1,sliderHandleWidth:16,sliderPadding:10,sliderBorder:1,layoutMargin:{material:10,space:10,wide:10,clean:0,head:4,line:-1,toolbar:4,form:16,accordion:0},layoutPadding:{material:10,space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:16,accordion:0},
tabMargin:0,tabOffset:0,tabBottomOffset:0,tabTopOffset:0,customCheckbox:!0,customRadio:!0,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion"};
webix.skin.contrast={topLayout:"space",barHeight:46,tabbarHeight:46,rowHeight:34,toolbarHeight:46,listItemHeight:34,inputHeight:38,buttonHeight:38,inputPadding:3,menuHeight:34,labelTopHeight:22,propertyItemHeight:28,inputSpacing:4,borderWidth:1,sliderHandleWidth:14,sliderPadding:10,sliderBorder:1,vSliderPadding:15,vSliderHeight:100,layoutMargin:{space:10,wide:10,clean:0,head:4,line:-1,toolbar:8,form:8,accordion:10},layoutPadding:{space:10,wide:0,clean:0,head:0,line:0,toolbar:4,form:17,accordion:0},
tabMargin:4,tabOffset:0,tabBottomOffset:6,tabTopOffset:1,customCheckbox:!0,customRadio:!0,popupPadding:8,calendarHeight:70,padding:0,accordionType:"accordion",optionHeight:32};webix.skin.set=function(a){webix.assert(webix.skin[a],"Incorrect skin name: "+a);webix.skin.$active=webix.skin[a];webix.skin.$name=a;if(webix.ui)for(var b in webix.ui)(a=webix.ui[b])&&a.prototype&&a.prototype.$skin&&a.prototype.$skin(a.prototype)};webix.skin.set(window.webix_skin||"flat");
webix.Destruction={$init:function(){var a=this._destructor_handler={obj:this};webix.destructors.push(a)},destructor:function(){var a=this._settings;this._last_editor&&this.editCancel();this.callEvent&&this.callEvent("onDestruct",[]);this.destructor=function(){};this._destructor_handler.obj=null;if(this.getChildViews){var b=this.getChildViews();if(b)for(var c=0;c<b.length;c++)b[c].destructor();if(this._destroy_with_me)for(c=0;c<this._destroy_with_me.length;c++)this._destroy_with_me[c].destructor()}delete webix.ui.views[a.id];
a.$id&&(b=this.getTopParentView())&&b._destroy_child&&b._destroy_child(a.$id);this._html=this._htmlrows=this._htmlmap=null;this._contentobj&&(this._contentobj.innerHTML="",this._contentobj._htmlmap=null);this._viewobj&&this._viewobj.parentNode&&this._viewobj.parentNode.removeChild(this._viewobj);this.data&&this.data.destructor&&this.data.destructor();this.unbind&&this.unbind();this._viewobj=this.$view=this._contentobj=this._dataobj=this.data=null;this._evs_events=this._evs_handlers={};webix.UIManager._view==
this&&(webix.UIManager._view=null);(a=a.url)&&a.$proxy&&a.release&&a.release();this.$scope=null;this.$destructed=!0}};webix.destructors=[];webix.event(window,"unload",function(){webix.callEvent("unload",[]);webix._final_destruction=!0;for(var a=0;a<webix.destructors.length;a++){var b=webix.destructors[a].obj;b&&b.destructor()}webix.destructors=[];webix.ui._popups=webix.toArray();for(var c in webix._events)webix.eventRemove(c)});
(function(){var a={},b={},c=/(\r\n|\n)/g,d=/(\")/g,e=/(\\)/g,f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},g=/[&<>"'`]/g,h=function(a){return f[a]||"&amp;"};webix.template=function(f){if("function"==typeof f)return f;if(a[f])return a[f];f=(f||"").toString();if(-1!=f.indexOf("->")){var g=f.split("->");switch(g[0]){case "html":f=webix.html.getValue(g[1]);break;case "http":f=(new webix.ajax).sync().get(g[1],{uid:webix.uid()}).responseText}}f=(f||"").toString();if(webix.env.strict){if(!b[f]){b[f]=
[];var h=[];f.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,function(a,b,c,d,e){h.push({pos:e,str:a,fn:function(a,e){return a[b]?c:d}})});f.replace(/\{common\.([^}\(]*)\}/g,function(a,b,c){h.push({pos:c,str:a,fn:function(a,c){return c[b]||""}})});f.replace(/\{common\.([^\}\(]*)\(\)\}/g,function(a,b,c){h.push({pos:c,str:a,fn:function(a,c){return c[b]?c[b].apply(this,arguments):""}})});f.replace(/\{obj\.([^:}]*)\}/g,function(a,b,c){h.push({pos:c,str:a,fn:function(a,c){return a[b]}})});f.replace("{obj}",
function(a,b,c){h.push({pos:c,str:a,fn:function(a,b){return a}})});f.replace(/#([^#'";, ]+)#/gi,function(a,b,c){"!"==b.charAt(0)?(b=b.substr(1),h.push({pos:c,str:a,fn:function(a,c){-1!=b.indexOf(".")&&(a=webix.CodeParser.collapseNames(a));return webix.template.escape(a[b])}})):h.push({pos:c,str:a,fn:function(a,c){-1!=b.indexOf(".")&&(a=webix.CodeParser.collapseNames(a));return a[b]}})});h.sort(function(a,b){return a.pos>b.pos?1:-1});if(h.length){g=0;for(var k=function(a,c,d){b[a].push(function(){return a.slice(c,
d)})},p=0;p<h.length;p++){var q=h[p].pos;k(f,g,q);b[f].push(h[p].fn);g=q+h[p].str.length}k(f,g,f.length)}else b[f].push(function(){return f})}return function(){for(var a="",c=0;c<b[f].length;c++)a+=b[f][c].apply(this,arguments);return a}}f=f.replace(e,"\\\\");f=f.replace(c,"\\n");f=f.replace(d,'\\"');f=f.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g,'"+(obj.$1?"$2":"$3")+"');f=f.replace(/\{common\.([^}\(]*)\}/g,"\"+(common.$1||'')+\"");f=f.replace(/\{common\.([^\}\(]*)\(\)\}/g,'"+(common.$1?common.$1.apply(this, arguments):"")+"');
f=f.replace(/\{obj\.([^}]*)\}/g,'"+(obj.$1)+"');f=f.replace("{obj}",'"+obj+"');f=f.replace(/#([^#'";, ]+)#/gi,function(a,b){return"!"==b.charAt(0)?'"+webix.template.escape(obj.'+b.substr(1)+')+"':'"+(obj.'+b+')+"'});try{a[f]=Function("obj","common",'return "'+f+'";')}catch(r){webix.assert_error("Invalid template:"+f)}return a[f]};webix.template.escape=function(a){return a===webix.undefined||null===a?"":(a.toString()||"").replace(g,h)};webix.template.empty=function(){return""};webix.template.bind=
function(a){return webix.bind(webix.template(a),this)};webix.type=function(a,b){if(a.$protoWait)a._webix_type_wait||(a._webix_type_wait=[]),a._webix_type_wait.push(b);else{"function"==typeof a&&(a=a.prototype);a.types||(a.types={"default":a.type},a.type.name="default");var c=b.name,d=a.type;c&&(d=a.types[c]=webix.clone(b.baseType?a.types[b.baseType]:a.type));for(var e in b)0===e.indexOf("template")?d[e]=webix.template(b[e]):d[e]=b[e];return c}}})();
webix.Settings={$init:function(){this._settings=this.config={}},define:function(a,b){return"object"==typeof a?this._parseSeetingColl(a):this._define(a,b)},_define:function(a,b){var c=this[a+"_setter"];return this._settings[a]=c?c.call(this,b,a):b},_parseSeetingColl:function(a){if(a)for(var b in a)this._define(b,a[b])},_parseSettings:function(a,b){var c={};b&&(c=webix.extend(c,b));"object"!=typeof a||a.tagName||webix.extend(c,a,!0);this._parseSeetingColl(c)},_mergeSettings:function(a,b){for(var c in b)switch(typeof a[c]){case "object":a[c]=
this._mergeSettings(a[c]||{},b[c]);break;case "undefined":a[c]=b[c]}return a}};webix.proxy=function(a,b,c){webix.assert(webix.proxy[a],"Invalid proxy name: "+a);a=webix.copy(webix.proxy[a]);a.source=b;c&&webix.extend(a,c,!0);a.init&&a.init();return a};webix.proxy.$parse=function(a){return"string"==typeof a&&-1!=a.indexOf("->")?(a=a.split("->"),webix.proxy(a[0],a[1])):a};
webix.proxy.post={$proxy:!0,load:function(a,b,c){c=webix.extend(c||{},this.params||{},!0);webix.ajax().bind(a).post(this.source,c,b)}};webix.proxy.sync={$proxy:!0,load:function(a,b){webix.ajax().sync().bind(a).get(this.source,null,b)}};
webix.proxy.connector={$proxy:!0,connectorName:"!nativeeditor_status",load:function(a,b){webix.ajax(this.source,b,a)},saveAll:function(a,b,c,d){a=this.source;c={};for(var e=[],f=0;f<b.length;f++){var g=b[f];e.push(g.id);for(var h in g.data)0!==h.indexOf("$")&&(c[g.id+"_"+h]=g.data[h]);c[g.id+"_"+this.connectorName]=g.operation}c.ids=e.join(",");c.webix_security=webix.securityKey;a+=-1==a.indexOf("?")?"?":"&";a+="editing=true";webix.ajax().post(a,c,d)},result:function(a,b,c,d,e,f){e=e.xml();if(!e)return c._processError(null,
d,e,f);a=e.data.action;a.length||(a=[a]);b=[];for(var g=0;g<a.length;g++){var h=a[g];b.push(h);h.status=h.type;h.id=h.sid;h.newid=h.tid;c.processResult(h,h,{text:d,data:e,loader:f})}return b}};webix.proxy.debug={$proxy:!0,load:function(){},save:function(a,b,c,d){webix.delay(function(){window.console.log("[DP] "+b.id+" -> "+b.operation,b.data);var a={id:b.data.id,newid:b.data.id,status:b.data.operation};c.processResult(a,a)})}};
webix.proxy.rest={$proxy:!0,load:function(a,b){webix.ajax(this.source,b,a)},save:function(a,b,c,d){return webix.proxy.rest._save_logic.call(this,a,b,c,d,webix.ajax())},_save_logic:function(a,b,c,d,e){a=this.source;c="";var f=a.indexOf("?");-1!==f&&(c=a.substr(f),a=a.substr(0,f));a+="/"==a.charAt(a.length-1)?"":"/";f=b.operation;b=b.data;"insert"==f&&delete b.id;"update"==f?e.put(a+b.id+c,b,d):"delete"==f?e.del(a+b.id+c,b,d):e.post(a+c,b,d)}};
webix.proxy.json={$proxy:!0,load:function(a,b){webix.ajax(this.source,b,a)},save:function(a,b,c,d){var e=webix.ajax().headers({"Content-Type":"application/json"});return webix.proxy.rest._save_logic.call(this,a,b,c,d,e)}};
webix.proxy.faye={$proxy:!0,init:function(){this.clientId=this.clientId||webix.uid()},load:function(a){var b=this.clientId;this.client.subscribe(this.source,function(c){c.clientId!=b&&webix.dp(a).ignore(function(){if("delete"==c.operation)a.remove(c.data.id);else if("insert"==c.operation)a.add(c.data);else if("update"==c.operation){var b=a.getItem(c.data.id);b&&(webix.extend(b,c.data,!0),a.refresh(b.id))}})})},save:function(a,b,c,d){b.clientId=this.clientId;this.client.publish(this.source,b)}};
webix.proxy.indexdb={$proxy:!0,create:function(a,b,c,d){this.source=a+"/";this._get_db(d,c,function(a){a=a.target.result;for(var c in b)for(var d=b[c],e=a.createObjectStore(c,{keyPath:"id",autoIncrement:!0}),k=0;k<d.length;k++)e.put(d[k])})},_get_db:function(a,b,c){if(-1!=this.source.indexOf("/")){var d=this.source.split("/");this.source=d[1];b=b||d[2];var e=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB;b=b?e.open(d[0],b):e.open(d[0]);c&&(b.onupgradeneeded=c);b.onerror=function(){};
b.onblocked=function(){};b.onsuccess=webix.bind(function(b){this.db=b.target.result;a&&a.call(this)},this)}else this.db?a.call(this):webix.delay(this._get_db,this,[a],50)},load:function(a,b){this._get_db(function(){var c=[];this.db.transaction(this.source).objectStore(this.source).openCursor().onsuccess=function(d){(d=d.target.result)?(c.push(d.value),d["continue"]()):(a.parse(c),webix.ajax.$callback(a,b,"[]",c))}})},save:function(a,b,c,d){this._get_db(function(){var a=b.operation,d=b.data,g=b.id,
h=this.db.transaction([this.source],"readwrite").objectStore(this.source);if("delete"==a)var k=h["delete"](g);else"update"==a?k=h.put(d):"insert"==a&&(delete d.id,k=h.add(d));k.onsuccess=function(d){var e={status:a,id:b.id};"insert"==a&&(e.newid=d.target.result);c.processResult(e,e)}})}};
webix.proxy.binary={$proxy:!0,load:function(a,b){var c=this.source.split("@"),d=c[0].split(".").pop();return webix.ajax().response("arraybuffer").get(c[0]).then(function(e){webix.ajax.$callback(a,b,"",{data:e,options:{ext:d,dataurl:c[1]}},-1)})}};webix.ajax=function(a,b,c){return 0!==arguments.length?(new webix.ajax).get(a,b,c):this.getXHR?this:new webix.ajax};webix.ajax.count=0;
webix.ajax.prototype={master:null,getXHR:function(){return new XMLHttpRequest},stringify:function(a){return webix.stringify(a)},_send:function(a,b,c,d){if(b&&(webix.isArray(b)||"function"==typeof(b.success||b.error||b))){var e=c;c=b;b=null}var f=webix.promise.defer(),g=this.getXHR();webix.isArray(c)||(c=[c]);c.push({success:function(a,b){f.resolve(b)},error:function(a,b){f.reject(g)}});var h=this._header||{};if(webix.callEvent("onBeforeAjax",[d,a,b,g,h,null,f])){var k=!1;if("GET"!==d){var l=!1,m;
for(m in h)"content-type"==m.toString().toLowerCase()&&(l=!0,"application/json"==h[m]&&(k=!0));l||(h["Content-Type"]="application/x-www-form-urlencoded")}if("object"==typeof b&&!(window.FormData&&b instanceof window.FormData))if(k)b=this.stringify(b);else{k=[];for(var n in b){l=b[n];if(null===l||l===webix.undefined)l="";"object"===typeof l&&(l=this.stringify(l));k.push(n+"="+encodeURIComponent(l))}b=k.join("&")}b&&"GET"===d&&(a=a+(-1!=a.indexOf("?")?"&":"?")+b,b=null);g.open(d,a,!this._sync);if(a=
this._response)g.responseType=a;for(m in h)g.setRequestHeader(m,h[m]);var p=this;this.master=this.master||e;g.onreadystatechange=function(){if(!g.readyState||4==g.readyState){webix.debug_time&&webix.log_full_time("data_loading");webix.ajax.count++;if(c&&p&&!g.aborted){if(-1!=webix._xhr_aborted.find(g))return webix._xhr_aborted.remove(g);var a=p.master||p,b=400<=g.status||0===g.status;if("blob"==g.responseType||"arraybuffer"==g.responseType){var d="";var f=g.response}else d=g.responseText||"",f=p._data(g);
webix.ajax.$callback(a,c,d,f,g,b)}p&&(p.master=null);c=p=e=null}};this._timeout&&(g.timeout=this._timeout);this._sync?g.send(b||null):setTimeout(function(){g.aborted||(-1!=webix._xhr_aborted.find(g)?webix._xhr_aborted.remove(g):g.send(b||null))},1);this.master&&this.master._ajax_queue&&this.master._ajax_queue.push(g);return this._sync?g:f}},_data:function(a){return{xml:function(){try{return webix.DataDriver.xml.tagToObject(webix.DataDriver.xml.toObject(a.responseText,this))}catch(b){webix.log(a.responseText),
webix.log(b.toString()),webix.assert_error("Invalid xml data for parsing")}},rawxml:function(){return window.XPathResult?a.responseXML:webix.DataDriver.xml.fromString(a.responseText)},text:function(){return a.responseText},json:function(){return webix.DataDriver.json.toObject(a.responseText,!1)}}},get:function(a,b,c){return this._send(a,b,c,"GET")},post:function(a,b,c){return this._send(a,b,c,"POST")},put:function(a,b,c){return this._send(a,b,c,"PUT")},del:function(a,b,c){return this._send(a,b,c,
"DELETE")},patch:function(a,b,c){return this._send(a,b,c,"PATCH")},sync:function(){this._sync=!0;return this},timeout:function(a){this._timeout=a;return this},response:function(a){this._response=a;return this},header:function(a){webix.assert(!1,"ajax.header is deprecated in favor of ajax.headers");this._header=a;return this},headers:function(a){this._header=webix.extend(this._header||{},a);return this},bind:function(a){this.master=a;return this}};
webix.ajax.$callback=function(a,b,c,d,e,f){if(!a.$destructed){-1===e&&d&&"function"==typeof d.json&&(d=d.json());f&&webix.callEvent("onAjaxError",[e]);webix.isArray(b)||(b=[b]);if(!f)for(var g=0;g<b.length;g++)if(b[g]){var h=b[g].before;h&&h.call(a,c,d,e)}for(g=0;g<b.length;g++)b[g]&&(h=b[g].success||b[g],f&&(h=b[g].error),h&&h.call&&h.call(a,c,d,e))}};
webix.send=function(a,b,c,d){a=webix.html.create("FORM",{target:d||"_self",action:a,method:c||"POST"},"");for(var e in b)c=webix.html.create("INPUT",{type:"hidden",name:e,value:b[e]},""),a.appendChild(c);a.style.display="none";document.body.appendChild(a);a.submit();document.body.removeChild(a)};
webix.AtomDataLoader={$init:function(a){this.data={};this.waitData=webix.promise.defer();a&&(this._settings.datatype=a.datatype||"json");this.$ready.push(this._load_when_ready)},_load_when_ready:function(){this._ready_for_data=!0;this._settings.url&&this.url_setter(this._settings.url);this._settings.data&&this.data_setter(this._settings.data)},url_setter:function(a){a=webix.proxy.$parse(a);if(!this._ready_for_data)return a;this.load(a,this._settings.datatype);return a},data_setter:function(a){if(!this._ready_for_data)return a;
this.parse(a,this._settings.datatype);return!0},load:function(a,b,c){var d=c||null;if(!this.callEvent("onBeforeLoad",[]))return webix.promise.reject();"string"==typeof b?(this.data.driver=webix.DataDriver[b],b=c):this.data.driver||(this.data.driver=webix.DataDriver.json);var e=[{success:this._onLoad,error:this._onLoadError}];b&&(webix.isArray(b)?e.push.apply(e,b):e.push(b));a=webix.proxy.$parse(a);return a.$proxy&&a.load?a.load(this,e,d):"function"===typeof a?a(d).then(webix.bind(function(a){webix.ajax.$callback(this,
e,"",a,-1)},this),webix.bind(function(a){webix.ajax.$callback(this,e,"",null,a,!0)},this)):webix.ajax(a,e,this)},parse:function(a,b){if(a&&a.then&&"function"==typeof a.then)return a.then(webix.bind(function(a){a&&"function"==typeof a.json&&(a=a.json());this.parse(a,b)},this));if(a&&a.sync&&this.sync)return this._syncData(a);if(!this.callEvent("onBeforeLoad",[]))return webix.promise.reject();this.data.driver=webix.DataDriver[b||"json"];this._onLoad(a,null)},_syncData:function(a){this.data&&this.data.attachEvent("onSyncApply",
webix.bind(function(){this._call_onready&&this._call_onready()},this));this.sync(a)},_parse:function(a){var b=this.data.driver;b=(a=b.getRecords(a)[0])?b.getDetails(a):{};this.setValues?this.setValues(b):this.data=b},_onLoadContinue:function(a,b,c,d){a?this.$onLoad&&this.$onLoad(a,this.data.driver)||(this.data&&this.data._parse?this.data._parse(a):this._parse(a)):this._onLoadError(b,c,d);this._call_onready&&this._call_onready();this.callEvent("onAfterLoad",[]);this.waitData.resolve()},_onLoad:function(a,
b,c){var d=this.data.driver;-1===c?a=d.toObject(b):(this._ajax_queue&&this._ajax_queue.remove(c),a=d.toObject(a,b));a&&a.then?a.then&&"function"==typeof a.then&&a.then(webix.bind(this._onLoadContinue,this)):this._onLoadContinue(a)},_onLoadError:function(a,b,c){this.callEvent("onAfterLoad",[]);this.callEvent("onLoadError",arguments);webix.callEvent("onLoadError",[a,b,c,this])},_check_data_feed:function(a){if(!this._settings.dataFeed||this._ignore_feed||!a)return!0;var b=this._settings.dataFeed;if("function"==
typeof b)return b.call(this,a.id||a,a);b=b+(-1==b.indexOf("?")?"?":"&")+"action=get&id="+encodeURIComponent(a.id||a);if(!this.callEvent("onBeforeLoad",[]))return!1;webix.ajax(b,function(a,b,e){this._ignore_feed=!0;var c=webix.DataDriver.json,d=c.toObject(a,b);d?this.setValues(c.getDetails(c.getRecords(d)[0])):this._onLoadError(a,b,e);this._ignore_feed=!1;this.callEvent("onAfterLoad",[])},this);return!1}};webix.DataDriver={};
webix.DataDriver.json={toObject:function(a){if(!a)return null;if("string"==typeof a)try{if(this.parseDates){var b=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d{1-3})?Z/;a=JSON.parse(a,function(a,d){return"string"==typeof d&&b.test(d)?new Date(d):d})}else a=JSON.parse(a)}catch(c){return webix.log(c),webix.log(a),webix.assert_error("Invalid JSON data for parsing"),null}return a},getRecords:function(a){a&&a.data&&(a=a.data);return a&&!webix.isArray(a)?[a]:a},getDetails:function(a){return"string"==typeof a?
{id:a||webix.uid(),value:a}:a},getOptions:function(a){return a.collections},getInfo:function(a){return{size:a.total_count||0,from:a.pos,parent:a.parent||0,config:a.config,key:a.webix_security}},child:"data",parseDates:!1};
webix.DataDriver.html={toObject:function(a){if("string"==typeof a){var b=null;-1==a.indexOf("<")&&(b=webix.toNode(a));b||(b=document.createElement("DIV"),b.innerHTML=a);return b.firstChild}return a},getRecords:function(a){return a.getElementsByTagName(this.tag)},getDetails:function(a){return webix.DataDriver.xml.tagToObject(a)},getOptions:function(){return!1},getInfo:function(a){return{size:0}},tag:"LI"};
webix.DataDriver.jsarray={toObject:function(a){return"string"==typeof a?JSON.parse(a):a},getRecords:function(a){a&&a.data&&(a=a.data);return a},getDetails:function(a){for(var b={},c=0;c<a.length;c++)b["data"+c]=a[c];null!==this.idColumn&&(b.id=a[this.idColumn]);return b},getOptions:function(){return!1},getInfo:function(a){return{size:0}},idColumn:null};
webix.DataDriver.csv={toObject:function(a){return a},getRecords:function(a){return a.split(this.row)},getDetails:function(a){a=this.stringToArray(a);for(var b={},c=0;c<a.length;c++)b["data"+c]=a[c];null!==this.idColumn&&(b.id=a[this.idColumn]);return b},getOptions:function(){return!1},getInfo:function(a){return{size:0}},stringToArray:function(a){a=a.split(this.cell);for(var b=0;b<a.length;b++)a[b]=a[b].replace(/^[ \t\n\r]*("|)/g,"").replace(/("|)[ \t\n\r]*$/g,"");return a},idColumn:null,row:"\n",
cell:","};
webix.DataDriver.xml={_isValidXML:function(a){return a&&a.documentElement&&!a.getElementsByTagName("parsererror").length?a:null},toObject:function(a,b){b=b?b.rawxml?b.rawxml():b:null;if(this._isValidXML(b))return b;b="string"==typeof a?this.fromString(a.replace(/^[\s]+/,"")):a;return this._isValidXML(b)?b:null},getRecords:function(a){return this.xpath(a,this.records)},records:"/*/item",child:"item",config:"/*/config",getDetails:function(a){return this.tagToObject(a,{})},getOptions:function(){return!1},getInfo:function(a){var b=
this.xpath(a,this.config);b=b.length?this.assignTypes(this.tagToObject(b[0],{})):null;return{size:a.documentElement.getAttribute("total_count")||0,from:a.documentElement.getAttribute("pos"),parent:a.documentElement.getAttribute("parent")||0,config:b,key:a.documentElement.getAttribute("webix_security")||null}},xpath:function(a,b){if(window.XPathResult){var c=a;-1==a.nodeName.indexOf("document")&&(a=a.ownerDocument);var d=[];a=a.evaluate(b,c,null,XPathResult.ANY_TYPE,null);for(b=a.iterateNext();b;)d.push(b),
b=a.iterateNext();return d}d=!0;try{"undefined"==typeof a.selectNodes&&(d=!1)}catch(e){}if(d)return a.selectNodes(b);d=b.split("/").pop();return a.getElementsByTagName(d)},assignTypes:function(a){for(var b in a){var c=a[b];"object"==typeof c?this.assignTypes(c):"string"==typeof c&&""!==c&&("true"==c?a[b]=!0:"false"==c?a[b]=!1:c==1*c&&(a[b]*=1))}return a},tagToObject:function(a,b){var c=0;if(1==a.nodeType&&a.getAttribute("stack"))for(b=[],e=a.childNodes,d=0;d<e.length;d++)1==e[d].nodeType&&b.push(this.tagToObject(e[d],
{}));else{b=b||{};if((e=a.attributes)&&e.length)for(var d=0;d<e.length;d++)b[e[d].name]=e[d].value,c=1;var e=a.childNodes;for(d=0;d<e.length;d++)1==e[d].nodeType&&(c=e[d].tagName,b[c]?("function"!=typeof b[c].push&&(b[c]=[b[c]]),b[c].push(this.tagToObject(e[d],{}))):b[c]=this.tagToObject(e[d],{}),c=2);if(!c)return this.nodeValue(a);2>c&&(b.value=b.value||this.nodeValue(a))}return b},nodeValue:function(a){return a.firstChild?a.firstChild.wholeText||a.firstChild.data:""},fromString:function(a){try{if(window.DOMParser)return(new DOMParser).parseFromString(a,
"text/xml");if(window.ActiveXObject){var b=new ActiveXObject("Microsoft.xmlDOM");b.loadXML(a);return b}}catch(c){return webix.assert_error(c),null}webix.assert_error("Load from xml string is not supported")}};
webix.debug_code(function(){webix.debug_load_event=webix.attachEvent("onLoadError",function(a,b,c,d){a=a||"[EMPTY DATA]";b="Data loading error, check console for details";0===a.indexOf("<?php")?b="PHP support missed":0===a.indexOf("WEBIX_ERROR:")&&(b=a.replace("WEBIX_ERROR:",""));webix.message&&webix.message({type:"debug",text:b,expire:-1});window.console&&(b=window.console,b.log("Data loading error"),b.log("Object:",d),b.log("Response:",a),b.log("XHTTP:",c))});webix.ready(function(){0===document.location.href.indexOf("file:")&&
(webix.message?webix.message({type:"error",text:"Please open sample by http,<br>not as file://",expire:-1}):window.alert("Please open sample by http, not as file://"))})});
webix.BaseBind={bind:function(a,b,c){this.attachEvent||webix.extend(this,webix.EventSystem);"string"==typeof a&&(a=webix.$$(a));a._initBindSource&&a._initBindSource();this._initBindSource&&this._initBindSource();a.getBindData||webix.extend(a,webix.BindSource);this._bind_ready();a.addBind(this._settings.id,b,c);this._bind_source=a._settings.id;webix.debug_bind&&webix.log("[bind] "+this.name+"@"+this._settings.id+" <= "+a.name+"@"+a._settings.id);var d=this._settings.id;this._bind_refresh_handler=this.attachEvent(this.touchable?
"onAfterRender":"onBindRequest",function(){return a.getBindData(d)});this.refresh&&this.isVisible(this._settings.id)&&this.refresh()},unbind:function(){if(this._bind_source){var a=webix.$$(this._bind_source);a&&a.removeBind(this._settings.id);this.detachEvent(this._bind_refresh_handler);this._bind_source=null}},_bind_ready:function(){var a=this._settings;if(this.filter){var b=a.id;this.data._on_sync=webix.bind(function(){webix.$$(this._bind_source)._bind_updated[b]=!1},this)}var c=this.render;this.render=
function(){if(!this._in_bind_processing){this._in_bind_processing=!0;var a=this.callEvent("onBindRequest");this._in_bind_processing=!1;return c.apply(this,!1===a?arguments:[])}};if(this.getValue||this.getValues)this.save=function(a){var b=webix.$$(this._bind_source);if(a)b.setBindData(a);else{if(this.validate&&!this.validate())return!1;a=this.getValue?this.getValue:this.getValues();b.setBindData(a,this._settings.id);this.setDirty&&this.setDirty(!1)}};this._bind_ready=function(){}}};
webix.BindSource={$init:function(){this._bind_hash={};this._bind_updated={};this._ignore_binds={};this._bind_specific_rules(this)},saveBatch:function(a){this._do_not_update_binds=!0;a.call(this);this._do_not_update_binds=!1;this._update_binds()},setBindData:function(a,b){b&&(this._ignore_binds[b]=!0);webix.debug_bind&&webix.log("[bind:save] "+this.name+"@"+this._settings.id+" <= @"+b);if(this.setValue)this.setValue(a);else if(this.setValues)this.setValues(a);else{var c=this.getCursor();c?this.updateItem(c,
a):this.add(a)}this.callEvent("onBindUpdate",[a,b]);this.save&&this.save();b&&(this._ignore_binds[b]=!1)},getBindData:function(a,b){if(this._bind_updated[a])return!1;var c=webix.$$(a);c.isVisible(c._settings.id)&&(this._bind_updated[a]=!0,webix.debug_bind&&webix.log("[bind:request] "+this.name+"@"+this._settings.id+" => "+c.name+"@"+c._settings.id),this._bind_update(c,this._bind_hash[a][0],this._bind_hash[a][1]),b&&c.filter&&c.refresh())},addBind:function(a,b,c){this._bind_hash[a]=[b,c]},removeBind:function(a){delete this._bind_hash[a];
delete this._bind_updated[a];delete this._ignore_binds[a]},_bind_specific_rules:function(a){a.filter?webix.extend(this,webix.CollectionBind):a.setValue?webix.extend(this,webix.ValueBind):webix.extend(this,webix.RecordBind)},_update_binds:function(){if(!this._do_not_update_binds)for(var a in this._bind_hash)this._ignore_binds[a]||(this._bind_updated[a]=!1,this.getBindData(a,!0))},_bind_update_common:function(a,b,c){a.setValue?a.setValue(c&&b?c[b]:c):a.filter?a.data.silent(function(){this.filter(b,
c)}):!c&&a.clear?a.clear():a._check_data_feed(c)&&a.setValues(webix.clone(c));a.callEvent("onBindApply",[c,b,this])}};
webix.DataValue=webix.proto({name:"DataValue",isVisible:function(){return!0},$init:function(a){if(!a||webix.isUndefined(a.value))this.data=a||"";a=a&&a.id?a.id:webix.uid();this._settings={id:a};webix.ui.views[a]=this},setValue:function(a){this.data=a;this.callEvent("onChange",[a])},getValue:function(){return this.data},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind);
webix.DataRecord=webix.proto({name:"DataRecord",isVisible:function(){return!0},$init:function(a){this.data=a||{};a=a&&a.id?a.id:webix.uid();this._settings={id:a};webix.ui.views[a]=this},getValues:function(){return this.data},setValues:function(a,b){this.data=b?webix.extend(this.data,a,!0):a;this.callEvent("onChange",[a])},refresh:function(){this.callEvent("onBindRequest")}},webix.EventSystem,webix.BaseBind,webix.AtomDataLoader,webix.Settings);
webix.ValueBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(a,b,c){b=b||"value";var d=this.getValue()||"";c&&(d=c(d));a.setValue?a.setValue(d):a.filter?a.data.silent(function(){this.filter(b,d)}):(c={},c[b]=d,a._check_data_feed(d)&&a.setValues(c));a.callEvent("onBindApply",[d,b,this])}};
webix.RecordBind={$init:function(){this.attachEvent("onChange",this._update_binds)},_bind_update:function(a,b,c){var d=this.getValues()||null;c&&(d=c(d));this._bind_update_common(a,b,d)}};
webix.CollectionBind={$init:function(){this._cursor=null;this.attachEvent("onSelectChange",function(a){a=this.getSelectedId();this.setCursor(a?a.id||a:null)});this.attachEvent("onAfterCursorChange",this._update_binds);this.attachEvent("onAfterDelete",function(a){a==this.getCursor()&&this.setCursor(null)});this.data.attachEvent("onStoreUpdated",webix.bind(function(a,b,c){a&&a==this.getCursor()&&"paint"!=c&&"delete"!=c&&this._update_binds()},this));this.data.attachEvent("onClearAll",webix.bind(function(){this._cursor=
null},this));this.data.attachEvent("onIdChange",webix.bind(function(a,b){this._cursor==a&&(this._cursor=b,this._update_binds())},this))},refreshCursor:function(){this._cursor&&this.callEvent("onAfterCursorChange",[this._cursor])},setCursor:function(a){a==this._cursor||null!==a&&!this.getItem(a)||(this.callEvent("onBeforeCursorChange",[this._cursor]),this._cursor=a,this.callEvent("onAfterCursorChange",[a]))},getCursor:function(){return this._cursor},_bind_update:function(a,b,c){if("$level"==b&&this.data.getBranch)return(a.data||
a).importData(this.data.getBranch(this.getCursor()));var d=this.getItem(this.getCursor())||this._settings.defaultData||null;"$data"==b?("function"===typeof c?c.call(a,d,this):a.data.importData(d?d[c]:[]),a.callEvent("onBindApply",[d,b,this])):(c&&(d=c(d)),this._bind_update_common(a,b,d))}};
webix.AtomRender={_toHTML:function(a){return a.$empty?"":this._settings.template(a,this)},render:function(){var a=this._settings;if(this.isVisible(a.id)){webix.debug_render&&webix.log("Render: "+this.name+"@"+a.id);if(!this.callEvent||this.callEvent("onBeforeRender",[this.data]))this.data&&!a.content&&(this._dataobj.innerHTML="",this._dataobj.innerHTML=this._toHTML(this.data)),this.callEvent&&this.callEvent("onAfterRender",[]);return!0}return!1},sync:function(a){this._backbone_sync=!1;"DataStore"!=
a.name&&(a.data&&"DataStore"==a.name?a=a.data:this._backbone_sync=!0);this._backbone_sync?a.bind("change",webix.bind(function(a){a.id==this.data.id&&(this.data=a.attributes,this.refresh())},this)):a.attachEvent("onStoreUpdated",webix.bind(function(b){b&&b!=this.data.id||(this.data=a.pull[b],this.refresh())},this))},template_setter:webix.template};
webix.SingleRender=webix.proto({template_setter:function(a){this.type.template=webix.template(a)},_toHTML:function(a){var b=this.type;return(b.templateStart?b.templateStart(a,b):"")+b.template(a,b)+(b.templateEnd?b.templateEnd(a,b):"")},customize:function(a){webix.type(this,a)}},webix.AtomRender);
webix.UIManager={_view:null,_hotkeys:{},_focus_time:0,_tab_time:0,_mouse_time:0,_controls:{enter:13,tab:9,esc:27,escape:27,up:38,down:40,left:37,right:39,pgdown:34,pagedown:34,pgup:33,pageup:33,end:35,home:36,insert:45,"delete":46,backspace:8,space:32,meta:91,win:91,mac:91,multiply:106,add:107,subtract:109,decimal:110,divide:111,scrollock:145,pausebreak:19,numlock:144,"5numlocked":12,shift:16,capslock:20},_inputs:{input:1,button:1,textarea:1,select:1},_enable:function(){webix.event(document.body,
"click",webix.bind(this._focus_click,this));webix.event(document,"keydown",webix.bind(this._keypress,this));webix._event(document.body,"mousedown",webix.bind(function(){this._mouse_time=new Date},this));document.body.addEventListener&&webix.event(document.body,"focus",this._focus_tab,{capture:!0,bind:this});webix.destructors.push({obj:this})},destructor:function(){webix.UIManager._view=null},getFocus:function(){return this._view},_focus_action:function(a){this._focus_was_there=this._focus_was_there||
a._settings.id},setFocus:function(a,b){(a=webix.$$(a))&&!a.$view&&(a=null);this._focus_time=webix._focus_time=new Date;if(this._view===a)return!0;this._view&&this._view.callEvent&&this._view.callEvent("onBlur",[this._view]);a&&a.callEvent&&a.callEvent("onFocus",[a,this._view]);webix.callEvent("onFocusChange",[a,this._view]);this._view&&this._view.blur&&!b&&this._view.blur();(this._view=a)&&a.focus&&!b&&a.focus();return!0},applyChanges:function(a){var b=this.getFocus();b&&b!=a&&b._applyChanges&&b._applyChanges(a)},
hasFocus:function(a){return a===this._view?!0:!1},_focus:function(a,b){var c=webix.html.locate(a,"view_id")||this._focus_was_there;c=webix.$$(c);this._focus_was_there=null;webix._focus_time=new Date;if(c!=this._view)return b||(this._focus_was_there=null),c?(c=webix.$$(c),this.canFocus(c)&&(c.getNode&&c.getNode(a),this.setFocus(c))):b||this.setFocus(null),!0},_focus_click:function(a){return 100>new Date-this._focus_time?(this._focus_was_there=null,!1):this._focus(a)},_focus_tab:function(a){return this._inputs[a.target.nodeName.toLowerCase()]?
this._focus(a,!0):!1},canFocus:function(a){return a.isVisible()&&a.isEnabled()},_moveChildFocus:function(a){var b=this.getFocus();if(a&&!this._is_child_of(a,b))return!1;this._focus_logic("getPrev",a)||(this._view=null)},_translation_table:{},_is_child_of:function(a,b){if(!a||!b)return!1;for(;b;){if(b===a)return!0;b=b.getParentView()}return!1},_keypress_timed:function(){this&&this.callEvent&&this.callEvent("onTimedKeyPress",[])},_isNumPad:function(a){return 112>a&&105<a},_keypress:function(a){var b=
a.which||a.keyCode;95<b&&106>b&&(b-=48);b=this._translation_table[b]||b;var c=a.ctrlKey,d=a.shiftKey,e=a.altKey,f=a.metaKey,g=this._keycode(b,c,d,e,f),h=this.getFocus();h&&h.callEvent&&(!1===h.callEvent("onKeyPress",[b,a])&&webix.html.preventEvent(a),h.hasEvent("onTimedKeyPress")&&(clearTimeout(h._key_press_timeout),h._key_press_timeout=webix.delay(this._keypress_timed,h,[],h._settings.keyPressTimeout||250)));this._isNumPad(b)||(g=this._keycode(String.fromCharCode(b),c,d,e,f));if(!1===this._check_keycode(g,
!c&&!e&&!f&&9!=b&&27!=b&&13!=b,a))return webix.html.preventEvent(a),!1},_focus_logic:function(a){if(!this.getFocus())return null;a=a||"getNext";for(var b=this.getFocus(),c=b,d=webix.uid();;){if((b=this[a](b))&&this.canFocus(b))return this.setFocus(b);if(b===c||b.$fmarker==d)return null;b.$fmarker=d}},_tab_logic:function(a,b){var c=!b.shiftKey;webix.UIManager._tab_time=new Date;if(a&&a._custom_tab_handler&&!a._custom_tab_handler(c,b))return!1;if(a&&a._in_edit_mode){if(a.editNext)return a.editNext(c);
if(a.editStop)return a.editStop(),!0}else webix.delay(function(){webix.UIManager.setFocus(webix.$$(document.activeElement),!0)},1)},getTop:function(a){var b;for(a=webix.$$(a);a&&(b=a.getParentView());)a=b;return a},getNext:function(a,b){var c=a.getChildViews();if(c.length&&!b)return c[0];b=a.getParentView();if(!b)return a;c=b.getChildViews();if(c.length)for(a=webix.PowerArray.find.call(c,a)+1;a<c.length;){if(this.canFocus(c[a]))return c[a];a++}return this.getNext(b,!0)},getPrev:function(a,b){var c=
a.getChildViews();if(c.length&&b)return this.getPrev(c[c.length-1],!0);if(b)return a;b=a.getParentView();if(!b)return this.getPrev(a,!0);if(c=b.getChildViews())for(a=webix.PowerArray.find.call(c,a)-1;0<=a;){if(this.canFocus(c[a]))return this.getPrev(c[a],!0);a--}return b},addHotKey:function(a,b,c){webix.assert(b,"Hot key handler is not defined");var d=this._parse_keys(a);webix.assert(d.letter,"Unknown key code");c||(c=null);d.handler=b;d.view=c;b=this._keycode(d.letter,d.ctrl,d.shift,d.alt,d.meta);
this._hotkeys[b]||(this._hotkeys[b]=[]);this._hotkeys[b].push(d);return a},removeHotKey:function(a,b,c){a=this._parse_keys(a);a=this._keycode(a.letter,a.ctrl,a.shift,a.alt,a.meta);if(b||c){var d=this._hotkeys[a];if(d){for(var e=d.length-1;0<=e;e--)c&&d[e].view!==c||b&&d[e].handler!==b||d.splice(e,1);d.length||delete this._hotkeys[a]}}else delete this._hotkeys[a]},_keycode:function(a,b,c,d,e){return a+"_"+["",b?"1":"0",c?"1":"0",d?"1":"0",e?"1":"0"].join("")},_check_keycode:function(a,b,c){var d=this.getFocus();
return this._hotkeys[a]?this._process_calls(this._hotkeys[a],d,c):b&&this._hotkeys.ANY_0000?this._process_calls(this._hotkeys.ANY_0000,d,c):!0},_process_calls:function(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];if(null===e.view||b===e.view||"string"===typeof e.view&&b&&b.name===e.view)if(e=e.handler(b,c),!!e===e)return e}return!0},_parse_keys:function(a){var b=this._controls,c=a.toLowerCase().split(/[\+\-_]/),d,e,f;var g=d=e=f=0;for(var h="",k=0;k<c.length;k++)"ctrl"===c[k]?g=1:"shift"===c[k]?
d=1:"alt"===c[k]?e=1:"command"===c[k]?f=1:b[c[k]]?(h=b[c[k]],h=this._isNumPad(h)?h.toString():String.fromCharCode(h)):h=c[k];return{letter:h.toUpperCase(),ctrl:g,shift:d,alt:e,meta:f,debug:a}}};
webix.ready(function(){webix.UIManager._enable();webix.UIManager.addHotKey("enter",function(a,b){a&&a.callEvent&&a.callEvent("onEnter",[b]);if(a&&a.editStop&&a._in_edit_mode)return a.editStop(),!0;if(a&&a.touchable){var c=a.getFormView();c&&!a._skipSubmit&&c.callEvent("onSubmit",[a,b])}});webix.UIManager.addHotKey("esc",function(a){if(a){if(a.editCancel&&a._in_edit_mode)return a.editCancel(),!0;(a=a.getTopParentView())&&a.setPosition&&a._hide()}});webix.UIManager.addHotKey("shift+tab",webix.UIManager._tab_logic);
webix.UIManager.addHotKey("tab",webix.UIManager._tab_logic)});
webix.IdSpace={$init:function(){this._elements={};this._translate_ids={};this.getTopParentView=this._get_self=webix.bind(function(){return this},this);this._run_inner_init_logic();this.$ready.push(this._run_after_inner_init_logic)},$$:function(a){return this._elements[a]},innerId:function(a){return this._translate_ids[a]},_run_inner_init_logic:function(a){this._prev_global_col=webix._global_collection;webix._global_collection=this},_run_after_inner_init_logic:function(a){for(var b in this._elements)a=this._elements[b],
this.callEvent&&a.mapEvent&&!a._evs_map.onitemclick&&a.mapEvent({onitemclick:this}),a.getTopParentView=this._get_self;webix._global_collection=this._prev_global_col;this._prev_global_col=0},_destroy_child:function(a){delete this._elements[a]},ui:function(){this._run_inner_init_logic();var a=webix.ui.apply(webix,arguments);this._run_after_inner_init_logic();return a}};
(function(){var a=[],b=webix.ui;if(!webix.ui){b=webix.ui=function(a,f,g){webix._ui_creation=!0;var e=webix.isArray(a);f=webix.toNode(a.container||f||document.body);if(f._settings)a:{var k=f,l=[k];if(e)l=k.getChildViews();else if(k._body_cell)l=[k._body_cell];else if("number"==typeof g)break a;else if(g){l=[webix.$$(g)];d(l);g=l[0].config.id;break a}d(l)}k=f==document.body;a._settings||f&&e?e=a:(f&&k&&(a.$topView=!0),a._inner||(a._inner={}),e=b._view(a));!k||e.setPosition||e.$apiOnly||webix.ui._fixHeight();
e._settings&&e._settings._hidden&&!f.$view?e._settings._container=f:e.$apiOnly||(f.appendChild?c(f,e,a):f.destructor?(k=f,g||0===g||webix.isArray(e)||(g=f,f=f.getParentView()),f&&f._replace?(e.getParentView&&e.getParentView()&&e.getParentView()._remove(e),f._replace(e,g)):(f=k.$view.parentNode,k.destructor(),c(f,e,a))):webix.assert_error("Not existing parent:"+a.container));webix._ui_creation=!1;return e};var c=function(b,c,d){b.appendChild(c._viewobj);((!c.setPosition||c._settings.fullscreen)&&b==
document.body||c._settings.position)&&a.push(c._destructor_handler);d.skipResize||c.adjust()},d=function(a){for(var b=a.length-1;0<=b;b--)delete webix.ui.views[a[b].config.id],a[b].config.id="x"+webix.uid(),webix.ui.views[a[b].config.id]=a[b],d(a[b].getChildViews())}}webix.ui.animate=function(a,b,c){var d=webix.$$(b);if(d){c=c||{type:"slide",direction:"left"};d=d._viewobj.cloneNode(!0);a=webix.ui(a,b);a._viewobj.parentNode.appendChild(d);var e=webix.animate.formLine(a._viewobj,d,c);c.callback=function(){webix.animate.breakLine(e)};
webix.animate(e,c);return a}};webix.ui.animateView=function(a,b,c){if(a=webix.$$(a)){c=c||{type:"slide",direction:"left"};for(var d=function(a){a=a._viewobj;return"<div class='"+a.className+"' style='width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px;'>"+a.innerHTML+"</div>"},e=[],f=0;f<a._viewobj.childNodes.length;f++){var g=a._viewobj.childNodes[f];g=g.currentStyle?g.currentStyle.display:getComputedStyle(g,null).display;e.push(g||"")}f=d(a);"function"==typeof b&&b.call(this);b=d(a);var n=a._viewobj.insertBefore(webix.html.create("DIV",
{"class":"webix_view_animate",style:"width:"+a._viewobj.offsetWidth+"px;height:"+a._viewobj.offsetHeight+"px;"},b+f),a._viewobj.firstChild);for(f=1;f<a._viewobj.childNodes.length;f++)a._viewobj.childNodes[f].style.display="none";b=webix.animate.formLine(n.childNodes[0],n.childNodes[1],c);c.callback=function(){if(n){a._viewobj.removeChild(n);n=null;for(var b=0;b<a._viewobj.childNodes.length;b++)a._viewobj.childNodes[b].style.display=e[b]}};webix.animate(b,c);return a}};webix.ui._detectScrollSize=function(){var a=
webix.html.create("div");a.className="webix_skin_mark";a.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;";document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth,c={110:"air",120:"aircompact",130:"clouds",140:"web",150:"terrace",160:"metro",170:"light",180:"glamour",190:"touch",200:"flat",210:"compact",220:"material",230:"contrast"}[10*Math.floor(a.offsetHeight/10)];document.body.removeChild(a);c&&(a=webix.skin[c])&&a!=webix.skin.$active&&
webix.skin.set(c);return webix.env.$customScroll?0:b};webix.ui.scrollSize=webix.env.touch||webix.env.$customScroll?0:17;webix.ready(function(){var a=webix.ui._detectScrollSize();webix.ui.scrollSize=webix.env.touch?0:a});webix.ui._uid=function(a){return"$"+a+(this._namecount[a]=(this._namecount[a]||0)+1)};webix.ui._namecount={};webix.ui._fixHeight=function(){webix.html.addStyle("html, body{ height:100%; }");document.body.className+=" webix_full_screen";webix.ui._fixHeight=function(){};webix.Touch.limit(!1)};
webix.ui.freeze=function(a,b){webix.ui._freeze_resize=!0;(a=a())&&a.then?a.then(function(a){webix.ui._freeze_resize=!1;!1!==b&&webix.ui.resize();return a}):(webix.ui._freeze_resize=!1,!1!==b&&webix.ui.resize())};webix.ui.resize=function(){webix.UIManager.applyChanges();webix.callEvent("onClick",[]);webix.ui._force_resize=!0;if(!webix.ui._freeze_resize)for(var b=a.length-1;0<=b;b--)a[b].obj&&a[b].obj.resize();webix.ui._force_resize=!1};webix.ui.each=function(a,b,c,d){if(a)for(a=d?[a]:a.getChildViews(),
d=0;d<a.length;d++)!1!==b.call(c||webix,a[d])&&webix.ui.each(a[d],b,c)};webix.event(window,"resize",function(){webix.env.touch&&(webix.edit_open_time&&1E3>new Date-webix.edit_open_time||webix._focus_time&&1E3>new Date-webix._focus_time)||webix.ui.resize()});b._delays={};b.delay=function(a){webix.ui._delays[a.id]=a};b.hasMethod=function(a,b){var c=webix.ui[a];if(!c)return!1;c.$protoWait&&c.call(webix);return!!webix.ui[a].prototype[b]};webix.ui.zIndex=function(){return webix.ui.zIndexBase++};webix.ui.zIndexBase=
100;b._view=function(a){webix.assert_config(a);if(a.view){var c=a.view;webix.assert(b[c],"unknown view:"+c);return new b[c](a)}if(a.rows||a.cols){c=a.rows||a.cols;for(var d=!1,e=0;e<c.length;e++)!c[e].body||c[e].view||c[e].align||(d=!0);return d?new b.headerlayout(a):new b.layout(a)}return a.cells?new b.multiview(a):a.template||a.content?new b.template(a):a.align&&a.body?new b.align(a):new b.spacer(a)};b.views={};webix.$$=function(a){if(!a)return null;if(b.views[a])return b.views[a];if(b._delays[a])return webix.ui(b._delays[a]);
var c=a;if("object"==typeof a){if(a._settings)return a;c=a.target||a.srcElement||a}return b.views[webix.html.locate({target:webix.toNode(c)},"view_id")]};webix.isUndefined(window.$$)&&(window.$$=webix.$$);webix.UIExtension=window.webix_view||{};webix.protoUI({name:"baseview",$init:function(a){a.id||(a.id=webix.ui._uid(this.name));this._parent_cell=webix._parent_cell;webix._parent_cell=null;this.$scope=a.$scope||(this._parent_cell?this._parent_cell.$scope:null);this._viewobj||(this.$view=this._contentobj=
this._viewobj=webix.html.create("DIV",{"class":"webix_view"}))},$skin:!1,defaults:{width:0,height:0,gravity:1},getNode:function(){return this._viewobj},getParentView:function(){return this._parent_cell||null},getTopParentView:function(){var a=this.getParentView();return a?a.getTopParentView():this},getFormView:function(){var a=this.getParentView();return!a||a.setValues?a:a.getFormView()},getChildViews:function(){return[]},queryView:function(a,b){var c;if("object"===typeof a){var d=Object.keys(a),
e=[];for(c=0;c<d.length;c++)e[c]=a[d[c]];c=function(a){a=a.config;for(var b=0;b<d.length;b++)if(a[d[b]]!=e[b])return!1;return!0}}else c=a;if("self"===b&&c(this))return this;a="all"===b?[]:!1;c=this._queryView(c,"parent"===b?this._queryGoUp:this._queryGoDown,a);return"all"===b?a:c},_queryGoDown:function(a){return a.getChildViews()},_queryGoUp:function(a){return(a=a.getParentView())?[a]:[]},_queryView:function(a,b,c){for(var d=b(this),e=0;e<d.length;e++)if(a(d[e]))if(c)c.push(d[e]);else return d[e];
else{var f=d[e]._queryView(a,b,c);if(f)return f}return null},isVisible:function(a,b){return this._settings.hidden?(a&&(this._hidden_render||(this._hidden_render=[],this._hidden_hash={}),this._hidden_hash[a]||(this._hidden_hash[a]=!0,this._hidden_render.push(a))),!1):(b=this.getParentView())?b.isVisible(a,this._settings.id):!0},isEnabled:function(){if(this._disable_cover)return!1;var a=this.getParentView();return a?a.isEnabled():!0},disable:function(){webix.html.remove(this._disable_cover);this._settings.disabled=
!0;this._disable_cover=webix.html.create("div",{"class":"webix_disabled"});window.getComputedStyle&&(this._disabled_view_pos=window.getComputedStyle(this._viewobj,null).getPropertyValue("position"));"absolute"!=this._disabled_view_pos&&(this._viewobj.style.position="relative");this._viewobj.appendChild(this._disable_cover);this._viewobj.setAttribute("aria-disabled","true");webix.html.addCss(this._viewobj,"webix_disabled_view",!0);webix.UIManager._moveChildFocus(this)},enable:function(){this._settings.disabled=
!1;this._disable_cover&&(webix.html.remove(this._disable_cover),webix.html.removeCss(this._viewobj,"webix_disabled_view"),this._viewobj.removeAttribute("aria-disabled"),this._disable_cover=null,this._disabled_view_pos&&(this._viewobj.style.position=this._disabled_view_pos))},disabled_setter:function(a){a?this.disable():this.enable();return a},container_setter:function(a){webix.assert(webix.toNode(a),"Invalid container");return!0},css_setter:function(a){"object"==typeof a&&(a=webix.html.createCss(a));
this._viewobj.className+=" "+a;return a},id_setter:function(a){if(webix._global_collection&&(webix._global_collection!=this||this._prev_global_col)){var b=this.config.$id=a;(this._prev_global_col||webix._global_collection)._elements[a]=this;a=webix.ui._uid(this.name);(this._prev_global_col||webix._global_collection)._translate_ids[a]=b}webix.assert(!webix.ui.views[a],"Non unique view id: "+a);webix.ui.views[a]=this;this._viewobj.setAttribute("view_id",a);return a},$setSize:function(a,b){var c=this._last_size;
if(c&&c[0]==a&&c[1]==b)return webix.debug_size_box(this,[a,b,"not changed"]),!1;webix.debug_size_box(this,[a,b]);this._last_size=[a,b];this.$width=this._content_width=a-(this._scroll_y?webix.ui.scrollSize:0);this.$height=this._content_height=b-(this._scroll_x?webix.ui.scrollSize:0);this._settings.flex||(this._viewobj.style.width=a+"px",this._viewobj.style.height=b+"px");return!0},$getSize:function(a,b){var c=this._settings,d=[1*(c.width||c.minWidth||0),1*(c.width||c.maxWidth||1E5),1*(c.height||c.minHeight||
0),1*(c.height||c.maxHeight||1E5),c.gravity];webix.assert&&(isNaN(d[0])||isNaN(d[1])||isNaN(d[2])||isNaN(d[3]))&&(webix.assert(!1,"Size is not a number "+this._settings.id),c.width=c.height=c.maxWidth=c.maxHeight=c.minWidth=c.minHeight=0,d=[0,0,1E5,1E5,1]);d[0]+=a;d[1]+=a;d[2]+=b;d[3]+=b;return d},show:function(a,b,c){var d=this.getParentView();c=!c;d?(!b&&!1!==b&&this._settings.animate&&d._settings.animate&&(b=webix.extend(d._settings.animate?webix.extend({},d._settings.animate):{},this._settings.animate,
!0)),(c?d._show:d._hide)&&(c?d._show:d._hide).call(d,this,b),c&&this._render_hidden_views(),a&&c&&d.show(d.$$?!1:a)):this._settings.hidden?c&&(webix.toNode(this._settings._container||document.body).appendChild(this._viewobj),this._settings.hidden=!1,this.adjust(),this._render_hidden_views()):c||(this._settings.hidden=this._settings._hidden=!0,this._viewobj&&(this._settings._container=this._viewobj.parentNode,webix.html.remove(this._viewobj)))},_render_hidden_views:function(){if(this._hidden_render){for(var a=
0;a<this._hidden_render.length;a++){var b=webix.$$(this._hidden_render[a]);b&&b.render()}this._hidden_render=[];this._hidden_hash={}}},_onKeyPress:function(a,b){var c=b.srcElement||b.target,d=c.getAttribute("role");13!==a&&32!==a||"button"!=d||this._settings.disabled||(webix.html.triggerEvent(c,"MouseEvents","click"),webix.html.preventEvent(b))},hidden_setter:function(a){a&&this.hide();return this._settings.hidden},hide:function(){this.show(null,null,!0);webix.UIManager._moveChildFocus(this)},adjust:function(){if(!this._viewobj.parentNode)return!1;
var a=this._viewobj.parentNode.clientWidth||0,b=this._viewobj.parentNode.clientHeight||0,c=this.$getSize(0,0),d=this._viewobj.parentNode==document.body&&!this.setPosition;c[0]>a&&(a=c[0]);c[2]>b&&(b=c[2]);(!d||this._settings.width)&&a>c[1]&&(a=c[1]);(!d||this._settings.height)&&b>c[3]&&(b=c[3]);this.$setSize(a,b);webix._responsive_exception&&(webix._responsive_exception=!1,this.adjust())},resize:function(){if(!(webix._child_sizing_active||webix.ui._freeze_resize||webix._responsive_tinkery)){var a=
this.getParentView();a?a.resizeChildren?a.resizeChildren():a.resize():(this.adjust(),webix.callEvent("onResize",[]))}}},webix.Settings,webix.Destruction,webix.BaseBind,webix.UIExtension);webix.protoUI({name:"view",$init:function(a){this._set_inner(a)},_set_inner:function(a){var b=webix.isUndefined(a.borderless);b&&!this.setPosition&&a.$topView&&(a.borderless=!0,b=!1);b&&this.defaults.borderless||a.borderless?a._inner={top:!0,left:!0,bottom:!0,right:!0}:(a._inner||(a._inner={}),this._contentobj.style.borderWidth=
"1px")},$getSize:function(a,b){var c=this._settings._inner;c&&(a+=(c.left?0:1)+(c.right?0:1),b+=(c.top?0:1)+(c.bottom?0:1));a=webix.ui.baseview.prototype.$getSize.call(this,a,b);webix.debug_size_box(this,a,!0);return a},$setSize:function(a,b){webix.debug_size_box(this,[a,b]);var c=this._settings._inner;c&&(a-=(c.left?0:1)+(c.right?0:1),b-=(c.top?0:1)+(c.bottom?0:1));return webix.ui.baseview.prototype.$setSize.call(this,a,b)}},webix.ui.baseview)})();webix.ui.view.call(webix);
webix.debug_size_indent=0;webix.debug_size_step=function(){for(var a="",b=0;b<webix.debug_size_indent;b++)a+="|  ";return a};webix.debug_size_box_start=function(a,b){webix.debug_size&&(webix.debug_size_indent||webix.log(b?"--- get sizes ---":"--- set sizes ---"),webix.log(webix.debug_size_step()+a.name+"@"+a.config.id),webix.debug_size_indent++)};webix.debug_size_box_end=function(a,b){webix.debug_size&&(webix.debug_size_indent--,webix.log(webix.debug_size_step()+b.join(",")))};
webix.debug_size_box=function(a,b,c){webix.debug_size&&(webix.debug_size_indent||webix.log(c?"--- get sizes ---":"--- set sizes ---"),webix.log(webix.debug_size_step()+a.name+"@"+a.config.id+" "+b.join(",")))};webix.protoUI({name:"spacer",defaults:{borderless:!0},$init:function(){this._viewobj.className+=" webix_spacer"}},webix.ui.view);
webix.protoUI({name:"baselayout",restore:function(a,b,c){a=this._restore(webix.copy(a),b);if(c)return a;webix.ui(a.cols||a.rows,this)},_restore:function(a,b){if(a.$layout)for(var c=a.cols||a.rows,d=0;d<c.length;d++)c[d]=this._restore(c[d],b);else return b.call(this,a);return a},serialize:function(a){for(var b=[],c=this.getChildViews(),d=0;d<c.length;d++){var e=c[d];e.movePortlet?(e=e.getChildViews(),b.push(a.call(this,e[e.length-1]))):e.serialize?b.push(e.serialize(a,!0)):b.push(a.call(this,e))}a=
{$layout:!0,type:this.config.type};this.config.rows?a.rows=b:a.cols=b;return a},$init:function(a){this.$ready.push(this._parse_cells);this._dataobj=this._contentobj;this._layout_sizes=[];this._responsive=[];a.$topView&&(a.borderless=!0,a._inner={top:!0,left:!0,bottom:!0,right:!0});a.isolate&&webix.extend(this,webix.IdSpace)},rows_setter:function(a){this._vertical_orientation=1;this._collection=a;return!0},cols_setter:function(a){this._vertical_orientation=0;this.$view.style.whiteSpace="nowrap";this._collection=
a;return!0},_remove:function(a){webix.PowerArray.removeAt.call(this._cells,webix.PowerArray.find.call(this._cells,a));this.resizeChildren(!0)},_replace:function(a,b){if(webix.isUndefined(b)){for(b=0;b<this._cells.length;b++)this._cells[b].destructor();this._collection=a;this._parse_cells()}else{if("number"==typeof b){if(0>b||b>this._cells.length)b=this._cells.length;var c=(this._cells[b]||{})._viewobj;webix.PowerArray.insertAt.call(this._cells,a,b);a._settings.hidden||webix.html.insertBefore(a._viewobj,
c,this._dataobj)}else{c=webix.$$(b);b=webix.PowerArray.find.call(this._cells,c);webix.assert(-1!=b,"Attempt to replace the non-existing view");var d=c._viewobj.parentNode;d&&!a._settings.hidden&&d.insertBefore(a._viewobj,c._viewobj);c.destructor();this._cells[b]=a}this._vertical_orientation||this._fix_vertical_layout(a);this._cells[b]._parent_cell=this}this.resizeChildren(!0);(a=this.elements?this:this.getFormView())&&a._recollect_elements();webix.callEvent("onReconstruct",[this])},_fix_vertical_layout:function(a){a._viewobj.style.display=
"inline-block";a._viewobj.style.verticalAlign="top"},addView:function(a,b){webix.isUndefined(b)&&(b=this._cells.length);var c=this.$$?this:this.getTopParentView();c=c&&c.ui?c:webix;return c.ui(a,this,b)._settings.id},removeView:function(a){var b="object"!=typeof a?webix.$$(a)||(this.$$?this.$$(a):null):a;var c=webix.PowerArray.find.call(this._cells,b);if(0<=c){this._beforeRemoveView&&this._beforeRemoveView(c,b);var d=this.elements?this:this.getFormView();this._cells.splice(c,1);d&&webix.ui.each(b,
function(a){a.name&&delete d.getCleanValues()[a.config.name]},d,!0);b.destructor();this.resizeChildren(!0);d&&d._recollect_elements()}else webix.assert(!1,"Attemp to remove not existing view: "+a);webix.callEvent("onReconstruct",[this])},reconstruct:function(){this._hiddencells=0;this._replace(this._collection)},_hide:function(a,b,c){a._settings.hidden||(a._settings.hidden=!0,webix.html.remove(a._viewobj),this._hiddencells++,c||webix._ui_creation||this.resizeChildren(!0))},_signal_hidden_cells:function(a){a.callEvent&&
a.callEvent("onViewShow",[])},resizeChildren:function(){if(!webix.ui._freeze_resize&&this._layout_sizes){var a=this.getParentView();if(a)return a.resizeChildren?a.resizeChildren():a.resize();var b=this.$getSize(0,0),c,d;var e=c=this._layout_sizes[0]||0;var f=d=this._layout_sizes[1]||0;(1E5<=b[1]||1E5<=b[3])&&this._viewobj.parentNode&&(e=c=Math.max(b[0],this._settings.width||this._viewobj.parentNode.offsetWidth||c||0),f=d=Math.max(b[2],this._settings.height||this._viewobj.parentNode.offsetHeight||
d||0));a?this._set_child_size(c,d):(b[0]>c&&(e=b[0]),b[2]>d&&(f=b[2]),a=this._viewobj.parentNode==document.body&&!this.setPosition,!a&&c>b[1]&&(e=b[1]),!a&&d>b[3]&&(f=b[3]),this.$setSize(e,f));webix._responsive_exception&&(webix._responsive_exception=!1,this.resizeChildren());webix.callEvent("onResize",[])}},getChildViews:function(){return this._cells},index:function(a){a._settings&&(a=a._settings.id);for(var b=0;b<this._cells.length;b++)if(this._cells[b]._settings.id==a)return b;return-1},_show:function(a,
b,c){if(a._settings.hidden){a._settings.hidden=!1;for(b=this.index(a)+1;this._cells[b]&&this._cells[b]._settings.hidden;)b++;webix.html.insertBefore(a._viewobj,this._cells[b]?this._cells[b]._viewobj:null,this._dataobj||this._viewobj);this._hiddencells--;c||(this.resizeChildren(!0),a.refresh&&a.refresh());a.callEvent&&(a.callEvent("onViewShow",[]),webix.ui.each(a,this._signal_hidden_cells))}},showBatch:function(a,b){var c="undefined"!=typeof b;b=!1!==b;if(c)this._settings.visibleBatch="";else{if(this._settings.visibleBatch==
a)return;this._settings.visibleBatch=a}for(var d=[],e=0;e<this._cells.length;e++)this._cells[e]._settings.batch?this._cells[e]._settings.batch==a?b?d.push(this._cells[e]):this._hide(this._cells[e],null,!0):c||this._hide(this._cells[e],null,!0):d.push(this._cells[e]);for(e=0;e<d.length;e++)this._show(d[e],null,!0),d[e]._render_hidden_views();this.resizeChildren(!0)},_parse_cells:function(a){this._cells=[];webix.assert(a,this.name+" was incorrectly defined. <br><br> You have missed rows|cols|cells|elements collection");
for(var b=0;b<a.length;b++)webix._parent_cell=this,a[b]._inner||(a[b].borderless=!0),this._cells[b]=webix.ui._view(a[b],this),this._vertical_orientation||this._fix_vertical_layout(this._cells[b]),this._settings.visibleBatch&&this._settings.visibleBatch!=this._cells[b]._settings.batch&&this._cells[b]._settings.batch&&(this._cells[b]._settings.hidden=!0,this._hiddencells++),this._cells[b]._settings.hidden||((this._dataobj||this._contentobj).appendChild(this._cells[b]._viewobj),this._cells[b].$nospace&&
this._hiddencells++);this._parse_cells_ext_end&&this._parse_cells_ext_end(a)},_bubble_size:function(a,b,c){if(this._vertical_orientation!=c)for(var d=0;d<this._cells.length;d++)this._cells[d]._settings[a]=b,this._cells[d]._bubble_size&&this._cells[d]._bubble_size(a,b,c)},$getSize:function(a,b){webix.debug_size_box_start(this,!0);var c=0,d=1E5,e=1E5,f=0;this._vertical_orientation?e=0:d=0;var g=0,h=0,k=0;this._sizes=[];for(var l=0;l<this._cells.length;l++)if(!this._cells[l]._settings.hidden){var m=
this._sizes[l]=this._cells[l].$getSize(0,0);this._cells[l].$nospace?h++:this._vertical_orientation?(m[0]>c&&(c=m[0]),m[1]<d&&(d=m[1]),f+=m[2],e+=m[3],m[2]==m[3]&&-1!=m[2]?(g+=m[2],h++):k+=m[4]):(m[2]>f&&(f=m[2]),m[3]<e&&(e=m[3]),c+=m[0],d+=m[1],m[0]==m[1]&&-1!=m[0]?(g+=m[0],h++):k+=m[4])}f>e&&(e=f);c>d&&(d=c);this._master_size=[g,this._cells.length-h,k];this._desired_size=[c+a,f+b];g=webix.ui.baseview.prototype.$getSize.call(this,0,0);1E5<=g[1]&&(g[1]=0);1E5<=g[3]&&(g[3]=0);g[0]=(g[0]||c)+a;g[1]=
Math.max(g[0],(g[1]||d)+a);g[2]=(g[2]||f)+b;g[3]=Math.max(g[2],(g[3]||e)+b);webix.debug_size_box_end(this,g);!this._vertical_orientation&&this._settings.responsive&&(g[0]=0);return g},$setSize:function(a,b){this._layout_sizes=[a,b];webix.debug_size_box_start(this);webix.ui.baseview.prototype.$setSize.call(this,a,b);this._set_child_size(a,b);webix.debug_size_box_end(this,[a,b])},_set_child_size_a:function(a,b,c){b=a[b];c=a[c];var d=b;if(b!=c)if(d=this._set_size_delta*a[4]/this._set_size_gravity,d<
b)d=b,this._set_size_gravity-=a[4],this._set_size_delta-=d;else if(d>c)d=c,this._set_size_gravity-=a[4],this._set_size_delta-=d;else return-1;return d},_responsive_hide:function(a,b){b=webix.$$(b);"hide"!==b&&b?(b||(b=webix.ui({view:"popup",body:[{}]})),a._responsive_width=a._settings.width,a._responsive_height=a._settings.height,a._responsive_marker=b._settings.id,a._settings.width=0,a._settings.height||(a._settings.autoheight=!0),webix.ui(a,b,this._responsive.length)):(a.hide(),a._responsive_marker=
"hide");this._responsive.push(a)},_responsive_show:function(a){var b=a._responsive_marker;a._responsive_marker=0;if("hide"!==b&&b){a._settings.width=a._responsive_width;a._settings.height=a._responsive_height;delete a._settings.autoheight;for(b=0;this._cells[b]&&!1===this._cells[b]._settings.responsiveCell;)b++;webix.ui(a,this,b)}else a.show();this._responsive.pop()},_responsive_cells:function(a,b){webix._responsive_tinkery=!0;if(a+2*this._paddingX+this._margin*(this._cells.length-1)<this._desired_size[0]){a=
this._cells.length-1;for(var c=0;c<a;c++)if(b=this._cells[c],!b._responsive_marker)if(!1!==b._settings.responsiveCell){this._responsive_hide(b,this._settings.responsive);webix.callEvent("onResponsiveHide",[b._settings.id]);webix._responsive_exception=!0;break}else a=this._cells.length}else this._responsive.length&&(b=this._responsive[this._responsive.length-1],b.$getSize("hide"==b._responsive_marker?0:b._responsive_width,0)[0]+this._desired_size[0]+this._margin+20<=a&&(this._responsive_show(b),webix.callEvent("onResponsiveShow",
[b._settings.id]),webix._responsive_exception=!0));webix._responsive_tinkery=!1},_set_child_size:function(a,b){webix._child_sizing_active=(webix._child_sizing_active||0)+1;!this._vertical_orientation&&this._settings.responsive&&this._responsive_cells(a,b);this._set_size_delta=(this._vertical_orientation?b:a)-this._master_size[0];this._set_size_gravity=this._master_size[2];for(var c=[],d=0;d<this._cells.length;d++)if(!this._cells[d]._settings.hidden&&this._sizes[d]){var e=this._sizes[d];if(this._vertical_orientation){if(b=
this._set_child_size_a(e,2,3),0>b){c.push(d);continue}}else if(a=this._set_child_size_a(e,0,1),0>a){c.push(d);continue}this._cells[d].$setSize(a,b)}for(d=0;d<c.length;d++){var f=c[d];e=this._sizes[f];var g=Math.round(this._set_size_delta*e[4]/this._set_size_gravity);this._set_size_delta-=g;this._set_size_gravity-=e[4];this._vertical_orientation?b=g:a=g;this._cells[f].$setSize(a,b)}--webix._child_sizing_active},_next:function(a,b){a=this.index(a);return-1==a?null:this._cells[a+b]},_first:function(){return this._cells[0]}},
webix.EventSystem,webix.ui.baseview);
webix.protoUI({name:"layout",$init:function(a){this._hiddencells=0},defaults:{type:"line"},_parse_cells:function(){this._parse_cells_ext&&this._parse_cells_ext(a);this._parse_once||(this._viewobj.className+=" webix_layout_"+(this._settings.type||""),this._parse_once=1);this._settings.margin!==webix.undefined&&(this._margin=this._settings.margin);this._settings.padding!=webix.undefined&&(this._paddingX=this._paddingY=this._settings.padding);this._settings.paddingX!==webix.undefined&&(this._paddingX=
this._settings.paddingX);this._settings.paddingY!==webix.undefined&&(this._paddingY=this._settings.paddingY);if(this._paddingY||this._paddingX)this._padding=!0;this._hasBorders()&&!this._settings.borderless&&(this._contentobj.style.borderWidth="1px",this._render_borders=!0);var a=this._collection;this._settings.borderless&&(this._settings._inner={top:!0,left:!0,right:!0,bottom:!0});this._beforeResetBorders(a);webix.ui.baselayout.prototype._parse_cells.call(this,a);this._afterResetBorders(a)},$getSize:function(a,
b){a=a||0;b=b||0;var c=this._margin*(this._cells.length-this._hiddencells-1);if(this._render_borders||this._hasBorders()){var d=this._settings._inner;d&&(a+=(d.left?0:1)+(d.right?0:1),b+=(d.top?0:1)+(d.bottom?0:1))}this._settings.height||(b+=2*(this._paddingY||0)+(this._vertical_orientation?c:0));this._settings.width||(a+=2*(this._paddingX||0)+(this._vertical_orientation?0:c));return webix.ui.baselayout.prototype.$getSize.call(this,a,b)},$setSize:function(a,b){this._layout_sizes=[a,b];webix.debug_size_box_start(this);
this._hasBorders()||this._render_borders?webix.ui.view.prototype.$setSize.call(this,a,b):webix.ui.baseview.prototype.$setSize.call(this,a,b);b=this._content_height;a=this._content_width;this._settings.scroll&&(b=Math.max(b,this._desired_size[1]),a=Math.max(a,this._desired_size[0]));this._set_child_size(a,b);webix.debug_size_box_end(this,[a,b])},_set_child_size:function(a,b){var c=this._margin*(this._cells.length-this._hiddencells-1);this._vertical_orientation?(b-=c+2*this._paddingY,a-=2*this._paddingX):
(a-=c+2*this._paddingX,b-=2*this._paddingY);return webix.ui.baselayout.prototype._set_child_size.call(this,a,b)},resizeChildren:function(a){if(a){this._last_size=null;a=[];for(var b=0;b<this._cells.length;b++){var c=this._cells[b];a[b]=c._settings;c._viewobj.style.borderTopWidth=c._viewobj.style.borderBottomWidth=c._viewobj.style.borderLeftWidth=c._viewobj.style.borderRightWidth=c._layout_sizes&&!c._render_borders||c._settings.borderless?"0px":"1px"}this._beforeResetBorders(a);for(b=0;b<a.length;b++)a[b].borderless&&
this._cells[b]._set_inner&&this._cells[b]._set_inner(a[b]);this._afterResetBorders(this._cells)}webix._responsive_tinkery||webix.ui.baselayout.prototype.resizeChildren.call(this)},_hasBorders:function(){return this._padding&&0<this._margin&&!this._cleanlayout},_beforeResetBorders:function(a){if(!this._hasBorders()||this._settings.borderless&&"space"!=this._settings.type){for(d=0;d<a.length;d++)a[d]._inner=webix.clone(this._settings._inner);var b=!1;this._cleanlayout&&(b=!0);var c=a.length;if(this._vertical_orientation){for(d=
1;d<c-1;d++)a[d]._inner.top=a[d]._inner.bottom=b;if(1<c){"head"!=this._settings.type&&(a[0]._inner.bottom=b);for(;a[c-1].hidden&&1<c;)c--;0<c&&(a[c-1]._inner.top=b)}}else{for(d=1;d<c-1;d++)a[d]._inner.left=a[d]._inner.right=b;if(1<c){"head"!=this._settings.type&&(a[0]._inner.right=b);for(a[c-1]._inner.left=b;1<c&&a[c-1].hidden;)c--;0<c&&(a[c-1]._inner.left=b)}}}else for(var d=0;d<a.length;d++)a[d]._inner&&a[d].borderless||(a[d]._inner={top:!1,left:!1,right:!1,bottom:!1})},_fix_container_borders:function(a,
b){b.top&&(a.borderTopWidth="0px");b.left&&(a.borderLeftWidth="0px");b.right&&(a.borderRightWidth="0px");b.bottom&&(a.borderBottomWidth="0px")},_afterResetBorders:function(a){for(var b=0,c=0;c<a.length;c++){var d=this._cells[c],e=d._settings._inner;if(d._settings.hidden&&this._cells[c+1]){var f=this._cells[c+1]._settings._inner;e.top||(f.top=!1);e.left||(f.left=!1);c==b&&b++}this._fix_container_borders(d._viewobj.style,d._settings._inner)}e=this._vertical_orientation?"marginLeft":"marginTop";d=this._vertical_orientation?
"marginTop":"marginLeft";f=this._vertical_orientation?this._paddingX:this._paddingY;var g=this._vertical_orientation?this._paddingY:this._paddingX;for(c=0;c<a.length;c++)this._cells[c]._viewobj.style[e]=(f||0)+"px";this._cells.length&&(this._cells[b]._viewobj.style[d]=(g||0)+"px");for(b+=1;b<a.length;b++)this._cells[b]._viewobj.style[d]=this._margin+"px"},type_setter:function(a){this._margin="undefined"!=typeof this._margin_set[a]?this._margin_set[a]:this._margin_set.line;this._paddingX=this._paddingY=
"undefined"!=typeof this._margin_set[a]?this._padding_set[a]:this._padding_set.line;this._cleanlayout="material"==a||"clean"==a;"material"==a&&(this._settings.borderless=!0);return a},$skin:function(){var a=webix.skin.$active;this._margin_set=a.layoutMargin;this._padding_set=a.layoutPadding}},webix.ui.baselayout);webix.ui.layout.call(webix);
webix.FlexLayout={$init:function(){this.$view.className+=" webix_flexlayout"},_fix_vertical_layout:function(){},_beforeResetBorders:function(){},_afterResetBorders:function(){},$getSize:function(a,b){webix.debug_size_box_start(this,!0);b=a=0;var c=this._settings.gravity;this._sizes=[];for(var d=0;d<this._cells.length;d++){var e=this._cells[d].$getSize(0,0);this._sizes.push(e);a=Math.max(a,e[0]);b=Math.max(b,e[2])}a+=2*(this._paddingX||0);b+=2*(this._paddingY||0);this._settings.width&&(a=Math.max(a,
this._settings.width));this._settings.height&&(b=Math.max(b,this._settings.height));a=[a,1E5,b,1E5,c];webix.debug_size_box_end(this,a);return a},_set_child_size:function(a,b){a=this.$view.style;var c=Math.round(this._margin/2);a.paddingTop=a.paddingBottom=this._paddingY-c+"px";a.paddingLeft=a.paddingRight=this._paddingX-c+"px";for(a=0;a<this._cells.length;a++)if(!this._cells[a]._settings.hidden){b=this._cells[a].$view;var d=this._sizes[a],e=this._cells[a]._settings;b&&(b.style.minWidth=d[0]+"px",
1E5>d[1]&&d[1]!=d[0]&&(b.style.maxWidth=d[1]+"px"),b.style.flexBasis=e.flexBasis||d[0]+"px",b.style.flexGrow=e.flexGrow||(d[1]!=d[0]?d[4]:0),b.style.height=d[3]!=d[2]?"auto":d[2]+"px",b.style.minHeight=d[2]+"px",1E5>d[3]&&d[3]!=d[2]&&(b.style.maxHeight=d[3]+"px"),b.style.margin=c+"px")}c=[];for(a=0;a<this._cells.length;a++)this._cells[a]._settings.hidden||(b=this._cells[a].$view,c[a]=[b.offsetWidth,b.offsetHeight]);for(a=0;a<this._cells.length;a++)!this._cells[a]._settings.hidden&&(e=this._cells[a],
b=e.$view)&&(e._settings.flex=!0,d=this._sizes[a],e.$setSize(c[a][0],d[2]==d[3]?d[2]:c[a][1]),e._settings.flex=!1);this.$height=this._content_height=this.$view.scrollHeight;this.$view.style.height=this._content_height+"px"}};webix.protoUI({$init:function(){webix.extend(this,webix.FlexLayout,!0)},name:"flexlayout"},webix.ui.layout);
webix.protoUI({name:"align",defaults:{borderless:!0,left:0,top:0,right:0,bottom:0},$init:function(){this._viewobj.className+=" webix_view_align"},getChildViews:function(){return[this._body_cell]},body_setter:function(a){a._inner={top:!1,left:!1,right:!1,bottom:!1};this._body_cell=webix.ui._view(a);this._body_cell._parent_cell=this;this._viewobj.appendChild(this._body_cell._viewobj);return a},align_setter:function(a){"string"===typeof a&&(a=a.split(","));this._x_align=this._y_align=this._p_align="";
for(var b=0;b<a.length;b++){var c=a[b];if("center"===c||"left"===c||"right"===c)this._x_align=c;if("top"===c||"bottom"===c||"middle"===c)this._y_align=c;"absolute"===c&&(this._x_align=this._y_align=this._p_align="precise")}return a},getBody:function(){return this._body_cell},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b);if(this._p_align){var c=a-this._settings.left-this._settings.right;var d=b-this._settings.top-this._settings.bottom}else c=this._desired_size[0]||a,d=this._desired_size[2]||
b;this._body_cell.$setSize(c,d);var e=this._body_cell._viewobj;e.style.marginLeft="center"==this._x_align?Math.ceil((a-c)/2)+"px":"right"==this._x_align?a-c+"px":(this._p_align?this._settings.left:0)+"px";e.style.marginTop="middle"==this._y_align?Math.ceil((b-d)/2)+"px":"bottom"==this._y_align?b-d+"px":(this._p_align?this._settings.top:0)+"px"},$getSize:function(a,b){var c=this._desired_size=this._body_cell.$getSize(0,0),d=webix.ui.baseview.prototype.$getSize.call(this,0,0);this._p_align&&(a+=this._settings.left+
this._settings.right,b+=this._settings.top+this._settings.bottom);!this._x_align||this._p_align?(d[0]=c[0]+a,d[1]=c[1]+a):(d[0]=(d[0]||c[0])+b,d[1]+=a);!this._y_align||this._p_align?(d[2]=c[2]+b,d[3]=c[3]+b):(d[2]=(d[2]||c[2])+b,d[3]+=b);return d}},webix.ui.view);
webix.animate=function(a,b){var c=b;if(webix.isArray(a))for(var d=0;d<a.length;d++){webix.isArray(b)&&(c=b[d]);if("slide"==c.type){if("out"==c.subtype&&0===d)continue;if("in"==c.subtype&&1==d)continue}if("flip"==c.type){var e=webix.clone(c);0===d&&(e.type="flipback");1==d&&(e.callback=null);webix.animate(a[d],e)}else webix.animate(a[d],c)}else a=webix.toNode(a),a._has_animation?webix.animate.end(a,c):webix.animate.start(a,c)};
webix.animate.end=function(a,b){a.style[webix.env.transitionDuration]="1ms";a._has_animation=null;webix._wait_animate&&window.clearTimeout(webix._wait_animate);webix._wait_animate=webix.delay(webix.animate,webix,[a,b],10)};webix.animate.isSupported=function(){return!webix.$testmode&&!webix.noanimate&&webix.env.transform&&webix.env.transition&&!webix.env.isOpera};
webix.animate.formLine=function(a,b,c){var d=c.direction;b.parentNode&&(b.parentNode.style.position="relative");b.style.position="absolute";a.style.position="absolute";var e=webix.env.isFF?"top"==d||"left"==d?-1:1:0;"top"==d||"bottom"==d?(a.style.left="0px",a.style.top=(c.top||e)+("top"==d?1:-1)*b.offsetHeight+"px"):(a.style.top=(c.top||0)+"px",a.style.left=e+("left"==d?1:-1)*b.offsetWidth+"px");b.parentNode==a.parentNode&&c.keepViews?a.style.display="":webix.html.insertBefore(a,b.nextSibling,b.parentNode);
"slide"==c.type&&"out"==c.subtype&&(a.style.left="0px",a.style.top=(c.top||0)+"px",b.parentNode.removeChild(b),webix.html.insertBefore(b,a.nextSibling,a.parentNode));return[a,b]};webix.animate.breakLine=function(a,b){b?a[1].style.display="none":webix.html.remove(a[1]);webix.animate.clear(a[0]);webix.animate.clear(a[1]);a[0].style.position=""};webix.animate.clear=function(a){a.style[webix.env.transform]="none";a.style[webix.env.transition]="none";a.style.top=a.style.left=""};
webix.animate.defaults={type:"slide",delay:"0",duration:"500",timing:"ease-in-out",x:0,y:0};
webix.animate.start=function(a,b){"string"==typeof b&&(b={type:b});b=webix.Settings._mergeSettings(b,webix.animate.defaults);var c=webix.env.cssPrefix,d=a._has_animation=b;switch("slide"==d.type&&d.direction){case "right":d.x=a.offsetWidth;break;case "left":d.x=-a.offsetWidth;break;case "top":d.y=-a.offsetHeight;break;default:d.y=d.y||a.offsetHeight}if("flip"==d.type||"flipback"==d.type){var e=[0,0];var f="scaleX";"vertical"==d.subtype?(e[0]=20,f="scaleY"):e[1]=20;if("right"==d.direction||"bottom"==
d.direction)e[0]*=-1,e[1]*=-1}b=d.duration+"ms "+d.timing+" "+d.delay+"ms";var g=c+"TransformStyle: preserve-3d;",h="",k="";switch(d.type){case "fade":h="opacity "+b;g="opacity: 0;";break;case "show":h="opacity "+b;g="opacity: 1;";break;case "flip":b=d.duration/2+"ms "+d.timing+" "+d.delay+"ms";k="skew("+e[0]+"deg, "+e[1]+"deg) "+f+"(0.00001)";h="all "+b;break;case "flipback":d.delay+=d.duration/2;b=d.duration/2+"ms "+d.timing+" "+d.delay+"ms";a.style[webix.env.transform]="skew("+-1*e[0]+"deg, "+
-1*e[1]+"deg) "+f+"(0.00001)";a.style.left="0";k="skew(0deg, 0deg) "+f+"(1)";h="all "+b;break;case "slide":k=webix.env.translate+"("+(d.x+"px, ")+(d.y+"px")+("translate3d"==webix.env.translate?", 0":"")+")",h=c+"transform "+b}webix.delay(function(){a.style[webix.env.transition]=h;webix.delay(function(){g&&(a.style.cssText+=g);k&&(a.style[webix.env.transform]=k);var b=!1,c=webix.event(a,webix.env.transitionEnd,function(e){a._has_animation=null;d.callback&&d.callback.call(d.master||window,a,d,e);b=
!0;webix.eventRemove(c)});window.setTimeout(function(){b||(a._has_animation=null,d.callback&&d.callback.call(d.master||window,a,d),b=!0,webix.eventRemove(c))},1.3*(1*d.duration+1*d.delay))})})};
webix.MouseEvents={$init:function(a){a=a||{};this._clickstamp=0;this._dbl_sensetive=300;this._item_clicked=null;this._mouse_action_extend(a.onClick,"on_click");this._mouse_action_extend(a.onContext,"on_context");this._mouse_action_extend(a.onDblClick,"on_dblclick");this._mouse_action_extend(a.onMouseMove,"on_mouse_move");this.on_click&&(webix._event(this._contentobj,"click",this._onClick,{bind:this}),webix.env.isIE8&&this.on_dblclick&&webix._event(this._contentobj,"dblclick",this._onDblClick,{bind:this}));
this.on_context&&webix._event(this._contentobj,"contextmenu",this._onContext,{bind:this});this.on_mouse_move&&this._enable_mouse_move()},_enable_mouse_move:function(){this._mouse_move_enabled||(this.on_mouse_move=this.on_mouse_move||{},webix._event(this._contentobj,"mousemove",this._onMouse,{bind:this}),webix._event(this._contentobj,webix.env.isIE?"mouseleave":"mouseout",this._onMouse,{bind:this}),this._mouse_move_enabled=1,this.attachEvent("onDestruct",function(){this._mouse_move_timer&&window.clearTimeout(this._mouse_move_timer)}))},
_mouse_action_extend:function(a,b){if(a){var c=this[b];c=c?webix.extend({},c):{};this[b]=webix.extend(c,a)}},_onClick:function(a){if(!this.isEnabled())return!1;webix.UIManager._focus_action(this);if(this.on_dblclick){var b=(new Date).valueOf();if(b-this._clickstamp<=this._dbl_sensetive&&this.locate&&""+this.locate(a)==""+this._item_clicked)return this._clickstamp=0,this._onDblClick(a);this._clickstamp=b}return this._mouseEvent(a,this.on_click,"ItemClick")},_onDblClick:function(a){return this._mouseEvent(a,
this.on_dblclick,"ItemDblClick")},_onContext:function(a){this._mouseEvent(a,this.on_context,"BeforeContextMenu","AfterContextMenu")},_onMouse:function(a){if(!this.$destructed){if(document.createEventObject)a=document.createEventObject(event);else if(!(webix.$testmode||webix.isUndefined(a.movementY)||a.movementY||a.movementX))return;this._mouse_move_timer&&window.clearTimeout(this._mouse_move_timer);this.callEvent("onMouseMoving",[a]);this._mouse_move_timer=window.setTimeout(webix.bind(function(){"mousemove"==
a.type?this._onMouseMove(a):this._onMouseOut(a)},this),this._settings.mouseEventDelay||500)}},_onMouseMove:function(a){this._mouseEvent(a,this.on_mouse_move,"MouseMove")||this.callEvent("onMouseOut",[a||event])},_onMouseOut:function(a){this.callEvent("onMouseOut",[a||event])},_mouseEvent:function(a,b,c,d){a=a||event;if(!a.processed&&this._viewobj){a.processed=!0;var e=a.target||a.srcElement;if(webix.env.isIE8){var f=this._settings.id,g=e.w_view;if(!g)e.w_view=f;else if(g!==f)return}g=null;for(var h=
!1;e&&e.parentNode&&this._viewobj&&e!=this._viewobj.parentNode;){if(!h&&e.getAttribute&&(g=e.getAttribute(this._id))){this._item_clicked=g;if(this.callEvent){if(!this.callEvent("on"+c,[g,a,e]))return;d&&this.callEvent("on"+d,[g,a,e])}h=!0}if(f=webix.html._getClassName(e)){f=f.toString().split(" ");for(var k=0;k<f.length;k++)if(b[f[k]]&&!1===webix.toFunctor(b[f[k]],this.$scope).call(this,a,g||webix.html.locate(a,this._id),e))return h}e=e.parentNode}return h}}};
webix.protoUI({name:"accordionitem",$init:function(a){this._viewobj.innerHTML="<div webix_ai_id='"+a.id+"'  class='webix_accordionitem_header'><div tabindex='0' role='button' class='webix_accordionitem_button' ></div><div class='webix_accordionitem_label' ></div></div><div class='webix_accordionitem_body'></div>";this._contentobj=this._viewobj;this._headobj=this._contentobj.childNodes[0];a.header||(this._headobj.style.display="none");this._headlabel=this._contentobj.childNodes[0].childNodes[1];this._headbutton=
this._contentobj.childNodes[0].childNodes[0];this._bodyobj=this._contentobj.childNodes[1];this._viewobj.className+=" webix_accordionitem";this._head_cell=this._body_cell=null;this._cells=!0;this._bodyobj.setAttribute("role","tabpanel");this._headobj.setAttribute("role","tab");this.attachEvent("onKeyPress",this._onKeyPress)},_remove:function(){this._body_cell={destructor:function(){}}},_replace:function(a){this._body_cell.destructor();this._body_cell=a;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);
this.resize()},_id:"webix_ai_id",getChildViews:function(){return[this._body_cell]},body_setter:function(a){"object"!=typeof a&&(a={template:a});a._inner={top:!0,left:!0,right:!0,bottom:!0};webix._parent_cell=this;this._body_cell=webix.ui._view(a);this._body_cell.$view.style.border="0px solid red";this._bodyobj.appendChild(this._body_cell._viewobj);return a},header_setter:function(a){a&&(a=webix.template(a));return a},headerAlt_setter:function(a){a&&(a=webix.template(a));return a},$getSize:function(a,
b){var c=this._body_cell.$getSize(0,0),d=this._settings._inner;d&&(a+=(d.left?0:1)+(d.right?0:1),b+=(d.top?0:1)+(d.bottom?0:1));d=0;var e=webix.ui.baseview.prototype.$getSize.call(this,0,0);e[0]=(e[0]||c[0])+a;1E5<=e[1]&&(e[1]=c[1]);e[1]+=a;e[2]=(e[2]||c[2])+b;(a=1E5>e[3])||(e[3]=c[3]);e[3]+=b;this.getParentView()._vertical_orientation?this._settings.collapsed?e[2]=e[3]=this._getHeaderSize():this._settings.header&&(d=this._settings.headerHeight):(this._settings.collapsed&&(e[0]=e[1]=this._getHeaderSize()),
this._settings.header&&(d=this._settings.headerHeight));a||(e[2]+=d,e[3]+=d);webix.debug_size_box(this,e,!0);return e},on_click:{webix_accordionitem_header:function(a,b){this._toggle(a);return!1},webix_accordionitem_header_v:function(a,b){this._toggle(a);return!1}},_toggle:function(a){this.define("collapsed",!this._settings.collapsed)},collapsed_setter:function(a){if(!1!==this._settings.header){var b=this.getParentView();if(b){if(a)if(b._canCollapse(this))this._collapse();else{var c=0;if(1<b._cells.length)for(var d=
0;d<b._cells.length;d++){var e=b._cells[d];if(this!=e&&e.isVisible()&&e.expand){e.expand();this._collapse();c=1;break}}if(!c)return}else this._expand();(this._settings.collapsed=a)||b._afterOpen(this);this.refresh();webix._ui_creation||this.resize();b.callEvent("onAfter"+(a?"Collapse":"Expand"),[this._settings.id]);this._settings.$noresize=a}return a}},collapse:function(){this.define("collapsed",!0);webix.UIManager._moveChildFocus(this)},expand:function(){this.define("collapsed",!1)},_show:function(){this.show()},
_hide:function(){this.hide()},_expand:function(){this._bodyobj.style.display="";webix.html.removeCss(this.$view,"collapsed");webix.html.removeCss(this._headobj,"collapsed");this._headobj.setAttribute("aria-expanded","true")},_collapse:function(){this.getParentView();this._settings.headerAlt&&(this._headlabel.innerHTML=this._settings.headerAlt());this._bodyobj.style.display="none";webix.html.addCss(this.$view,"collapsed");webix.html.addCss(this._headobj,"collapsed");this._headobj.setAttribute("aria-expanded",
"false")},refresh:function(){var a=this._settings[this._settings.collapsed?"headerAlt":"header"]||this._settings.header;a&&(this._headlabel.innerHTML=a(),this._headbutton.setAttribute("aria-label",a()));a=this.getParentView()._vertical_orientation?"vertical":"horizontal";0>this._viewobj.className.indexOf(" "+a)&&webix.html.addCss(this._viewobj,a);webix.env.transform||webix.html.addCss(this._viewobj,"webix_ie",!0)},_getHeaderSize:function(){return this._settings.collapsed?this._settings.headerAltHeight:
this._settings.headerHeight},$setSize:function(a,b){if(webix.ui.view.prototype.$setSize.call(this,a,b)||this._getHeaderSize()!=this._last_set_header_size){a=this._content_width;b=this._content_height;var c=this._last_set_header_size=this._getHeaderSize();this._settings.header&&(this._headobj.style.height=c+"px",this._headobj.style.width="auto",this._headobj.style[webix.env.transform]="",this._headobj.style.borderBottomWidth=(this._settings.collapsed?0:1)+"px",this.getParentView()._vertical_orientation||
!this._settings.collapsed?b-=this._getHeaderSize():this._settings.collapsed&&(webix.animate.isSupported()?(this._headobj.style.width=b+"px",this._headobj.style.height=a+3+"px",c=Math.floor(b/2-a/2)+(a-this._settings.headerAltHeight)/2,this._headobj.style[webix.env.transform]="rotate(90deg) translate("+c+"px, "+(c+1)+"px)"):(this._headobj.style.width=a+"px",this._headobj.style.height=b+3+"px")));this._settings.collapsed||(this._body_cell.$setSize(a,b),this._last_size_y=b)}else this._settings.collapsed||
(a=this._body_cell,this._last_size_y&&a.$setSize(this._content_width,this._last_size_y))},$skin:function(){var a=this.defaults;a.headerAltHeight=a.headerHeight=webix.skin.$active.barHeight;webix.skin.$active.borderlessAccordion&&(a.borderless=!0)},defaults:{header:!1,headerAlt:!1,body:""}},webix.MouseEvents,webix.EventSystem,webix.ui.view);
webix.protoUI({name:"accordion",defaults:{panelClass:"accordionitem",multi:!1,collapsed:!1},$init:function(){this._viewobj.setAttribute("role","tablist");this._viewobj.setAttribute("aria-multiselectable","true")},addView:function(a){var b=webix.ui.layout.prototype.addView.apply(this,arguments),c=webix.$$(b);c.collapsed_setter&&c.refresh&&c.refresh();return b},_parse_cells:function(){for(var a=this._settings.panelClass,b=this._collection,c=0;c<b.length;c++)!b[c].body&&!b[c].header||b[c].view||b[c].align||
(b[c].view=a),webix.isUndefined(b[c].collapsed)&&(b[c].collapsed=this._settings.collapsed);this._skin_render_collapse=!0;webix.ui.layout.prototype._parse_cells.call(this);this._skin_render_collapse=!1;for(c=0;c<this._cells.length;c++)this._cells[c].name==a&&this._cells[c].refresh(),this._cells[c]._accLastChild=!1;a=!1;for(c=this._cells.length-1;0<=c&&!a;c--)this._cells[c]._settings.hidden||(a=this._cells[c]._accLastChild=!0)},_afterOpen:function(a){if(!1===this._settings.multi&&!0!==this._skin_render_collapse)for(var b=
0;b<this._cells.length;b++)a!=this._cells[b]&&!this._cells[b]._settings.collapsed&&this._cells[b].collapse&&this._cells[b].collapse();a.callEvent&&(a.callEvent("onViewShow",[]),webix.ui.each(a,this._signal_hidden_cells))},_canCollapse:function(a){if(!0===this._settings.multi||this._skin_render_collapse)return!0;for(var b=0;b<this._cells.length;b++)if(a!=this._cells[b]&&!this._cells[b]._settings.collapsed&&this._cells[b].isVisible()&&!this._cells[b].$nospace)return!0;return!1},$skin:function(){var a=
this.defaults;webix.skin.$active.accordionType&&(a.type=webix.skin.$active.accordionType)}},webix.ui.layout);webix.protoUI({name:"headerlayout",defaults:{type:"accordion",multi:"mixed",collapsed:!1}},webix.ui.accordion);
webix.DragControl={_drag_masters:webix.toArray(["dummy"]),addDrop:function(a,b,c){a=webix.toNode(a);a.webix_drop=this._getCtrl(b);c&&(a.webix_master=!0)},_getCtrl:function(a){a=a||webix.DragControl;var b=this._drag_masters.find(a);0>b&&(b=this._drag_masters.length,this._drag_masters.push(a));return b},_createTouchDrag:function(a){var b=webix.DragControl,c=this._getActiveDragMaster();c&&c._getDragItemPos&&(b._html||b.createDrag(a),c=b._drag_context,b._html.style.left=a.x+b.left+(c.x_offset||0)+"px",
b._html.style.top=a.y+b.top+(c.y_offset||0)+"px")},addDrag:function(a,b){a=webix.toNode(a);a.webix_drag=this._getCtrl(b);webix._event(a,webix.env.mouse.down,this._preStart,{bind:a});webix._event(a,"dragstart",webix.html.preventEvent)},_preStart:function(a){if(webix.DragControl._active){if(webix.DragControl._saved_event==a)return;webix.DragControl._preStartFalse();webix.DragControl.destroyDrag(a)}webix.DragControl._active=this;var b=webix.env.mouse.context(a);webix.DragControl._start_pos=b;webix.DragControl._saved_event=
a;webix.DragControl._webix_drag_mm=webix.event(document.body,webix.env.mouse.move,webix.DragControl._startDrag);webix.DragControl._webix_drag_mu=webix.event(document,webix.env.mouse.up,webix.DragControl._preStartFalse);webix.html.addCss(document.body,"webix_noselect",1)},_preStartFalse:function(){webix.DragControl._clean_dom_after_drag()},_startDrag:function(a){var b=webix.env.mouse.context(a),c=webix.DragControl._getActiveDragMaster();if(!(c&&webix.env.touch&&c._getDragItemPos&&!webix.Touch._long_touched||
5>Math.abs(b.x-webix.DragControl._start_pos.x)&&5>Math.abs(b.y-webix.DragControl._start_pos.y))&&(webix.DragControl._clean_dom_after_drag(!0),webix.DragControl._html||webix.DragControl.createDrag(webix.DragControl._saved_event))&&(webix.DragControl.sendSignal("start"),webix.DragControl._webix_drag_mm=webix.event(document.body,webix.env.mouse.move,webix.DragControl._moveDrag),webix.DragControl._webix_drag_mu=webix.event(document,webix.env.mouse.up,webix.DragControl._stopDrag),webix.DragControl._moveDrag(a),
webix.env.touch))return webix.html.preventEvent(a)},_stopDrag:function(a){webix.DragControl._clean_dom_after_drag();webix.DragControl._saved_event=null;webix.DragControl._last&&(webix.DragControl.$drop(webix.DragControl._active,webix.DragControl._last,a),webix.DragControl.$dragOut(webix.DragControl._active,webix.DragControl._last,null,a));webix.DragControl.destroyDrag(a);webix.DragControl.sendSignal("stop")},_clean_dom_after_drag:function(a){this._webix_drag_mm=webix.eventRemove(this._webix_drag_mm);
this._webix_drag_mu=webix.eventRemove(this._webix_drag_mu);a||webix.html.removeCss(document.body,"webix_noselect")},_moveDrag:function(a){var b=webix.DragControl,c=webix.html.pos(a),d=webix.env.mouse.context(a),e=b.$dragPos(c,a),f=b._drag_context;b._html.style.top=c.y+b.top+(e||!f.y_offset?0:f.y_offset)+"px";b._html.style.left=c.x+b.left+(e||!f.x_offset?0:f.x_offset)+"px";b._skip?b._skip=!1:(c=d.target=webix.env.touch?document.elementFromPoint(d.x,d.y):d.target,b._checkLand(c,webix.env.touch?d:a));
return webix.html.preventEvent(a)},_checkLand:function(a,b){for(;a&&"BODY"!=a.tagName;){if(a.webix_drop){this._last&&(this._last!=a||a.webix_master)&&this.$dragOut(this._active,this._last,a,b);if(!this._last||this._last!=a||a.webix_master)if(this._last=null,this._landing=this.$dragIn(webix.DragControl._active,a,b))this._last=a;return}a=a.parentNode}this._last&&(this._last=this._landing=this.$dragOut(this._active,this._last,null,b))},sendSignal:function(a){webix.DragControl.active="start"==a},getMaster:function(a){return this._drag_masters[a.webix_drag||
a.webix_drop]},getContext:function(){return this._drag_context},getNode:function(){return this._html},createDrag:function(a){var b=webix.DragControl,c=b._active;b._drag_context={};var d=this._drag_masters[c.webix_drag];if(d.$dragCreate){d=d.$dragCreate(c,a);if(!d)return!1;this._setDragOffset(a);d.style.position="absolute"}else{var e=b.$drag(c,a);b._setDragOffset(a);if(!e)return!1;d=document.createElement("DIV");d.innerHTML=e;d.className="webix_drag_zone";document.body.appendChild(d);a=b._drag_context;
a.html&&webix.env.pointerevents&&(a.x_offset=-Math.round(.5*d.offsetWidth),a.y_offset=-Math.round(.75*d.offsetHeight))}d.style.zIndex=Math.max(d.style.zIndex,webix.ui.zIndex());webix.DragControl._skipDropH=webix.event(d,webix.env.mouse.move,webix.DragControl._skip_mark);webix.DragControl._drag_context.from||(webix.DragControl._drag_context={source:c,from:c});webix.DragControl._html=d;return!0},_skip_mark:function(){webix.DragControl._skip=!0},destroyDrag:function(a){var b=webix.DragControl._active,
c=this._drag_masters[b.webix_drag];c&&c.$dragDestroy?(webix.DragControl._skipDropH=webix.eventRemove(webix.DragControl._skipDropH),webix.DragControl._html&&c.$dragDestroy(b,webix.DragControl._html,a)):webix.html.remove(webix.DragControl._html);webix.DragControl._landing=webix.DragControl._active=webix.DragControl._last=webix.DragControl._html=null},_getActiveDragMaster:function(){return webix.DragControl._drag_masters[webix.DragControl._active.webix_drag]},top:5,left:5,_setDragOffset:function(a){var b=
webix.DragControl,c=b._start_pos;b=b._drag_context;if("undefined"!=typeof b.x_offset&&"undefined"!=typeof b.y_offset)return null;b.x_offset=b.y_offset=0;if(webix.env.pointerevents){var d=webix.DragControl._getActiveDragMaster();d._getDragItemPos&&d!==this&&(a=d._getDragItemPos(c,a))&&(b.x_offset=a.x-c.x,b.y_offset=a.y-c.y)}},$dragPos:function(a,b){var c=this._drag_masters[webix.DragControl._active.webix_drag];if(c.$dragPos&&c!=this)return c.$dragPos(a,b,webix.DragControl._html),!0},$dragIn:function(a,
b,c){var d=this._drag_masters[b.webix_drop];if(d.$dragIn&&d!=this)return d.$dragIn(a,b,c);b.className+=" webix_drop_zone";return b},$dragOut:function(a,b,c,d){var e=this._drag_masters[b.webix_drop];if(e.$dragOut&&e!=this)return e.$dragOut(a,b,c,d);b.className=b.className.replace("webix_drop_zone","");return null},$drop:function(a,b,c){var d=this._drag_masters[b.webix_drop];webix.DragControl._drag_context.from=webix.DragControl.getMaster(a);if(d.$drop&&d!=this)return d.$drop(a,b,c);b.appendChild(a)},
$drag:function(a,b){var c=this._drag_masters[a.webix_drag];return c.$drag&&c!=this?c.$drag(a,b):"<div style='"+a.style.cssText+"'>"+a.innerHTML+"</div>"}};webix.attachEvent("onLongTouch",function(a){webix.DragControl._active&&webix.DragControl._createTouchDrag(a)});
webix.DataMove={copy:function(a,b,c,d){d=d||{};var e=d.newId||a;c=c||this;a=this.getItem(a);webix.assert(a,"Incorrect ID in DataMove::copy");c&&(a=c._externalData(a));return c.data.add(c._externalData(a,e),b,d.parent||0)},_next_move_index:function(a,b,c){if(b&&a)return a=this.getIndexById(a),a+(c==this&&c.getIndexById(b)<a?0:1)},move:function(a,b,c,d){d=d||{};var e=d.newId||a;c=c||this;webix.assert(c.data,"moving attempt to component without datastore");if(c.data)if(webix.isArray(a)){3<a.length&&
(this.$blockRender=c.$blockRender=!0);for(e=0;e<a.length;e++){var f=this.move(a[e],b,c,d);b=c._next_move_index(f,a[e+1],this)}this.$blockRender=c.$blockRender=!1;3<a.length&&(this.refresh(),c!=this&&c.refresh())}else{f=a;var g=this.getItem(a);webix.assert(g,"Incorrect ID in DataMove::move");c&&c!=this?(f=c.data.add(c._externalData(g,e),b,d.parent||0),this.data.remove(a)):(0>b&&(b=this.data.order.length-1),this.data.move(this.getIndexById(a),b),this.data.callEvent("onDataMove",[a,b,null,this.data.order[b+
1]]));return f}},moveUp:function(a,b){return this.move(a,this.getIndexById(a)-(b||1))},moveDown:function(a,b){return this.moveUp(a,-1*(b||1))},moveTop:function(a){return this.move(a,0)},moveBottom:function(a){return this.move(a,this.data.count()-1)},_externalData:function(a,b){var c=webix.extend({},a);c.id=!b||this.data.pull[b]?webix.uid():b;c.$template=null;this._settings.externalData&&(c=this._settings.externalData.call(this,c,b,a));return c}};
webix.Movable={move_setter:function(a){a&&(this._move_admin=webix.clone(this._move_admin),this._move_admin.master=this,webix.DragControl.addDrag(this._headobj,this._move_admin));return a},_move_admin:{$dragCreate:function(a,b){if(this.master.config.move)return a=webix.html.offset(a),b=webix.html.pos(b),webix.DragControl.top=a.y-b.y,webix.DragControl.left=a.x-b.x,webix.toNode(this.master._viewobj)},$dragDestroy:function(a,b){a=this.master;a._settings&&(a._settings.top=parseInt(b.style.top,10),a._settings.left=
parseInt(b.style.left,10));webix.DragControl.top=webix.DragControl.left=5;this.master.callEvent("onViewMoveEnd",[])},$dragPos:function(a,b){this.master.callEvent("onViewMove",[a,b])}}};
webix.Modality={_modal_set:function(a){if(a){if(!this._modal_cover){this._modal_cover=webix.html.create("div",{"class":"webix_modal"});var b=this._settings.zIndex||webix.ui.zIndex();this._previous_modality=webix._modality;webix._modality=b;this._modal_cover.style.zIndex=b-1;this._viewobj.style.zIndex=b;document.body.appendChild(this._modal_cover);document.body.style.overflow="hidden";webix._event(this._modal_cover,"click",webix.bind(this._ignore_clicks,this))}}else if(this._modal_cover){webix.html.remove(this._modal_cover);
document.body.style.overflow="";var c=this._previous_modality;setTimeout(function(){webix._modality=c},1);this._modal_cover=null}return a}};
webix.protoUI({name:"window",$init:function(a){this._viewobj.innerHTML="<div class='webix_win_content'><div class='webix_win_head'></div><div class='webix_win_body'></div></div>";this._contentobj=this._viewobj.firstChild;this._headobj=this._contentobj.childNodes[0];this._dataobj=this._bodyobj=this._contentobj.childNodes[1];this._viewobj.className+=" webix_window";this._viewobj.setAttribute("role","dialog");this._viewobj.setAttribute("tabindex","0");this._head_cell=this._body_cell=null;this._settings._inner=
{top:!1,left:!1,right:!1,bottom:!1};a.id||(a.id=webix.uid());webix._event(this._contentobj,"click",webix.bind(this._ignore_clicks,this));this._contentobj.addEventListener&&webix._event(this._contentobj,"click",function(){!this._settings.zIndex&&this._settings.toFront&&(this._viewobj.style.zIndex=webix.ui.zIndex())},{bind:this,capture:!0});a.modal&&(this._modal=!0);this.attachEvent("onViewMoveEnd",function(){this._settings.position&&delete this._settings.position})},_ignore_clicks:function(a){var b=
webix.ui._popups,c=b.find(this);-1==c&&(c=b.length-1);a.click_view=c;webix.env.isIE8&&(a.srcElement.click_view=c)},getChildViews:function(){return this._head_cell?[this._head_cell,this._body_cell]:[this._body_cell]},zIndex_setter:function(a){return this._viewobj.style.zIndex=a},_remove:function(){this._body_cell={destructor:function(){}}},_replace:function(a){this._body_cell.destructor();this._body_cell=a;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);a=this._body_cell._viewobj.style;
a.borderTopWidth=a.borderBottomWidth=a.borderLeftWidth=a.borderRightWidth="1px";this._body_cell._settings._inner=webix.clone(this._settings._inner);this.resize(!0)},show:function(a,b,c){if(!0===a){if(!this._settings.hidden)return;a=null}if(!this.callEvent("onBeforeShow",arguments))return!1;this._settings.hidden=!1;this._viewobj.style.zIndex=this._settings.zIndex||webix.ui.zIndex();if(this._settings.modal||this._modal)this._modal_set(!0),this._modal=null;b=b||{};b.pos||(b.pos=this._settings.relative);
if(a){if("object"!=typeof a||a.tagName){a=webix.toNode(a);webix.assert(a,"Not existing target for window:show");var d=webix.html.offset(a)}else if(a.target||a.srcElement){d=webix.html.pos(a);var e=20;var f=5}else d=a;var g=Math.max(window.innerWidth||0,document.body.offsetWidth),h=Math.max(window.innerHeight||0,document.body.offsetHeight);e=e||a.offsetWidth||0;f=f||a.offsetHeight||0;var k=this._last_size,l=d.x,m=d.y,n=0,p=0,q=0;q=0;var r=this._settings.autofit;if(r){r="node"===r;var v=6;c="top";l=
m=0;q=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;g-d.x-e<k[0]&&"right"==b.pos&&!r&&(b.pos="left");"right"==b.pos?(l=d.x+6+e,v=-f,c="left",n=Math.round(d.y+f/2),p=l-6):"left"==b.pos?(l=d.x-6-k[0]-1,v=-f,c="right",n=Math.round(d.y+f/2),p=l+k[0]+1):(l=d.x<q?q:g+q-d.x>k[0]?d.x:g+q-6-k[0],p=Math.round(d.x+e/2),p=Math.min(p,l+k[0]-18));q=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;(!k[1]||h+q-f-d.y-v>k[1]||r)&&"top"!=b.pos?(m=f+
d.y+v-4,n||(c="top",n=m-6)):(m=d.y-v-k[1],0>m?(m=0,"top"==c&&(c=!1)):n||(c="bottom",m--,n=m+k[1]+1))}d=b.x||0;e=b.y||0;if(f=this._checkFixedPosition())m-=q,n-=q;this.setPosition(l+d,m+e);this._set_point&&(c&&this._settings.point?this._set_point(c,p+d,n+e,f):this._hide_point())}else this._settings.position&&this._setPosition();this._viewobj.style.display="block";this._hide_timer=1;webix.delay(function(){this._hide_timer=0},this,[],webix.env.touch?400:100);this._render_hidden_views();this.config.autofocus&&
(this._prev_focus=webix.UIManager.getFocus(),webix.UIManager.setFocus(this));-1==webix.ui._popups.find(this)&&webix.ui._popups.push(this);this.callEvent("onShow",[])},_hide:function(a){if(!(this._settings.hidden||this._settings.modal||this._hide_timer||a&&a.showpopup||webix._modality&&this._settings.zIndex<=webix._modality)){if(a&&((a=webix.env.isIE8?a.srcElement.click_view:a.click_view)||0===a||(a=-1),webix.ui._popups.find(this)<=a))return;this.hide()}},hidden_setter:function(a){a?this.hide():this.show();
return!!a},hide:function(a){this.$destructed||!a&&this._settings.hidden||(this._settings.modal&&this._modal_set(!1),"top"==this._settings.position?webix.animate(this._viewobj,{type:"slide",x:0,y:-(this._content_height+20),duration:300,callback:this._hide_callback,master:this}):this._hide_callback(),this._settings.autofocus&&(a=document.activeElement)&&this._viewobj&&(this._viewobj.contains(a)||a===document.body)&&(webix.UIManager.setFocus(this._prev_focus),this._prev_focus=null),this._hide_sub_popups())},
_hide_sub_popups:function(){var a=webix.ui._popups,b=a.find(this),c=a.length-1;if(-1<b)for(;c>b;c--)a[c]._hide_point&&a[c].hide();a.removeAt(b)},destructor:function(){this._modal_set(!1);webix.html.remove(this._viewobj);this._settings.autofocus&&(webix._final_destruction||webix.UIManager.setFocus(this._prev_focus),this._prev_focus=null);this._hide_sub_popups();this._hide_point&&this._hide_point();webix.Destruction.destructor.apply(this,[])},_hide_callback:function(){this.$destructed||(this._viewobj.style.display=
"none",this._settings.hidden=!0,this.callEvent("onHide",[]))},close:function(){this.destructor()},_inner_body_set:function(a){a.borderless=!0},body_setter:function(a){"object"!=typeof a&&(a={template:a});this._inner_body_set(a);webix._parent_cell=this;this._body_cell=webix.ui._view(a);this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);return a},head_setter:function(a){if(!1===a)return a;"object"!=typeof a&&(this._viewobj.setAttribute("aria-label",a),a={template:a,
padding:0});a.borderless=!0;webix._parent_cell=this;this._head_cell=webix.ui._view(a);this._head_cell._parent_cell=this;this._headobj.appendChild(this._head_cell._viewobj);return a},getBody:function(){return this._body_cell},getHead:function(){return this._head_cell},adjust:function(){return this.resize()},resizeChildren:function(){this._body_cell&&this.resize()},resize:function(){webix.ui.baseview.prototype.adjust.call(this);this._setPosition(this._settings.left,this._settings.top)},_checkFixedPosition:function(){if(this._settings.master){var a=
webix.$$(this._settings.master).getTopParentView().$view;return a&&"fixed"===a.style.position}return!1},_setPosition:function(a,b){if(this._settings.position||this._checkFixedPosition()){this.$view.style.position="fixed";a=this._content_width;b=this._content_height;webix.assert(a&&b,"Attempt to show not rendered window");var c=window.innerWidth||document.documentElement.offsetWidth,d=window.innerHeight||document.documentElement.offsetHeight,e=Math.round((c-a)/2),f=Math.round((d-b)/2);"function"==
typeof this._settings.position?(c={left:e,top:f,width:a,height:b,maxWidth:c,maxHeight:d},this._settings.position.call(this,c),c.width==a&&c.height==b||this.$setSize(c.width,c.height),this.setPosition(c.left,c.top)):("top"==this._settings.position&&(f=webix.animate.isSupported()?-1*b:10),this._settings.position||(e=this._settings.left||e,f=this._settings.top||f),this.setPosition(e,f));"top"==this._settings.position&&webix.animate(this._viewobj,{type:"slide",x:0,y:b-2*(this._settings.padding||0),duration:300,
callback:this._topPositionCallback,master:this})}else this.setPosition(a,b)},_topPositionCallback:function(a){webix.animate.clear(a);this._settings.top=-(2*(this._settings.padding||0));this.setPosition(this._settings.left,this._settings.top)},setPosition:function(a,b){this._viewobj.style.top=b+"px";this._viewobj.style.left=a+"px";this._settings.left=a;this._settings.top=b},$getSize:function(a,b){var c=this._settings._inner;c&&(a+=(c.left?0:1)+(c.right?0:1),b+=(c.top?0:1)+(c.bottom?0:1));this._settings.head&&
(b+=1);c=this._body_cell.$getSize(0,0);var d=0;this._head_cell&&(d=this._head_cell.$getSize(0,0),d[3]==d[2]&&(this._settings.headHeight=d[3]),b+=this._settings.headHeight,d=d[0]);if(this._settings.fullscreen)return a=window.innerWidth||document.body.clientWidth,b=window.innerHeight||document.body.clientHeight,[a,a,b,b];var e=webix.ui.view.prototype.$getSize.call(this,0,0);d&&1E5<c[1]&&(c[0]=Math.max(d,c[0]));e[1]=Math.min(e[1],(1E5<=c[1]&&1E5<=e[1]?Math.max(c[0],300):c[1])+a);e[3]=Math.min(e[3],(1E5<=
c[3]&&1E5<=e[3]?Math.max(c[2],200):c[3])+b);e[0]=Math.min(Math.max(e[0],c[0]+a),e[1]);e[2]=Math.min(Math.max(e[2],c[2]+b),e[3]);return e},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b);a=this._content_width;b=this._content_height;!1===this._settings.head?(this._headobj.style.display="none",this._body_cell.$setSize(a,b)):(this._head_cell.$setSize(a,this._settings.headHeight),this._body_cell.$setSize(a,b-this._settings.headHeight))},$skin:function(){this.defaults.headHeight=
webix.skin.$active.barHeight},defaults:{top:0,left:0,autofit:!0,relative:"bottom",body:"",head:"",hidden:!0,autofocus:!0}},webix.ui.view,webix.Movable,webix.Modality,webix.EventSystem);
webix.protoUI({name:"popup",defaults:{point:!0},$init:function(){this._settings.head=!1;this.$view.className+=" webix_popup";webix.attachEvent("onClick",webix.bind(this._hide,this));this.attachEvent("onHide",this._hide_point)},$skin:function(){this.defaults.headHeight=webix.skin.$active.barHeight;this.defaults.padding=webix.skin.$active.popupPadding},close:function(){webix.html.remove(this._point_element);webix.ui.window.prototype.close.call(this)},$getSize:function(a,b){return webix.ui.window.prototype.$getSize.call(this,
a+2*this._settings.padding,b+2*this._settings.padding)},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b);a=this._content_width-2*this._settings.padding;b=this._content_height-2*this._settings.padding;this._contentobj.style.padding=this._settings.padding+"px";this._headobj.style.display="none";this._body_cell.$setSize(a,b)},_inner_body_set:function(){},head_setter:function(){},_set_point:function(a,b,c,d){this._hide_point();document.body.appendChild(this._point_element=webix.html.create("DIV",
{"class":"webix_point_"+a},""));this._point_element.style.zIndex=webix.ui.zIndex();this._point_element.style.position=d?"fixed":"absolute";this._point_element.style.top=c+"px";this._point_element.style.left=b+"px"},_hide_point:function(){this._point_element=webix.html.remove(this._point_element)}},webix.ui.window);webix.ui._popups=webix.toArray();
webix.ResizeArea={resize_setter:function(a){a&&!this._resizeHandlers&&this._renderResizeHandler();return a},_renderResizeHandler:function(){if(!this._rwHandle){var a=this._viewobj;a.firstChild&&(a=a.firstChild,a.style.position="relative");this._rwHandle=webix.html.create("DIV",{"class":"webix_resize_handle",webix_disable_drag:"true"});a.appendChild(this._rwHandle);webix._event(this._rwHandle,webix.env.mouse.down,this._wrDown,{bind:this})}},_showResizeFrame:function(a,b){if(!this._resizeFrame){this._resizeFrame=
webix.html.create("div",{"class":"webix_resize_frame"},"");document.body.appendChild(this._resizeFrame);var c=webix.html.offset(this._viewobj);this._resizeFrame.style.left=c.x+"px";this._resizeFrame.style.top=c.y+"px";this._resizeFrame.style.zIndex=webix.ui.zIndex()}this._resizeFrame.style.width=a+"px";this._resizeFrame.style.height=b+"px"},_wrDown:function(a){this.config.resize&&(webix.html.addCss(document.body,"webix_noselect webix_resize_cursor"),this._wsReady=webix.html.offset(this._viewobj),
this._resizeHandlersMove=webix.event(document.body,webix.env.mouse.move,this._wrMove,{bind:this}),this._resizeHandlersUp=webix.event(document.body,webix.env.mouse.up,this._wrUp,{bind:this}))},_wrMove:function(a){if(!1!==this._wsReady){a=webix.html.pos(a);var b={x:a.x-this._wsReady.x+10,y:a.y-this._wsReady.y+10};if(this.$resizeMove)this.$resizeMove(b);else if(Math.abs(this._wsReady.x-a.x)<(this.config.minWidth||100)||Math.abs(this._wsReady.y-a.y)<(this.config.maxHeight||100))return;this._wsProgress=
b;this._showResizeFrame(b.x,b.y)}},_wrUp:function(){this._resizeFrame&&(this._resizeFrame=webix.html.remove(this._resizeFrame));webix.html.removeCss(document.body,"webix_resize_cursor");webix.html.removeCss(document.body,"webix_noselect");webix.eventRemove(this._resizeHandlersMove);webix.eventRemove(this._resizeHandlersUp);this._wsProgress&&(this.$resizeEnd?this.$resizeEnd(this._wsProgress):(this.config.width=this._wsProgress.x,this.config.height=this._wsProgress.y,this.resize()));this._wsReady=this._wsProgress=
!1;this.callEvent("onViewResize",[])}};webix.extend(webix.ui.window,webix.ResizeArea);
webix.protoUI({name:"suggest",defaults:{autofocus:!1,type:"list",keyPressTimeout:1,body:{yCount:10,autoheight:!0,body:!0,select:!0,borderless:!0,navigation:!0},filter:function(a,b){return 0===a.value.toString().toLowerCase().indexOf(b.toLowerCase())?!0:!1}},template_setter:webix.template,filter_setter:function(a){return webix.toFunctor(a,this.$scope)},$init:function(a){var b={};webix.extend(b,webix.copy(this.defaults.body));b.view=a.type||this.defaults.type;var c=this._get_extendable_cell(b);a.body&&
webix.extend(c,a.body,!0);a.data&&(c.data=a.data);a.url&&(c.url=a.url);a.datatype&&(c.datatype=a.datatype);a.id&&(b.id=b.id||a.id+"_"+b.view);a.body=b;this.$ready.push(this._set_on_popup_click);this.attachEvent("onShow",function(){if(this._settings.master){var a=webix.$$(this._settings.master);a&&(a._getInputDiv?a._getInputDiv():a.getInputNode()).setAttribute("aria-expanded","true")}this._show_selection()});this.attachEvent("onHide",function(){if(this._settings.master){var a=webix.$$(this._settings.master);
a&&(a._getInputDiv?a._getInputDiv():a.getInputNode()).setAttribute("aria-expanded","false")}});this._old_text={}},_get_extendable_cell:function(a){return a},_preselectMasterOption:function(a){var b,c="";if(a&&this._settings.master){var d=webix.$$(this._settings.master);(b=d.getInputNode())&&d.$setValueHere?d.$setValueHere(a.value):b&&(d.options_setter?c=this.getItemText(a.id):a.value&&(c=d._get_visible_text?d._get_visible_text(a.value):a.value.toString()),webix.isUndefined(b.value)?b.innerHTML=c:
b.value=c.replace(/<[^>]*>/g,""))}(b=b||this._last_input_target)&&b.focus()},setMasterValue:function(a,b){var c=a.id?this.getItemText(a.id):a.text||a.value;if(this._settings.master){var d=webix.$$(this._settings.master);b&&a.id?d.refresh():d.options_setter?d.setValue(a.$empty?"":a.id):d.setValueHere?d.setValueHere(c):d.setValue(c)}else this._last_input_target&&(this._last_input_target.value=c);b||(this.hide(!0),this._last_input_target&&this._last_input_target.focus());this.callEvent("onValueSuggest",
[a,c]);webix.delay(function(){webix.callEvent("onEditEnd",[])})},getMasterValue:function(){return this._settings.master?webix.$$(this._settings.master).getValue():null},getItemId:function(a){var b=this.getList(),c;for(c in b.data.pull){var d=b.getItem(c);if(this._settings.filter.call(this,d,a))return d.id}},getItemText:function(a){var b=this.getList().getItem(a);if(!b)return this._old_text[a]||"";if(this._settings.template)return this._settings.template.call(this,b,this.type);if(this._settings.textValue)return""+
b[this._settings.textValue];var c=this.getList().type;b=c.template.call(c,b,c);return this._old_text[a]=b},getSuggestion:function(){var a,b=this.getList(),c=b.data.order;b.getSelectedId&&(a=b.getSelectedId());c.length&&(!a||0>c.find(a))&&(a=c[0]);a&&"object"==typeof a&&(a+="");return a},getList:function(){return this._body_cell},_set_on_popup_click:function(){var a=this.getList(),b=this._settings.type;a.count?(a.attachEvent("onItemClick",webix.bind(function(b){this.setMasterValue(a.getItem(b))},this)),
a.data.attachEvent("onstoreupdated",webix.bind(function(a,b,e){"delete"==e&&a==this.getMasterValue()?this.setMasterValue({id:"",text:""},1):"update"==e&&a==this.getMasterValue()&&this.setMasterValue(b,1)},this)),a.data.attachEvent("onAfterFilter",webix.bind(this._suggest_after_filter,this)),a.data.attachEvent("onStoreLoad",webix.bind(this._suggest_after_filter,this)),webix.isUndefined(this._settings.fitMaster)&&(this._settings.fitMaster=!0)):"calendar"==b?(a.attachEvent("onDateSelect",function(b){this.getParentView().setMasterValue({value:a.getSelectedDate()},
a.config.multiselect)}),a.attachEvent("onTodaySet",function(a){this.getParentView().setMasterValue({value:a})}),a.attachEvent("onDateClear",function(a){this.getParentView().setMasterValue({value:a})})):"colorboard"==b&&a.attachEvent("onItemClick",function(a){this.getParentView().setMasterValue({value:a})})},input_setter:function(a){this.linkInput(a);return 0},linkInput:function(a){if(a.getInputNode){var b=a.getInputNode();b.webix_master_id=a._settings.id}else b=webix.toNode(a);webix._event(b,"keydown",
function(c){b==document.body&&!this.isVisible()||(a.config?a.config.readonly:b.getAttribute("readonly"))||this._suggestions(c)},{bind:this});a._getInputDiv&&(b=a._getInputDiv());b.setAttribute("aria-autocomplete","list");b.setAttribute("aria-expanded","false");"DIV"===b.tagName&&(b.setAttribute("aria-live","assertive"),b.setAttribute("aria-atomic","true"));this._non_ui_mode=!0},_suggestions:function(a){a=a||event;var b=this.getList(),c=a.target||a.srcElement;if(c!=document.body&&"webix_clipbuffer"!=
c.className){this._last_input_target=c;this._settings.master=c.webix_master_id;window.clearTimeout(this._key_timer);var d=a.keyCode;if(16!=d&&17!=d){if(9==d)return this._tab_key(this,b);if(27==d)return this._escape_key(this,b);if(13==d)return this.$enterKey(this,b);if(this._navigate(a))return webix.html.preventEvent(a),!1;webix.isUndefined(c.value)||(clearTimeout(this._last_delay),this._last_delay=webix.delay(function(){if(this._non_ui_mode||webix.UIManager.getFocus()==webix.$$(this._settings.master)){this._resolve_popup=
!0;var a=c.value;b.config.dataFeed?b.filter("value",a):b.filter&&b.filter(webix.bind(function(b){return this._settings.filter.call(this,b,a)},this))}},this,[],this._settings.keyPressTimeout))}}},_suggest_after_filter:function(){if(!this._resolve_popup)return!0;this._resolve_popup=!1;0<this.getList().count()?(this.adjust(),this.isVisible()||(this._dont_unfilter=!0),this.show(this._last_input_target,null,!0),this._dont_unfilter=!1):(this.hide(!0),this._last_input_target=null)},show:function(a){if(!this.isVisible()){var b=
this.getList();b.filter&&!this._dont_unfilter&&b.filter("");this.$customWidth&&this.$customWidth(a);a.tagName&&this._settings.fitMaster&&(this._settings.width=a.offsetWidth-2);b._zoom_level&&b.render();this.adjust();"INPUT"==a.tagName&&(this._last_input_target=a)}webix.ui.popup.prototype.show.apply(this,arguments)},_show_selection:function(a){a=a||this.getList();var b=this.getMasterValue();a.select&&a.showItem?b&&a.exists&&a.exists(b)?(a.select(b),a.showItem(b)):(a.unselect(),a.showItem(a.getFirstId())):
a.setValue&&(this._settings.master&&(b=webix.$$(this._settings.master).$prepareValue(b)),a.setValue(b))},$enterKey:function(a,b){if(a.isVisible()){if(b.count&&b.count()){var c=b.getSelectedId(!1,!0);1==b.count()&&b.getFirstId()!=c&&(c=b.getFirstId());c&&(c=b.getItem(c))}else b.getSelectedDate&&b.getSelectedDate()?c={value:b.getSelectedDate()}:b.getValue&&b.getValue()&&(c={value:b.getValue()});c&&this.setMasterValue(c);a.hide(!0)}else a.show(this._last_input_target)},_escape_key:function(a,b){return a.hide(!0)},
_tab_key:function(a,b){return a.hide(!0)},_navigate:function(a){var b=this.getList(),c=a.keyCode,d;if(b.moveSelection&&41>c&&32<c&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey){if(40===c)this.isVisible()||this.show(this._last_input_target),b.moveSelection("down",!1,!1);else{if(b.count&&38!==c||!b.count&&!b.isVisible())return!1;var e;33==c&&(e="pgup");34==c&&(e="pgdown");35==c&&(e="bottom");36==c&&(e="top");37==c&&(e="left");38==c&&(e="up");39==c&&(e="right");b.moveSelection(e,!1,!1)}b.count?d=b.getSelectedItem():
b.getSelectedDate?d={value:b.getVisibleDate()}:b.getValue&&(d={value:b.getValue()});this._preselectMasterOption(d);return!0}return!1},getValue:function(){var a=this.getList(),b=(a.getValue?a.getValue():a.getSelectedId())||"";b=b.id||b;return a.getItem&&(a=a.getItem(b))&&a.$empty?"":b},setValue:function(a){var b=this.getList();a?b.exists(a)&&(b.select(a),b.showItem(a)):(b.unselect(),b.showItem(b.getFirstId()))}},webix.ui.popup);
webix.HTMLOptions={$init:function(a){(webix.skin.$active.customRadio||this.addOption)&&webix._event(this.$view,"keydown",this._moveSelection,{bind:this})},_focus:function(){var a=this._getInputNode();if(a)for(var b=0;b<a.length;b++)"0"==a[b].getAttribute("tabindex")&&a[b].focus()},_blur:function(){var a=this._getInputNode();if(a)for(var b=0;b<a.length;b++)"0"==a[b].getAttribute("tabindex")&&a[b].blur()},_moveSelection:function(a){var b=a.which||a.keyCode;if(b>(this.addOption?34:36)&&41>b){webix.html.preventEvent(a);
a=this._getInputNode();if(35==b)var c=a.length-1;else if(36===b)c=0;else{b=37===b||38===b?-1:1;for(var d=0;d<a.length;d++)if("0"==a[d].getAttribute("tabindex")){c=d+b;0>c?c=a.length-1:c>=a.length&&(c=0);break}}webix.isUndefined(c)||(b=this.addOption?a[c].getAttribute("button_id"):a[c].value,webix.skin.$active.customRadio&&!this.addOption&&(a=this.$view.getElementsByTagName("BUTTON")),this.setValue(b),a[c].focus())}}};
webix.attachEvent("onClick",function(a){var b=webix.$$(a);if(b&&b.touchable){webix.UIManager.applyChanges(b);b.getNode(a);var c=a.target||a.srcElement;if("webix_disabled"!=c.className){var d;if(!c.className||0!==c.className.toString().indexOf("webix_view")){for(b&&webix.UIManager._focus_action(b);c&&c.parentNode;){if(c.getAttribute){if(c.getAttribute("view_id"))break;if(d=c.className){d=d.toString().split(" ");for(var e=0;e<d.length;e++)if(b.on_click[d[e]]&&!1===b.on_click[d[e]].call(b,a,b._settings.id,
c))return}}c=c.parentNode}b._settings.click&&(c=webix.toFunctor(b._settings.click,b.$scope))&&c.call&&c.call(b,b._settings.id,a);(c=b._settings.popup)&&!b._settings.readonly&&("object"!=typeof c||c.name||(c=b._settings.popup=webix.ui(c)._settings.id),c=webix.$$(c),webix.assert(c,"Unknown popup"),c.isVisible()||(c._settings.master=b._settings.id,c.show(b.getInputNode()||b.getNode(),null,!0)));b.callEvent("onItemClick",[b._settings.id,a])}}}});
webix.protoUI({name:"button",touchable:!0,$skin:function(){this.defaults.height=webix.skin.$active.buttonHeight||webix.skin.$active.inputHeight;this._labelTopHeight=webix.skin.$active.labelTopHeight||15;this._borderWidth=webix.skin.$active.borderWidth},defaults:{template:function(a,b){b=b.$renderInput(a,b);a.badge&&(b=b.replace("</button>","<span class='webix_badge'>"+a.badge+"</span></button>"));return"<div class='webix_el_box' style='width:"+a.awidth+"px; height:"+a.aheight+"px'>"+b+"</div>"},label:"",
borderless:!0},$renderInput:function(a){return"<button type='button' "+(a.popup?"aria-haspopup='true'":"")+("class='webixtype_"+(a.type||"base")+"' >")+webix.template.escape(a.label||a.value)+"</button>"},$init:function(a){this._viewobj.className+=" webix_control webix_el_"+(this.$cssName||this.name);this.data=this._settings;this._dataobj=this._viewobj;this._calc_size(a)},hotkey_setter:function(a){var b=this;this._addElementHotKey(a,function(a,d){webix.html.triggerEvent(b.$view.firstChild,"MouseEvents",
"click");webix.html.preventEvent(d)})},_addElementHotKey:function(a,b,c){var d=webix.UIManager.addHotKey(a,b,c);this.attachEvent("onDestruct",function(){webix.UIManager.removeHotKey(d,b,c)})},tooltip_setter:function(a){var b=this._getBox()||this.$view.firstChild;b&&(b.title=a);return a},type_setter:function(a){this._types[a]&&(this.$renderInput=webix.template(this._types[a]));this._set_inner_size="prev"==a||"next"==a?this._set_inner_size_next:!1;return a},_types:{htmlbutton:"<button type='button' class='webix_el_htmlbutton webixtype_base'>#label#</button>",
prev:"<input type='button' class='webixtype_prev' value='#label#' /><div class='webix_el_arrow webixtype_prev_arrow'></div>",next:"<input type='button' class='webixtype_next' value='#label#' /><div class='webix_el_arrow webixtype_next_arrow'></div>",imageButton:"<button type='button' class='webix_img_btn_abs webixtype_base' style='width:100%; line-height:#cheight#px'><div class='webix_image' style='width:#dheight#px;height:#dheight#px;background-image:url(#image#);'> </div> #label#</button>",imageButtonTop:"<button type='button' class='webix_img_btn_abs webix_img_btn_abs_top webixtype_base'><div class='webix_image' style='width:100%;height:100%;background-image:url(#image#);'> </div> <div class='webix_img_btn_text'>#label#</div></button>",
image:"<button type='button' class='webix_img_btn' style='line-height:#cheight#px;'><div class='webix_image' style='width:#cheight#px;height:#cheight#px;background-image:url(#image#);'> </div> #label#</button>",imageTop:"<button type='button' class='webix_img_btn_top'><div class='webix_image' style='width:100%;height:100%;background-image:url(#image#);'></div> <div class='webix_img_btn_text'>#label#</div></button>",icon:"<button type='button' class='webix_img_btn' style='line-height:#cheight#px;'><span class='webix_icon_btn fa-#icon#' style='max-width:#cheight#px;'></span>#label#</button>",
iconButton:"<button type='button' class='webix_img_btn_abs webixtype_base' style='width:100%;'><span class='webix_icon fa-#icon#'></span> #label#</button>",iconTop:"<button type='button' class='webix_img_btn_top' style='width:100%;top:4px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#label#</div></button>",iconButtonTop:"<button type='button' class='webix_img_btn_abs webix_img_btn_abs_top webixtype_base' style='width:100%;top:0px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#label#</div></button>"},
_findAllInputs:function(){for(var a=[],b=["input","select","textarea","button"],c=0;c<b.length;c++)for(var d=this.$view.getElementsByTagName(b[c]),e=0;e<d.length;e++)a.push(d[e]);return a},disable:function(){var a=this._getBox();webix.ui.baseview.prototype.disable.apply(this,arguments);if(a&&-1==a.className.indexOf(" webix_disabled_box")){a.className+=" webix_disabled_box";var b=this._findAllInputs();for(a=0;a<b.length;a++)b[a].setAttribute("disabled",!0);(a=this.getInputNode())&&"div"==a.tagName.toLowerCase()&&
(this._disabledTabIndex=a.getAttribute("tabIndex"),a.removeAttribute("tabIndex"));"top"==this._settings.labelPosition&&(a=this._dataobj.firstChild)&&(a.className+=" webix_disabled_top_label")}},enable:function(){webix.ui.baseview.prototype.enable.apply(this,arguments);var a;if(a=this._getBox()){a.className=a.className.replace(" webix_disabled_box","");a=this._findAllInputs();for(var b=0;b<a.length;b++)a[b].removeAttribute("disabled");(a=this.getInputNode())&&!webix.isUndefined(this._disabledTabIndex)&&
a.setAttribute("tabIndex",this._disabledTabIndex);"top"==this._settings.labelPosition&&(a=this._dataobj.firstChild)&&(a.className=a.className.replace(" webix_disabled_top_label",""))}},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&this.render()},setValue:function(a){a=this.$prepareValue(a);var b=this._settings.value;if(this.$compareValue(b,a))return!1;this._settings.value=a;this._rendered_input&&this.$setValue(a);this.callEvent("onChange",[a,b])},$compareValue:function(a,
b){"number"===typeof b&&(b=b.toString());"number"===typeof a&&(a=a.toString());return a==b},$prepareValue:function(a){return this._pattern(a,!1)},_pattern:function(a){return a},$setValue:function(a){var b=this.getInputNode();b&&("BUTTON"==b.tagName?b.innerHTML=a:b.value=a)},getValue:function(){var a=this._rendered_input?this.$getValue():this._settings.value;return"undefined"==typeof a?"":a},$getValue:function(){return this._settings.value||""},focus:function(){if(!this._settings.disabled){var a=this.getInputNode();
a&&a.focus&&a.focus()}},blur:function(){var a=this.getInputNode();a&&a.blur&&a.blur()},getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]||this._dataobj.getElementsByTagName("button")[0]},_getBox:function(){for(var a=0;a<this._dataobj.childNodes.length;a++)if(0<=this._dataobj.childNodes[a].className.indexOf("webix_el_box"))return this._dataobj.childNodes[a];return null},_sqrt_2:Math.sqrt(2),_set_inner_size_next:function(){var a=this._settings,b=this._getBox().childNodes[1],
c=b.previousSibling,d="next"==a.type?"right":"left",e=a.aheight-2*webix.skin.$active.inputPadding-2*this._borderWidth,f=e*this._sqrt_2/2;b.style.width=f+"px";b.style.height=f+"px";b.style.top=(e-f)/2+webix.skin.$active.inputPadding+"px";b.style[d]=(e-f)/2+this._sqrt_2/2+"px";c.style.width=a.awidth-e/2-2+"px";c.style.height=e+2+"px";c.style[d]=e/2+2+"px";c.style.top=webix.skin.$active.inputPadding+"px"},_calc_size:function(a){a=a||this._settings;a.autowidth&&(a.width=webix.html.getTextSize(a.value||
a.label,"webixbutton").width+(a.badge?15:0)+("iconButton"===a.type?30:0)+("icon"===a.type?20:0))},_calck_input_size:function(){this._input_width=this._settings.inputWidth||(2<this._content_width-this._settings.width?this._settings.width:0)||this._content_width;this._input_height=this._settings.inputHeight||this._inputHeight||0},resize:function(){this._calc_size();return webix.ui.view.prototype.resize.apply(this,arguments)},render:function(){this._calck_input_size();this._settings.awidth=this._input_width||
this._content_width;this._settings.aheight=this._input_height||this._content_height;this._settings.bheight=this._settings.aheight+2;this._settings.cheight=this._settings.aheight-2*webix.skin.$active.inputPadding;this._settings.dheight=this._settings.cheight-2;if(webix.AtomRender.render.call(this)){this._rendered_input=!0;this._set_inner_size&&this._set_inner_size();if(this._settings.align){var a=this._dataobj.firstChild;"top"==this._settings.labelPosition&&a.nextSibling&&(a=a.nextSibling);switch(this._settings.align){case "right":a.style.cssFloat=
"right";break;case "center":a.style.display="inline-block";a.parentNode.style.textAlign="center";break;case "middle":a.style.marginTop=Math.round((this._content_height-this._input_height)/2)+"px";break;case "bottom":a.style.marginTop=this._content_height-this._input_height+"px";break;case "left":a.style.cssFloat="left";break;default:webix.assert(!1,"Unknown align mode: "+this._settings.align)}}this.$render&&this.$render(this.data);this._settings.disabled&&this.disable();this._settings.tooltip&&this.define("tooltip",
this._settings.tooltip);this._init_once&&(this._init_once(this.data),this._init_once=0)}},refresh:function(){this.render()},on_click:{_handle_tab_click:function(a,b){(b=webix.html.locate(a,"button_id"))&&this.callEvent("onBeforeTabClick",[b,a])&&(this.setValue(b),this.callEvent("onAfterTabClick",[b,a]))},webix_all_segments:function(a,b){this.on_click._handle_tab_click.call(this,a,b)},webix_all_tabs:function(a,b){this.on_click._handle_tab_click.call(this,a,b)},webix_inp_counter_next:function(a,b,c){this._settings.readonly||
this.next()},webix_inp_counter_prev:function(a,b,c){this._settings.readonly||this.prev()},webix_input_icon:function(a,b,c){this.getInputNode().focus()},webix_inp_checkbox_border:function(a,b,c){this._settings.disabled||"DIV"==(a.target||a.srcElement).tagName||this._settings.readonly||this.toggle()},webix_inp_checkbox_label:function(a,b,c){this._settings.readonly||this.toggle()},webix_inp_radio_border:function(a,b,c){a=webix.html.locate(a,"radio_id");this.setValue(a)},webix_inp_radio_label:function(a,
b,c){c=c.parentNode.getElementsByTagName("input")[0];return this.on_click.webix_inp_radio_border.call(this,c,b,c)},webix_tab_more_icon:function(a,b,c){this.getPopup().resize();this.getPopup().show(c,null,!0)},webix_tab_close:function(a,b,c){(b=webix.html.locate(a,"button_id"))&&this.callEvent("onBeforeTabClose",[b,a])&&this.removeOption(b)}},_check_options:function(a){webix.assert(a,this.name+": options not defined");for(var b=0;b<a.length;b++)webix.assert(!a[b].text,"Please replace .text with .value in control config"),
webix.assert(!a[b].label,"Please replace .label with .value in control config"),"string"==typeof a[b]?a[b]={id:a[b],value:a[b]}:(webix.isUndefined(a[b].id)&&(a[b].id=a[b].value),webix.isUndefined(a[b].value)&&(a[b].value=a[b].id));return a},_get_div_placeholder:function(a){return(a=a?a.placeholder:this._settings.placeholder)?"<span class='webix_placeholder'>"+a+"</span>":""}},webix.ui.view,webix.AtomRender,webix.Settings,webix.EventSystem);
webix.protoUI({name:"label",defaults:{template:"<div style='height:100%;line-height:#cheight#px'>#label#</div>"},$skin:function(){this.defaults.height=webix.skin.$active.inputHeight},focus:function(){return!1},_getBox:function(){return this._dataobj.firstChild},setHTML:function(a){this._settings.template=function(){return a};this.refresh()},setValue:function(a){this._settings.label=a;webix.ui.button.prototype.setValue.apply(this,arguments)},$setValue:function(a){this._dataobj.firstChild.innerHTML=
a},_set_inner_size:function(){},_calc_size:function(a){a=a||this._settings;a.autowidth&&(a.width=webix.html.getTextSize(a.value||a.label,"webix_el_label").width)}},webix.ui.button);
webix.protoUI({name:"icon",$skin:function(){this.defaults.height=webix.skin.$active.inputHeight},defaults:{template:function(a){return"<button type='button'  style='height:100%;width:100%;' class='webix_icon_button'><span class='webix_icon fa-"+a.icon+" '></span>"+(a.badge?"<span class='webix_badge'>"+a.badge+"</span>":"")+"</button>"},width:33},_set_inner_size:function(){},$setValue:function(){}},webix.ui.button);
webix.protoUI({name:"text",_allowsClear:!0,_init_onchange:function(){this._allowsClear&&(this._onBlur||webix._event(this.getInputNode(),"change",this._applyChanges,{bind:this}),this._settings.suggest&&webix.$$(this._settings.suggest).linkInput(this))},_applyChanges:function(){var a=this.getValue();a!=this._settings.value?this.setValue(a,!0):this._custom_format&&this.$setValue(a)},$skin:function(){this.defaults.height=webix.skin.$active.inputHeight;this.defaults.inputPadding=webix.skin.$active.inputPadding;
this._inputSpacing=webix.skin.$active.inputSpacing},$init:function(a){"top"==a.labelPosition&&webix.isUndefined(a.height)&&this.defaults.height&&(a.height=this.defaults.height+this._labelTopHeight);this._destroy_with_me=[];this.attachEvent("onAfterRender",this._init_onchange);this.attachEvent("onBlur",function(){this._onBlur&&this._onBlur()})},$renderIcon:function(){var a=this._settings;if(a.icon){var b=a.aheight-2*a.inputPadding,c=(b-18)/2-1;return"<span style='height:"+(b-c)+"px;padding-top:"+c+
"px;' class='webix_input_icon fa-"+a.icon+"' "+(this.addSection?"role='button' tabindex='0' aria-label='"+webix.i18n.aria["multitext"+(a.mode||"")+"Section"]+"'":"")+"></span>"}return""},relatedView_setter:function(a){this.attachEvent("onChange",function(){var a=this.getValue(),c=this._settings.relatedAction,d=this._settings.relatedView,e=webix.$$(d);if(!e){var f=this.getTopParentView();f&&f.$$&&(e=f.$$(d))}webix.assert(e,"Invalid relatedView: "+d);"enable"==c?a?e.enable():e.disable():a?e.show():
e.hide()});return a},validateEvent_setter:function(a){"blur"==a&&this.attachEvent("onBlur",this.validate);"key"==a&&this.attachEvent("onTimedKeyPress",this.validate);return a},validate:function(){var a=this._settings.validate;!a&&this._settings.required&&(a=webix.rules.isNotEmpty);var b=this.getFormView(),c=this._settings.name,d=this.getValue(),e={};e[c]=d;webix.assert(b,"Validation works only for fields in the form");webix.assert(c,"Validation works only for fields with name");return a&&!b._validate(a,
d,e,c)?!1:!0},bottomLabel_setter:function(a){this._settings.bottomPadding||(this._settings.bottomPadding=18);return a},_getInvalidText:function(){var a=this._settings.invalidMessage;"function"==typeof a&&a.call(this);return a},setBottomText:function(a,b){var c=this._settings;if("undefined"!=typeof a){if(c.bottomLabel==a)return;c.bottomLabel=a}a=(c.invalid?c.invalidMessage:"")||c.bottomLabel;a||c.bottomPadding||(c.inputHeight=0);a&&!c.bottomPadding?(this._restorePadding=1,c.bottomPadding=c.bottomPadding||
b||18,this.render(),this.resize()):!a&&this._restorePadding?(c.bottomPadding=this._restorePadding=0,c.height||this.render(),this.resize()):this.render()},$getSize:function(){var a=webix.ui.view.prototype.$getSize.apply(this,arguments),b=this.config.bottomPadding;b&&(a[2]+=b,a[3]+=b);return a},$setSize:function(a,b){var c=this._settings;webix.ui.view.prototype.$setSize.call(this,a,b)&&a&&b&&("top"==c.labelPosition?(c.inputHeight||(this._inputHeight=this._content_height-this._labelTopHeight-(this.config.bottomPadding||
0)),c.labelWidth=0):c.bottomPadding&&(c.inputHeight=this._content_height-this.config.bottomPadding),this.render())},_get_input_width:function(a){a=(this._input_width||0)-(a.label?this._settings.labelWidth:0)-this._inputSpacing-(a.iconWidth||0);return 0>a?0:a},_render_div_block:function(a,b){var c="x"+webix.uid(),d=b._get_input_width(a),e=a.inputAlign||"left";this.$renderIcon&&this.$renderIcon(a);var f=this._settings.aheight-2*webix.skin.$active.inputPadding-2*this._borderWidth,g=a.text||a.value||
this._get_div_placeholder(a);d="<div class='webix_inp_static' role='combobox' aria-label='"+webix.template.escape(a.label)+"' tabindex='0'"+(a.readonly?" aria-readonly='true'":"")+(a.invalid?"aria-invalid='true'":"")+" onclick='' style='line-height:"+f+"px;width: "+d+"px; text-align: "+e+";' >"+g+"</div>";return b.$renderInput(a,d,c)},_baseInputHTML:function(a){a="<"+a+(this._settings.placeholder?" placeholder='"+this._settings.placeholder+"' ":" ");this._settings.readonly&&(a+="readonly='true' aria-readonly=''");
this._settings.required&&(a+="aria-required='true'");this._settings.invalid&&(a+="aria-invalid='true'");var b=this._settings.attributes;if(b)for(var c in b)a+=c+"='"+b[c]+"' ";return a},$renderLabel:function(a,b){var c=a.labelAlign||"left",d="top"==this._settings.labelPosition,e=d?"display:block;":"width: "+this._settings.labelWidth+"px;",f="",g=d?this._labelTopHeight-2*this._borderWidth:this._settings.aheight-2*this._settings.inputPadding;a.label&&(f="<label style='"+e+"text-align: "+c+";line-height:"+
g+"px;' onclick='' for='"+b+"' class='webix_inp_"+(d?"top_":"")+"label "+(a.required?"webix_required":"")+"'>"+(a.label||"")+"</label>");return f},$renderInput:function(a,b,c){var d=a.inputAlign||"left",e="top"==a.labelPosition,f=this._get_input_width(a);c=c||webix.uid();var g=this.$renderLabel(a,c),h="";if(b)h+=b;else{b=webix.template.escape(a.text||this._pattern(a.value)||(0===a.value?"0":""));h+=this._baseInputHTML("input")+"id='"+c+"' type='"+(a.type||this.name)+"'"+(a.editable?" role='combobox'":
"")+" value='"+b+"' style='width: "+f+"px; text-align: "+d+";'";if(c=a.attributes)for(var k in c)h+=" "+k+"='"+c[k]+"'";h+=" />"}k=this.$renderIcon?this.$renderIcon(a):"";h+=k;e=e?g+"<div class='webix_el_box' style='width:"+a.awidth+"px; height:"+a.aheight+"px'>"+h+"</div>":"<div class='webix_el_box' style='width:"+a.awidth+"px; height:"+a.aheight+"px'>"+g+h+"</div>";g=a.awidth-f-2*webix.skin.$active.inputPadding;(h=(a.invalid?a.invalidMessage:"")||a.bottomLabel)&&(e+="<div class='webix_inp_bottom_label'"+
(a.invalid?"role='alert' aria-relevant='all'":"")+" style='width:"+(f||a.awidth)+"px;margin-left:"+Math.max(g,webix.skin.$active.inputPadding)+"px;'>"+h+"</div>");return e},defaults:{template:function(a,b){return b.$renderInput(a)},label:"",labelWidth:80},type_setter:function(a){return a},_set_inner_size:!1,$setValue:function(a){this.getInputNode().value=this._pattern(a)},$getValue:function(){return this._pattern(this.getInputNode().value,!1)},suggest_setter:function(a){if(a){webix.assert(!0!==a,
"suggest options can't be set as true, data need to be provided instead");if("string"==typeof a){if(webix.$$(a))return webix.$$(a)._settings.id;a={body:{url:a,dataFeed:a}}}else webix.isArray(a)?a={body:{data:this._check_options(a)}}:a.body||(a.body={});webix.extend(a,{view:"suggest"});a=webix.ui(a);this._destroy_with_me.push(a);return a._settings.id}return!1}},webix.ui.button);
webix.protoUI({name:"segmented",_allowsClear:!1,$init:function(){this.attachEvent("onChange",function(a){this._settings.multiview&&this._show_view(a)});this.attachEvent("onAfterRender",webix.once(function(){this._settings.multiview&&this._settings.value&&this._show_view(this._settings.value)}))},_show_view:function(a){var b=this.getTopParentView(),c=null;b&&b.$$&&(c=b.$$(a));c||(c=webix.$$(a));c&&c.show&&c.show()},defaults:{template:function(a,b){a.options||webix.assert(!1,"segmented: options undefined");
var c=a.options;b._check_options(c);c=b._filterOptions(c);var d=b._get_input_width(a),e=webix.uid(),f="<div style='width:"+d+"px' class='webix_all_segments' role='tablist' aria-label='"+webix.template.escape(a.label)+"'>";d=a.optionWidth||Math.floor(d/c.length);a.value||(a.value=c[0].id);for(var g=0;g<c.length;g++)f+="<button type='button' style='width:"+(c[g].width||d)+"px' role='tab' aria-selected='"+(a.value==c[g].id?"true":"false")+"' tabindex='"+(a.value==c[g].id?"0":"-1")+"'",f+="class='webix_segment_"+
(g==c.length-1?"N":0<g?1:0)+(a.value==c[g].id?" webix_selected ":"")+"' button_id='"+c[g].id+"' "+(c[g].tooltip?"title='"+c[g].tooltip+"'":"")+">",f+=c[g].value+"</button>";return b.$renderInput(a,f+"</div>",e)}},_getInputNode:function(){return this.$view.getElementsByTagName("BUTTON")},focus:function(){this._focus()},blur:function(){this._blur()},$setValue:function(a){for(var b=this._getInputNode(),c=0;c<b.length;c++){var d=b[c].getAttribute("button_id");b[c].setAttribute("aria-selected",a==d?"true":
"false");b[c].setAttribute("tabindex",a==d?"0":"-1");a==d?webix.html.addCss(b[c],"webix_selected"):webix.html.removeCss(b[c],"webix_selected")}(b=this.config.tabbarPopup)&&webix.$$(b)&&webix.$$(b).getBody().exists(a)&&this.refresh()},getValue:function(){return this._settings.value},getInputNode:function(){return null},optionIndex:function(a){for(var b=this._settings.options,c=0;c<b.length;c++)if(b[c].id==a)return c;return-1},addOption:function(a,b,c,d){var e=a;"object"!=typeof a?e={id:a,value:b||
a}:(a=e.id,d=c,c=b);0>this.optionIndex(a)&&webix.PowerArray.insertAt.call(this._settings.options,e,d);this.refresh();c&&this.setValue(a)},removeOption:function(a,b){b=this.optionIndex(a);var c=this._settings.options;0<=b&&webix.PowerArray.removeAt.call(c,b);this._settings.value==a&&this._setNextVisible(c,b);this.refresh();this.callEvent("onOptionRemove",[a,this._settings.value])},_setNextVisible:function(a,b){var c=a.length;if(c){for(var d=b=Math.min(b,c-1);d<c;d++)if(!a[d].hidden)return this.setValue(a[d].id);
for(d=b;0<=d;d--)if(!a[d].hidden)return this.setValue(a[d].id)}this.setValue("")},_filterOptions:function(a){for(var b=[],c=0;c<a.length;c++)a[c].hidden||b.push(a[c]);return b},_setOptionVisibility:function(a,b){var c=this._settings.options,d=this.optionIndex(a),e=c[d];e&&b==!!e.hidden&&(e.hidden=!b,b||this._settings.value!=a?this.refresh():this._setNextVisible(c,d))},hideOption:function(a){this._setOptionVisibility(a,!1)},showOption:function(a){this._setOptionVisibility(a,!0)},_set_inner_size:!1},
webix.HTMLOptions,webix.ui.text);webix.protoUI({name:"search",on_click:{webix_input_icon:function(a){this.getInputNode().focus();this.callEvent("onSearchIconClick",[a])}},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},defaults:{type:"text",icon:"search"}},webix.ui.text);
webix.protoUI({name:"toggle",_allowsClear:!0,$init:function(){this.attachEvent("onItemClick",function(){this.toggle()})},$setValue:function(a){var b=this.getInputNode(),c=this._settings,d=((a=a&&"0"!=a)?c.onLabel:c.offLabel)||c.label;b.setAttribute("aria-pressed",a?"true":!1);b.value=d;b.lastChild&&(b.lastChild.nodeValue=" "+d);b.firstChild&&"SPAN"===b.firstChild.nodeName&&c.onIcon&&c.offIcon&&c.onIcon!==c.offIcon&&(b.firstChild.className=b.firstChild.className.replace(a?c.offIcon:c.onIcon,a?c.onIcon:
c.offIcon));b=b.parentNode;a?webix.html.addCss(b,"webix_pressed"):webix.html.removeCss(b,"webix_pressed")},toggle:function(){this.setValue(!this.getValue())},getValue:function(){var a=this._settings.value;return a&&"0"!=a?1:0},defaults:{template:function(a,b){var c=a.value&&"0"!=a.value;a.label=(c?a.onLabel:a.offLabel)||a.label;a.icon=(c?a.onIcon:a.offIcon)||a.icon;a="<div class='webix_el_box"+(c?" webix_pressed":"")+"' style='width:"+a.awidth+"px; height:"+a.aheight+"px'>"+b.$renderInput(a,b)+"</div>";
return a=a.replace(/(button)\s*(?=\w)/,"$1 aria-pressed='"+((c?"true":"false")+"' "))}},_set_inner_size:!1},webix.ui.button);
webix.protoUI({name:"select",defaults:{template:function(a,b){var c=b._check_options(a.options),d="x"+webix.uid(),e=b._baseInputHTML("select")+"id='"+d+"' style='width:"+b._get_input_width(a)+"px;'>",f=webix.$$(c);if(f&&f.data&&f.data.each)f.data.each(function(b){e+="<option"+(b.id==a.value?" selected='true'":"")+" value='"+b.id+"'>"+b.value+"</option>"});else for(f=0;f<c.length;f++)e+="<option"+(c[f].id==a.value?" selected='true'":"")+" value='"+c[f].id+"'>"+c[f].value+"</option>";e+="</select>";
return b.$renderInput(a,e,d)}},options_setter:function(a){if(a)return"string"==typeof a&&(a=new webix.DataCollection({url:a}),a.data.attachEvent("onStoreLoad",webix.bind(this.refresh,this))),a},getInputNode:function(){return this._dataobj.getElementsByTagName("select")[0]}},webix.ui.text);
webix.protoUI({name:"textarea",defaults:{template:function(a,b){var c=a.name||a.id,d="x"+webix.uid(),e=b._baseInputHTML("textarea")+"style='width:"+b._get_input_width(a)+"px;'";e+=" id='"+d+"' name='"+c+"' class='webix_inp_textarea'>"+b._pattern(a.value||(0===a.value?"0":""))+"</textarea>";return b.$renderInput(a,e,d)},height:0,minHeight:60},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding;this._inputSpacing=webix.skin.$active.inputSpacing},_skipSubmit:!0,$renderLabel:function(a,
b){var c=a.labelAlign||"left",d="top"==this._settings.labelPosition,e=d?"display:block;":"width: "+this._settings.labelWidth+"px;",f="";a.label&&(f="<label style='"+e+"text-align: "+c+";' onclick='' for='"+b+"' class='webix_inp_"+(d?"top_":"")+"label "+(a.required?"webix_required":"")+"'>"+(a.label||"")+"</label>");return f},getInputNode:function(){return this._dataobj.getElementsByTagName("textarea")[0]}},webix.ui.text);
webix.protoUI({name:"counter",defaults:{template:function(a,b){var c=a.value||0,d="x"+webix.uid(),e="<div role='spinbutton' aria-label='"+webix.template.escape(a.label)+"' aria-valuemin='"+a.min+"' aria-valuemax='"+a.max+"' aria-valuenow='"+a.value+"' class='webix_el_group' style='width:"+b._get_input_width(a)+"px'>";e+="<button type='button' class='webix_inp_counter_prev' tabindex='-1' aria-label='"+webix.i18n.aria.decreaseValue+"'>-</button>";e+=b._baseInputHTML("input")+" id='"+d+"' type='text' class='webix_inp_counter_value' aria-live='assertive' value='"+
c+"'></input>";e+="<button type='button' class='webix_inp_counter_next' tabindex='-1' aria-label='"+webix.i18n.aria.increaseValue+"'>+</button></div>";return b.$renderInput(a,e,d)},min:0,max:Infinity,step:1},$init:function(){webix._event(this.$view,"keydown",this._keyshift,{bind:this})},_keyshift:function(a){a=a.which||a.keyCode;var b=this._settings,c=b.value||b.min;32<a&&41>a&&(35===a?c=b.min:36===a?c=Infinity===b.max?1E6:b.max:33===a?this.next():34===a?this.prev():c+=37===a||40===a?-1:1,34<a&&c>=
b.min&&c<=b.max&&this.setValue(c))},$setValue:function(a){this.getInputNode().value=a},getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]},getValue:function(a){return 1*webix.ui.button.prototype.getValue.apply(this,arguments)},next:function(a){a=this._settings.step;this.shift(a)},prev:function(a){a=-1*this._settings.step;this.shift(a)},shift:function(a){var b=this._settings.min,c=this._settings.max;a=this.getValue()+a;a>=b&&a<=c&&this.setValue(a)}},webix.ui.text);
webix.protoUI({name:"checkbox",defaults:{checkValue:1,uncheckValue:0,template:function(a,b){var c="x"+webix.uid(),d="";a.labelRight&&(d="<label class='webix_label_right'>"+a.labelRight+"</label>",a.labelWidth&&(a.label=a.label||"&nbsp;"));var e=a.checkValue==a.value,f=Math.floor((b._settings.aheight-16)/2);f=b._baseInputHTML("input")+"style='margin-top:"+f+"px;"+(a.customCheckbox?"display:none":"")+"' id='"+c+"' type='checkbox' "+(e?"checked='1'":"")+(a.labelRight?" aria-label='"+webix.template.escape(a.labelRight)+
"'":"")+"/>";e="webix_inp_checkbox_border webix_el_group webix_checkbox_"+(e?"1":"0");var g=a.customCheckbox||"";g&&(g=g.replace(/(aria-checked=')\w*(?=')/,"$1"+(a.value==a.checkValue?"true":"false")),g=g.replace(/(aria-label=')\w*(?=')/,"$1"+webix.template.escape(a.labelRight||a.label)),g=g.replace(/(aria-invalid=')\w*(?=')/,"$1"+(a.invalid?"true":"false")));return b.$renderInput(a,"<div style='line-height:"+b._settings.cheight+"px' class='"+e+"'>"+f+g+d+"</div>",c)}},customCheckbox_setter:function(a){!0===
a&&webix.skin.$active.customCheckbox&&(a="<a role='presentation' onclick='javascript:void(0)'><button role='checkbox' aria-checked='false' aria-label='' type='button' aria-invalid='' class='webix_custom_checkbox'></button></a>");return a},focus:function(){var a=this.getInputNode();a&&a.focus()},blur:function(){var a=this.getInputNode();a&&a.blur()},_init_onchange:function(){},$setValue:function(a){a=a==this._settings.checkValue;var b=this.$view.getElementsByTagName("input")[0],c=b?b.parentNode:null;
if(c&&this._settings.customCheckbox){var d=c.getElementsByTagName("BUTTON");d[0]&&d[0].setAttribute("aria-checked",a?"true":"false")}c&&(c.className=c.className.replace(/(webix_checkbox_)\d/,"$1"+(a?1:0)));b.checked=a},toggle:function(){var a=this.getValue()!=this._settings.checkValue?this._settings.checkValue:this._settings.uncheckValue;this.setValue(a)},getValue:function(){return this._settings.value==this._settings.checkValue?this._settings.checkValue:this._settings.uncheckValue},getInputNode:function(){return this.$view.getElementsByTagName(this._settings.customCheckbox?
"button":"input")[0]},$skin:function(){webix.skin.$active.customCheckbox&&(this.defaults.customCheckbox=!0)}},webix.ui.text);
webix.protoUI({name:"radio",defaults:{template:function(a,b){for(var c=b._check_options(a.options),d=[],e,f=0;f<c.length;f++){var g="x"+webix.uid();e=e||g;f&&(c[f].newline||a.vertical)&&d.push("<div class='webix_line_break'></div>");var h=c[f].id==a.value,k=c[f].value||"",l=a.customRadio||"";l&&(l=l.replace(/(aria-label=')\w*(?=')/,"$1"+webix.template.escape((0===f?a.label+" ":"")+k)),l=l.replace(/(aria-checked=')\w*(?=')/,"$1"+(h?"true":"false")),l=l.replace(/(tabindex=')\w*(?=')/,"$1"+(h||0===f&&
!a.value?"0":"-1")),l=l.replace(/(aria-invalid=')\w*(?=')/,"$1"+(a.invalid?"true":"false")));var m=b._baseInputHTML("input")+" name='"+(a.name||a.id)+"' type='radio' "+(h?"checked='1'":"")+"tabindex="+(h||0===f&&!a.value?"0":"-1")+" value='"+c[f].id+"' id='"+g+"' style='"+(l?"display:none":"")+"' />";h="<div radio_id='"+c[f].id+"' class='webix_inp_radio_border webix_radio_"+(h?"1":"0")+"' role='presentation'>"+m+l+"</div>";k&&(k="<label for='"+g+"' class='webix_label_right'>"+k+"</label>");d.push("<div class='webix_radio_option' role='presentation'>"+
h+k+"</div>")}d="<div class='webix_el_group' role='radiogroup' style='margin-left:"+(a.label?a.labelWidth:0)+"px;'>"+d.join("")+"</div>";return b.$renderInput(a,d,e)}},refresh:function(){this.render();this._last_size&&this.$getSize(0,0)[2]!=this._last_size[1]&&this.resize()},$getSize:function(a,b){a=webix.ui.button.prototype.$getSize.call(this,a,b);if(this._settings.options){b=this._settings.vertical?0:1;for(var c=0;c<this._settings.options.length;c++)(this._settings.vertical||this._settings.options[c].newline)&&
b++;a[3]=a[2]=Math.max(a[2],(this._settings.optionHeight||25)*b+2*this._settings.inputPadding+("top"==this._settings.labelPosition?this._labelTopHeight:0))}if(b=this.config.bottomPadding)a[2]+=b,a[3]+=b;return a},_getInputNode:function(){return this._dataobj.getElementsByTagName("input")},$setValue:function(a){for(var b=this._getInputNode(),c=0;c<b.length;c++){b[c].parentNode.getAttribute("radio_id")==a?(b[c].className="webix_inp_radio_on",b[c].checked=!0,b[c].setAttribute("tabindex","0")):(b[c].className=
"webix_inp_radio_on webix_hidden",b[c].checked=!1,b[c].setAttribute("tabindex","-1"));var d=b[c]?b[c].parentNode:null;d&&(d.className=d.className.replace(/(webix_radio_)\d/,"$1"+(b[c].checked?1:0)),this._settings.customRadio&&(d=d.getElementsByTagName("BUTTON"),d[0]&&(d[0].setAttribute("aria-checked",b[c].checked?"true":"false"),d[0].setAttribute("tabindex",b[c].checked?"0":"-1"))))}},getValue:function(a){return this._settings.value},focus:function(){this._focus()},blur:function(){this._blur()},customRadio_setter:function(a){!0===
a&&webix.skin.$active.customRadio&&(a="<a role='presentation' onclick='javascript:void(0)'><button type='button' class='webix_custom_radio' role='radio' aria-checked='false' aria-label='' aria-invalid='' tabindex=''></button></a>");return a},$skin:function(){webix.skin.$active.customRadio&&(this.defaults.customRadio=!0);webix.skin.$active.optionHeight&&(this.defaults.optionHeight=webix.skin.$active.optionHeight)}},webix.HTMLOptions,webix.ui.text);
webix.protoUI({name:"richselect",defaults:{template:function(a,b){return b._render_div_block(a,b)},popupWidth:200,icon:"angle-down"},_onBlur:function(){if(this._settings.text!=this.getText()&&(!webix.isUndefined(this._settings.text)||this.getText())){var a=this.getPopup(),b=a.getSuggestion(),c=this.getValue();!b||b==c||""===this.getInputNode().value&&""!==a.getItemText(b)?""===this.getInputNode().value?this.setValue(""):this._revertValue&&this._revertValue():this.setValue(b)}},suggest_setter:function(a){return this.options_setter(a)},
options_setter:function(a){a=this._suggest_config?this._suggest_config(a):a;a=this._settings.popup=this._settings.suggest=webix.ui.text.prototype.suggest_setter.call(this,a);var b=webix.$$(a).getList();b&&b.attachEvent("onAfterLoad",webix.bind(this._reset_value,this));return a},getList:function(){var a=webix.$$(this._settings.suggest);webix.assert(a,"Input doesn't have a list");return a.getList()},_reset_value:function(){var a=this._settings.value;webix.isUndefined(a)||this.getPopup().isVisible()||
this._settings.text||!this._dataobj.firstChild||this.$setValue(a)},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},$render:function(a){webix.isUndefined(a.value)||this.$setValue(a.value)},getInputNode:function(){return this._dataobj.getElementsByTagName("DIV")[1]},getPopup:function(){return webix.$$(this._settings.popup)},getText:function(){var a=this._settings.value,b=this.getInputNode();return b?"undefined"==typeof b.value?b.firstChild&&"webix_placeholder"===b.firstChild.className?
"":b.innerHTML:b.value:a?this.getPopup().getItemText(a):""},$setValue:function(a){if(this._rendered_input){var b=a;this.getPopup()&&(b=this.getPopup().getItemText(a));!b&&a&&a.id&&(this.getPopup().getList().add(a),b=this.getPopup().getItemText(a.id),this._settings.value=a.id);a=this.getInputNode();webix.isUndefined(a.value)?a.innerHTML=b||this._get_div_placeholder():a.value=b=b.replace(/<[^>]*>/g,"");this._settings.text=b}},getValue:function(){return this._settings.value||""}},webix.ui.text);
webix.protoUI({name:"combo",getInputNode:function(){return this._dataobj.getElementsByTagName("input")[0]},$render:function(a){webix.isUndefined(a.value)||this.$setValue(a.value)},_revertValue:function(){if(!this._settings.editable){var a=this.getValue();this.$setValue(webix.isUndefined(a)?"":a)}},_applyChanges:function(){var a=this.getInputNode(),b="",c=this.getPopup();a.value&&(b=this._settings.value,c.getItemText(b)!=this.getText()&&(b=c.getSuggestion()||b));b!=this._settings.value?this.setValue(b,
!0):this.$setValue(b)},defaults:{template:function(a,b){return b.$renderInput(a).replace(/(<input)\s*(?=\w)/,"$1 role='combobox'")},icon:"angle-down"}},webix.ui.richselect);
webix.protoUI({name:"datepicker",$init:function(){this.$ready.push(this._init_popup)},defaults:{template:function(a,b){"time"==b._settings.type&&(b._settings.icon=b._settings.timeIcon);var c=a.type;a.type="";b=a.editable?b.$renderInput(a):b._render_div_block(a,b);a.type=c;return b},stringResult:!1,timepicker:!1,icon:"calendar",icons:!0,timeIcon:"clock-o",separator:", "},_onBlur:function(){if(this._settings.text!=this.getText()&&(!webix.isUndefined(this._settings.text)||this.getText())){var a=this.getPopup().getValue();
a&&this.setValue(a)}},$skin:function(){this.defaults.inputPadding=webix.skin.$active.inputPadding},getPopup:function(){return webix.$$(this._settings.popup)},_init_popup:function(){var a=this._settings;if(a.suggest)a.popup=a.suggest;else if(!a.popup){var b=this._settings.timepicker;a.popup=a.suggest=this.suggest_setter({type:"calendar",point:!1===this._settings.point?!1:!0,height:240+(b?30:0),width:250,padding:0,body:{multiselect:this._settings.multiselect,timepicker:b,type:this._settings.type,icons:this._settings.icons}})}this._init_once=
function(){}},$render:function(a){webix.isUndefined(a.value)||(a.value=this.$prepareValue(a.value),this.$setValue(a.value))},$prepareValue:function(a){if(this._settings.multiselect){"string"===typeof a?a=a.split(this._settings.separator):a instanceof Date?a=[a]:a||(a=[]);for(var b=0;b<a.length;b++)a[b]=this._prepareSingleValue(a[b]);return a}return this._prepareSingleValue(a)},_prepareSingleValue:function(a){var b=this._settings.type,c="time"==b;isNaN(parseFloat(a))||(a=""+a);"string"==typeof a&&
a&&(a=("month"!=b&&"year"!=b||!this._formatDate?c?webix.i18n.parseTimeFormatDate:webix.i18n.parseFormatDate:this._formatDate)(a));a&&(c&&webix.isArray(a)&&(b=new Date,b.setHours(a[0]),b.setMinutes(a[1]),a=b),isNaN(a.getTime())&&(a=""));return a},_get_visible_text:function(a){return this._settings.multiselect?[].concat(a).map(function(a){return this._get_visible_text_single(a)}.bind(this)).join(this.config.separator):this._get_visible_text_single(a)},_get_visible_text_single:function(a){var b="time"==
this._settings.type,c=this.config.timepicker;return(this._formatStr||(b?webix.i18n.timeFormatStr:c?webix.i18n.fullDateFormatStr:webix.i18n.dateFormatStr))(a)},_set_visible_text:function(){var a=this.getInputNode();a.value==webix.undefined?a.innerHTML=this._settings.text||this._get_div_placeholder():a.value=this._settings.text||""},$compareValue:function(a,b){return a||b?webix.Date.equal(a,b):!0},$setValue:function(a){this._settings.text=a?this._get_visible_text(a):"";this._set_visible_text()},format_setter:function(a){a?
"function"===typeof a?this._formatStr=a:(this._formatStr=webix.Date.dateToStr(a),this._formatDate=webix.Date.strToDate(a)):this._formatStr=this._formatDate=null;return a},getInputNode:function(){return this._settings.editable?this._dataobj.getElementsByTagName("input")[0]:this._dataobj.getElementsByTagName("DIV")[1]},getValue:function(){if(this._settings.multiselect){var a=[].concat(this._settings.value).map(function(a){return this._get_value_single(a)}.bind(this));return this._settings.stringResult?
a.join(this._settings.separator):a}return this._get_value_single(this._settings.value)},_get_value_single:function(a){var b=this._settings.type,c="time"==b,d=this.config.timepicker;this._rendered_input?this._settings.editable&&(a=(this._formatDate||(c?webix.i18n.timeFormatDate:d?webix.i18n.fullDateFormatDate:webix.i18n.dateFormatDate))(this.getInputNode().value)):a=this.$prepareValue(a)||null;return this._settings.stringResult?(d=webix.i18n.parseFormatStr,c&&(d=webix.i18n.parseTimeFormatStr),!this._formatStr||
"month"!=b&&"year"!=b||(d=this._formatStr),a?d(a):""):a||null},getText:function(){var a=this.getInputNode();return a?"undefined"==typeof a.value?this.getValue()?a.innerHTML:"":a.value:""}},webix.ui.text);
webix.protoUI({name:"colorpicker",$init:function(){this.$ready.push(this._init_popup)},defaults:{icon:!0},_init_popup:function(){var a=this._settings;a.suggest?a.popup=a.suggest:a.popup||(a.popup=a.suggest=this.suggest_setter({type:"colorboard",height:200}));this._init_once=function(){}},$render:function(a){webix.isUndefined(a.value)||(a.value=this.$prepareValue(a.value),this.$setValue(a.value))},getValue:function(){return this._rendered_input&&this._settings.editable?this.getInputNode().value:this._settings.value},
$prepareValue:function(a){a&&a.charAt&&"#"!=a.charAt(0)&&(a="#"+a);return a||""},_getColorNode:function(){return this.$view.getElementsByTagName("DIV")[this._settings.editable?1:2]},_get_visible_text:function(a){return a},$setValue:function(a){this._getColorNode().style.backgroundColor=a;this._settings.text=a;var b=this.getInputNode();b.value==webix.undefined?b.innerHTML=a:b.value=a},$renderIcon:function(){return'<div class="webix_input_icon" style="background-color:'+this.config.value+';"> </div>'}},
webix.ui.datepicker);
webix.RenderStack={$init:function(){webix.assert(this.data,"RenderStack :: Component doesn't have DataStore");webix.assert(webix.template,"webix.template :: webix.template is not accessible");this._html=document.createElement("DIV");this.data.attachEvent("onIdChange",webix.bind(this._render_change_id,this));this.attachEvent("onItemClick",this._call_onclick);this.types||(this.types={"default":this.type},this.type.name="default");this.type=webix.clone(this.type)},customize:function(a){webix.type(this,a)},
item_setter:function(a){return this.type_setter(a)},type_setter:function(a){this.types[a]?(this.type=webix.clone(this.types[a]),this.type.css&&(this._contentobj.className+=" "+this.type.css)):this.customize(a);this.type.on_click&&webix.extend(this.on_click,this.type.on_click);return a},template_setter:function(a){this.type.template=webix.template(a)},_toHTML:function(a){var b=this.data._marks[a.id];webix.assert(!a.$template||this.type["template"+a.$template],"RenderStack :: Unknown template: "+a.$template);
this.callEvent("onItemRender",[a]);return this.type.templateStart(a,this.type,b)+(a.$template?this.type["template"+a.$template]:this.type.template)(a,this.type,b)+this.type.templateEnd(a,this.type,b)},_toHTMLObject:function(a){this._html.innerHTML=this._toHTML(a);return this._html.firstChild},_render_change_id:function(a,b){var c=this.getItemNode(a);c&&(c.setAttribute(this._id,b),this._htmlmap[b]=this._htmlmap[a],delete this._htmlmap[a])},_call_onclick:function(){if(this._settings.click){var a=webix.toFunctor(this._settings.click,
this.$scope);a&&a.call&&a.apply(this,arguments)}},getItemNode:function(a){if(this._htmlmap)return this._htmlmap[a];this._htmlmap={};for(var b=this._dataobj.childNodes,c=0;c<b.length;c++){var d=b[c].getAttribute(this._id);d&&(this._htmlmap[d]=b[c])}return this.getItemNode(a)},locate:function(a){return webix.html.locate(a,this._id)},showItem:function(a){var b=this.getItemNode(a);if(b&&this.scrollTo){var c=Math.abs(this._contentobj.offsetLeft-b.offsetLeft),d=c+b.offsetWidth,e=Math.abs(this._contentobj.offsetTop-
b.offsetTop);b=e+b.offsetHeight;var f=this.getScrollState(),g=f.x;if(g>c||g+this._content_width<d)g=c;c=f.y;if(c>e||c+this._content_height<b)c=e-5;this.scrollTo(g,c);this._setItemActive&&this._setItemActive(a)}},render:function(a,b,c){if(this.isVisible(this._settings.id)&&!this.$blockRender)if(webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id+", mode:"+(c||"#")+", item:"+(a||"#")),a){var d=this.getItemNode(a);switch(c){case "paint":case "update":if(!d)break;b=this._htmlmap[a]=
this._toHTMLObject(b);webix.html.insertBefore(b,d);webix.html.remove(d);break;case "delete":if(!d)break;webix.html.remove(d);delete this._htmlmap[a];break;case "add":b=this._htmlmap[a]=this._toHTMLObject(b);webix.html.insertBefore(b,this.getItemNode(this.data.getNextId(a)),this._dataobj);break;case "move":webix.html.insertBefore(this.getItemNode(a),this.getItemNode(this.data.getNextId(a)),this._dataobj);break;default:webix.assert_error("Unknown render command: "+c)}}else this.callEvent("onBeforeRender",
[this.data])&&((this._renderobj||this._dataobj).innerHTML=this.data.getRange().map(this._toHTML,this).join(""),this._htmlmap=null,this.callEvent("onAfterRender",[]))}};
webix.ValidateData={$init:function(){this._events&&this.attachEvent("onChange",this.clearValidation)},clearValidation:function(){if(this.elements)for(var a in this.elements)this._clear_invalid(a)},validate:function(a,b){webix.assert(this.callEvent,"using validate for eventless object");this.callEvent("onBeforeValidate",[]);var c=this._validate_details={},d=!0,e=this._settings.rules,f=this.isVisible&&!this.isVisible(),g=a&&a.hidden,h=a&&a.disabled;a={};var k={},l;for(l in this.elements){var m=this.elements[l].config.name;
(f||this.elements[l].isVisible()||g)&&(this.elements[l].isEnabled()||h)?a[m]=this.elements[l]:k[m]=!0}(e||a)&&!b&&this.getValues&&(b=this.getValues());if(e){e.$obj&&(d=this._validate(e.$obj,b,b,"")&&d);f=e.$all;g=b;this._settings.complexData&&(g=webix.CodeParser.collapseNames(b));if(f)for(var n in b)k[n]||((l=this._validate(f,g[n],b,n))||(c[n]=!0),d=l&&d);for(n in e)k[n]||0===n.indexOf("$")||c[n]||(webix.assert(e[n],"Invalid rule for:"+n),(l=this._validate(e[n],g[n],b,n))||(c[n]=!0),d=l&&d)}if(a)for(n in a)if(!c[n])if(e=
a[n],e.validate)d=(l=e.validate())&&d,l||(c[n]=!0);else if(e=e._settings)k=e.validate,!k&&e.required&&(k=webix.rules.isNotEmpty),k&&((l=this._validate(k,b[n],b,n))||(c[n]=!0),d=l&&d);this.callEvent("onAfterValidation",[d,this._validate_details]);return d},_validate:function(a,b,c,d){"string"==typeof a&&(a=webix.rules[a]);if(a.call(this,b,c,d))return this.callEvent("onValidationSuccess",[d,c])&&this._clear_invalid&&this._clear_invalid(d),!0;this.callEvent("onValidationError",[d,c])&&this._mark_invalid&&
this._mark_invalid(d);return!1}};
webix.ValidateCollection={_validate_init_once:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(a,b,c){!a||"add"!=c&&"update"!=c||this.validate(a)},this));this.data.attachEvent("onClearAll",webix.bind(this.clearValidation,this));this._validate_init_once=function(){}},rules_setter:function(a){a&&this._validate_init_once();return a},clearValidation:function(){this.data.clearMark("webix_invalid",!0)},validate:function(a){var b=!0;if(a){this._validate_details={};var c=this.getItem(a);
(b=webix.ValidateData.validate.call(this,null,c))?this.callEvent("onValidationSuccess",[a,c])&&this._clear_invalid(a):this.callEvent("onValidationError",[a,c,this._validate_details])&&this._mark_invalid(a,this._validate_details)}else for(c in this.data.pull)b=this.validate(c)&&b;return b},_validate:function(a,b,c,d){"string"==typeof a&&(a=webix.rules[a]);(a=a.call(this,b,c,d))||(this._validate_details[d]=!0);return a},_clear_invalid:function(a){this.data.removeMark(a,"webix_invalid",!0)},_mark_invalid:function(a,
b){this.data.addMark(a,"webix_invalid",!0)}};webix.rules={isEmail:function(a){return/\S+@[^@\s]+\.[^@\s]+$/.test((a||"").toString())},isNumber:function(a){return parseFloat(a)==a},isChecked:function(a){return!!a||"0"===a},isNotEmpty:function(a){return 0===a||a}};
webix.MapCollection={$init:function(){this.$ready.push(this._create_scheme_init);this.attachEvent("onStructureUpdate",this._create_scheme_init);this.attachEvent("onStructureLoad",function(){this._scheme_init_order.length||this._create_scheme_init()})},_create_scheme_init:function(a){a=this._scheme_init_order=[];var b=this._settings;b.columns&&this._build_data_map(b.columns);this._settings.map&&this._process_field_map(b.map);if(this._scheme_init_order.length)try{this.data._scheme_init=Function("obj",
a.join("\n"))}catch(c){webix.assert_error("Invalid data map:"+a.join("\n"))}},_process_field_map:function(a){for(var b in a)this._scheme_init_order.push(this._process_single_map(b,a[b]))},_process_single_map:function(a,b,c){var d="",e="";0===b.indexOf("(date)")?(d="webix.i18n.parseFormatDate(",e=")",c&&!c.format&&(c.format=webix.i18n.dateFormatStr),b=b.replace("(date)","")):0===b.indexOf("(number)")&&(d="(",e=")*1",b=b.replace("(number)",""));""!==b?(b=b.replace(/\{obj\.([^}]*)\}/g,"\"+(obj.$1||'')+\""),
b=b.replace(/#([^#'";, ]+)#/gi,"\"+(obj.$1||'')+\"")):b='"+(obj.'+a+"||'')+\"";return"obj."+a+" = "+d+'"'+b+'"'+e+";"},_build_data_map:function(a){for(var b=0;b<a.length;b++){var c=a[b].map,d=a[b].id;d||(d=a[b].id="i"+webix.uid(),a[b].header||(a[b].header=""));c&&this._scheme_init_order.push(this._process_single_map(d,c,a[b]));this._map_options(a[b])}},_map_options:function(a){var b=a.options||a.collection;if(b)if("string"===typeof b){var c=webix.$$(b);c||(c=new webix.DataCollection({url:b}),this._destroy_with_me.push(c));
c.getBody&&(c=c.getBody());this._bind_collection(c,a)}else if(b.loadNext)this._bind_collection(b,a);else if(b[0]&&"object"==typeof b[0])b=new webix.DataCollection({data:b}),this._bind_collection(b,a),this._destroy_with_me.push(b);else{if(webix.isArray(b)){c={};for(var d=0;d<b.length;d++)c[b[d]]=b[d];a.options=b=c}a.template=a.template||this._collection_accesser(b,a.id,a.optionslist)}},_bind_collection:function(a,b){if(b){delete b.options;b.collection=a;b.template=b.template||this._bind_accesser(a,
b.id,b.optionslist);var c=a.data.attachEvent("onStoreUpdated",webix.bind(function(){this.refresh();this.refreshFilter&&this.refreshFilter(b.id)},this));this.attachEvent("onDestruct",function(){a.$destructed||a.data.detachEvent(c)})}},_collection_accesser:function(a,b,c){if(c){var d="string"==typeof c?c:",";return function(c,f){c=c[b]||c.value;if(!c)return"";c=c.split(d);for(f=0;f<c.length;f++)c[f]=a[c[f]]||"";return c.join(", ")}}return function(c,d){return a[c[b]]||c.value||""}},_bind_accesser:function(a,
b,c){if(c){var d="string"==typeof c?c:",";return function(c,f){c=c[b]||c.value;if(!c)return"";c=c.split(d);for(f=0;f<c.length;f++){var e=a.data.pull[c[f]];c[f]=e?e.value||"":""}return c.join(", ")}}return function(c,d){return(c=a.data.pull[c[b]||c.value])&&(c.value||0===c.value)?c.value:""}}};
webix.Undo={$init:function(){this._undoHistory=webix.extend([],webix.PowerArray,!0);this._undoCursor=-1},undo_setter:function(a){a&&(this._init_undo(),this._init_undo=function(){});return a},_init_undo:function(){var a=this;this.attachEvent("onBeforeDrop",function(b){b.from==b.to&&(b=a._draggedItem=webix.copy(this.getItem(b.start)),b.$index=this.data.branch?this.getBranchIndex(b.id):this.getIndexById(b.id))});this.data.attachEvent("onDataMove",function(b){if(a._draggedItem&&a._draggedItem.id==b){var c=
a._draggedItem;a._draggedItem=null;a._addToHistory(b,c,"move")}});this.data.attachEvent("onBeforeDelete",function(b){if(this.getItem(b)){var c=a._deletedItem=webix.copy(this.getItem(b));this.branch?(c.$index=this.getBranchIndex(b),this.branch[b]&&(c.$branch=webix.copy(this.serialize(b)))):c.$index=this.getIndexById(b)}});this.data.attachEvent("onDataUpdate",function(b,c,d){a._addToHistory(b+"",d,"update")});this.data.attachEvent("onStoreUpdated",function(b,c,d){var e=null;b&&("add"==d?e=webix.copy(c):
"delete"==d&&(e=a._deletedItem),e&&a._addToHistory(b,e,d))});this.data.attachEvent("onIdChange",function(b,c){"object"==typeof b&&(b=b.row);for(var d=0;d<a._undoHistory.length;d++)a._undoHistory[d].id==b&&(a._undoHistory[d].id=c)})},_addToHistory:function(a,b,c){!this._skipHistory&&this._settings.undo&&(this._undoHistory.push({id:a,action:c,data:b}),20==this._undoHistory.length&&this._undoHistory.splice(0,1),this._skipCursorInc||(this._undoCursor=this._undoHistory.length-1))},ignoreUndo:function(a,
b){this._skipHistory=!0;a.call(b||this);this._skipHistory=!1},removeUndo:function(a){for(var b=this._undoHistory.length-1;0<=b;b--)this._undoHistory[b].id==a&&("id"==this._undoHistory[b].action&&(a=this._undoHistory[b].data),this._undoHistory.removeAt(b));this._undoCursor=this._undoHistory.length-1},undo:function(a){if(a)this.ignoreUndo(function(){var b,d;for(d=this._undoHistory.length-1;!b&&0<=d;d--)this._undoHistory[d].id==a&&(b=this._undoHistory[d]);b&&(this._undoAction(b),this._undoHistory.removeAt(d+
1),this._undoCursor=this._undoHistory.length-1)});else{var b=this._undoHistory[this._undoCursor];b&&(this.ignoreUndo(function(){this._undoAction(b);this._undoHistory.removeAt(this._undoCursor)}),this._undoCursor--)}},_undoAction:function(a){if("delete"==a.action){var b=null,c=a.data.$parent;a.data.$branch&&(b={parent:a.id,data:webix.copy(a.data.$branch)},delete a.data.$branch,c&&!this.data.branch[c]&&(c=0));this.add(a.data,a.data.$index,c);b&&this.parse(b)}else"add"==a.action?this.remove(a.id):"update"==
a.action?this.updateItem(a.id,a.data):"move"==a.action&&(a.data.$parent?this.getItem(a.data.$parent)&&this.move(a.id,a.data.$index,null,{parent:a.data.$parent}):this.move(a.id,a.data.$index))}};
webix.DataLoader=webix.proto({$init:function(a){a=a||"";this._ajax_queue=webix.toArray();this._feed_last={};this.data=new webix.DataStore;this.data.attachEvent("onClearAll",webix.bind(this._call_onclearall,this));this.data.attachEvent("onServerConfig",webix.bind(this._call_on_config,this));this.attachEvent("onDestruct",this._call_onclearall);this.data.feed=this._feed;this.data.owner=a.id},_feed:function(a,b,c){if(this._load_count)return this._load_count=[a,b,c];this._load_count=!0;this._feed_last.from=
a;this._feed_last.count=b;this._feed_common.call(this,a,b,c)},_feed_common:function(a,b,c,d,e){var f=null;d=d||this.data.url;c=[{success:this._feed_callback,error:this._feed_callback},c];0>a&&(a=0);e||(e={start:a,count:b});this.count()&&(e["continue"]="true");this.getState&&(f=this.getState());if(d&&"string"!=typeof d)f&&(f.sort&&(e.sort=f.sort),f.filter&&(e.filter=f.filter)),this.load(d,c,e);else{d+=-1==d.indexOf("?")?"?":"&";a=[];for(var g in e)a.push(g+"="+e[g]);if(f&&(f.sort&&a.push("sort["+f.sort.id+
"]="+encodeURIComponent(f.sort.dir)),f.filter))for(var h in f.filter)e=f.filter[h],"object"==typeof e&&(e=webix.ajax().stringify(e)),a.push("filter["+h+"]="+encodeURIComponent(e));d+=a.join("&");this._feed_last.url!==d?(this._feed_last.url=d,this.load(d,c)):this._load_count=!1}},_feed_callback:function(){var a=this._load_count;this._load_count=!1;"object"==typeof a&&this.data.feed.apply(this,a)},load:function(a,b){a=webix.proxy.$parse(a);var c=webix.AtomDataLoader.load.apply(this,arguments);this.data.url||
(this.data.url=a);return c},loadNext:function(a,b,c,d,e){var f=this._settings;f.datathrottle&&!e?(this._throttle_request&&window.clearTimeout(this._throttle_request),this._throttle_request=webix.delay(function(){this.loadNext(a,b,c,d,!0)},this,0,f.datathrottle)):(b||0===b||(b=this.count()),a||(a=f.datafetch||this.count()),this.data.url=this.data.url||d,this.callEvent("onDataRequest",[b,a,c,d])&&this.data.url&&this.data.feed.call(this,b,a,c))},_maybe_loading_already:function(a,b){var c=this._feed_last;
return this._load_count&&c.url&&c.from<=b&&c.count+c.from>=a+b?!0:!1},removeMissed_setter:function(a){return this.data._removeMissed=a},_init_dataprocessor:function(){var a=this._settings.save;!0===a&&(a=this._settings.save=this._settings.url);var b={master:this};a&&a.url?webix.extend(b,a):b.url=a;webix.dp(b)},save_setter:function(a){a&&this.$ready.push(this._init_dataprocessor);return a},scheme_setter:function(a){this.data.scheme(a)},dataFeed_setter:function(a){a=webix.proxy.$parse(a);this.data.attachEvent("onBeforeFilter",
webix.bind(function(a,c){if("function"==typeof a)return!0;if(this._settings.dataFeed&&(a||c)){a=a||"id";c&&"object"==typeof c&&(c=c.id);this.clearAll();var b=this._settings.dataFeed;if("function"==typeof b){var e={};e[a]=c;b.call(this,c,e)}else b.$proxy?b.load&&(e={},e[a]=c,b.load(this,{success:this._onLoad,error:this._onLoadError},{filter:e})):(a="filter["+a+"]="+encodeURIComponent(c),this.load(b+(0>b.indexOf("?")?"?":"&")+a,this._settings.datatype));return!1}},this));return a},_call_onready:function(){if(this._settings.ready&&
!this._ready_was_used){var a=webix.toFunctor(this._settings.ready,this.$scope);a&&webix.delay(a,this,arguments);this.callEvent&&webix.delay(this.callEvent,this,["onReady",[]]);this._ready_was_used=!0}},_call_onclearall:function(a){for(var b=0;b<this._ajax_queue.length;b++){var c=this._ajax_queue[b];try{c.aborted=!0}catch(d){webix._xhr_aborted.push(c)}c.abort()}a||(this._load_count=!1,this._feed_last={},this._ajax_queue=webix.toArray(),this.waitData=webix.promise.defer())},_call_on_config:function(a){this._parseSeetingColl(a)}},
webix.AtomDataLoader);webix._xhr_aborted=webix.toArray();
webix.DataMarks={addCss:function(a,b,c){if(!this.addRowCss&&!c&&!this.hasCss(a,b)){var d=this.getItemNode(a);d&&(d.className+=" "+b,c=!0)}return this.data.addMark(a,b,1,1,c)},removeCss:function(a,b,c){if(!this.addRowCss&&!c&&this.hasCss(a,b)){var d=this.getItemNode(a);d&&(d.className=d.className.replace(b,"").replace("  "," "),c=!0)}return this.data.removeMark(a,b,1,c)},hasCss:function(a,b){return this.data.getMark(a,b)},clearCss:function(a,b){return this.data.clearMark(a,1,b)}};
webix.DataStore=function(){this.name="DataStore";webix.extend(this,webix.EventSystem);this.setDriver("json");this.pull={};this.order=webix.toArray();this._marks={}};
webix.DataStore.prototype={setDriver:function(a){webix.assert(webix.DataDriver[a],"incorrect DataDriver");this.driver=webix.DataDriver[a]},_parse:function(a,b){this.callEvent("onParse",[this.driver,a]);this._filter_order&&this.filter();b=this.driver.getInfo(a);b.key&&(webix.securityKey=b.key);b.config&&this.callEvent("onServerConfig",[b.config]);var c=this.driver.getOptions(a);c&&this.callEvent("onServerOptions",[c]);c=this.driver.getRecords(a);this._inner_parse(b,c);this._scheme_group&&this._group_processing&&
!this._not_grouped_order&&this._group_processing(this._scheme_group);this._scheme_sort&&(this.blockEvent(),this.sort(this._scheme_sort),this.unblockEvent());this.callEvent("onStoreLoad",[this.driver,a]);this.refresh()},_inner_parse:function(a,b){var c=a.from,d=!0,e=!1;if(!c&&0!==c&&this.order[0]){if(this._removeMissed){e={};for(var f=0;f<this.order.length;f++)e[this.order[f]]=!0}d=!1;c=this.order.length}else c=1*(c||0);var g=0;for(f=0;f<b.length;f++){var h=this.driver.getDetails(b[f]),k=this.id(h);
this.pull[k]?d&&this.order[g+c]&&g++:(this.order[g+c]=k,g++);this.pull[k]?(webix.extend(this.pull[k],h,!0),this._scheme_update&&this._scheme_update(this.pull[k]),e&&delete e[k]):(this.pull[k]=h,this._scheme_init&&this._scheme_init(h))}if(e){this.blockEvent();for(var l in e)this.remove(l);this.unblockEvent()}this.order[a.size-1]||(this.order[a.size-1]=webix.undefined)},id:function(a){return a.id||(a.id=webix.uid())},changeId:function(a,b){a!=b&&(this.pull[a]&&(this.pull[b]=this.pull[a]),this.pull[b].id=
b,this.order[this.order.find(a)]=b,this._filter_order&&(this._filter_order[this._filter_order.find(a)]=b),this._marks[a]&&(this._marks[b]=this._marks[a],delete this._marks[a]),this.callEvent("onIdChange",[a,b]),this._render_change_id&&this._render_change_id(a,b),delete this.pull[a])},getItem:function(a){return this.pull[a]},updateItem:function(a,b,c){var d=this.getItem(a),e=null,f=this.hasEvent("onDataUpdate");webix.assert(d,"Ivalid ID for updateItem");webix.assert(!b||!b.id||b.id==a,"Attempt to change ID in updateItem");
webix.isUndefined(b)||d===b||(f&&(e=webix.copy(d)),a=d.id,webix.extend(d,b,!0),d.id=a);this._scheme_update&&this._scheme_update(d);this.callEvent("onStoreUpdated",[a.toString(),d,c||"update"]);f&&this.callEvent("onDataUpdate",[a,d,e])},refresh:function(a){this._skip_refresh||(a?this.exists(a)&&this.callEvent("onStoreUpdated",[a,this.pull[a],"paint"]):this.callEvent("onStoreUpdated",[null,null,null]))},silent:function(a,b){this._skip_refresh=!0;a.call(b||this);this._skip_refresh=!1},getRange:function(a,
b){a=a?this.getIndexById(a):this.$min||this.startOffset||0;b?b=this.getIndexById(b):(b=0===this.$max?0:Math.min(this.$max?this.$max-1:this.endOffset||Infinity,this.count()-1),0>b&&(b=0));if(a>b){var c=b;b=a;a=c}return this.getIndexRange(a,b)},getIndexRange:function(a,b){b=Math.min(0===b?0:b||Infinity,this.count()-1);var c=webix.toArray();for(a=a||0;a<=b;a++)c.push(this.getItem(this.order[a]));return c},count:function(){return this.order.length},exists:function(a){return!!this.pull[a]},move:function(a,
b){webix.assert(0<=a&&0<=b,"DataStore::move","Incorrect indexes");if(a!=b){var c=this.getIdByIndex(a),d=this.getItem(c);this._filter_order&&this._move_inner(this._filter_order,0,0,this.getIdByIndex(a),this.getIdByIndex(b));this._move_inner(this.order,a,b);this.callEvent("onStoreUpdated",[c,d,"move"])}},_move_inner:function(a,b,c,d,e){if(d||e){b=c=-1;for(var f=0;f<a.length;f++)a[f]==d&&0>b&&(b=f),a[f]==e&&0>c&&(c=f)}d=a[b];a.removeAt(b);a.insertAt(d,Math.min(a.length,c))},scheme:function(a){this._scheme=
{};this._scheme_save=a.$save;this._scheme_init=a.$init||a.$change;this._scheme_update=a.$update||a.$change;this._scheme_serialize=a.$serialize;this._scheme_group=a.$group;this._scheme_sort=a.$sort;for(var b in a)"$"!=b.substr(0,1)&&(this._scheme[b]=a[b])},importData:function(a,b){var c=a?a.data||a:[];this._filter_order=null;if("function"==typeof c.serialize){this.order=webix.toArray([].concat(c.order));if(this._make_full_copy){this._make_full_copy=!1;a=this.pull;this.pull={};for(var d in c.pull){var e=
a[d];this.pull[d]=webix.copy(c.pull[d]);e&&e.open&&(this.pull[d].open=!0)}}else this.pull=c.pull;c.branch&&this.branch&&(this.branch=webix.copy(c.branch),this._filter_branch=null)}else if(this.order=webix.toArray(),this.pull={},webix.isArray(a))for(d=0;d<a.length;d++){var f=e=a[d];"object"==typeof f?f.id=f.id||webix.uid():f={id:e,value:e};this.order.push(f.id);this._scheme_init&&this._scheme_init(f);this.pull[f.id]=f}else for(d in c)this.order.push(d),this.pull[d]={id:d,value:c[d]};if(this._extraParser&&
!c.branch)for(this.branch={0:[]},this._datadriver_child||this._set_child_scheme("data"),c=0;c<this.order.length;c++)d=this.order[c],this._extraParser(this.pull[d],0,0,!1);this.callEvent("onStoreLoad",[]);b||this.callEvent("onStoreUpdated",[])},sync:function(a,b,c){this.unsync();var d=typeof a;"string"==d&&(a=webix.$$(a));"function"!=d&&"object"!=d&&(c=b,b=null);webix.debug_bind&&(this.debug_sync_master=a,webix.log("[sync] "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id+" <= "+
this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id));if("DataStore"!=a.name){if(!a.data||"DataStore"!==a.data.name&&"TreeStore"!==a.data.name)return this._sync_source=a,webix.callEvent("onSyncUnknown",[this,a,b]);a=a.data}d=webix.bind(function(d,f,g){this._skip_next_sync||(b&&this.branch&&(this._make_full_copy=!0),this.importData(a,!0),b&&this.silent(b),this._on_sync&&this._on_sync(),d&&f&&g||(this._marks={}),"delete"==g&&this._marks[d]&&delete this._marks[d],webix.debug_bind&&webix.log("[sync:request] "+
this.debug_sync_master.name+"@"+this.debug_sync_master._settings.id+" <= "+this.debug_bind_master.name+"@"+this.debug_bind_master._settings.id),this.callEvent("onSyncApply",[]),c?c=!1:this.refresh())},this);this._sync_events=[a.attachEvent("onStoreUpdated",d),a.attachEvent("onIdChange",webix.bind(function(a,b){this.changeId(a,b);this.refresh(b)},this))];this._sync_source=a;this._back_sync_handler=this.attachEvent("onStoreUpdated",function(b,c,d){if("update"==d||"save"==d)this._skip_next_sync=1,a.updateItem(b,
c),this._skip_next_sync=0});d()},unsync:function(){if(this._sync_source){var a=this._sync_source;if("DataStore"==a.name||a.data&&"DataStore"==a.data.name){for(var b=0;b<this._sync_events.length;b++)a.detachEvent(this._sync_events[b]);this.detachEvent(this._back_sync_handler)}else webix.callEvent("onUnSyncUnknown",[this,a]);this._sync_source=null}},destructor:function(){this.unsync();this.pull=this.order=this._marks=null;this._evs_events=this._evs_handlers={}},add:function(a,b,c){if(this._scheme)for(var d in this._scheme)webix.isUndefined(a[d])&&
(a[d]=this._scheme[d]);this._scheme_init&&this._scheme_init(a);d=this.id(a);c=c||this.order;var e=c.length;if(webix.isUndefined(b)||0>b)b=e;b>e&&(webix.log("Warning","DataStore:add","Index of out of bounds"),b=Math.min(c.length,b));if(!1===this.callEvent("onBeforeAdd",[d,a,b]))return!1;webix.assert(!this.exists(d),"Not unique ID");this.pull[d]=a;c.insertAt(d,b);this._filter_order&&(c=this._filter_order.length,this.order.length&&(c=Math.min(b||0,c)),this._filter_order.insertAt(d,c));this.callEvent("onStoreUpdated",
[d,a,"add"]);this.callEvent("onAfterAdd",[d,b]);return a.id},remove:function(a){if(webix.isArray(a))for(var b=0;b<a.length;b++)this.remove(a[b]);else{if(!1===this.callEvent("onBeforeDelete",[a]))return!1;webix.assert(this.exists(a),"Not existing ID in remove command"+a);b=this.getItem(a);this.order.remove(a);this._filter_order&&this._filter_order.remove(a);delete this.pull[a];this._marks[a]&&delete this._marks[a];this.callEvent("onStoreUpdated",[a,b,"delete"]);this.callEvent("onAfterDelete",[a])}},
clearAll:function(a){this.pull={};this._marks={};this.order=webix.toArray();this._filter_order=null;a||(this.url=null);this.callEvent("onClearAll",[a]);this.refresh()},getIdByIndex:function(a){webix.assert(0<=a,"DataStore::getIdByIndex Incorrect index");return this.order[a]},getIndexById:function(a){var b=this.order.find(a);return this.pull[a]?b:-1},getNextId:function(a,b){return this.order[this.getIndexById(a)+(b||1)]},getFirstId:function(){return this.order[0]},getLastId:function(){return this.order[this.order.length-
1]},getPrevId:function(a,b){return this.order[this.getIndexById(a)-(b||1)]},sort:function(a,b,c){var d=a;"function"==typeof a?d={as:a,dir:b}:"string"==typeof a&&(d={by:a.replace(/#/g,""),dir:b,as:c});a=[d.by,d.dir,d.as,d];this.callEvent("onBeforeSort",a)&&(this.order=this._sort_core(d,this.order),this._filter_order&&this._filter_order.length!=this.order.length&&(this._filter_order=this._sort_core(d,this._filter_order)),this.refresh(),this.callEvent("onAfterSort",a))},_sort_core:function(a,b){a=this.sorting.create(a);
if(this.order.length){for(var c=b.splice(0,this.$freeze),d=webix.toArray(),e=b.length-1;0<=e;e--)d[e]=this.pull[b[e]];d.sort(a);return webix.toArray(c.concat(d.map(function(a){webix.assert(a,"Client sorting can't be used with dynamic loading");return this.id(a)},this)))}return b},_filter_reset:function(a){this._filter_order&&!a&&(this.order=this._filter_order,delete this._filter_order)},_filter_core:function(a,b,c){for(var d=webix.toArray(),e=this.$freeze||0,f=0;f<this.order.length;f++){var g=this.order[f];
(f<e||a(this.getItem(g),b))&&d.push(g)}c&&this._filter_order||(this._filter_order=this.order);this.order=d},find:function(a,b){var c=[],d;for(d in this.pull){var e=this.pull[d],f=!0;if("object"==typeof a)for(var g in a){if(e[g]!=a[g]){f=!1;break}}else a(e)||(f=!1);f&&c.push(e);if(b&&c.length)return c[0]}return c},filter:function(a,b,c){if((a||this._filter_order||this._filter_branch)&&this.callEvent("onBeforeFilter",[a,b])&&(this._filter_reset(c),this.order.length)){if(a){var d=a;b=b||"";"string"==
typeof a&&(a=a.replace(/#/g,""),"function"==typeof b?d=function(c){return b(c[a])}:(b=b.toString().toLowerCase(),d=function(b,c){webix.assert(b,"Client side filtering can't be used with dynamic loading");return-1!=(b[a]||"").toString().toLowerCase().indexOf(c)}));this._filter_core(d,b,c,this._filterMode)}this.refresh();this.callEvent("onAfterFilter",[])}},_obj_array:function(){for(var a=[],b=this.order.length-1;0<=b;b--)a[b]=this.pull[this.order[b]];return a},each:function(a,b,c){var d=this.order;
c&&(d=this._filter_order||d);for(c=0;c<d.length;c++)d[c]&&a.call(b||this,this.getItem(d[c]),c)},_methodPush:function(a,b){return function(){return a[b].apply(a,arguments)}},provideApi:function(a,b){this.debug_bind_master=a;b&&this.mapEvent({onbeforesort:a,onaftersort:a,onbeforeadd:a,onafteradd:a,onbeforedelete:a,onafterdelete:a,ondataupdate:a});b="sort add remove exists getIdByIndex getIndexById getItem updateItem refresh count filter find getNextId getPrevId clearAll getFirstId getLastId serialize sync".split(" ");
for(var c=0;c<b.length;c++)a[b[c]]=this._methodPush(this,b[c])},addMark:function(a,b,c,d,e){var f=this._marks[a]||{};this._marks[a]=f;f[b]||(f[b]=d||!0,c&&(f.$css=(f.$css||"")+" "+b),e||this.refresh(a));return f[b]},removeMark:function(a,b,c,d){var e=this._marks[a];e&&(e[b]&&delete e[b],c&&(c=e.$css)&&(e.$css=c.replace(b,"").replace("  "," ")),d||this.refresh(a))},getMark:function(a,b){return(a=this._marks[a])?a[b]:!1},clearMark:function(a,b,c){for(var d in this._marks){var e=this._marks[d];e[a]&&
(delete e[a],b&&e.$css&&(e.$css=e.$css.replace(a,"").replace("  "," ")),c||this.refresh(d))}},serialize:function(a){var b=this.order;a&&this._filter_order&&(b=this._filter_order);a=[];for(var c=0;c<b.length;c++){var d=this.pull[b[c]];if(this._scheme_serialize&&(d=this._scheme_serialize(d),!1===d))continue;a.push(d)}return a},sorting:{create:function(a){return this._dir(a.dir,this._by(a.by,a.as))},as:{server:function(){return!1},date:function(a,b){a-=0;b-=0;return a>b?1:a<b?-1:0},"int":function(a,
b){a*=1;b*=1;return a>b?1:a<b?-1:0},string_strict:function(a,b){a=a.toString();b=b.toString();return a>b?1:a<b?-1:0},string:function(a,b){if(!b)return 1;if(!a)return-1;a=a.toString().toLowerCase();b=b.toString().toLowerCase();return a>b?1:a<b?-1:0},raw:function(a,b){return a>b?1:a<b?-1:0}},_by:function(a,b){if(!a)return b;"function"!=typeof b&&(b=this.as[b||"string"]);webix.assert(b,"Invalid sorting method");return function(c,d){return b(c[a],d[a])}},_dir:function(a,b){return"asc"!=a&&a?function(a,
d){return-1*b(a,d)}:b}}};
webix.DataCollection=webix.proto({name:"DataCollection",isVisible:function(){return this.data.order.length||this.data._filter_order||this._settings.dataFeed?!0:!1},$init:function(a){this.data.provideApi(this,!0);a=a&&a.id?a.id:webix.uid();this._settings.id=a;webix.ui.views[a]=this;this.data.attachEvent("onStoreLoad",webix.bind(function(){this.callEvent("onBindRequest",[])},this))},refresh:function(){this.callEvent("onBindRequest",[])}},webix.DataMove,webix.CollectionBind,webix.BindSource,webix.ValidateCollection,
webix.DataLoader,webix.MapCollection,webix.EventSystem,webix.BaseBind,webix.Destruction,webix.Settings);
webix.Scrollable={$init:function(a){if(a&&!a.scroll&&this._one_time_scroll)return this._dataobj=this._dataobj||this._contentobj;(this._dataobj||this._contentobj).appendChild(webix.html.create("DIV",{"class":"webix_scroll_cont"},""));this._dataobj=(this._dataobj||this._contentobj).firstChild;webix.env.touch&&"native"!==webix.env.touch||webix._event(this._viewobj,"scroll",webix.bind(function(a){this.callEvent&&webix.delay(function(){this.callEvent("onAfterScroll",[])},this)},this))},scroll_setter:function(a){if(!a)return!1;
var b="x"==a?"x":"xy"==a?"xy":"a"==a?"xy":"y";if(webix.Touch&&webix.Touch.$active&&"native"!=webix.env.touch)this._dataobj.setAttribute("touch_scroll",b),this.attachEvent&&this.attachEvent("onAfterRender",webix.bind(this._refresh_scroll,this)),this._touch_scroll=!0;else if(webix.env.$customScroll)webix.CustomScroll.enable(this,b);else{var c=this._dataobj.parentNode.style;-1!=a.toString().indexOf("a")?c.overflowX=c.overflowY="auto":(-1!=b.indexOf("x")&&(this._scroll_x=!0,c.overflowX="scroll"),-1!=
b.indexOf("y")&&(this._scroll_y=!0,c.overflowY="scroll"))}return b},_onoff_scroll:function(a){if(!!this._settings.scroll!=!!a){if(!webix.env.$customScroll){var b=this._dataobj.parentNode.style;b.overflowX=b.overflowY=a?"auto":"hidden"}this._scroll_x=this._scroll_y=!!a;this._settings.scroll=!!a}},getScrollState:function(){if(webix.Touch&&webix.Touch.$active){var a=webix.Touch._get_matrix(this._dataobj);return{x:-a.e,y:-a.f}}return{x:this._dataobj.parentNode.scrollLeft,y:this._dataobj.parentNode.scrollTop}},
scrollTo:function(a,b){webix.Touch&&webix.Touch.$active&&"native"!=webix.env.touch?(b=Math.max(0,Math.min(b,this._dataobj.offsetHeight-this._content_height)),a=Math.max(0,Math.min(a,this._dataobj.offsetWidth-this._content_width)),webix.Touch._set_matrix(this._dataobj,-a,-b,this._settings.scrollSpeed||"100ms")):(this._dataobj.parentNode.scrollLeft=a,this._dataobj.parentNode.scrollTop=b)},_refresh_scroll:function(){if(-1!=this._settings.scroll.toString().indexOf("x")){var a=this._dataobj.scrollWidth;
a&&(this._dataobj.style.width="100%",this._dataobj.style.width=this._dataobj.scrollWidth+"px")}if(webix.Touch&&webix.Touch.$active&&this._touch_scroll){webix.Touch._clear_artefacts();webix.Touch._scroll_end();var b=this.getScrollState();a=this._dataobj.offsetWidth-this.$width-b.x;var c=this._dataobj.offsetHeight-this.$height-b.y;if(0>a||0>c)a=0>a?Math.min(-a-b.x,0):-b.x,webix.Touch._set_matrix(this._dataobj,a,0>c?Math.min(-c-b.y,0):-b.y,0)}}};
webix.protoUI({defaults:{size:10,page:0,group:5,template:"{common.pages()}",maxWidth:1E5,height:30,borderless:!0},name:"pager",on_click:{webix_pager_item:function(a,b){this.select(b)}},$init:function(a){this.data=this._settings;this._dataobj=this._viewobj;this._viewobj.className+=" webix_pager"+(a.autowidth?" webix_pager_auto":"");!1!==a.master&&0!==a.master||this.$ready.push(this._remove_master)},_remove_master:function(){this.refresh();this.$master={refresh:function(){},select:function(){}}},select:function(a){if(this.$master&&
"pager"==this.$master.name)return this.$master.select(a);switch(a){case "next":a=this._settings.page+1;break;case "prev":a=this._settings.page-1;break;case "first":a=0;break;case "last":a=this._settings.limit-1}0>a&&(a=0);a>=this.data.limit&&(a=this.data.limit-1);var b=this.data.page;this.callEvent("onBeforePageChange",[a,b])&&(this.data.page=1*a,this.refresh()&&(this._settings.animate&&this._animate(b,1*a,this._settings.animate)||this.$master.refresh()),this.callEvent("onAfterPageChange",[a]))},
_id:"webix_p_id",template_setter:webix.template,type:{template:function(a,b){return a.template.call(this,a,b)},pages:function(a){var b="";if(-1==a.page)return"";a.$min=a.page-Math.round((a.group-1)/2);a.$max=a.$min+1*a.group-1;0>a.$min&&(a.$max+=-1*a.$min,a.$min=0);a.$max>=a.limit&&(a.$min-=Math.min(a.$min,a.$max-a.limit+1),a.$max=a.limit-1);for(var c=a.$min||0;c<=a.$max;c++)b+=this.button({id:c,index:c+1,selected:c==a.page?"_selected":"",label:webix.i18n.aria.page+" "+(c+1)});return b},page:function(a){return a.page+
1},first:function(){return this.button({id:"first",index:webix.locale.pager.first,selected:"",label:webix.i18n.aria.pages[0]})},last:function(){return this.button({id:"last",index:webix.locale.pager.last,selected:"",label:webix.i18n.aria.pages[3]})},prev:function(){return this.button({id:"prev",index:webix.locale.pager.prev,selected:"",label:webix.i18n.aria.pages[1]})},next:function(){return this.button({id:"next",index:webix.locale.pager.next,selected:"",label:webix.i18n.aria.pages[2]})},button:webix.template("<button type='button' webix_p_id='{obj.id}' class='webix_pager_item{obj.selected}' aria-label='{obj.label}'>{obj.index}</button>")},
clone:function(a){a.$view||(a.view="pager",a=webix.ui(a));this._clone=a;a.$master=this;this._refresh_clone()},refresh:function(){var a=this._settings;if(a.count){a.limit=Math.ceil(a.count/a.size);var b=Math.min(a.limit-1,a.page);if(b!=a.page)return this.$master.setPage(b);a.page=b;if(0<=b&&b!=a.old_page||a.limit!=a.old_limit||a.old_count!=a.count)return this.render(),this._refresh_clone(),a.old_limit=a.limit,a.old_page=a.page,a.old_count=a.count,!0}},apiOnly_setter:function(a){return this.$apiOnly=
a},_refresh_clone:function(){this._clone&&(this._clone._settings.count=this._settings.count,this._clone._settings.page=this._settings.page,this._clone.refresh())},_animate:function(a,b,c){if(a==b)return!1;if(this._pgInAnimation)return this._pgAnimateTimeout&&window.clearTimeout(this._pgAnimateTimeout),this._pgAnimateTimeout=webix.delay(this._animate,this,[a,b,c],100);var d=b>a?"left":"right";if("top"==c.direction||"bottom"==c.direction)d=b>a?"top":"bottom";c.flip&&(d="");a=0;b=this.$master._dataobj;
var e=!!this.$master._body;e&&(b=this.$master._body,a=b.offsetTop,webix.html.addCss(this.$master.$view,"webix_animation"));var f=b.cloneNode(!0);f.style.width=b.style.width="100%";this.$master.refresh();webix.html.insertBefore(f,b.nextSibling,b.parentNode);e&&(f.childNodes[1].scrollLeft=b.childNodes[1].scrollLeft);c=!0!==c?c:{};var g=webix.extend({direction:d,callback:webix.bind(function(){g.callback=null;webix.animate.breakLine(h);this._pgInAnimation=!1;this.$master._body&&webix.html.removeCss(this.$master.$view,
"webix_animation")},this),top:a,keepViews:e},c);var h=webix.animate.formLine(b,f,g);webix.animate([b,f],g);this._pgInAnimation=!0}},webix.MouseEvents,webix.SingleRender,webix.ui.view,webix.EventSystem);webix.locale.pager={first:" &lt;&lt; ",last:" &gt;&gt; ",next:" &gt; ",prev:" &lt; "};
webix.PagingAbility={pager_setter:function(a){function b(c){if(a.config.autosize&&this.getVisibleCount){var d=this.getVisibleCount();isNaN(d)?(a.config.size=1,webix.delay(b,this,[!0])):d!=a.config.size&&(a.config.size=d,a.refresh(),!0===c&&this.refresh())}c=this._settings.pager;if(-1==c.page)return!1;this.data.$min=this._count_pager_index(0,c.page*c.size);this.data.$max=this._count_pager_index(this.data.$min,c.size);this.data.$pagesize=this.data.$max-this.data.$min;return!0}if("string"==typeof a){var c=
webix.$$(a);if(!c)return this.$blockRender=!0,webix.delay(function(){var b=webix.$$(a);this._settings.pager=this.pager_setter(b);var c=b._settings;c.count=this.data._count_pager_total(c.level);b.refresh();this.$blockRender=!1;this.render()},this),null;a=c}this.attachEvent("onBeforeRender",b);a.$view||(a.view="pager",a=webix.ui(a));this._pager=a;a.$master=this;this.data.attachEvent("onStoreUpdated",function(){var b=a._settings;b.count=this._count_pager_total(b.level);a.refresh()});this.data._count_pager_total=
this._count_pager_total;return a._settings},_count_pager_total:function(a){if(a&&0!==a){var b=0;this.each(function(c){c.$level==a&&b++});return b}return this.count()},_count_pager_index:function(a,b){var c=this._settings.pager;if(c.level&&0!==c.level){var d=this.data.order.length;if(b)for(;a<d;){if(this.data.getItem(this.data.order[a]).$level==c.level)if(0===b)break;else b--;a++}return a}return a+b},setPage:function(a){this._pager&&this._pager.select(a)},getPage:function(){return this._pager._settings.page},
getPager:function(){return this._pager}};
webix.protoUI({name:"tooltip",defaults:{dy:0,dx:20},$init:function(a){"string"==typeof a&&(a={template:a});this.type=webix.extend({},this.type);this.$view=this._viewobj=this._contentobj=this._dataobj=webix.html.create("DIV",{role:"alert","aria-atomic":"true"});this._contentobj.className="webix_tooltip";webix.html.insertBefore(this._contentobj,document.body.firstChild,document.body);this._hideHandler=webix.attachEvent("onClick",webix.bind(function(a){this._visible&&webix.$$(a)!=this&&this.hide()},
this));this.attachEvent("onDestruct",function(){webix.detachEvent(this._hideHandler)})},adjust:function(){},isVisible:function(){return!0},show:function(a,b){if(!this._disabled){this.data!=a&&(this.data=webix.extend({},a),this.render(a));if(this._dataobj.firstChild){a=Math.max(document.documentElement.clientWidth,window.innerWidth||0)-b.x;var c=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-b.y;this._contentobj.style.display="block";a-this._settings.dx>this._contentobj.offsetWidth?
a=b.x:(a=b.x-2*this._settings.dx-this._contentobj.offsetWidth,0>=a&&(a=0));c=c-this._settings.dy>this._contentobj.offsetHeight?b.y:b.y-this._settings.dy-this._contentobj.offsetHeight;this._contentobj.style.left=a+this._settings.dx+"px";this._contentobj.style.top=c+this._settings.dy+"px"}this._visible=!0}},hide:function(){this.data=null;this._contentobj.style.display="none";this._visible=!1},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},type:{template:webix.template("{obj.id}"),
templateStart:webix.template.empty,templateEnd:webix.template.empty}},webix.SingleRender,webix.Settings,webix.EventSystem,webix.ui.view);
webix.AutoTooltip={tooltip_setter:function(a){if(a){"function"==typeof a&&(a={template:a});var b=!a.template,c=new webix.ui.tooltip(a);this._enable_mouse_move();var d=this.attachEvent("onMouseMove",function(a,d){this._mouseEventX=d.clientX;this._mouseEventY=d.clientY;if(this.getColumnConfig){var e=c.type.column=this.getColumnConfig(a.column);if(b){if(!e.tooltip&&e.tooltip!=webix.undefined)return;var f=d.target||d.srcElements;if(f.getAttribute("webix_area")&&e.tooltip){var g=f.getAttribute("webix_area");
c.type.template=function(a,b){var c=a[b.column.id];return webix.template(e.tooltip).call(this,a,b,c[g],g)}}else if(e.tooltip)c.type.template=e.tooltip=webix.template(e.tooltip);else{var m=this.getText(a.row,a.column);c.type.template=function(){return m}}}}webix.DragControl.active||c.show(this.getItem(a.row||a),webix.html.pos(d))}),e=webix.event(document.body,"mousemove",webix.bind(function(a){a=a||event;this._mouseEventX==a.clientX&&this._mouseEventY==a.clientY||c.hide()},this));this.attachEvent("onDestruct",
function(){this.config.tooltip&&this.config.tooltip.destructor()});this.attachEvent("onAfterScroll",function(){c.hide()});c.attachEvent("onDestruct",webix.bind(function(){this.detachEvent(d);webix.eventRemove(e)},this));return c}}};
webix.protoUI({name:"proto",$init:function(){this.data.provideApi(this,!0);this._dataobj=this._dataobj||this._contentobj;this.data.attachEvent("onStoreUpdated",webix.bind(function(){this.render.apply(this,arguments)},this))},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments)&&this.render()},_id:"webix_item",on_mouse_move:{},type:{}},webix.PagingAbility,webix.DataMarks,webix.AutoTooltip,webix.ValidateCollection,webix.RenderStack,webix.DataLoader,webix.ui.view,webix.EventSystem,
webix.Settings);webix.CodeParser={collapseNames:function(a,b,c){c=c||{};b=b||"";if(!a||"object"!=typeof a)return null;for(var d in a)!a[d]||"object"!=typeof a[d]||webix.isDate(a[d])||webix.isArray(a[d])?c[b+d]=a[d]:webix.CodeParser.collapseNames(a[d],b+d+".",c);return c},expandNames:function(a){var b={},c,d;for(d in a){var e=d.split(".");var f=e.length-1;var g=b;for(c=0;c<f;c++)g[e[c]]||(g[e[c]]={}),g=g[e[c]];g[e[f]]=a[d]}return b}};
webix.Values={$init:function(){this.elements={}},focus:function(a){if(a)webix.assert(this.elements[a],"unknown input name: "+a),this._focus(this.elements[a]);else for(var b in this.elements)if(this._focus(this.elements[b]))return!0},_focus:function(a){if(a&&a.focus)return a.focus(),!0},setValues:function(a,b){this._settings.complexData&&(a=webix.CodeParser.collapseNames(a));this._inner_setValues(a,b)},_inner_setValues:function(a,b){this._is_form_dirty=b;this.blockEvent();b&&this._values||(this._values=
{});webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id);for(var c in a)this.elements[c]||(this._values[c]=a[c]);for(c in this.elements){var d=this.elements[c];d&&(webix.isUndefined(a[c])?!b&&d._allowsClear&&d.setValue(""):d.setValue(a[c]),this._values[c]=d.getValue())}this.unblockEvent();this.callEvent("onValues",[])},isDirty:function(){return this._is_form_dirty||1===this.getDirtyValues(1)?!0:!1},setDirty:function(a){this._is_form_dirty=a;a||(this._values=this._inner_getValues())},
getDirtyValues:function(a){var b={};if(this._values)for(var c in this.elements){var d=this.elements[c].getValue();if(this._values[c]!=d&&(b[c]=d,a))return 1}return b},getCleanValues:function(){return this._values},getValues:function(a){a=this._inner_getValues(a);this._settings.complexData&&(a=webix.CodeParser.expandNames(a));return a},_inner_getValues:function(a){var b=this._values?webix.copy(this._values):{},c;for(c in this.elements){var d=this.elements[c];var e=!0;a&&("object"==typeof a?(!1===a.hidden&&
(e=d.isVisible()),e&&!1===a.disabled&&(e=d.isEnabled())):e=a.call(this,d));e?b[c]=d.getValue():delete b[c]}return b},clear:function(){this._is_form_dirty=!1;var a={},b;for(b in this.elements)this.elements[b]._allowsClear&&(a[b]=this.elements[b]._settings.defaultValue||"");this._inner_setValues(a)},markInvalid:function(a,b){if(!1===b)this._clear_invalid(a);else{if("string"==typeof b){var c=this.elements[a];c&&(c._settings.invalidMessage=b)}this._mark_invalid(a)}},_mark_invalid:function(a){var b=this.elements[a];
a&&b&&(this._clear_invalid(a,!0),webix.html.addCss(b._viewobj,"webix_invalid"),b._settings.invalid=!0,"string"===typeof b._settings.invalidMessage&&b.setBottomText&&b.setBottomText())},_clear_invalid:function(a,b){var c=this.elements[a];a&&c&&c.$view&&c._settings.invalid&&(webix.html.removeCss(c._viewobj,"webix_invalid"),c._settings.invalid=!1,"string"===typeof c._settings.invalidMessage&&!b&&c.setBottomText&&c.setBottomText())}};
webix.protoUI({name:"toolbar",defaults:{type:"toolbar"},_render_borders:!0,_form_classname:"webix_toolbar",_form_vertical:!1,$init:function(a){a.borderless||(this._contentobj.style.borderWidth="1px");this._contentobj.className+=" "+this._form_classname;this._viewobj.setAttribute("role","toolbar")},_recollect_elements:function(){var a=this;a.elements={};webix.ui.each(this,function(b){b._settings.name&&b.getValue&&b.setValue&&(a.elements[b._settings.name]=b,b.mapEvent&&b.mapEvent({onbeforetabclick:a,
onaftertabclick:a,onitemclick:a,onchange:a}));if(b.setValues)return!1});var b=this._values;this.setDirty(!1);if(b){var c=this._values,d;for(d in a.elements)b[d]&&c[d]!=b[d]&&(c[d]=b[d],this.setDirty(!0))}},_parse_cells_ext_end:function(){this._recollect_elements()},_parse_cells_ext:function(a){var b=this._settings;b.elements&&!a&&(this._collection=a=b.elements,this._vertical_orientation=this._form_vertical,delete b.elements);this._settings.elementsConfig&&this._rec_apply_settings(this._collection,
b.elementsConfig);return a},_rec_apply_settings:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];webix.extend(d,b);var e=b;d.elementsConfig&&(e=webix.extend(webix.extend({},d.elementsConfig),b));(d=d.body?[d.body]:d.rows||d.cols||d.cells||d.body)&&this._rec_apply_settings(d,e)}},$getSize:function(a,b){a=webix.ui.layout.prototype.$getSize.call(this,a,b);b=this.getParentView();var c=this._vertical_orientation?3:1;b&&this._vertical_orientation!=b._vertical_orientation&&(a[c]+=1E5);webix.debug_size_box(this,
a,!0);return a},render:function(){},refresh:function(){this.render()}},webix.Scrollable,webix.AtomDataLoader,webix.Values,webix.ui.layout,webix.ValidateData);
webix.protoUI({name:"template",$init:function(a){var b=this._template_types[a.type];b&&(webix.extend(a,b),a.borderless&&(delete a._inner,this._set_inner(a)));this._dataobj==this._viewobj?(this._dataobj=webix.html.create("DIV"),this._dataobj.className=" webix_template",this._viewobj.appendChild(this._dataobj)):this._dataobj.className+=" webix_template";this.attachEvent("onAfterRender",this._correct_width_scroll)},setValues:function(a,b){this.data=b?webix.extend(this.data,a,!0):a;this.render()},getValues:function(){return this.data},
$skin:function(){this._template_types.header.height=this._template_types.section.height=webix.skin.$active.barHeight},_template_types:{header:{css:"webix_header"},section:{css:"webix_section",borderless:!0},clean:{css:"webix_clean",borderless:!0}},onClick_setter:function(a){this.on_click=webix.extend(this.on_click||{},a,!0);this._onClick||webix.extend(this,webix.MouseEvents);return a},defaults:{template:webix.template.empty},_render_me:function(){this._not_render_me=!1;this._probably_render_me();
this.resize()},_probably_render_me:function(){this._not_render_me||(this._not_render_me=!0,this.render())},src_setter:function(a){this._not_render_me=!0;if(!this.callEvent("onBeforeLoad",[]))return"";webix.ajax(a,webix.bind(function(a){this._settings.template=webix.template(a);this._render_me();this.callEvent("onAfterLoad",[])},this));return a},_correct_width_scroll:function(){this._settings.autoheight&&(this._last_size=null,this.resize());this._settings.scroll&&-1!=this._settings.scroll.indexOf("x")&&
(this._dataobj.style.width=this._dataobj.scrollWidth+"px")},content_setter:function(a){a&&(this._not_render_me=!0,this.render=function(){},this._dataobj.appendChild(webix.toNode(a)))},refresh:function(){this.render()},setHTML:function(a){this._settings.template=function(){return a};this.refresh()},setContent:function(a){this._dataobj.innerHTML="";this.content_setter(a)},$setSize:function(a,b){if(webix.ui.view.prototype.$setSize.call(this,a,b))return this._probably_render_me(),this._settings.autoheight&&
(a=this.getTopParentView(),clearTimeout(a._template_resize_timer),a._template_resize_timer=webix.delay(this.resize,this)),!0},$getSize:function(a,b){this._settings.autoheight&&!this._settings.type&&(this._settings.height=this._get_auto_height());return webix.ui.view.prototype.$getSize.call(this,a,b)},_get_auto_height:function(){var a=webix.skin.$active.layoutPadding.space;this._probably_render_me();this.isVisible()?(this._dataobj.style.height="auto",a=this._dataobj.scrollHeight,this._dataobj.style.height=
""):a=webix.html.getTextSize(this._toHTML(this.data)||this._dataobj.innerHTML,"webix_template",(this.$width||(this.getParentView()?this.getParentView().$width:0))-a).height;return a},_one_time_scroll:!0},webix.Scrollable,webix.AtomDataLoader,webix.AtomRender,webix.EventSystem,webix.ui.view);
webix.protoUI({name:"iframe",$init:function(a){this._dataobj=this._contentobj;this._contentobj.innerHTML="<iframe style='width:100%; height:100%' frameborder='0' onload='var t = $$(this.parentNode.getAttribute(\"view_id\")); if (t) t.callEvent(\"onAfterLoad\",[]);' src='about:blank'></iframe>"},load:function(a){this.src_setter(a)},src_setter:function(a){return this.callEvent("onBeforeLoad",[])?this.getIframe().src=a:""},getIframe:function(){return this._contentobj.getElementsByTagName("iframe")[0]},
getWindow:function(){return this.getIframe().contentWindow}},webix.ui.view,webix.EventSystem);webix.OverlayBox={showOverlay:function(a){this._overlay?this._overlay.innerHTML=a:(this._overlay=webix.html.create("DIV",{"class":"webix_overlay"},a||""),webix.html.insertBefore(this._overlay,this._viewobj.firstChild,this._viewobj),this._viewobj.style.position="relative")},hideOverlay:function(){this._overlay&&(webix.html.remove(this._overlay),this._overlay=null)}};
webix.protoUI({name:"scrollview",defaults:{scroll:"y",scrollSpeed:"0ms"},$init:function(){this._viewobj.className+=" webix_scrollview"},body_setter:function(a){a.borderless=!0;this._body_cell=webix.ui._view(a);this._body_cell._parent_cell=this;this._dataobj.appendChild(this._body_cell._viewobj)},getChildViews:function(){return[this._body_cell]},getBody:function(){return this._body_cell},resizeChildren:function(){this._desired_size=this._body_cell.$getSize(0,0);this._resizeChildren();webix.callEvent("onResize",
[])},_resizeChildren:function(){this._body_cell.$setSize(Math.max(this._content_width,this._desired_size[0]),Math.max(this._content_height,this._desired_size[2]));this._dataobj.style.width=this._body_cell._content_width+"px";this._dataobj.style.height=this._body_cell._content_height+"px";if(webix.env.touch){var a=this.getScrollState(),b=this._body_cell._content_height-this._content_height;b<a.y&&this.scrollTo(null,b)}webix._responsive_exception&&(webix._responsive_exception=!1,this._desired_size=
this._body_cell.$getSize(0,0),this._resizeChildren())},$getSize:function(a,b){var c=this._desired_size=this._body_cell.$getSize(0,0);a=webix.ui.view.prototype.$getSize.call(this,a,b);b=this._native_scroll||webix.ui.scrollSize;"x"==this._settings.scroll?(a[2]=Math.max(a[2],c[2])+b,a[3]=Math.min(a[3],c[3])+b):"y"==this._settings.scroll&&(a[0]=Math.max(a[0],c[0])+b,a[1]=Math.min(a[1],c[1])+b);return a},$setSize:function(a,b){var c=webix.ui.scrollSize;webix.ui.scrollSize=this._native_scroll||c;(webix.ui.view.prototype.$setSize.call(this,
a,b)||webix.ui._force_resize)&&this._resizeChildren();webix.ui.scrollSize=c},scroll_setter:function(a){var b=webix.env.$customScroll;"string"==typeof a&&0===a.indexOf("native-")&&(this._native_scroll=17,a=a.replace("native-"),webix.env.$customScroll=!1);a=webix.Scrollable.scroll_setter.call(this,a);webix.env.$customScroll=b;return a},_replace:function(a){this._body_cell.destructor();this._body_cell=a;this._body_cell._parent_cell=this;this._bodyobj.appendChild(this._body_cell._viewobj);this.resize()},
showView:function(a){a=webix.$$(a).$view.offsetTop-webix.$$(a).$view.parentNode.offsetTop;this.scrollTo(0,a)}},webix.Scrollable,webix.EventSystem,webix.ui.view);
webix.TreeRenderStack={$init:function(){webix.assert(this.render,"TreeRenderStack :: Object must use RenderStack first")},_toHTMLItem:function(a){var b=this.data._marks[a.id];this.callEvent("onItemRender",[a]);return this.type.templateStart(a,this.type,b)+(a.$template?this.type["template"+a.$template](a,this.type,b):this.type.template(a,this.type,b))+this.type.templateEnd()},_toHTMLItemObject:function(a){this._html.innerHTML=this._toHTMLItem(a);return this._html.firstChild},_toHTML:function(a){webix.assert(!a.$template||
this.type["template"+a.$template],"RenderStack :: Unknown template: "+a.$template);var b="<div role='presentation' class='webix_tree_branch_"+a.$level+"'>"+this._toHTMLItem(a);a.open&&(b+=this._toHTMLLevel(a.id));return b+"</div>"},_toHTMLLevel:function(a){var b="";if(a=this.data.branch[a]){b+="<div role='presentation' class='webix_tree_leaves'>";for(var c=a.length-1,d=0;d<=c;d++){var e=this.getItem(a[d]);this.type._tree_branch_render_state[e.$level]=d==c;b+=this._toHTML(e)}b+="</div>"}return b},
render:function(a,b,c){webix.TreeRenderStack._obj=this;if(this.isVisible(this._settings.id)&&!this.$blockRender){webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id);if(a){var d=this.getItem(a);if("add"!=c){var e=this.getItemNode(a);if(!e)return}switch(c){case "branch":var f=e.parentNode;d=this._toHTMLObject(d);webix.html.insertBefore(d,f);webix.html.remove(f);this._htmlmap=null;break;case "paint":case "update":d=this._htmlmap[a]=this._toHTMLItemObject(d);webix.html.insertBefore(d,
e);webix.html.remove(e);break;case "delete":webix.html.remove(e.parentNode);break;case "add":0==d.$parent?f=this._dataobj.firstChild:this.getItem(d.$parent).open&&(f=this.getItemNode(d.$parent))&&(f.nextSibling||(e=webix.html.create("DIV",{"class":"webix_tree_leaves"},""),f.parentNode.appendChild(e)),f=f.nextSibling);if(f){e=this.data.getNextSiblingId(a);if(e=this.getItemNode(e))e=e.parentNode;d=this._toHTMLObject(d);this._htmlmap[a]=d.firstChild;webix.html.insertBefore(d,e,f)}break;default:return!1}this.callEvent("onPartialRender",
[a,b,c])}else this.callEvent("onBeforeRender",[this.data])&&(this.type._tree_branch_render_state=[],this._dataobj.innerHTML=this._toHTMLLevel(0),this._htmlmap=null,this.callEvent("onAfterRender",[]));this.type._tree_branch_render_state=0;webix.TreeRenderStack._obj=null;return!0}},getItemNode:function(a){if(this._htmlmap)return this._htmlmap[a];this._htmlmap={};for(var b=this._dataobj.getElementsByTagName("DIV"),c=0;c<b.length;c++){var d=b[c].getAttribute(this._id);d&&(this._htmlmap[d]=b[c])}return this.getItemNode(a)},
_branch_render_supported:1};
webix.SelectionModel={$init:function(){this._selected=webix.toArray();webix.assert(this.data,"SelectionModel :: Component doesn't have DataStore");this.data.attachEvent("onStoreUpdated",webix.bind(this._data_updated,this));this.data.attachEvent("onStoreLoad",webix.bind(this._data_loaded,this));this.data.attachEvent("onAfterFilter",webix.bind(this._data_filtered,this));this.data.attachEvent("onSyncApply",webix.bind(this._select_check,this));this.data.attachEvent("onIdChange",webix.bind(this._id_changed,
this));this.$ready.push(this._set_noselect)},_set_noselect:function(){("multiselect"==this._settings.select||this._settings.multiselect)&&webix._event(this.$view,"mousedown",function(a){(a||event).shiftKey&&(webix._noselect_element=this,webix.html.addCss(this,"webix_noselect",1))})},_id_changed:function(a,b){for(var c=this._selected.length-1;0<=c;c--)this._selected[c]==a&&(this._selected[c]=b)},_data_filtered:function(){for(var a=this._selected.length-1;0<=a;a--)if(0>this.data.getIndexById(this._selected[a])){var b=
this._selected[a];this.removeCss(b,"webix_selected",!0);this._selected.splice(a,1);this.callEvent("onSelectChange",[b])}},_data_updated:function(a,b,c){"delete"==c?this.loadBranch?this._select_check():this._selected.remove(a):a||this.data.count()||this.data._filter_order||(this._selected=webix.toArray())},_data_loaded:function(){this._settings.select&&this.data.each(function(a){a&&a.$selected&&this.select(a.id)},this)},_select_check:function(){for(var a=this._selected.length-1;0<=a;a--)this.exists(this._selected[a])||
this._selected.splice(a,1)},_select_mark:function(a,b,c,d){if(!this.callEvent(b?"onBeforeSelect":"onBeforeUnSelect",[a,b]))return!1;d&&(this._silent_selection=!0,this.unselectAll(),this._silent_selection=!1);b?this.addCss(a,"webix_selected",!0):this.removeCss(a,"webix_selected",!0);c?c.push(a):(b?this._selected.push(a):this._selected.remove(a),this._refresh_selection(a));this.callEvent(b?"onAfterSelect":"onAfterUnSelect",[a]);return!0},select:function(a,b,c,d){if(!a)return this.selectAll();if(webix.isArray(a))for(var e=
0;e<a.length;e++)this.select(a[e],e?1:b,c,d);else{webix.assert(this.data.exists(a),"Incorrect id in select command: "+a);if(d&&this._selected.length)return this.selectAll(this._selected[this._selected.length-1],a);d=!1;c||b||1==this._selected.length&&this._selected[0]==a||(d=!0);!d&&this.isSelected(a)?c&&this.unselect(a):this._select_mark(a,!0,null,d)}},unselect:function(a){if(!a)return this.unselectAll();this.isSelected(a)&&this._select_mark(a,!1)},selectAll:function(a,b){var c=[];(a||b?this.data.getRange(a||
null,b||null):this.data.getRange()).each(function(a){this.data.getMark(a.id,"webix_selected")||(this._selected.push(a.id),this._select_mark(a.id,!0,c))},this);this._refresh_selection(c)},unselectAll:function(){var a=[];this._selected.each(function(b){this._select_mark(b,!1,a)},this);this._selected=webix.toArray();this._refresh_selection(a)},isSelected:function(a){return-1!=this._selected.find(a)},getSelectedId:function(a){switch(this._selected.length){case 0:return a?[]:"";case 1:return a?[this._selected[0]]:
this._selected[0];default:return[].concat(this._selected)}},getSelectedItem:function(a){var b=this.getSelectedId(!0);if(1<b.length||a){for(a=b.length-1;0<=a;a--)b[a]=this.getItem(b[a]);return b}if(b.length)return this.getItem(b[0])},_is_mass_selection:function(a){return 100<a.length||a.length>this.data.count/2},_refresh_selection:function(a){"object"!=typeof a&&(a=[a]);if(a.length){if(this._is_mass_selection(a))this.data.refresh();else for(var b=0;b<a.length;b++)this.render(a[b],this.data.getItem(a[b]),
"update");this._silent_selection||this.callEvent("onSelectChange",[a])}}};webix.ready(function(){webix.event(document.body,"mouseup",function(a){webix._noselect_element&&(webix.html.removeCss(webix._noselect_element,"webix_noselect"),webix._noselect_element=null)})});
webix.TreeDataMove={$init:function(){webix.assert(this.data,"DataMove :: Component doesn't have DataStore")},copy:function(a,b,c,d){d=d||{};d.copy=!0;return this.move(a,b,c,d)},_next_move_index:function(a,b,c){if(b&&a)return a=this.getBranchIndex(a),a+(c==this&&c.getBranchIndex(b)<a?0:1)},_check_branch_child:function(a,b){if((a=this.data.branch[a])&&a.length)for(var c=0;c<a.length;c++)if(a[c]==b||this._check_branch_child(a[c],b))return!0;return!1},move:function(a,b,c,d){d=d||{};b=b||0;var e=d.newId||
a,f=d.parent||0;c=c||this;webix.assert(c.data,"moving attempt to component without datastore");if(c.data)if(webix.isArray(a))for(e=0;e<a.length;e++)b=this.move(a[e],b,c,d),b=c._next_move_index(b,a[e+1],this);else{if(this!=c||d.copy)e=c.data.add(c._externalData(this.getItem(a),e),b,f||0),this.data.branch[a]&&c.getBranchIndex&&(b=this.data._scheme_serialize,this.data._scheme_serialize=function(a){a=webix.copy(a);delete a.$parent;delete a.$level;delete a.$child;c.data.pull[a.id]&&(a.id=webix.uid());
return a},f={data:this.serialize(a,!0),parent:e},this.data._scheme_serialize=b,c.parse(f)),d.copy||this.data.remove(a);else{if(a==f||this._check_branch_child(a,f))return;d=this.getItem(a);var g=this.data.branch[f];g||(g=this.data.branch[f]=[]);var h=this.data.branch[d.$parent],k=webix.PowerArray.find.call(h,a);0>b&&(b=g.length);if(h===g&&b===k)return;webix.PowerArray.removeAt.call(h,k);webix.PowerArray.insertAt.call(g,a,Math.min(g.length,b));h.length||delete this.data.branch[d.$parent];d.$parent&&
"0"!=d.$parent&&this.getItem(d.$parent).$count--;f&&"0"!=f?(h=c.getItem(f),h.$count++,this._set_level_rec(d,h.$level+1)):this._set_level_rec(d,1);d.$parent=f;c.data.callEvent("onDataMove",[a,b,f,g[b+1]])}this.refresh();return e}},_set_level_rec:function(a,b){a.$level=b;if(a=this.data.branch[a.id])for(var c=0;c<a.length;c++)this._set_level_rec(this.getItem(a[c]),b+1)},_drag_pause:function(a){a&&!a.header&&this.open(a)},$dropAllow:function(a){if(a.from!=a.to)return!0;for(var b=0;b<a.source.length;b++)if(a.source==
a.target||this._check_branch_child(a.source,a.target))return!1;return!0},_externalData:function(a,b){a=webix.DataMove._externalData.call(this,a,b);delete a.open;return a}};
webix.TreeDataLoader={$init:function(){this.data.attachEvent("onStoreUpdated",webix.bind(this._sync_hierarchy,this),null,!0);this._feed_common=this._feed_commonA},_feed_commonA:function(a,b,c,d){var e=0===b?{parent:encodeURIComponent(a)}:null;webix.DataLoader.prototype._feed_common.call(this,a,b,c,d,e)},loadBranch:function(a,b,c){a=a||0;this.data.url=c||this.data.url;this.callEvent("onDataRequest",[a,b,this.data.url])&&this.data.url&&this.data.feed.call(this,a,0,b,c)},_sync_hierarchy:function(a,b,
c){c&&"add"!=c&&"delete"!=c&&"branch"!=c||this.data._sync_to_order(this)}};
webix.TreeStore={name:"TreeStore",$init:function(){this._filterMode={showSubItems:!0};this.branch={0:[]};this.attachEvent("onParse",function(a,b){this._set_child_scheme(a.child);a.getInfo(b)});this.attachEvent("onClearAll",webix.bind(function(){this._filter_branch=null},this))},filterMode_setter:function(a){return webix.extend(this._filterMode,a,!0)},_filter_reset:function(a){if(this._filter_branch&&!a){this.branch=this._filter_branch;this.order=webix.toArray(webix.copy(this.branch[0]));for(var b in this.branch)"0"!=
b&&(this.getItem(b).$count=this.branch[b].length);delete this._filter_branch}},_filter_core:function(a,b,c,d){c&&this._filter_branch||(this._filter_branch=this.branch,this.branch=webix.clone(this.branch));this.branch[0]=this._filter_branch_rec(a,b,this.branch[0],1,d||{})},_filter_branch_rec:function(a,b,c,d,e){for(var f=[],g=e.level&&e.level!=d,h=0;h<c.length;h++){var k=c[h],l=this.getItem(k),m=!1,n=this.branch[k];if(g)m=!0;else if(a(this.getItem(k),b)){f.push(k);if(!1!==e.openParents)for(var p=this.getParentId(k);p&&
"0"!=p;)this.getItem(p).open=1,p=this.getParentId(p);if(e.level||e.showSubItems)continue}else m=!0;!g&&e.level||!n||(n=this.branch[k]=this._filter_branch_rec(a,b,n,d+1,e),l.$count=n.length,m&&n.length&&f.push(k))}return f},count:function(){if(this.order.length)return this.order.length;var a=0;this.eachOpen(function(){a++});return a},_change_branch_id:function(a,b,c,d){if(a[c]){for(var e=a[d]=a[c],f=0;f<e.length;f++)this.getItem(e[f]).$parent=d;delete a[c]}a[b]&&(c=webix.PowerArray.find.call(a[b],
c),0<=c&&(a[b][c]=d))},changeId:function(a,b){if(a!=b){var c=this.getItem(a).$parent;this._change_branch_id(this.branch,c,a,b);this._filter_branch&&this._change_branch_id(this._filter_branch,c,a,b);return webix.DataStore.prototype.changeId.call(this,a,b)}},clearAll:function(a){this.branch={0:[]};webix.DataStore.prototype.clearAll.call(this,a)},getPrevSiblingId:function(a){var b=this.branch[this.getItem(a).$parent];a=webix.PowerArray.find.call(b,a)-1;return 0<=a?b[a]:null},getNextSiblingId:function(a){var b=
this.branch[this.getItem(a).$parent];a=webix.PowerArray.find.call(b,a)+1;return a<b.length?b[a]:null},getParentId:function(a){return this.getItem(a).$parent},getFirstChildId:function(a){return(a=this.branch[a])&&a.length?a[0]:null},isBranch:function(a){return!!this.branch[a]},getBranchIndex:function(a){return webix.PowerArray.find.call(this.branch[this.pull[a].$parent],a)},_set_child_scheme:function(a){this._datadriver_child="string"==typeof a?function(b){var c=b[a];c&&delete b[a];return c}:a},_inner_parse:function(a,
b){for(var c=a.parent||0,d=0;d<b.length;d++){var e=this.driver.getDetails(b[d]),f=this.id(e),g=!!this.pull[f];g?(e=webix.extend(this.pull[f],e,!0),this._scheme_update&&this._scheme_update(e)):(this._scheme_init&&this._scheme_init(e),this.pull[f]=e);this._extraParser(e,c,0,g,a.from?1*a.from+d:0)}b=this.pull[c]||{};c=this.branch[c]||[];b.$count=c.length;delete b.webix_kids;a.size&&a.size!=c.length&&(c[a.size-1]=webix.undefined)},_extraParser:function(a,b,c,d,e){a.$count=0;a.$parent="0"!=b?b:0;a.$level=
c||("0"!=b?this.pull[b].$level+1:1);(b=this.branch[a.$parent])||(b=this.branch[a.$parent]=[]);this._filter_branch&&(this._filter_branch[a.$parent]=b);d||(b[e||b.length]=a.id);e=this._datadriver_child(a);if(a.webix_kids)return a.$count=-1;if(!e)return a.$count=0;webix.isArray(e)||(e=[e]);for(b=0;b<e.length;b++){c=webix.DataDriver.json.getDetails(e[b]);var f=this.id(c);(d=!!this.pull[f])?(c=webix.extend(this.pull[f],c,!0),this._scheme_update&&this._scheme_update(c)):(this._scheme_init&&this._scheme_init(c),
this.pull[f]=c);this._extraParser(c,a.id,a.$level+1,d)}if(d=this.branch[a.id])a.$count=d.length},_sync_to_order:function(a){this.order=webix.toArray();this._sync_each_child(0,a)},_sync_each_child:function(a,b){a=this.branch[a];for(var c=0;c<a.length;c++){var d=a[c];this.order.push(d);var e=this.pull[d];e&&e.open&&(-1==e.$count?b.loadBranch(d):e.$count&&this._sync_each_child(d,b))}},provideApi:function(a,b){for(var c="getPrevSiblingId getNextSiblingId getParentId getFirstChildId isBranch getBranchIndex filterMode_setter".split(" "),
d=0;d<c.length;d++)a[c[d]]=this._methodPush(this,c[d]);a.getIndexById||webix.DataStore.prototype.provideApi.call(this,a,b)},getTopRange:function(){return webix.toArray([].concat(this.branch[0])).map(function(a){return this.getItem(a)},this)},eachChild:function(a,b,c,d){var e=this.branch;d&&this._filter_branch&&(e=this._filter_branch);if(a=e[a])for(d=0;d<a.length;d++)a[d]&&b.call(c||this,this.getItem(a[d]))},each:function(a,b,c,d){this.eachChild(d||0,function(d){var e=this.branch;a.call(b||this,d);
c&&this._filter_branch&&(e=this._filter_branch);d&&e[d.id]&&this.each(a,b,c,d.id)},this,c)},eachOpen:function(a,b,c){this.eachChild(c||0,function(c){a.call(b||this,c);this.branch[c.id]&&c.open&&this.eachOpen(a,b,c.id)})},eachSubItem:function(a,b){if(a=this.branch[a||0])for(var c=0;c<a.length;c++){var d=a[c];this.branch[d]?(b.call(this,this.getItem(d),!0),this.eachSubItem(d,b)):b.call(this,this.getItem(d),!1)}},eachLeaf:function(a,b){if(a=this.branch[a||0])for(var c=0;c<a.length;c++){var d=a[c];this.branch[d]?
this.eachLeaf(d,b):b.call(this,this.getItem(d),!1)}},_sort_core:function(a,b){a=this.sorting.create(a);for(var c in this.branch){for(var d=this.branch[c],e=[],f=0;f<d.length;f++)e.push(this.pull[d[f]]);e.sort(a);for(f=0;f<d.length;f++)e[f]=e[f].id;this.branch[c]=e}return b},add:function(a,b,c){var d=!1,e=this.getItem(c||0);e&&(this.branch[e.id]||(d=!0),e.$count++,e.$count||(e.$count=1));this.branch[c||0]=this.order=webix.toArray(this.branch[c||0]);a.$count=0;a.$level=e?e.$level+1:1;a.$parent=e?e.id:
0;if(this._filter_branch&&(e=this._filter_branch[c||0],e||(e=this._filter_branch[c]=this.order),this.order!==e)){var f=e.length;!b&&this.branch[c||0].length&&(f=0);e=webix.toArray(e);a.id=a.id||webix.uid();e.insertAt(a.id,f)}a=webix.DataStore.prototype.add.call(this,a,b);d&&this.refresh(c);return a},_rec_remove:function(a,b){b=this.pull[a];if(this.branch[b.id]&&0<this.branch[b.id].length){b=this.branch[a];for(var c=0;c<b.length;c++)this._rec_remove(b[c],!0)}delete this.branch[a];this._filter_branch&&
delete this._filter_branch[a];delete this.pull[a];this._marks[a]&&delete this._marks[a]},_filter_removed:function(a,b,c){var d=a[b];1==d.length&&d[0]==c&&b?delete a[b]:webix.toArray(d).remove(c)},remove:function(a){if(webix.isArray(a))for(var b=0;b<a.length;b++)this.remove(a[b]);else{webix.assert(this.exists(a),"Not existing ID in remove command"+a);b=this.pull[a];var c=b.$parent||0;if(!1===this.callEvent("onBeforeDelete",[a]))return!1;this._rec_remove(a);this.callEvent("onAfterDelete",[a]);var d=
this.pull[c];this._filter_removed(this.branch,c,a);this._filter_branch&&this._filter_removed(this._filter_branch,c,a);c=0;d&&(d.$count--,0>=d.$count&&(d.$count=0,d.open=0,c=1));this.callEvent("onStoreUpdated",[a,b,"delete"]);c&&this.refresh(d.id)}},getBranch:function(a){var b=[];if(a=(this._filter_branch||this.branch)[a])for(var c=0;c<a.length;c++)b[c]=this.pull[a[c]];return b},serialize:function(a,b){a=this.branch[a||0];for(var c=[],d=0;d<a.length;d++){var e=this.pull[a[d]];if(this._scheme_serialize){var f=
this._scheme_serialize(e);if(!1===f)continue}else f=webix.copy(e);this.branch[e.id]&&(f.data=this.serialize(e.id,b));c.push(f)}return c}};
webix.TreeType={space:function(a,b){b="";for(var c=1;c<a.$level;c++)b+="<div class='webix_tree_none'></div>";return b},icon:function(a,b){return a.$count?a.open?"<div class='webix_tree_open'></div>":"<div class='webix_tree_close'></div>":"<div class='webix_tree_none'></div>"},checkbox:function(a,b){return a.nocheckbox?"":"<input type='checkbox' class='webix_tree_checkbox' "+(a.checked?"checked":"")+(a.disabled?" disabled":"")+">"},folder:function(a,b){return a.icon?"<div class='webix_tree_file webix_tree_"+
a.icon+"'></div>":a.$count?a.open?"<div class='webix_tree_folder_open'></div>":"<div class='webix_tree_folder'></div>":"<div class='webix_tree_file'></div>"}};
webix.TreeAPI={open:function(a,b){if(a){var c=this.getItem(a);c.$count&&!c.open&&(this.callEvent("onBeforeOpen",[a])&&(c.open=!0,this.data.callEvent("onStoreUpdated",[a,0,"branch"]),this.callEvent("onAfterOpen",[a])),b&&"0"!=a&&this.open(this.getParentId(a),b))}},close:function(a){if(a){var b=this.getItem(a);b.open&&this.callEvent("onBeforeClose",[a])&&(b.open=!1,this.data.callEvent("onStoreUpdated",[a,0,"branch"]),this.callEvent("onAfterClose",[a]))}},openAll:function(a){this.data.eachSubItem(a||
0,function(a,c){c&&(a.open=!0)});this.data.refresh()},closeAll:function(a){this.data.eachSubItem(a||0,function(a,c){c&&(a.open=!1)});this.data.refresh()},_tree_check_uncheck:function(a,b,c){if(this._settings.threeState)return this._tree_check_uncheck_3(a,null!==b?b:"");var d=this.getItem(a),e=c?c.target||c.srcElement:null;d.checked=e&&"checkbox"==e.type?e.checked?!0:!1:null!==b?b:!d.checked;this.callEvent("onItemCheck",[a,d.checked,c])},isBranchOpen:function(a){if("0"==a)return!0;a=this.getItem(a);
return a.open?this.isBranchOpen(a.$parent):!1},getOpenItems:function(){var a=[],b;for(b in this.data.branch)this.exists(b)&&this.getItem(b).open&&a.push(b);return a},getState:function(){return{open:this.getOpenItems(),select:this.getSelectedId(!0)}},_repeat_set_state:function(a,b){var c=this.data.attachEvent("onStoreLoad",function(){a.setState.call(a,b);a.data.detachEvent(c);a=null})},setState:function(a){if(a.open){this.closeAll();for(var b=a.open,c=0;c<b.length;c++){var d=this.getItem(b[c]);if(d&&
d.$count&&(d.open=!0,-1==d.$count))return this._repeat_set_state(this,a),this.refresh(),0}this.refresh()}if(a.select&&this.select)for(a=a.select,this.unselect(),c=0;c<a.length;c++)this.exists(a[c])&&this.select(a[c],!0);return 1}};webix.TreeClick={webix_tree_open:function(a,b){this.close(b);return!1},webix_tree_close:function(a,b){this.open(b);return!1},webix_tree_checkbox:function(a,b){this._tree_check_uncheck(b,null,a);return!1}};
webix.TreeCollection=webix.proto({name:"TreeCollection",$init:function(){webix.extend(this.data,webix.TreeStore,!0);this.data.provideApi(this,!0);webix.extend(this,webix.TreeDataMove,!0)}},webix.TreeDataLoader,webix.DataCollection);
webix.AutoScroll={_auto_scroll:function(a,b){var c=1;b=0;var d=this._settings.dragscroll;"string"==typeof d&&(b=-1!=d.indexOf("x"),c=-1!=d.indexOf("y"));d=this._body||this.$view;var e=webix.html.offset(d),f=e.y,g=f+d.offsetHeight;e=e.x;var h=e+d.offsetWidth;d=this.getScrollState();var k=!1,l=Math.max(this.type&&!isNaN(parseFloat(this.type.height))?this.type.height+5:0,40);c&&(c=this._settings,c.topSplit&&(c=this._cellPosition(this.getIdByIndex(c.topSplit-1),this.columnId(0)),f+=c.top+c.height),a.y<
f+l?(this._auto_scrollTo(d.x,d.y-2*l,a),k=!0):a.y>g-l&&(this._auto_scrollTo(d.x,d.y+2*l,a),k=!0));b&&(a.x<e+l?(this._auto_scrollTo(d.x-2*l,d.y,a),k=!0):a.x>h-l&&(this._auto_scrollTo(d.x+2*l,d.y,a),k=!0));k&&(this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[a],100))},_auto_scrollTo:function(a,b,c){this.callEvent("onBeforeAutoScroll",[c])&&this.scrollTo(a,b)}};
webix.DragOrder={_do_not_drag_selection:!0,$drag:function(a,b){if(a=webix.DragItem.$drag.call(this,a,b))b=webix.DragControl.getContext(),this.getBranchIndex&&(this._drag_order_stored_left=this._drag_order_complex?16*this.getItem(b.start).$level:0),b.fragile||this.addCss(b.start,"webix_transparent");return a},_getDragItemPos:function(a,b){return webix.DragItem._getDragItemPos(a,b)},$dragPos:function(a,b,c){var d=webix.html.offset(this.$view),e=d.x+(this._drag_order_complex?1+this._drag_order_stored_left:
1),f=a.y,g="x"==this._settings.layout;g&&(f=d.y+(this._drag_order_complex?+d.height-webix.ui.scrollSize-1:1),e=a.x);c.style.display="none";e=document.elementFromPoint(e,f);if(e!=this._last_sort_dnd_node&&(f=webix.$$(e))&&f==this)if(e=this.locate(e,!0),!e&&webix.DragControl._saved_event&&(e=this.locate(webix.DragControl._saved_event,!0)),f=webix.DragControl.getContext().start,this._auto_scroll_force=!0,e){if(e!=this._last_sort_dnd_node){if(e!=f){if(this.getBranchIndex){var h={parent:this.getParentId(e)};
var k=this.getBranchIndex(e)}else h={},k=this.getIndexById(e);this.callEvent("onBeforeDropOrder",[f,k,b,h])&&(this.move(f,k,this,h),this._last_sort_dnd_node=e)}webix.DragControl._last=this._contentobj}}else if(e="$webix-last",this._last_sort_dnd_node!=e){if(!this.callEvent("onBeforeDropOrder",[f,-1,b,{parent:0}]))return;this._last_sort_dnd_node=e}c.style.display="block";g?(a.y=d.y,a.x-=18,a.x<d.x?a.x=d.x:(c=d.x+this.$view.offsetWidth-60,a.x>c&&(a.x=c))):(d.y+=this._header_height,a.x=this._drag_order_stored_left||
d.x,a.y-=18,a.y<d.y?a.y=d.y:(c=d.y+this.$view.offsetHeight-60,a.y>c&&(a.y=c)));this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[webix.html.pos(b),this.locate(b)||null],250);webix.DragControl._skip=!0},$dragIn:function(){return!1},$drop:function(a,b,c){this._auto_scroll_delay&&(this._auto_scroll_force=null,this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));a=webix.DragControl.getContext();
b=a.start;this.removeCss(b,"webix_transparent");var d=this.getIndexById(b);this.callEvent("onAfterDropOrder",[b,d,c]);a.fragile&&this.refresh()}};
webix.DragItem={_initHandlers:function(a,b,c){b||webix.DragControl.addDrop(a._contentobj,a,!0);c||webix.DragControl.addDrag(a._contentobj,a);this.attachEvent("onDragOut",function(a,b){this.$dragMark(a,b)});this.attachEvent("onBeforeAutoScroll",function(){var a=webix.DragControl.getContext();return!(!webix.DragControl._active||!a||a.to!==this&&!this._auto_scroll_force)})},drag_setter:function(a){a&&(webix.extend(this,webix.AutoScroll,!0),"order"==a&&webix.extend(this,webix.DragOrder,!0),"inner"==a&&
(this._inner_drag_only=!0),this._initHandlers(this,"source"==a,"target"==a),delete this.drag_setter);return a},$dragIn:function(a,b,c){a=this.locate(c)||null;var d=webix.DragControl._drag_context;if((this._inner_drag_only||d.from._inner_drag_only)&&d.from!==this)return!1;b=webix.DragControl.getMaster(b);var e=this.getItemNode(a,c)||this._dataobj;if(e==webix.DragControl._landing)return e;d.target=a;d.to=b;this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));
this._auto_scroll_delay=webix.delay(function(a,b){this._drag_pause(b);this._auto_scroll(a,b)},this,[webix.html.pos(c),a],250);if(!this.$dropAllow(d,c)||!this.callEvent("onBeforeDragIn",[d,c]))return d.to=d.target=null,this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay)),null;this.$dragMark(d,c);return e},$dropAllow:function(){return!0},_drag_pause:function(a){},_target_to_id:function(a){return a&&"object"===typeof a?a.toString():a},$dragOut:function(a,b,
c,d){a=(this._viewobj.contains(c)?this.locate(d):null)||null;b=webix.DragControl._drag_context;if((b.target||"").toString()==(a||"").toString())return null;this._auto_scroll_delay&&(this._auto_scroll_force=null,this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));b.target=b.to=null;this.callEvent("onDragOut",[b,d]);return null},$drop:function(a,b,c){this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));a=webix.DragControl._drag_context;a.to=
this;b=this._target_to_id(a.target);this.getBranchIndex?b&&(a.parent=this.getParentId(b),a.index=this.getBranchIndex(b)):a.index=b?this.getIndexById(b):this.count();this.$dragMark({},c);a.from&&a.from!=a.to&&a.from.callEvent&&a.from.callEvent("onBeforeDropOut",[a,c]);this.callEvent("onBeforeDrop",[a,c])&&(this._context_to_move(a,c),this.callEvent("onAfterDrop",[a,c]))},_context_to_move:function(a,b){webix.assert(a.from,"Unsopported d-n-d combination");a.from&&a.from.move(a.source,a.index,a.to,{parent:a.parent,
mode:a.pos})},_getDragItemPos:function(a,b){if(this.getItemNode)return(a=(a=this.locate(b,!0))?this.getItemNode(a):null)?webix.html.offset(a):a},$drag:function(a,b){if(a=this.locate(b,!0)){var c=[a];if(this.getSelectedId&&!this._do_not_drag_selection){var d=this.getSelectedId(!0,!0);if(d&&1<d.length&&-1!=webix.PowerArray.find.call(d,a)){var e={};c=[];for(var f=0;f<d.length;f++)e[d[f]]=!0;for(f=0;f<this.data.order.length;f++)d=this.data.order[f],e[d]&&c.push(d)}}c=webix.DragControl._drag_context={source:c,
start:a};c.fragile=this.addRowCss&&webix.env.touch&&(webix.env.isWebKit||webix.env.isFF);c.from=this;if(this.callEvent("onBeforeDrag",[c,b]))return webix.Touch&&(webix.Touch._start_context=null),c.html||this.$dragHTML(this.getItem(a),b)}return null},$dragHTML:function(a,b){return this._toHTML(a)},$dragMark:function(a,b){b=null;a.target&&(b=this._target_to_id(a.target));this._marked&&this._marked!=b&&(a.fragile||this.removeCss(this._marked,"webix_drag_over"),this._marked=null);return!this._marked&&
b?(this._marked=b,a.fragile||this.addCss(b,"webix_drag_over"),b):a.to?!0:!1}};webix.Group={$init:function(){webix.extend(this.data,webix.GroupStore);this.data.attachEvent("onClearAll",webix.bind(function(){this.data._not_grouped_order=this.data._not_grouped_pull=null;this._group_level_count=0},this))},group:function(a){this.data.ungroup(!0);this.data.group(a)},ungroup:function(a){this.data.ungroup(a)}};
webix.GroupMethods={sum:function(a,b){b=b||this;for(var c=0,d=0;d<b.length;d++)c+=1*a(b[d]);return c},min:function(a,b){b=b||this;for(var c=Infinity,d=0;d<b.length;d++)1*a(b[d])<c&&(c=1*a(b[d]));return 1*c},max:function(a,b){b=b||this;for(var c=-Infinity,d=0;d<b.length;d++)1*a(b[d])>c&&(c=1*a(b[d]));return 1*c},count:function(a,b){for(var c=0,d=0;d<b.length;d++){var e=a(b[d]);null!==e&&"undefined"!==typeof e&&c++}return c},any:function(a,b){return a(b[0])},string:function(a,b){return a.$name}};
webix.GroupStore={$init:function(){this.attachEvent("onClearAll",this._reset_groups)},_reset_groups:function(){this._not_grouped_order=this._not_grouped_pull=null;this._group_level_count=0},ungroup:function(a){if(this.getBranchIndex)return this._ungroup_tree.apply(this,arguments);this._not_grouped_order&&(this.order=this._not_grouped_order,this.pull=this._not_grouped_pull,this._not_grouped_pull=this._not_grouped_order=null,a||this.callEvent("onStoreUpdated",[]))},_group_processing:function(a){this.blockEvent();
this.group(a);this.unblockEvent()},_group_prop_accessor:function(a){if("function"==typeof a)return a;var b=function(b){return b[a]};b.$name=a;return b},group:function(a){if(this.getBranchIndex)return this._group_tree.apply(this,arguments);"string"==typeof a&&(a={by:a,map:{}});var b="function"==typeof a.by?"value":a.by,c=this._group_prop_accessor(a.by);a.map[b]||(a.map[b]=[b,this._any]);var d={},e=[];this.each(function(b){var f=c(b);d[f]||(e.push({id:f,$group:!0,$row:a.row}),d[f]=webix.toArray());
d[f].push(b)});for(var f in a.map){var g=a.map[f][1]||"any",h=this._group_prop_accessor(a.map[f][0]);"function"!=typeof g&&(webix.assert(webix.GroupMethods[g],"unknown grouping rule: "+g),g=webix.GroupMethods[g]);for(b=0;b<e.length;b++)e[b][f]=g.call(this,h,d[e[b].id])}this._not_grouped_order=this.order;this._not_grouped_pull=this.pull;this.order=webix.toArray();this.pull={};for(b=0;b<e.length;b++)f=this.id(e[b]),this.pull[f]=e[b],this.order.push(f),this._scheme_init&&this._scheme_init(e[b]);this.callEvent("onStoreUpdated",
[])},_group_tree:function(a,b){this._group_level_count=(this._group_level_count||0)+1;if("string"==typeof a){var c={by:this._group_prop_accessor(a),map:{}};c.map[a]=[a]}else c="function"==typeof a?{by:a,map:{}}:a;a=b?this.getItem(b).$level:b=0;for(var d=this.branch[b],e=this._group_prop_accessor(c.by),f=[],g=[],h=0;h<d.length;h++){var k=this.getItem(d[h]),l=e(k),m=a+"$"+l,n=this.branch[m];n||(l=this.pull[m]={id:m,value:l,$group:!0,$row:c.row},this._scheme_init&&this._scheme_init(l),g.push(l),n=this.branch[m]=
[],n._formath=[],f.push(m));n.push(k.id);n._formath.push(k)}this.branch[b]=f;for(var p in c.map)for(e=c.map[p][1]||"any",k=this._group_prop_accessor(c.map[p][0]),"function"!=typeof e&&(webix.assert(webix.GroupMethods[e],"unknown grouping rule: "+e),e=webix.GroupMethods[e]),h=0;h<g.length;h++)g[h][p]=e.call(this,k,this.branch[g[h].id]._formath);for(h=0;h<g.length;h++){d=g[h];this.hasEvent("onGroupCreated")&&this.callEvent("onGroupCreated",[d.id,d.value,this.branch[d.id]._formath]);if(c.footer){e="footer$"+
d.id;m=this.pull[e]={id:e,$footer:!0,value:d.value,$level:a,$count:0,$parent:d.id,$row:c.footer.row};for(p in c.footer)e=c.footer[p][1]||"any",k=this._group_prop_accessor(c.footer[p][0]),"function"!=typeof e&&(webix.assert(webix.GroupMethods[e],"unknown grouping rule: "+e),e=webix.GroupMethods[e]),m[p]=e.call(this,k,this.branch[g[h].id]._formath);this.branch[d.id].push(m.id);this.callEvent("onGroupFooter",[m.id,m.value,this.branch[d.id]._formath])}delete this.branch[d.id]._formath}this._fix_group_levels(f,
b,a+1);this.callEvent("onStoreUpdated",[])},_ungroup_tree:function(a,b,c){if(c||this._group_level_count){this._group_level_count=Math.max(0,this._group_level_count-1);b=b||0;c=[];for(var d=this.branch[b],e=0;e<d.length;e++){var f=d[e],g=this.branch[f];g&&(c=c.concat(g));delete this.pull[f];delete this.branch[f]}this.branch[b]=c;for(e=c.length-1;0<=e;e--)this.pull[c[e]].$footer&&c.splice(e,1);this._fix_group_levels(c,0,1);a||this.callEvent("onStoreUpdated",[])}},_fix_group_levels:function(a,b,c){b&&
(this.getItem(b).$count=a.length);for(var d=0;d<a.length;d++){var e=this.pull[a[d]];e.$level=c;e.$parent=b;var f=this.branch[e.id];f&&this._fix_group_levels(f,e.id,c+1)}}};
webix.clipbuffer={_area:null,_blur_id:null,_ctrl:0,init:function(){if(null!==this._area)return this._area;webix.destructors.push({obj:this});this._area=document.createElement("textarea");this._area.className="webix_clipbuffer";this._area.setAttribute("webixignore",1);this._area.setAttribute("spellcheck","false");this._area.setAttribute("autocapitalize","off");this._area.setAttribute("autocorrect","off");this._area.setAttribute("autocomplete","off");document.body.appendChild(this._area);webix.event(document.body,
"keydown",webix.bind(function(a){var b=!(!a.ctrlKey&&!a.metaKey);86===a.keyCode&&b&&webix.delay(this._paste,this,[a],100)},this));return this._area},destructor:function(){this._area=null},set:function(a){this.init();this._area.value=a;this.focus()},focus:function(){this._isSelectRange()||(this.init(),this._area.focus(),this._area.select())},_isSelectRange:function(){var a="";"undefined"!=typeof window.getSelection?a=window.getSelection().toString():"undefined"!=typeof document.selection&&"Text"==
document.selection.type&&(a=document.selection.createRange().text);return!!a},_paste:function(a){if((a.target||a.srcElement)===this._area){a=this._area.value;var b=webix.UIManager.getFocus();!b||b.getEditor&&b.getEditor()||(b.callEvent("onPaste",[a]),this._area.select())}}};
webix.CopyPaste={clipboard_setter:function(a){if(!0===a||1===a)a="modify";this.attachEvent("onAfterSelect",function(a){this.getEditor&&this.getEditor()||(a=this.getItem(a),a=this.type.templateCopy(a),webix.clipbuffer.set(a,this),webix.clipbuffer.focus(),webix.UIManager.setFocus(this))});this.attachEvent("onPaste",function(a){webix.isUndefined(this._paste[this._settings.clipboard])||this._paste[this._settings.clipboard].call(this,a)});this.attachEvent("onFocus",function(){webix.clipbuffer.focus()});
this.attachEvent("onItemClick",function(a){this._selected&&-1===this._selected.find(a)||(webix.clipbuffer.focus(),webix.UIManager.setFocus(this))});return a},_paste:{insert:function(a){this.add({value:a})},modify:function(a){for(var b=this.getSelectedId(!0),c=0;c<b.length;c++)this.getItem(b[c]).value=a,this.refresh(b[c])},custom:function(a){}},templateCopy_setter:function(a){this.type.templateCopy=webix.template(a)},type:{templateCopy:function(a){return this.template(a)}}};
webix.KeysNavigation={$init:function(){this.getSelectedId&&(this.attachEvent("onAfterRender",this._set_focusable_item),this.attachEvent("onAfterSelect",webix.once(function(){if(1<this.count()&&this._dataobj){var a=this._dataobj.querySelector("["+this._id+"]");a&&a.setAttribute("tabindex","-1")}})))},_set_focusable_item:function(){var a=this.getSelectedId(!0);a.length&&this.getItemNode(a[0])||(a=this._dataobj.querySelector("["+this._id+"]"))&&a.setAttribute("tabindex","0")},_navigation_helper:function(a){return function(b,
c){var d=c.srcElement||c.target;return d.getAttribute("webixignore")||(d=d.tagName,"INPUT"!=d&&"TEXTAREA"!=d&&"SELECT"!=d)?b&&b.moveSelection&&b.config.navigation&&!b._in_edit_mode?(webix.html.preventEvent(c),b.moveSelection(a,{shift:c.shiftKey,ctrl:c.ctrlKey})):!0:!0}},moveSelection:function(a,b,c){var d=this._settings;if(!d.disabled){b=this.getSelectedId(!0);d=this.count&&("x"==d.layout||1<d.xCount);if("right"!=a&&"left"!=a||!this._parent_menu){if(!b.length&&this.count()){if("down"==a||"right"==
a&&d)a="top";else if("up"==a||"left"==a&&d)a="bottom";else return;b=[this.getFirstId()]}if(1==b.length){d=b=b[0];if("left"==a&&this.close)return this.close(b);if("right"==a&&this.open)return this.open(b);if("top"==a)b=this.getFirstId();else if("bottom"==a)b=this.getLastId();else if("up"==a||"left"==a||"pgup"==a)b=this.getIndexById(b),b=this.getIdByIndex(Math.max(0,b-("pgup"==a?10:1)));else if("down"==a||"right"==a||"pgdown"==a){b=this.getIndexById(b);var e="pgdown"==a?10:1;b=this.getIdByIndex(Math.min(this.count()-
1,b+e))}else{webix.assert(!1,"Not supported selection moving mode");return}this._skip_item&&(b=this._skip_item(b,d,a));this.showItem(b);this.select(b);this.getSubMenu&&this.getSubMenu(b)&&this._mouse_move_activation(b,this.getItemNode(b));this.config.clipboard||!1===c||(a=this.getItemNode(b))&&a.focus()}return!1}c=webix.$$(this._parent_menu);c._hide_sub_menu(!0);"x"===c.config.layout?c.moveSelection(a):webix.UIManager.setFocus(c)}},navigation_setter:function(a){a&&!webix.UIManager._global_nav_grid_hotkeys&&
(webix.UIManager._global_nav_grid_hotkeys=!0,webix.UIManager.addHotKey("up",this._navigation_helper("up")),webix.UIManager.addHotKey("down",this._navigation_helper("down")),webix.UIManager.addHotKey("right",this._navigation_helper("right")),webix.UIManager.addHotKey("left",this._navigation_helper("left")),webix.UIManager.addHotKey("shift+up",this._navigation_helper("up")),webix.UIManager.addHotKey("shift+down",this._navigation_helper("down")),webix.UIManager.addHotKey("shift+right",this._navigation_helper("right")),
webix.UIManager.addHotKey("shift+left",this._navigation_helper("left")),webix.UIManager.addHotKey("ctrl+shift+up",this._navigation_helper("up")),webix.UIManager.addHotKey("ctrl+shift+down",this._navigation_helper("down")),webix.UIManager.addHotKey("ctrl+shift+right",this._navigation_helper("right")),webix.UIManager.addHotKey("ctrl+shift+left",this._navigation_helper("left")),webix.UIManager.addHotKey("pageup",this._navigation_helper("pgup")),webix.UIManager.addHotKey("pagedown",this._navigation_helper("pgdown")),
webix.UIManager.addHotKey("home",this._navigation_helper("top")),webix.UIManager.addHotKey("end",this._navigation_helper("bottom")));return a}};
webix.protoUI({name:"tree",defaults:{scroll:"a",navigation:!0},$init:function(){this._viewobj.className+=" webix_tree";webix.extend(this.data,webix.TreeStore,!0);webix.extend(this.on_click,webix.TreeClick);this.attachEvent("onAfterRender",this._refresh_scroll);this.attachEvent("onPartialRender",this._refresh_scroll);this.data.provideApi(this,!0);this._viewobj.setAttribute("role","tree")},_id:"webix_tm_id",on_context:{},on_dblclick:{webix_tree_checkbox:function(){if(this.on_click.webix_tree_checkbox)return this.on_click.webix_tree_checkbox.apply(this,
arguments)}},$fixEditor:function(a){var b=this.getItemNode(a.id).querySelector("span");b&&(""===b.innerHTML&&(b.innerHTML="&nbsp;"),b=b.offsetLeft,a.node.style.width=this.$view.scrollWidth-b-10+"px",a.node.style.marginLeft=b+"px",a.node.style.left="0px")},on_click:{webix_tree_item:function(a,b,c){this._settings.activeTitle&&(this.getItem(b).open?this.close(b):this.open(b));if(this._settings.select)if("multiselect"==this._settings.select||this._settings.multiselect){if("level"==this._settings.multiselect&&
(c=this.getSelectedId(!0)[0])&&this.getParentId(b)!=this.getParentId(c))return;this.select(b,!1,a.ctrlKey||a.metaKey||"touch"==this._settings.multiselect,a.shiftKey)}else this.select(b)}},_paste:{insert:function(a){var b=this.getSelectedId()||"0";this.add({value:a},null,b)},modify:function(a){for(var b=this.getSelectedId(!0),c=0;c<b.length;c++)this.getItem(b[c]).value=a,this.refresh(b[c])},custom:function(a){}},_drag_order_complex:!0,$dragHTML:function(a){return"<div class='borderless'>"+this.type.template(a,
this.type)+"</div>"},type:webix.extend({template:function(a,b){return(b["template"+a.level]||b.templateCommon).apply(this,arguments)},classname:function(a,b,c){b="webix_tree_item";a.$css&&("object"==typeof a.$css&&(a.$css=webix.html.createCss(a.$css)),b+=" "+a.$css);c&&c.$css&&(b+=" "+c.$css);return b},aria:function(a,b,c){return'role="treeitem"'+(c&&c.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')+(a.$count?'aria-expanded="'+(a.open?"true":"false")+'"':"")+'aria-level="'+a.$level+
'"'},templateCommon:webix.template("{common.icon()} {common.folder()} <span>#value#</span>"),templateStart:webix.template('<div webix_tm_id="#id#" class="{common.classname()}" {common.aria()}>'),templateEnd:webix.template("</div>"),templateCopy:webix.template("#value#")},webix.TreeType)},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.DragItem,webix.TreeDataMove,webix.SelectionModel,webix.KeysNavigation,webix.MouseEvents,webix.Scrollable,webix.TreeDataLoader,webix.ui.proto,webix.TreeRenderStack,
webix.CopyPaste,webix.EventSystem);
webix.TreeStateCheckbox={_init_render_tree_state:function(){if(this._branch_render_supported){var a=this.render;this.render=function(b,c,d){var e=a.apply(this,arguments);this._settings.threeState&&e&&"checkbox"!=c&&this._setThirdState.apply(this,arguments)};this._init_render_tree_state=function(){}}},threeState_setter:function(a){a&&this._init_render_tree_state();return a},_setThirdState:function(a){var b=[];var c=this;a&&!c.data.pull[a]&&(a=0);if(!a||c.data.pull[a].$count){var d=this._getAllLeaves(a);
d.sort(function(a,b){return c.data.pull[b].$level-c.data.pull[a].$level});for(a=0;a<d.length;a++)a&&c.data.pull[d[a]].$parent==c.data.pull[d[a-1]].$parent||(b=b.concat(c._setParentThirdState(d[a])))}else b=b.concat(c._setParentThirdState(a));d={};for(a=0;a<b.length;a++)d[b[a]]||(d[b[a]]=1,this._setCheckboxIndeterminate(b[a]));c=null},_setCheckboxIndeterminate:function(a){var b;if(b=this.getItemNode(a))if(this.render(a,"checkbox","update"),this.getItem(a).indeterminate&&(b=this.getItemNode(a),b=b.getElementsByTagName("input")[0]))b.indeterminate=
this.getItem(a).indeterminate},_setParentThirdState:function(a){var b,c,d,e;var f=this.getParentId(a);for(c=[];f&&"0"!=f;){var g=d=0;this.data.eachChild(f,function(a){a.indeterminate?d++:a.checked&&g++});a=b=e=!1;var h=this.getItem(f);if(g==h.$count)a=!0;else if(0<g||0<d)b=!0;if(b||b!=h.indeterminate)e=!0;h.indeterminate=b;if(a||h.checked!=a)e=!0;h.checked=a;e?(c.push(f),f=this.getParentId(f)):f=0}return c},getChecked:function(){var a=[],b=this;this.data.eachSubItem(0,function(c){b.isChecked(c.id)&&
a.push(c.id)});return a},_tree_check_uncheck_3:function(a,b){var c=this.getItem(a);if(c&&(""===b&&(b=!c.checked),c.checked!=b||c.indeterminate)){c.checked=b;this._correctThreeState(a);c=this._setParentThirdState(a);if(this._branch_render_supported&&5>c.length)for(var d=0;d<c.length;d++)this._setCheckboxIndeterminate(c[d]);else this.refresh();this.callEvent("onItemCheck",[a,b])}},checkItem:function(a){this._tree_check_uncheck(a,!0);this.updateItem(a)},uncheckItem:function(a){this._tree_check_uncheck(a,
!1);this.updateItem(a)},_checkUncheckAll:function(a,b,c){var d=b?"checkItem":"uncheckItem";if(a)this[d](a);else a=0;this._settings.threeState?a||this.data.eachChild(0,function(a){this[d](a.id)},this,c):this.data.each(function(a){this[d](a.id)},this,c,a)},checkAll:function(a,b){this._checkUncheckAll(a,!0,b)},uncheckAll:function(a,b){this._checkUncheckAll(a,!1,b)},_correctThreeState:function(a){var b=this.getItem(a);b.indeterminate=!1;var c=b.checked;this.data.eachSubItem(a,function(a){a.indeterminate=
!1;a.checked=c});this._branch_render_supported&&this.isBranchOpen(b.$parent)&&this.render(a,0,"branch")},isChecked:function(a){return this.getItem(a).checked},_getAllLeaves:function(a){var b=[];this.data.eachSubItem(a,function(a,d){d||b.push(a.id)});return b}};webix.ui.tree&&webix.extend(webix.ui.tree,webix.TreeStateCheckbox,!0);
webix.type(webix.ui.tree,{name:"lineTree",css:"webixLineTree",icon:function(a,b){for(var c="",d="",e=1;e<=a.$level;e++){e==a.$level&&(d=a.$count?a.open?"webix_tree_open ":"webix_tree_close ":"webix_tree_none ");var f=this._icon_src(a,b,e);f&&(c+="<div class='"+d+"webix_tree_img webix_tree_"+f+"'></div>")}return c},_icon_src:function(a,b,c){var d=b._tree_branch_render_state,e=webix.TreeRenderStack._obj;if(0===d&&e){var f=a.$level,g=a.id;for(d=[];f;){var h=e.getParentId(g),k=e.data.branch[h];k[k.length-
1]==g&&(d[f]=!0);g=h;f--}b._tree_branch_render_state=d}return d?c==a.$level?(b=3,a.$parent||0===a.$index&&(b=4),d[a.$level]&&(b=2),a.$count?a.open?"minus"+b:"plus"+b:"line"+b):d[c]?"blank":"line1":0}});
webix.NavigationButtons={$init:function(){this.$ready.push(function(){this.attachEvent("onKeyPress",this._onKeyPress)})},_moveActive:function(a,b){if(37===a||39===a)webix.html.preventEvent(b),this._showNavItem(37===a?-1:1),(a=this._navPanel.querySelector("[tabindex='0']"))&&a.focus()},_renderPanel:function(){webix.html.remove(this._navPanel);this._navPanel=webix.html.create("DIV",{"class":"webix_nav_panel webix_nav_panel_"+this._settings.navigation.type,role:"tablist"},"");this._viewobj.appendChild(this._navPanel);
this._renderNavItems();this._renderNavButtons();this._setLinkEventHandler()},_setLinkEventHandler:function(){var a=[];this._navPanel&&(a[0]=webix.event(this._navPanel,"click",webix.bind(function(a){a=a.srcElement||a.target;for(var b=!1;a!=this._navPanel&&!b;){var d=a.getAttribute(this._linkAttr);d&&(b=!0,this._showPanelBind(d));a=a.parentNode}},this)));this._prevNavButton&&(a[1]=webix.event(this._prevNavButton,"click",webix.bind(function(a){this._showNavItem(-1)},this)));this._nextNavButton&&(a[1]=
webix.event(this._nextNavButton,"click",webix.bind(function(a){this._showNavItem(1)},this)));this.attachEvent("onDestruct",function(){for(var b=0;b<a.length;b++)this.detachEvent(a[b]);a=null})},_showNavItem:function(a){if(this._cells){a=this._active_cell+a;if(a>=this._cells.length||0>a)a=0>a?this._cells.length-1:0;this.setActiveIndex(a)}},_showPanelBind:function(a){this._cells&&webix.$$(a).show()},_renderNavItems:function(){var a=this._settings.navigation;if(a.items){this._linkAttr=a.linkAttr||"bind_id";
this._navPanel?this._clearPanel():this._renderPanel();var b=this._cells?this._cells:this.data.order;if(1<b.length)for(var c=0;c<b.length;c++){a=webix.html.create("DIV",{"class":"webix_nav_item webix_nav_"+(c==this._active_cell?"active":"inactive"),role:"tab",tabindex:c==this._active_cell?"0":"-1"},"<div></div>");var d=this._cells?this._cells[c]._settings.id:b[c];d&&a.setAttribute(this._linkAttr,d);this._navPanel.appendChild(a)}}},_clearPanel:function(){if(this._navPanel)for(var a=this._navPanel.childNodes,
b=a.length-1;0<=b;b--)webix.html.remove(a[b])},_renderNavButtons:function(){var a=this._settings.navigation;a.buttons&&(this._prevNavButton&&webix.html.remove(this._prevNavButton),this._prevNavButton&&webix.html.remove(this._nextNavButton),this._prevNavButton=webix.html.create("DIV",{"class":"webix_nav_button_"+a.type+" webix_nav_button_prev ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.prevTab},'<div class="webix_nav_button_inner"></div>'),this._viewobj.appendChild(this._prevNavButton),
this._nextNavButton=webix.html.create("DIV",{"class":"webix_nav_button_"+a.type+" webix_nav_button_next ",role:"button",tabindex:"0","aria-label":webix.i18n.aria.nextTab},'<div class="webix_nav_button_inner"></div>'),this._viewobj.appendChild(this._nextNavButton))}};
(function(){function a(a,b){var c=webix.html.create("div",{"class":"webix_view webix_print_"+a.toLowerCase(),style:"height:0px;visibility:hidden;"},b["doc"+a]);"Header"===a?webix.html.insertBefore(c,document.body.firstChild):document.body.appendChild(c);b["doc"+a]=c}webix.env.printPPI=96;webix.env.printMargin=.75*webix.env.printPPI;var b=webix.env.printMargin,c={a4:"A4",a3:"A3",letter:"letter"},d={page:!0,data:!0},e={portrait:!0,landscape:!0},f={A3:{width:11.7,height:16.5},A4:{width:8.27,height:11.7},
letter:{width:8.5,height:11}};webix.print=function(g,h){(g=webix.$$(g))&&g.$printView&&(g=g.$printView());webix.assert(g,"non-existing view for printing");if(g){g.callEvent&&g.callEvent("onBeforePrint",[h]);h=h||{};h.paper=c[(h.paper||"").toLowerCase()]||"A4";h.mode=e[h.mode]?h.mode:"portrait";h.fit=d[h.fit]?h.fit:"page";h.scroll=h.scroll||!1;h.size=f[h.paper];h.margin=h.margin||0===h.margin?h.margin:{};b=isNaN(1*h.margin)?b:h.margin;h.margin={top:h.margin.top||0===h.margin.top?h.margin.top:b,bottom:h.margin.bottom||
0===h.margin.bottom?h.margin.bottom:b,right:h.margin.right||0===h.margin.right?h.margin.right:b,left:h.margin.left||0===h.margin.left?h.margin.left:b};var k=h;webix.html.addCss(document.body,"webix_print");k.docHeader&&a("Header",k);k.docFooter&&a("Footer",k);webix.html.addStyle("@media print { @page{ size:"+k.paper+" "+k.mode+";margin-top:"+k.margin.top+"px;margin-bottom:"+k.margin.bottom+"px;margin-right:"+k.margin.right+"px;margin-left:"+k.margin.left+"px;}}","print");if(!g.$customPrint||!0===
g.$customPrint(h)){k=h;var l=g.$view.cloneNode(!0),m=g.$view.getElementsByTagName("canvas");if(m.length)for(var n=m.length-1;0<=n;n--)l.getElementsByTagName("canvas")[n].getContext("2d").drawImage(m[n],0,0);webix.html.insertBefore(l,k.docFooter,document.body);webix.html.addCss(l,"webix_ui_print");!k.scroll&&(g._dataobj&&g.data&&g.data.pull||g.getBody)&&webix.html.addCss(l,"webix_print_noscroll");window.print();webix.html.remove(l)}webix.html.removeCss(document.body,"webix_print");webix.html.removeStyle("print");
h.docHeader&&webix.html.remove(h.docHeader);h.docFooter&&webix.html.remove(h.docFooter)}}})();
webix.CustomPrint={$customPrint:function(a,b){if(this._prePrint(a,b))return!0;var c=this._getTableArray(a);c=this._getTableHTML(c,a);if(b)return c;b=webix.html.create("div",{"class":"webix_ui_print"});b.appendChild(c);webix.html.insertBefore(b,a.docFooter,document.body);window.print();webix.html.remove(b)},_prePrint:function(a,b){if(!b&&("y"==this.config.layout||a.scroll||this.config.prerender||this.config.autoheight))return!0;"x"==this.config.layout&&webix.extend(a||{},{xCount:this.count(),nobreaks:!0},
!0)},_getPageWidth:function(a){return"page"==a.fit?Infinity:Math.min(a.size["portrait"==a.mode?"width":"height"]*webix.env.printPPI-2*webix.env.printMargin)},_getTableArray:function(a,b,c){var d=this._getPageWidth(a),e=a.xCount||this._getVisibleRange()._dx,f=[],g=[],h=0;c=c||0;b=b||[];for(var k=0;k<this.data.order.length;){var l=this.data.pull[this.data.order[k]];var m=parseInt(k/e);m=k-m*e;if(l&&m>=c){h+=this.type.width;if(h>d&&m>c){var n=g.length+c;f.push(g);k+=e-g.length;g=[];h=0;continue}m=this.type.template(l,
this.type);g.push({txt:m,className:this._itemClassName+" "+(l.$css||""),style:{display:"table-cell",height:this.type.height+"px",width:this.type.width+"px"}});0===(k+1)%e&&(f.push(g),g=[],h=0)}k++}b.push(f);n&&this._getTableArray(a,b,n);return b},_getTableHTML:function(a,b){var c=webix.html.create("div");a.forEach(webix.bind(function(d,e){var f=webix.html.create("table",{"class":"webix_table_print "+this.$view.className,style:"border-collapse:collapse"});d.forEach(function(a){var b=webix.html.create("tr");
a.forEach(function(a){var c=webix.html.create("td");a.txt&&(c.innerHTML=a.txt);a.className&&(c.className=a.className);a.style&&Object.keys(a.style).forEach(function(b){a.style[b]&&(c.style[b]=a.style[b])});a.span&&(1<a.span.colspan&&(c.colSpan=a.span.colspan),1<a.span.rowspan&&(c.rowSpan=a.span.rowspan));b.appendChild(c)});f.appendChild(b)});c.appendChild(f);!b.nobreaks&&e+1<a.length&&(d=webix.html.create("DIV",{"class":"webix_print_pagebreak"}),c.appendChild(d))},this));return c}};
webix.protoUI({name:"list",_listClassName:"webix_list",_itemClassName:"webix_list_item",$init:function(a){webix.html.addCss(this._viewobj,this._listClassName+("x"==(a.layout||this.defaults.layout)?"-x":""));this.data.provideApi(this,!0);this._auto_resize=webix.bind(this._auto_resize,this);this.data.attachEvent("onStoreUpdated",this._auto_resize);this.data.attachEvent("onSyncApply",this._auto_resize);this.attachEvent("onAfterRender",this._correct_width_scroll);this._viewobj.setAttribute("role","listbox")},
$dragHTML:function(a,b){return"y"==this._settings.layout&&"auto"==this.type.width?(this.type.width=this._content_width,a=this._toHTML(a),this.type.width="auto",a):this._toHTML(a)},defaults:{select:!1,scroll:!0,layout:"y",navigation:!0},_id:"webix_l_id",on_click:{webix_list_item:function(a,b){this._settings.select&&(this._no_animation=!0,"multiselect"==this._settings.select||this._settings.multiselect?this.select(b,!1,a.ctrlKey||a.metaKey||"touch"==this._settings.multiselect,a.shiftKey):this.select(b),
this._no_animation=!1)}},on_dblclick:{},getVisibleCount:function(){return Math.floor(this._content_height/this._one_height())},_auto_resize:function(){(this._settings.autoheight||this._settings.autowidth)&&this.resize()},_auto_height_calc:function(a){var b=this.data.$pagesize||this.count();this._onoff_scroll(a&&a<b);this._settings.autoheight&&b<(a||Infinity)&&(a=b);a=this._one_height()*a+(this.type.margin||0);this.getUnits&&(a+=this.getUnits().length*this.type.headerHeight);return Math.max(a,this._settings.minHeight||
0)},_one_height:function(){return this.type.height+(this.type.margin||0)},_auto_width_calc:function(a){var b=this.data.$pagesize||this.count();this._onoff_scroll(a&&a<b);this._settings.autowidth&&b<(a||Infinity)&&(a=b);return this.type.width*a},_correct_width_scroll:function(){"x"==this._settings.layout&&(this._dataobj.style.width="auto"!=this.type.width?this.type.width*this.count()+"px":"auto")},$getSize:function(a,b){if("y"==this._settings.layout){if("auto"!=this.type.width&&(this._settings.width=
this.type.width+(this._scroll_y?webix.ui.scrollSize:0)),this._settings.yCount||this._settings.autoheight)this._settings.height=this._auto_height_calc(this._settings.yCount)||1}else if("auto"!=this.type.height&&(this._settings.height=this._one_height()+(this._scroll_x?webix.ui.scrollSize:0)),this._settings.xCount||this._settings.autowidth)this._settings.width=this._auto_width_calc(this._settings.xCount)||1;return webix.ui.view.prototype.$getSize.call(this,a,b)},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,
arguments)},type:{css:"",widthSize:function(a,b){return b.width+(-1<b.width?"px":"")},heightSize:function(a,b){return b.height+(-1<b.height?"px":"")},classname:function(a,b,c){b="webix_list_item";a.$css&&("object"==typeof a.$css&&(a.$css=webix.html.createCss(a.$css)),b+=" "+a.$css);c&&c.$css&&(b+=" "+c.$css);return b},aria:function(a,b,c){return'role="option"'+(c&&c.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')+(a.$count&&a.$template?'aria-expanded="true"':"")},template:function(a){return(a.icon?
"<span class='webix_icon fa-"+a.icon+"'></span> ":"")+a.value+(a.badge?"<div class='webix_badge'>"+a.badge+"</div>":"")},width:"auto",templateStart:webix.template('<div webix_l_id="#id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden;" {common.aria()}>'),templateEnd:webix.template("</div>")},$skin:function(){this.type.height=webix.skin.$active.listItemHeight}},webix.CustomPrint,webix.KeysNavigation,webix.DataMove,webix.DragItem,webix.MouseEvents,
webix.SelectionModel,webix.Scrollable,webix.ui.proto,webix.CopyPaste);
webix.protoUI({name:"grouplist",defaults:{animate:{}},_listClassName:"webix_grouplist",$init:function(){webix.extend(this.data,webix.TreeStore,!0);this.data.count=function(){return this.order.length};this.data.provideApi(this,!0);this.data.attachEvent("onClearAll",webix.bind(this._onClear,this));this._onClear()},_onClear:function(){this._nested_cursor=[];this._nested_chain=[]},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments)&&(this._dataobj.style.width=this._content_width)},
on_click:{webix_list_item:function(a,b){if(this._in_animation)return!1;for(var c=0;c<this._nested_chain.length;c++)if(this._nested_chain[c]==b){for(a=c;a<this._nested_chain.length;a++)this.data.getItem(this._nested_chain[a]).$template="";c?(this._nested_cursor=this.data.branch[this._nested_chain[c-1]],this._nested_chain.splice(c)):(this._nested_cursor=this.data.branch[0],this._nested_chain=[]);this._is_level_down=!1;return this.render()}c=this.getItem(b);if(c.$count)return this._is_level_down=!0,
this._nested_chain.push(b),c.$template="Back",this._nested_cursor=this.data.branch[c.id],this.render();this._settings.select&&(this._no_animation=!0,"multiselect"==this._settings.select||this._settings.multiselect?this.select(b,!1,"touch"==this._settings.multiselect||a.ctrlKey||a.metaKey,a.shiftKey):this.select(b),this._no_animation=!1)}},getOpenState:function(){return{parents:this._nested_chain,branch:this._nested_cursor}},render:function(a,b,c,d){var e;this._nested_chain=webix.copy(this._nested_chain);
this._nested_cursor=webix.copy(this._nested_cursor);if(this._nested_chain.length)for(e=0;e<this._nested_chain.length;e++)this.data.branch[this._nested_chain[e]]||(this._nested_chain.splice(e,1),e--);e=this._nested_chain.length?this._nested_chain[this._nested_chain.length-1]:0;this._nested_cursor=webix.copy(this.data.branch[e]);!this._nested_cursor.length&&this._nested_chain.length&&(this._nested_cursor=[e],this._nested_chain.pop());if(this._in_animation)return webix.delay(this.render,this,arguments,
100);for(e=0;e<this._nested_cursor.length;e++)this.data.getItem(this._nested_cursor[e]).$template="";this._nested_cursor.length||(this._nested_cursor=this.data.branch[0]);this.data.order=webix.toArray([].concat(this._nested_chain).concat(this._nested_cursor));if(this.callEvent("onBeforeRender",[this.data])){if(this._no_animation||!this._dataobj.innerHTML||!webix.animate.isSupported()||!this._settings.animate||this._prev_nested_chain_length==this._nested_chain.length)webix.RenderStack.render.apply(this,
arguments);else if(this.callEvent("onBeforeRender",[this.data])){this._back_scroll_states||(this._back_scroll_states=[]);var f=this._dataobj.cloneNode(!1);f.innerHTML=this.data.getRange().map(this._toHTML,this).join("");var g=webix.extend({},this._settings.animate);g.direction=this._is_level_down?"left":"right";var h=[webix.clone(g),webix.clone(g)];if(this._is_level_down)this._back_scroll_states.push(this.getScrollState()),webix.Touch&&webix.Touch.$active&&(h[0].y=0,h[1].y=-this.getScrollState().y);
else{var k=this._back_scroll_states.pop();webix.Touch&&webix.Touch.$active&&(h[0].y=-k.y,h[1].y=-this.getScrollState().y)}var l=webix.animate.formLine(f,this._dataobj,g);webix.Touch&&webix.Touch.$active&&webix.Touch._set_matrix(f,0,this._is_level_down?0:h[0].y,"0ms");g.master=this;g.callback=function(){this._dataobj=f;this._is_level_down?webix.Touch&&webix.Touch.$active||this.scrollTo(0,0):webix.Touch&&webix.Touch.$active?webix.delay(function(){webix.Touch._set_matrix(f,0,h[0].y,"0ms")},this):k&&
this.scrollTo(0,k.y);webix.animate.breakLine(l);this._htmlmap=g.master=g.callback=null;this._in_animation=!1;this.callEvent("onAfterRender",[])};this._in_animation=!0;webix.animate(l,h)}this._prev_nested_chain_length=this._nested_chain.length}},templateBack_setter:function(a){this.type.templateBack=webix.template(a)},templateItem_setter:function(a){this.type.templateItem=webix.template(a)},templateGroup_setter:function(a){this.type.templateGroup=webix.template(a)},type:{template:function(a,b){return a.$count?
b.templateGroup(a,b):b.templateItem(a,b)},css:"group",classname:function(a,b,c){return"webix_list_item webix_"+(a.$count?"group":"item")+(a.$template?"_back":"")+(c&&c.webix_selected?" webix_selected ":"")+(a.$css?a.$css:"")},templateStart:webix.template('<div webix_l_id="#id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()};  overflow:hidden;" {common.aria()}>'),templateBack:webix.template("#value#"),templateItem:webix.template("#value#"),templateGroup:webix.template("#value#"),
templateEnd:function(a,b){b="";a.$count&&(b+="<div class='webix_arrow_icon'></div>");return b+"</div>"}},showItem:function(a){if(a){var b=this.getItem(a);var c=b.$parent;b.$count&&(c=b.id)}this._nested_cursor=this.data.branch[c||0];for(this._nested_chain=[];c;)this.getItem(c).$template="Back",this._nested_chain.unshift(c),c=this.getItem(c).$parent;this._no_animation=!0;this.render();this._no_animation=!1;webix.RenderStack.showItem.call(this,a)}},webix.Group,webix.ui.list);
webix.type(webix.ui.grouplist,{});
webix.protoUI({name:"unitlist",_id:"webix_item_id",uniteBy_setter:webix.template,render:function(a,b,c,d){d=this._settings;if(this.isVisible(d.id)){webix.debug_render&&webix.log("Render: "+this.name+"@"+d.id);if(!d.uniteBy)return webix.debug_render&&webix.log("uniteBy is undefined"),!1;if(a&&(d=this.getItemNode(a))&&"update"==c&&this._settings.uniteBy.call(this,b)==this.getItem(a).$unitValue){a=this._htmlmap[a]=this._toHTMLObject(b);webix.html.insertBefore(a,d);webix.html.remove(d);return}this.callEvent("onBeforeRender",
[this.data])&&(this.units=null,this._setUnits(),this.units&&(this._dataobj.innerHTML=this._getUnitRange().map(this._toHTML,this).join(""),this._htmlmap=null),this.callEvent("onAfterRender",[]))}},getUnits:function(){var a=[];if(this.units)for(var b in this.units)a.push(b);return a},getUnitList:function(a){return this.units?this.units[a]:null},_toHTML:function(a){var b=this.data._marks[a.id];webix.assert(!a.$template||this.type["template"+a.$template],"RenderStack :: Unknown template: "+a.$template);
this.callEvent("onItemRender",[a]);return a.$unit?this.type.templateStartHeader(a,this.type)+this.type.templateHeader.call(this,a.$unit)+this.type.templateEnd(a,this.type):this.type.templateStart(a,this.type,b)+(a.$template?this.type["template"+a.$template]:this.type.template)(a,this.type)+this.type.templateEnd(a,this.type)},_getUnitRange:function(){var a,b;var c=[];var d=this.data.$min||0,e=this.data.$max||Infinity,f=0;for(b in this.units){c.push({$unit:b});var g=this.units[b];for(a=0;a<g.length;a++){f==
d&&(c=[{$unit:b}]);c.push(this.getItem(g[a]));if(f==e)return webix.toArray(c);f++}}return webix.toArray(c)},_setUnits:function(){var a=this;this.units={};this.data.each(function(b){var c=a._settings.uniteBy.call(this,b);b.$unitValue=c;a.units[c]||(a.units[c]=[]);a.units[c].push(b.id)})},type:{headerHeight:20,templateHeader:function(a){return"<span class='webix_unit_header_inner'>"+a+"</span>"},templateStart:function(a,b,c){if(a.$unit)return b.templateStartHeader.apply(this,arguments);var d="webix_list_item webix_list_"+
b.css+"_item"+(c&&c.webix_selected?" webix_selected":"")+(a.$css?a.$css:""),e="width:"+b.widthSize(a,b,c)+"; height:"+b.heightSize(a,b,c)+"; overflow:hidden;"+(b.layout&&"x"==b.layout?"float:left;":"");return'<div webix_item_id="'+a.id+'" class="'+d+'" style="'+e+'" '+b.aria(a,b,c)+">"},templateStartHeader:function(a,b,c){var d="webix_unit_header webix_unit_"+b.css+"_header"+(a.$selected?"_selected":"");b="width:"+b.widthSize(a,b,c)+"; height:"+b.headerHeight+"px; overflow:hidden;";return'<div webix_unit_id="'+
a.$unit+'" class="'+d+'" style="'+b+'">'}},$skin:function(){this.type.headerHeight=webix.skin.$active.unitHeaderHeight||20}},webix.ui.list);
webix.EditAbility={defaults:{editaction:"click"},$init:function(a){this._editors={};this._edit_open_time=this._in_edit_mode=0;this._contentobj.style.position="relative";a&&(a.onDblClick=a.onDblClick||{});this.attachEvent("onAfterRender",this._refocus_inline_editor);this._settings.editable&&this._init_edit_events_once();webix.extend(this,webix.Undo)},_refocus_try:function(a){try{if("number"==typeof a.selectionStart)a.selectionStart=a.selectionEnd=a.value.length;else if("undefined"!=typeof a.createTextRange){var b=
a.createTextRange();b.collapse(!1);b.select()}}catch(c){}},_refocus_inline_editor:function(){var a=this.getEditor();if(a&&a.$inline&&!a.getPopup){var b=this._locateInput(a);if(b&&b!=a.node){var c=a.node.value;a.node=b;b.value=c;b.focus();this._refocus_try(b)}else this.editStop()}},editable_setter:function(a){a&&this._init_edit_events_once();return a},_init_edit_events_once:function(){webix.attachEvent("onEditEnd",webix.bind(function(){this._in_edit_mode&&this.editStop()},this));webix.attachEvent("onClick",
webix.bind(function(a){this._in_edit_mode&&200<new Date-this._edit_open_time&&(this._last_editor&&!this._last_editor.popupType&&a&&this._last_editor.node&&this._last_editor.node.contains(a.target||a.srcElement)||this.editStop())},this));this.data.attachEvent&&this.data.attachEvent("onIdChange",webix.bind(function(a,b){this._changeEditorId(a,b)},this));this.attachEvent("onItemClick",function(a){this._settings.editable&&"click"==this._settings.editaction&&this.edit(a)});this.attachEvent("onItemDblClick",
function(a){this._settings.editable&&"dblclick"==this._settings.editaction&&this.edit(a)});this._reset_active_editor=webix.bind(function(){this._edit_open_time=new Date},this);this._init_edit_events_once=function(){};this._component_specific_edit_init&&this._component_specific_edit_init()},_handle_live_edits:function(){webix.delay(function(){var a=this.getEditor();if(a&&a.config.liveEdit){var b={value:a.getValue(),old:a.value};b.value!=b.old&&(a.value=b.value,this._set_new_value(a,b.value,!1),this.callEvent("onLiveEdit",
[b,a]))}},this)},_show_editor_form:function(a){var b=this._settings.form;"string"!=typeof b&&(this._settings.form=b=webix.ui(b).config.id);b=webix.$$(b);var c=b.setValues?b:b.getChildViews()[0];c.setValues(this.getItem(a.row||a));b.config.master=this.config.id;b.show(this.getItemNode(a));a=c.getChildViews()[0];a.focus&&a.focus()},edit:function(a,b,c){if(this.callEvent("onBeforeEditStart",[a])){if(this._settings.form)return this._show_editor_form(a);var d=this._get_editor_type(a);if(d){if(this.getEditor(a))return;
b||this.editStop();webix.assert(webix.editors[d],"Invalid editor type: "+d);b=webix.extend({},webix.editors[d]);d=this._init_editor(a,b,c);b.config.liveEdit&&(this._live_edits_handler=this.attachEvent("onKeyPress",this._handle_live_edits));var e=b.getPopup?b.getPopup(d)._viewobj:d;e&&webix._event(e,"click",this._reset_active_editor);d&&webix._event(d,"change",this._on_editor_change,{bind:{view:this,id:a}});!1!==c&&b.focus();this.$fixEditor&&this.$fixEditor(b);this._edit_open_time=webix.edit_open_time=
new Date;webix.UIManager.setFocus(this,!0);this.callEvent("onAfterEditStart",[a]);return b}return null}},getEditor:function(a){return a?this._editors[a]:this._last_editor},_changeEditorId:function(a,b){var c=this._editors[a];c&&(this._editors[b]=c,c.id=b,delete this._editors[a])},_on_editor_change:function(a){this.view.hasEvent("onEditorChange")&&this.view.callEvent("onEditorChange",[this.id,this.view.getEditorValue(this.id)])},_get_edit_config:function(a){return this._settings},_init_editor:function(a,
b,c){b.config=this._get_edit_config(a);var d=b.render();b.$inline&&(d=this._locateInput(a));b.node=d;var e=this.getItem(a),f=e[this._settings.editValue||"value"];webix.isUndefined(f)&&(f="");b.setValue(f,e);b.value=f;this._addEditor(a,b);!1!==c&&this.showItem(a);b.$inline||this._sizeToCell(a,d,!0);b.afterRender&&b.afterRender();return d},_locate_cell:function(a){return this.getItemNode(a)},_locateInput:function(a){(a=this._locate_cell(a))&&(a=a.getElementsByTagName("input")[0]||a);return a},_get_editor_type:function(a){return this._settings.editor},
_addEditor:function(a,b){b.id=a;this._editors[a]=this._last_editor=b;this._in_edit_mode++},_removeEditor:function(a){this._last_editor==a&&(this._last_editor=0);a.destroy&&a.destroy();delete a.popup;delete a.node;delete this._editors[a.id];this._in_edit_mode--},focusEditor:function(a){var b=this.getEditor.apply(this,arguments);b&&b.focus&&b.focus()},editCancel:function(){this.editStop(null,null,!0)},_applyChanges:function(a){if(a){var b=this.getEditor();if(b&&b.getPopup&&b.getPopup()==a.getTopParentView())return}this.editStop()},
editStop:function(a,b,c){if(!this._edit_stop){var d=this._edit_stop=1;a?d=this._editStop(this._editors[a],c):this._for_each_editor(function(a){d*=this._editStop(a,c)});this._edit_stop=0;return d}},_cellPosition:function(a){a=this.getItemNode(a);return{left:a.offsetLeft,top:a.offsetTop,height:a.offsetHeight,width:a.offsetWidth,parent:this._contentobj}},_sizeToCell:function(a,b,c){b.style&&(a=this._cellPosition(a),b.style.top=a.top+"px",b.style.left=a.left+"px",b.style.width=a.width-1+"px",b.style.height=
a.height-1+"px",b.top=a.top,c&&a.parent.appendChild(b))},_for_each_editor:function(a){for(var b in this._editors)a.call(this,this._editors[b])},_editStop:function(a,b){if(a&&!webix._final_destruction){var c={value:a.getValue(),old:a.value};if(this.callEvent("onBeforeEditStop",[c,a,b])){if(!b){var d=c.old;"string"==typeof c.value&&(d+="");if(d!=c.value||a.config.liveEdit)d=this._set_new_value(a,c.value,!0),this.updateItem(a.row||a.id,d)}a.$inline?a.node=null:webix.html.remove(a.node);(d=a.config.suggest)&&
"string"==typeof d&&webix.$$(d).hide();this._removeEditor(a);this._live_edits_handler&&this.detachEvent(this._live_edits_handler);this.callEvent("onAfterEditStop",[c,a,b]);return 1}return 0}},validateEditor:function(a){var b=!0;if(this._settings.rules){a=this.getEditor(a);var c=a.column||this._settings.editValue||"value",d=this._settings.rules[c],e=this._settings.rules.$all;if(d||e){var f=this.data.getItem(a.row||a.id),g=a.getValue(),h=a.getInputNode();d&&(b=d.call(this,g,f,c));e&&(b=e.call(this,
g,f,c)&&b);b?webix.html.removeCss(h,"webix_invalid"):webix.html.addCss(h,"webix_invalid");webix.callEvent("onLiveValidation",[a,b,f,g])}}return b},getEditorValue:function(a){var b;if(b=0===arguments.length?this._last_editor:this.getEditor(a))return b.getValue()},getEditState:function(){return this._last_editor||!1},editNext:function(a,b){if(1==this._in_edit_mode||b)if(a=this._find_cell_next(this._last_editor||b,function(a){return this._get_editor_type(a)?!0:!1},!1!==a),this.editStop())return a&&(this.edit(a),
this._after_edit_next(a)),!1},_after_edit_next:function(){},_find_cell_next:function(a,b,c){var d=this.getIndexById(a.id);a=this.data.order;if(c)for(c=d+1;c<a.length;c++){if(b.call(this,a[c]))return a[c]}else for(c=d-1;0<=c;c--)if(b.call(this,a[c]))return a[c];return null},_set_new_value:function(a,b,c){a=c?{}:this.getItem(a.id);a[this._settings.editValue||"value"]=b;return a}};
(function(){function a(a){if("string"==typeof a)return a;if(a.linkInput)return a._settings.id;"object"==typeof a?(webix.isArray(a)&&(a={data:a}),a.view=a.view||"suggest"):!0===a&&(a={view:"suggest"});return webix.ui(a).config.id}function b(a){return((a.header&&a.header[0]?a.header[0].text:a.editValue||a.label)||"").toString().replace(/<[^>]*>/g,"")}webix.editors={text:{focus:function(){this.getInputNode(this.node).focus();this.getInputNode(this.node).select()},getValue:function(){return this.getInputNode(this.node).value},
setValue:function(b){var c=this.getInputNode(this.node);c.value=b;if(b=this.config.suggest)b=this.config.suggest=a(b),(b=webix.$$(b))&&c&&b.linkInput(c)},getInputNode:function(){return this.node.firstChild},render:function(){return webix.html.create("div",{"class":"webix_dt_editor"},"<input type='text' aria-label='"+b(this.config)+"'>")}},"inline-checkbox":{render:function(){return{}},getValue:function(){return this.node.checked},setValue:function(){},focus:function(){this.node.focus()},getInputNode:function(){},
$inline:!0},"inline-text":{render:function(){return{}},getValue:function(){return this.node.value},setValue:function(){},focus:function(){try{this.node.select(),this.node.focus()}catch(c){}},getInputNode:function(){},$inline:!0},checkbox:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().checked},setValue:function(a){this.getInputNode().checked=!!a},getInputNode:function(){return this.node.firstChild.firstChild},render:function(){return webix.html.create("div",
{"class":"webix_dt_editor"},"<div><input type='checkbox' aria-label='"+b(this.config)+"'></div>")}},select:{focus:function(){this.getInputNode().focus()},getValue:function(){return this.getInputNode().value},setValue:function(a){this.getInputNode().value=a},getInputNode:function(){return this.node.firstChild},render:function(){var a="",d=this.config.options||this.config.collection;webix.assert(d,"options not defined for select editor");if(d.data&&d.data.each)d.data.each(function(b){a+="<option value='"+
b.id+"'>"+b.value+"</option>"});else if(webix.isArray(d))for(var e=0;e<d.length;e++){var f=d[e],g=webix.isUndefined(f.id);a+="<option value='"+(g?f:f.id)+"'>"+(g?f:f.value)+"</option>"}else for(e in d)a+="<option value='"+e+"'>"+d[e]+"</option>";return webix.html.create("div",{"class":"webix_dt_editor"},"<select aria-label='"+b(this.config)+"'>"+a+"</select>")}},popup:{focus:function(){this.getInputNode().focus()},destroy:function(){this.getPopup().hide()},getValue:function(){return this.getInputNode().getValue()||
""},setValue:function(a){this.getPopup().show(this.node);this.getInputNode().setValue(a)},getInputNode:function(){return this.getPopup().getChildViews()[0]},getPopup:function(){this.config._popup||(this.config._popup=this.config.popup=this.createPopup());return webix.$$(this.config.popup)},createPopup:function(){var a=this.config.popup||this.config.suggest;if(a)return"object"!=typeof a||a.name?a=webix.$$(a):(a.view=a.view||"suggest",a=webix.ui(webix.copy(a))),a._linked||(a.linkInput?a.linkInput(document.body):
this.linkInput&&this.linkInput(document.body),a._linked=!0),a;a=webix.editors.$popup[this.popupType];"string"==typeof a||a.name||(a=webix.editors.$popup[this.popupType]=webix.ui(a),this.popupInit(a),a.linkInput||this.linkInput(document.body));return a._settings.id},linkInput:function(a){webix._event(webix.toNode(a),"keydown",webix.bind(function(a){var b=a.which||a.keyCode,c=this.getInputNode();if(c.isVisible())if(c.moveSelection&&41>b&&32<b){var d;33==b&&(d="pgup");34==b&&(d="pgdown");35==b&&(d="bottom");
36==b&&(d="top");37==b&&(d="left");38==b&&(d="up");39==b&&(d="right");40==b&&(d="down");c.moveSelection(d)}else 13!==b||"TEXTAREA"===a.target.nodeName&&a.shiftKey||webix.callEvent("onEditEnd",[])},this))},popupInit:function(a){},popupType:"text",render:function(){return{}},$inline:!0}};webix.editors.color=webix.extend({focus:function(){},popupType:"color",popupInit:function(a){a.getChildViews()[0].attachEvent("onItemClick",function(a){webix.callEvent("onEditEnd",[a])})}},webix.editors.popup);webix.editors.date=
webix.extend({focus:function(){},popupType:"date",setValue:function(a){this._is_string=this.config.stringResult||a&&"string"==typeof a;webix.editors.popup.setValue.call(this,a)},getValue:function(){return this.getInputNode().getValue(this._is_string?webix.i18n.parseFormatStr:"")||""},popupInit:function(a){a.getChildViews()[0].attachEvent("onDateSelect",function(a){webix.callEvent("onEditEnd",[a])})}},webix.editors.popup);webix.editors.combo=webix.extend({_create_suggest:function(b){return this.config.popup?
this.config.popup.config.id:b?a(b):this._shared_suggest(b)},_shared_suggest:function(){var a=webix.editors.combo;return a._suggest=a._suggest||this._create_suggest(!0)},render:function(){var a=webix.html.create("div",{"class":"webix_dt_editor"},"<input type='text' role='combobox' aria-label='"+b(this.config)+"'>"),d=this.config.suggest=this._create_suggest(this.config.suggest);d&&(webix.$$(d).linkInput(a.firstChild,!0),webix._event(a.firstChild,"click",webix.bind(this.showPopup,this)));return a},
getPopup:function(){return webix.$$(this.config.suggest)},showPopup:function(){var a=this.getPopup(),b=a.getList(),e=this.getInputNode(),f=this._initial_value;a.show(e);e.setAttribute("aria-expanded","true");f?(webix.assert(b.exists(f),"Option with ID "+f+" doesn't exist"),b.exists(f)&&(b.select(f),b.showItem(f))):(b.unselect(),b.showItem(b.getFirstId()));a._last_input_target=e},afterRender:function(){this.showPopup()},setValue:function(a){this._initial_value=a;if(this.config.suggest){var b=webix.$$(this.config.suggest),
c=this.config.collection||this.config.options;c&&b.getList().data.importData(c);this.getInputNode(this.node).value=b.getItemText(a)}},getValue:function(){var a=this.getInputNode().value;if(this.config.suggest){var b=webix.$$(this.config.suggest),e=b.getList();if(a||e.getSelectedId&&e.getSelectedId())a=b.getSuggestion()}return a}},webix.editors.text);webix.editors.richselect=webix.extend({focus:function(){},getValue:function(){return this.getPopup().getValue()},setValue:function(a){var b=this.config.collection||
this.config.options;this.getInputNode();b&&this.getPopup().getList().data.importData(b);this.getPopup().show(this.node);this.getPopup().setValue(a)},getInputNode:function(){return this.getPopup().getList()},popupInit:function(a){a.linkInput(document.body)},popupType:"richselect"},webix.editors.popup);webix.editors.password=webix.extend({render:function(){return webix.html.create("div",{"class":"webix_dt_editor"},"<input type='password' aria-label='"+b(this.config)+"'>")}},webix.editors.text);webix.editors.$popup=
{text:{view:"popup",width:250,height:150,body:{view:"textarea"}},color:{view:"popup",body:{view:"colorboard"}},date:{view:"popup",width:250,height:250,padding:0,body:{view:"calendar",icons:!0,borderless:!0}},richselect:{view:"suggest",body:{view:"list",select:!0}}}})();
webix.VirtualRenderStack={$init:function(){webix.assert(this.render,"VirtualRenderStack :: Object must use RenderStack first");this._htmlmap={};webix._event(this._viewobj,"scroll",webix.bind(this._render_visible_rows,this));webix.env.touch&&this.attachEvent("onAfterScroll",webix.bind(this._render_visible_rows,this));this._unrendered_area=[]},getItemNode:function(a){return this._htmlmap[a]},showItem:function(a){var b=this._getVisibleRange();a=this.data.getIndexById(a);b=Math.floor(a/b._dx)*b._y;a=
this.getScrollState();(b<a.y||b+this._settings.height>=a.y+this._content_height)&&this.scrollTo(0,b)},render:function(a,b,c){if(this.isVisible(this._settings.id)&&!this.$blockRender)if(webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id),a){var d=this.getItemNode(a);switch(c){case "update":if(!d)break;a=this._htmlmap[a]=this._toHTMLObject(b);webix.html.insertBefore(a,d);webix.html.remove(d);break;default:this._render_delayed()}}else this.callEvent("onBeforeRender",[this.data])&&
(this._htmlmap={},this._render_visible_rows(null,!0),this._wait_for_render=!1,this.callEvent("onAfterRender",[]))},_render_delayed:function(){this._wait_for_render||(this._wait_for_render=!0,window.setTimeout(webix.bind(function(){this.render()},this),1))},_create_placeholder:function(a){webix.env.maxHTMLElementSize&&(a=Math.min(webix.env.maxHTMLElementSize,a));var b=document.createElement("DIV");b.style.cssText="height:"+a+"px; width:100%; overflow:hidden;";return b},_render_visible_rows:function(a,
b){this._unrendered_area=[];a=this._getVisibleRange();if(!this._dataobj.firstChild||b)this._dataobj.innerHTML="",this._dataobj.appendChild(this._create_placeholder(a._max)),this._htmlrows=[this._dataobj.firstChild];for(b=a._from;b<=a._height;){for(;this._htmlrows[b]&&this._htmlrows[b]._filled&&b<=a._height;)b++;if(b>a._height)break;for(var c=b;!this._htmlrows[c];)c--;var d=this._htmlrows[c],e=b*a._dx+(this.data.$min||0);if(e>(this.data.$max||Infinity))break;var f=Math.min(e+a._dx-1,this.data.$max?
this.data.$max-1:Infinity),g=this._create_placeholder(a._y);f=this.data.getIndexRange(e,f);if(!f.length)break;for(var h={$template:"Loading"},k=0;k<f.length;k++)f[k]||this._unrendered_area.push(e+k),f[k]=this._toHTML(f[k]||h);g.innerHTML=f.join("");for(k=0;k<f.length;k++)this._htmlmap[this.data.getIdByIndex(e+k)]=g.childNodes[k];e=parseFloat(d.style.height,10);c=(b-c)*a._y;e=e-c-a._y;webix.html.insertBefore(g,c?d.nextSibling:d,this._dataobj);this._htmlrows[b]=g;g._filled=!0;0>=c&&0<e?(d.style.height=
e+"px",this._htmlrows[b+1]=d):(0>c?webix.html.remove(d):d.style.height=c+"px",0<e&&(d=this._htmlrows[b+1]=this._create_placeholder(e),webix.html.insertBefore(d,g.nextSibling,this._dataobj)));b++}this._unrendered_area.length&&(a=this._unrendered_area[0],b=this._unrendered_area.pop()+1,b>a&&(b-=a,this._maybe_loading_already(b,a)||(b=Math.max(b,this._settings.datafetch||this._settings.loadahead||0),this.loadNext(b,a))))},_getVisibleRange:function(){var a=this.getScrollState().y,b=this.type,c=Math.floor(this._content_width/
b.width)||1,d=Math.floor(a/b.height),e=Math.ceil((this._content_height+a)/b.height)-1,f=this.data.$max?this.data.$max-this.data.$min:this.data.count();return{_from:d,_height:e,_top:a,_max:Math.ceil(f/c)*b.height,_y:b.height,_dx:c}},_cellPosition:function(a){var b=this.getItemNode(a);b||(this.showItem(a),this._render_visible_rows(),b=this.getItemNode(a));return{left:b.offsetLeft,top:b.offsetTop,height:b.offsetHeight,width:b.offsetWidth,parent:this._contentobj}}};
webix.protoUI({name:"dataview",$init:function(a){a.sizeToContent&&this.$ready.unshift(this._after_init_call);var b=a.prerender||this.defaults.prerender;(!1===b||!0!==b&&"auto"!==a.height&&!a.autoheight)&&webix.extend(this,webix.VirtualRenderStack,!0);a.autoheight&&(a.scroll=!1);this._contentobj.className+=" webix_dataview";this._viewobj.setAttribute("role","listbox")},_after_init_call:function(){var a=webix.html.create("DIV",0,this.type.template({}));a.style.position="absolute";document.body.appendChild(a);
this.type.width=a.offsetWidth;this.type.height=a.offsetHeight;webix.html.remove(a)},defaults:{scroll:!0,datafetch:50,navigation:!0},_id:"webix_f_id",_itemClassName:"webix_dataview_item",on_click:{webix_dataview_item:function(a,b){this._settings.select&&("multiselect"==this._settings.select||this._settings.multiselect?this.select(b,!1,"touch"==this._settings.multiselect||a.ctrlKey||a.metaKey,a.shiftKey):this.select(b))}},on_dblclick:{},on_mouse_move:{},type:{template:webix.template("#value#"),templateLoading:webix.template("Loading..."),
width:160,height:50,classname:function(a,b,c){var d="webix_dataview_item ";b.css&&(d+=b.css+" ");a.$css&&("object"==typeof a.$css&&(a.$css=webix.html.createCss(a.$css)),d+=a.$css+" ");c&&c.$css&&(d+=c.$css+" ");return d},aria:function(a,b,c){return'role="option"'+(c&&c.webix_selected?' aria-selected="true" tabindex="0"':' tabindex="-1"')},templateStart:webix.template('<div webix_f_id="#id#" class="{common.classname()}" {common.aria()} style="width:{common.width}px; height:{common.height}px; float:left; overflow:hidden;">'),
templateEnd:webix.template("</div>")},_calck_autoheight:function(a){return this._settings.height=this.type.height*Math.ceil(this.data.count()/Math.floor(a/this.type.width))},autoheight_setter:function(a){a&&(this.data.attachEvent("onStoreLoad",webix.bind(this.resize,this)),this._contentobj.style.overflowY="hidden");return a},$getSize:function(a,b){0<this._settings.xCount&&"auto"!=this.type.width&&!this._autowidth&&(this._settings.width=this.type.width*this._settings.xCount+(this._scroll_y?webix.ui.scrollSize:
0));this._settings.yCount&&"auto"!=this.type.height&&(this._settings.height=this.type.height*this._settings.yCount);var c=this._settings.width||this._content_width;this._settings.autoheight&&c&&(this._calck_autoheight(c),this.scroll_setter(!1));return webix.ui.view.prototype.$getSize.call(this,a,b)},_recalk_counts:function(){var a=!1;this._settings.yCount&&"auto"==this.type.height&&(this.type.height=Math.floor(this._content_height/this._settings.yCount),a=!0);this._settings.xCount&&("auto"==this.type.width||
this._autowidth)?(this._autowidth=!0,this.type.width=Math.floor(this._content_width/this._settings.xCount),a=!0):this._autowidth=!1;return a},$setSize:function(a,b){if(webix.ui.view.prototype.$setSize.call(this,a,b)){if(this._settings.autoheight&&this._calck_autoheight()!=this._content_height)return webix.delay(this.resize,this);(this._recalk_counts()||this._render_visible_rows)&&this.render()}}},webix.DataMove,webix.DragItem,webix.MouseEvents,webix.KeysNavigation,webix.SelectionModel,webix.Scrollable,
webix.CustomPrint,webix.ui.proto);
webix.DataDriver.htmltable={toObject:function(a){a=webix.toNode(a);webix.assert(a,"table is not found");webix.assert("table"===a.tagName.toLowerCase(),"Incorrect table object");var b=a.rows;webix.html.remove(a);return b},getRecords:function(a){for(var b=[],c=a[0]&&a[0]._webix_skip?1:0;c<a.length;c++)b.push(a[c]);return b},getDetails:function(a){var b=a.getElementsByTagName("td");a={};for(var c=0;c<b.length;c++)a["data"+c]=b[c].innerHTML;return a},getInfo:function(a){return{size:0}},getOptions:function(){},
getConfig:function(a){var b=[],c=a[0].getElementsByTagName("th");c.length&&(a[0]._webix_skip=!0);for(a=0;a<c.length;a++){var d={id:"data"+a,header:this._de_json(c[a].innerHTML)},e=this._get_attrs(c[a]);d=webix.extend(d,e);b.push(d)}return b},_de_json:function(a){var b=a.indexOf("json://");-1!=b&&(a=JSON.parse(a.substr(b+7)));return a},_get_attrs:function(a){a=a.attributes;for(var b={},c=0;c<a.length;c++)b[a[c].nodeName]=this._de_json(a[c].nodeValue);b.width=parseInt(b.width,10);return b}};
webix.protoUI({name:"vscroll",defaults:{scroll:"x",scrollStep:40,scrollPos:0,scrollSize:18,scrollVisible:1,zoom:1},$init:function(a){var b=a.scroll||"x";a=this._viewobj=webix.toNode(a.container);a.className+=" webix_vscroll_"+b;a.innerHTML="<div class='webix_vscroll_body'></div>";webix._event(a,"scroll",this._onscroll,{bind:this});this._last_scroll_pos=this._last_set_size=0},reset:function(){this._last_scroll_pos=this.config.scrollPos=0;this._viewobj["x"==this.config.scroll?"scrollLeft":"scrollTop"]=
0},_check_quantum:function(a){15E5<a?(this._settings.zoom=Math.floor(a/15E5)+1,this._zoom_limit=a-this._last_set_size,a=Math.floor(a/this._settings.zoom)+this._last_set_size):(this._settings.zoom=1,this._zoom_limit=Infinity);return a},scrollWidth_setter:function(a){a=this._check_quantum(a);this._viewobj.firstChild.style.width=a+"px";return a},scrollHeight_setter:function(a){a=this._check_quantum(a);this._viewobj.firstChild.style.height=a+"px";return a},sizeTo:function(a,b,c){a=a-(b||0)-(c||0);c=this._settings.scrollSize;
webix.env.isIE&&c&&(c+=1);c||!this._settings.scrollVisible||webix.env.$customScroll||(this._viewobj.style.pointerEvents="none",c=14);c?(this._viewobj.style.display="block",b&&(this._viewobj.style.marginTop=b+"px"),this._viewobj.style["x"==this._settings.scroll?"width":"height"]=Math.max(0,a)+"px",this._viewobj.style["x"==this._settings.scroll?"height":"width"]=c+"px"):this._viewobj.style.display="none";this._last_set_size=a},getScroll:function(){return this._settings.scrollPos*this._settings.zoom},
getSize:function(){return(this._settings.scrollWidth||this._settings.scrollHeight)*this._settings.zoom},scrollTo:function(a){0>a&&(a=0);var b=this._settings;a=Math.min(((b.scrollWidth||b.scrollHeight)-this._last_set_size)*b.zoom,a);0>a&&(a=0);a/=b.zoom;if(this._last_scroll_pos!=a)return this._viewobj["x"==b.scroll?"scrollLeft":"scrollTop"]=a,this._onscroll_inner(a),!0},_onscroll:function(){var a=this._viewobj["x"==this._settings.scroll?"scrollLeft":"scrollTop"];a!=this._last_scroll_pos&&this._onscroll_inner(a)},
_onscroll_inner:function(a){this._last_scroll_pos=a;this._settings.scrollPos=Math.min(this._zoom_limit,a*this._settings.zoom)||0;this.callEvent("onScroll",[this._settings.scrollPos])},activeArea:function(a,b){this._x_scroll_mode=b;webix._event(a,webix.env.isIE8?"mousewheel":"wheel",this._on_wheel,{bind:this});this._add_touch_events(a)},_add_touch_events:function(a){!webix.env.touch&&window.navigator.pointerEnabled&&(webix.html.addCss(a,"webix_scroll_touch_ie",!0),webix._event(a,"pointerdown",function(a){if("touch"==
a.pointerType||"pen"==a.pointerType)this._start_context=webix.Touch._get_context_m(a),this._start_scroll_pos=this._settings.scrollPos},{bind:this}),webix.event(document.body,"pointermove",function(a){var b;this._start_context&&(this._current_context=webix.Touch._get_context_m(a),"x"==this._settings.scroll?b=this._current_context.x-this._start_context.x:"y"==this._settings.scroll&&(b=this._current_context.y-this._start_context.y),b&&5<Math.abs(b)&&this.scrollTo(this._start_scroll_pos-b))},{bind:this}),
webix.event(window,"pointerup",function(a){this._start_context&&(this._start_context=this._current_context=null)},{bind:this}))},_on_wheel:function(a){var b=0,c=0===a.deltaMode?30:1;webix.env.isIE8&&(b=a.detail=-a.wheelDelta/30);a.deltaX&&Math.abs(a.deltaX)>Math.abs(a.deltaY)?this._x_scroll_mode&&this._settings.scrollVisible&&(b=a.deltaX/c):!this._x_scroll_mode&&this._settings.scrollVisible&&(b=webix.isUndefined(a.deltaY)?a.detail:a.deltaY/c);webix.env.isSafari&&(this._scroll_trg=a.target||a.srcElement);
if(b&&this.scrollTo(this._settings.scrollPos+b*this._settings.scrollStep))return webix.html.preventEvent(a)}},webix.EventSystem,webix.Settings);
webix.Number={getConfig:function(a){var b={decimalSize:0,groupSize:999},c=a.indexOf("0");0<c&&(b.decimalSize=a.length-c,b.decimalDelimiter=a[c-1],a=a.substr(0,c-1));if(c=a.match(/[^0-9]/))b.groupSize=a.length-c.index-1,b.groupDelimiter=a[c.index];return b},parse:function(a,b){if("string"!==typeof a)return a;var c="";if(b.decimalDelimiter){var d=a.indexOf(b.decimalDelimiter);-1<d&&(c=a.substr(d+1).replace(/[^0-9]/g,""),c=c.substr(0,Math.min(c.length,b.decimalSize)),a=a.substr(0,d))}(a=a.replace(/[^0-9]/g,
""))||(a="0");c&&(a+="."+c);return parseFloat(a)},format:function(a,b){if(""===a||"undefined"===typeof a)return a;b=b||webix.i18n;a=parseFloat(a);var c=0>a?"-":"";a=Math.abs(a);b.decimalOptional||(a=a.toFixed(b.decimalSize));a=a.toString();a=a.split(".");var d="";if(b.groupSize){var e=b.groupSize,f=a[0].length;do f-=e,d=(0<f?a[0].substr(f,e):a[0].substr(0,e+f))+(d?b.groupDelimiter+d:"");while(0<f)}else d=a[0];return b.decimalSize?c+d+(a[1]?b.decimalDelimiter+a[1]:""):c+d},numToStr:function(a){return function(b){return webix.Number.format(b,
a)}}};
webix.Date={startOnMonday:!1,toFixed:function(a){return 10>a?"0"+a:a},weekStart:function(a){a=this.copy(a);var b=a.getDay();this.startOnMonday&&(0===b?b=6:b--);return this.datePart(this.add(a,-1*b,"day"))},monthStart:function(a){a=this.copy(a);a.setDate(1);return this.datePart(a)},yearStart:function(a){a=this.copy(a);a.setMonth(0);return this.monthStart(a)},dayStart:function(a){return this.datePart(a,!0)},dateToStr:function(a,b){if("function"==typeof a)return a;if(webix.env.strict)return function(b){var c="",
e=0;a.replace(/%[a-zA-Z]/g,function(d,g){c+=a.slice(e,g);c+=function(a){if("%d"==d)return webix.Date.toFixed(a.getDate());if("%m"==d)return webix.Date.toFixed(a.getMonth()+1);if("%j"==d)return a.getDate();if("%n"==d)return a.getMonth()+1;if("%y"==d)return webix.Date.toFixed(a.getFullYear()%100);if("%Y"==d)return a.getFullYear();if("%D"==d)return webix.i18n.calendar.dayShort[a.getDay()];if("%l"==d)return webix.i18n.calendar.dayFull[a.getDay()];if("%M"==d)return webix.i18n.calendar.monthShort[a.getMonth()];
if("%F"==d)return webix.i18n.calendar.monthFull[a.getMonth()];if("%h"==d)return webix.Date.toFixed((a.getHours()+11)%12+1);if("%g"==d)return(a.getHours()+11)%12+1;if("%G"==d)return a.getHours();if("%H"==d)return webix.Date.toFixed(a.getHours());if("%i"==d)return webix.Date.toFixed(a.getMinutes());if("%a"==d)return 11<a.getHours()?webix.i18n.pm[0]:webix.i18n.am[0];if("%A"==d)return 11<a.getHours()?webix.i18n.pm[1]:webix.i18n.am[1];if("%s"==d)return webix.Date.toFixed(a.getSeconds());if("%S"==d)return webix.Date.toFixed(a.getMilliseconds());
if("%W"==d)return webix.Date.toFixed(webix.Date.getISOWeek(a));if("%c"==d){var b=a.getFullYear();b+="-"+webix.Date.toFixed(a.getMonth()+1);b+="-"+webix.Date.toFixed(a.getDate());b=b+"T"+webix.Date.toFixed(a.getHours());b+=":"+webix.Date.toFixed(a.getMinutes());return b+=":"+webix.Date.toFixed(a.getSeconds())}return d}(b);e=g+2});return c+=a.slice(e,a.length)};a=a.replace(/%[a-zA-Z]/g,function(a){switch(a){case "%d":return'"+webix.Date.toFixed(date.getDate())+"';case "%m":return'"+webix.Date.toFixed((date.getMonth()+1))+"';
case "%j":return'"+date.getDate()+"';case "%n":return'"+(date.getMonth()+1)+"';case "%y":return'"+webix.Date.toFixed(date.getFullYear()%100)+"';case "%Y":return'"+date.getFullYear()+"';case "%D":return'"+webix.i18n.calendar.dayShort[date.getDay()]+"';case "%l":return'"+webix.i18n.calendar.dayFull[date.getDay()]+"';case "%M":return'"+webix.i18n.calendar.monthShort[date.getMonth()]+"';case "%F":return'"+webix.i18n.calendar.monthFull[date.getMonth()]+"';case "%h":return'"+webix.Date.toFixed((date.getHours()+11)%12+1)+"';
case "%g":return'"+((date.getHours()+11)%12+1)+"';case "%G":return'"+date.getHours()+"';case "%H":return'"+webix.Date.toFixed(date.getHours())+"';case "%i":return'"+webix.Date.toFixed(date.getMinutes())+"';case "%a":return'"+(date.getHours()>11?webix.i18n.pm[0]:webix.i18n.am[0])+"';case "%A":return'"+(date.getHours()>11?webix.i18n.pm[1]:webix.i18n.am[1])+"';case "%s":return'"+webix.Date.toFixed(date.getSeconds())+"';case "%S":return'"+webix.Date.toFixed(date.getMilliseconds())+"';case "%W":return'"+webix.Date.toFixed(webix.Date.getISOWeek(date))+"';
case "%c":return a='"+date.getFullYear()+"-"+webix.Date.toFixed((date.getMonth()+1))+"-"+webix.Date.toFixed(date.getDate())+"T"+webix.Date.toFixed(date.getHours())+":"+webix.Date.toFixed(date.getMinutes())+":"+webix.Date.toFixed(date.getSeconds())+"',!0===b&&(a+="Z"),a;default:return a}});!0===b&&(a=a.replace(/date\.get/g,"date.getUTC"));return new Function("date","if (!date) return ''; if (!date.getMonth) date=webix.i18n.parseFormatDate(date);  return \""+a+'";')},strToDate:function(a,b){if("function"==
typeof a)return a;var c=a.match(/%[a-zA-Z]/g);a="var temp=date.split(/[^0-9a-zA-Z]+/g);";var d;if(!webix.i18n.calendar.monthShort_hash){var e=webix.i18n.calendar.monthShort;var f=webix.i18n.calendar.monthShort_hash={};for(d=0;d<e.length;d++)f[e[d]]=d;e=webix.i18n.calendar.monthFull;f=webix.i18n.calendar.monthFull_hash={};for(d=0;d<e.length;d++)f[e[d]]=d}if(webix.env.strict)return function(a){if(!a)return"";if("object"==typeof a)return a;var e=a.split(/[^0-9a-zA-Z]+/g),f=[0,0,1,0,0,0,0];for(d=0;d<
c.length;d++){var g=c[d];"%y"==g?f[0]=1*e[d]+(30<e[d]?1900:2E3):"%Y"==g?(f[0]=1*(e[d]||0),30>f[0]&&(f[0]+=2E3)):"%n"==g||"%m"==g?f[1]=(e[d]||1)-1:"%M"==g?f[1]=webix.i18n.calendar.monthShort_hash[e[d]]||0:"%F"==g?f[1]=webix.i18n.calendar.monthFull_hash[e[d]]||0:"%j"==g||"%d"==g?f[2]=e[d]||1:"%g"==g||"%G"==g||"%h"==g||"%H"==g?f[3]=e[d]||0:"%a"==g?f[3]=f[3]%12+((e[d]||"")==webix.i18n.am[0]?0:12):"%A"==g?f[3]=f[3]%12+((e[d]||"")==webix.i18n.am[1]?0:12):"%i"==g?f[4]=e[d]||0:"%s"==g?f[5]=e[d]||0:"%S"==
g?f[6]=e[d]||0:"%c"==g&&(g=/(\d+)-(\d+)-(\d+)T(\d+):(\d+):(\d+)(\+.*|)/g.exec(a),f[0]=1*(g[1]||0),30>f[0]&&(f[0]+=2E3),f[1]=(g[2]||1)-1,f[2]=g[3]||1,f[3]=g[4]||0,f[4]=g[5]||0,f[5]=g[6]||0)}return b?new Date(Date.UTC(f[0],f[1],f[2],f[3],f[4],f[5],f[6])):new Date(f[0],f[1],f[2],f[3],f[4],f[5],f[6])};for(d=0;d<c.length;d++)switch(c[d]){case "%j":case "%d":a+="set[2]=temp["+d+"]||1;";break;case "%n":case "%m":a+="set[1]=(temp["+d+"]||1)-1;";break;case "%y":a+="set[0]=temp["+d+"]*1+(temp["+d+"]>30?1900:2000);";
break;case "%g":case "%G":case "%h":case "%H":a+="set[3]=temp["+d+"]||0;";break;case "%i":a+="set[4]=temp["+d+"]||0;";break;case "%Y":a+="set[0]=(temp["+d+"]||0)*1; if (set[0]<30) set[0]+=2000;";break;case "%a":a+="set[3]=set[3]%12+(temp["+d+"]==webix.i18n.am[0]?0:12);";break;case "%A":a+="set[3]=set[3]%12+(temp["+d+"]==webix.i18n.am[1]?0:12);";break;case "%s":a+="set[5]=temp["+d+"]||0;";break;case "%S":a+="set[6]=temp["+d+"]||0;";break;case "%M":a+="set[1]=webix.i18n.calendar.monthShort_hash[temp["+
d+"]]||0;";break;case "%F":a+="set[1]=webix.i18n.calendar.monthFull_hash[temp["+d+"]]||0;";break;case "%c":a+="var res = date.split('T');",a+="if(res[0]){ var d = res[0].split('-');",a+="set[0]= (d[0]||0)*1; if (set[0]<30) set[0]+=2000;",a+="set[1]= (d[1]||1)-1;",a+="set[2]= d[2]||1;}",a+="if(res[1]){ var t = res[1].split(':');",a+="set[3]= t[0]||0;",a+="set[4]= t[1]||0;",a+="set[5]= parseInt(t[2])||0;}"}f="set[0],set[1],set[2],set[3],set[4],set[5], set[6]";b&&(f=" Date.UTC("+f+")");return new Function("date",
"if (!date) return ''; if (typeof date == 'object') return date; var set=[0,0,1,0,0,0,0]; "+a+" return new Date("+f+");")},getISOWeek:function(a){if(!a)return!1;var b=a.getDay();0===b&&(b=7);var c=new Date(a.valueOf());c.setDate(a.getDate()+(4-b));a=c.getFullYear();c=Math.floor((c.getTime()-(new Date(a,0,1)).getTime())/864E5);return 1+Math.floor(c/7)},getUTCISOWeek:function(a){return this.getISOWeek(a)},_correctDate:function(a,b,c,d){if(c){var e=d(a,b);if(e)for(var f=0<c?1:-1;e;)a.setHours(a.getHours()+
f),e=d(a,b),f+=0<c?1:-1}},add:function(a,b,c,d){d&&(a=this.copy(a));d=webix.Date.copy(a);switch(c){case "day":a.setDate(a.getDate()+b);this._correctDate(a,d,b,function(a,b){return webix.Date.datePart(b,!0).valueOf()==webix.Date.datePart(a,!0).valueOf()});break;case "week":a.setDate(a.getDate()+7*b);this._correctDate(a,d,7*b,function(a,b){return webix.Date.datePart(b,!0).valueOf()==webix.Date.datePart(a,!0).valueOf()});break;case "month":a.setMonth(a.getMonth()+b);this._correctDate(a,d,b,function(a,
b){return b.getMonth()==a.getMonth()&&b.getYear()==a.getYear()});break;case "year":a.setYear(a.getFullYear()+b);this._correctDate(a,d,b,function(a,b){return b.getFullYear()==a.getFullYear()});break;case "hour":a.setHours(a.getHours()+b);this._correctDate(a,d,b,function(a,b){return b.getHours()==a.getHours()&&webix.Date.datePart(b,!0)==webix.Date.datePart(a,!0)});break;case "minute":a.setMinutes(a.getMinutes()+b);break;default:webix.Date.add[c](a,b,c)}return a},datePart:function(a,b){b&&(a=this.copy(a));
b=this.copy(a);b.setHours(0);b.getDate()!=a.getDate()?a.setHours(1):a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},timePart:function(a,b){b&&(a=this.copy(a));return(a.valueOf()/1E3-60*a.getTimezoneOffset())%86400},copy:function(a){return new Date(a.valueOf())},equal:function(a,b){return a&&b?a.valueOf()===b.valueOf():!1},isHoliday:function(a){a=a.getDay();if(0===a||6==a)return"webix_cal_event"}};
webix.i18n={_dateMethods:"fullDateFormat timeFormat dateFormat longDateFormat parseFormat parseTimeFormat".split(" "),parseFormat:"%Y-%m-%d %H:%i",parseTimeFormat:"%H:%i",numberFormat:webix.Number.format,priceFormat:function(a){return webix.i18n._price_format(webix.i18n.numberFormat(a,webix.i18n._price_settings))},setLocale:function(a){var b=function(a,c){for(var d in c)"object"!=typeof c[d]||webix.isArray(c[d])?a[d]=c[d]:(a[d]||(a[d]={}),b(a[d],c[d]))};"string"==typeof a&&(a=this.locales[a]);a&&
b(this,a);a=webix.i18n._dateMethods;for(var c=0;c<a.length;c++){var d=a[c],e=webix.i18n[d+"UTC"];webix.i18n[d+"Str"]=webix.Date.dateToStr(webix.i18n[d],e);webix.i18n[d+"Date"]=webix.Date.strToDate(webix.i18n[d],e)}this._price_format=webix.template(this.price);this._price_settings=this.priceSettings||this;this.intFormat=webix.Number.numToStr({groupSize:this.groupSize,groupDelimiter:this.groupDelimiter,decimalSize:0})}};webix.i18n.locales={};
webix.i18n.locales["en-US"]={groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2,dateFormat:"%m/%d/%Y",timeFormat:"%h:%i %A",longDateFormat:"%d %F %Y",fullDateFormat:"%m/%d/%Y %h:%i %A",am:["am","AM"],pm:["pm","PM"],price:"${obj}",priceSettings:{groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2},fileSize:"b Kb Mb Gb Tb Pb Eb".split(" "),calendar:{monthFull:"January February March April May June July August September October November December".split(" "),monthShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
dayFull:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today"},controls:{select:"Select",invalidMessage:"Invalid input value"},dataExport:{page:"Page",of:"of"},PDFviewer:{of:"of",automaticZoom:"Automatic Zoom",actualSize:"Actual Size",pageFit:"Page Fit",pageWidth:"Page Width",pageHeight:"Page Height"},aria:{calendar:"Calendar",increaseValue:"Increase value",decreaseValue:"Decrease value",
navMonth:["Previous month","Next month"],navYear:["Previous year","Next year"],navDecade:["Previous decade","Next decade"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Hours: %h %A",minuteFormat:"Minutes: %i",removeItem:"Remove item",pages:["First page","Previous page","Next page","Last page"],page:"Page",headermenu:"Header menu",openGroup:"Open column group",closeGroup:"Close column group",closeTab:"Close tab",showTabs:"Show more tabs",resetTreeMap:"Reset tree map",navTreeMap:"Level up",
nextTab:"Next tab",prevTab:"Previous tab",multitextSection:"Add section",multitextextraSection:"Remove section",showChart:"Show chart",hideChart:"Hide chart",resizeChart:"Resize chart"},richtext:{underline:"Underline",bold:"Bold",italic:"Italic"},combo:{selectAll:"Select all",unselectAll:"Unselect all"}};webix.i18n.setLocale("en-US");
webix.protoUI({name:"datatable",defaults:{leftSplit:0,rightSplit:0,topSplit:0,columnWidth:100,minColumnWidth:20,minColumnHeight:26,prerender:!1,autoheight:!1,autowidth:!1,header:!0,fixedRowHeight:!0,scrollAlignY:!0,scrollX:!0,scrollY:!0,datafetch:50,navigation:!0},$skin:function(){var a=this.defaults;a.rowHeight=webix.skin.$active.rowHeight;a.headerRowHeight=webix.skin.$active.barHeight},on_click:{webix_richfilter:function(){return!1},webix_table_checkbox:function(a,b){b=this.locate(a);var c=this.getItem(b.row),
d=this.getColumnConfig(b.column);a=a.target||a.srcElement;c=("checkbox"==a.type?a.checked:c[b.column]!=d.checkValue)?d.checkValue:d.uncheckValue;d={};d[b.column]=c;this.updateItem(b.row,d,this._settings.checkboxRefresh?"update":"save");this.callEvent("onCheck",[b.row,b.column,c]);return!1},webix_table_radio:function(a){var b=this.locate(a);a=this.getItem(b.row);var c=this.getColumnConfig(b.column);this.eachRow(function(a){(a=this.data.pull[a])&&a[b.column]==c.checkValue&&(a[b.column]=c.uncheckValue)});
a[b.column]=c.checkValue;this.callEvent("onCheck",[b.row,b.column,!0]);this.refresh();return!1}},on_dblclick:{webix_table_checkbox:function(){return this.on_click.webix_table_checkbox.apply(this,arguments)}},on_context:{},$init:function(a){this.on_click=webix.extend({},this.on_click);this._contentobj.innerHTML="<div class='webix_ss_header'><div class='webix_hs_left'></div><div class='webix_hs_center'></div><div class='webix_hs_right'></div></div><div class='webix_ss_body'><div class='webix_ss_left'><div class='webix_ss_center_scroll'></div></div><div class='webix_ss_center'><div class='webix_ss_center_scroll' role='rowgroup'></div></div><div class='webix_ss_right'><div class='webix_ss_center_scroll'></div></div></div><div class='webix_ss_hscroll' role='scrollbar' aria-orientation='horizontal'></div><div class='webix_ss_footer'><div class='webix_hs_left'></div><div class='webix_hs_center'></div><div class='webix_hs_right'></div></div><div class='webix_ss_vscroll_header'></div><div class='webix_ss_vscroll' role='scrollbar' aria-orientation='vertical'></div><div class='webix_ss_vscroll_footer'></div>";
this._top_id=this._contentobj.id=this.name+webix.uid();this._contentobj.className+=" webix_dtable";this._dataobj=this._contentobj;this._header=this._contentobj.firstChild;this._body=this._header.nextSibling;this._footer=this._body.nextSibling.nextSibling;this._viewobj.setAttribute("role","grid");a.editable||this._viewobj.setAttribute("aria-readonly","true");this.data.provideApi(this,!0);this.data.attachEvent("onParse",webix.bind(this._call_onparse,this));this.$ready.push(this._first_render);this._columns=
[];this._hidden_column_order=[];this._headers=[];this._footers=[];this._rows_cache=[];this._active_headers={};this._filter_elements={};this._header_height=this._footer_height=0;this._destroy_with_me=[];this.data.attachEvent("onServerConfig",webix.bind(this._config_table_from_file,this));this.data.attachEvent("onServerOptions",webix.bind(this._config_options_from_file,this));this.attachEvent("onViewShow",function(){this._restore_scroll_state();this._refresh_any_header_content()});this.data.attachEvent("onClearAll",
webix.bind(function(a){a||(this._scrollLeft=this._scrollTop=0,this._x_scroll&&this._x_scroll.reset(),this._y_scroll&&this._y_scroll.reset(),this._setLeftScroll(0))},this));this.attachEvent("onDestruct",this._clean_config_struct);this.attachEvent("onKeyPress",this._onKeyPress);this.attachEvent("onScrollY",this._adjust_rows);webix.callEvent("onDataTable",[this,a])},_render_initial:function(){this._scrollSizeX=this._scrollSizeY=webix.ui.scrollSize;webix.html.addStyle("#"+this._top_id+" .webix_cell { height:"+
this._settings.rowHeight+"px; line-height:"+(this._settings.rowLineHeight||this._settings.rowHeight)+"px;"+(this._settings.fixedRowHeight?"":"white-space:normal;")+" }");webix.html.addStyle("#"+this._top_id+" .webix_hcell { height:"+this._settings.headerRowHeight+"px; line-height:"+this._settings.headerRowHeight+"px;}");this._render_initial=function(){}},_first_render:function(){this.data.attachEvent("onStoreLoad",webix.bind(this._refresh_any_header_content,this));this.data.attachEvent("onSyncApply",
webix.bind(this._refresh_any_header_content,this));this.data.attachEvent("onStoreUpdated",webix.bind(function(){return this.render.apply(this,arguments)},this));this.data.attachEvent("onStoreUpdated",webix.bind(this._refresh_tracking_header_content,this));this.render()},refresh:function(){this.render()},render:function(a,b,c){if("save"!=c){if("move"==c){var d=webix.DragControl.getContext();if(d&&d.fragile)return}if(!this._columns.length){d=this._settings.columns;if(!d||!d.length)if(this._settings.autoConfig&&
this.data.order.length&&!this._hidden_column_order.length)this._dtable_fully_ready=0,this._autoDetectConfig();else return;this._define_structure()}if(!this.isVisible(this._settings.id)||this.$blockRender)return this._render_initial();if(!a||-1==b||"paint"!=c&&"update"!=c){if(this._render_timer&&(clearTimeout(this._render_timer),this._render_timer=0),this.callEvent("onBeforeRender",[this.data]))return this._render_initial(),this._dtable_fully_ready||this._apply_headers(),this._content_width&&(this.config.experimental&&
("paint"==c||"update"==c)&&a?this._repaint_single_row(a):this._check_rendered_cols(!0,!0)),a&&"update"==c||(this._dtable_height=this._get_total_height(),this._set_split_sizes_y()),this._viewobj.setAttribute("aria-colcount",Math.max(this._hidden_column_order.length,this._columns.length)),this._viewobj.setAttribute("aria-rowcount",this.data.count()),this.callEvent("onAfterRender",[this.data]),!0}else this._render_timer&&clearTimeout(this._render_timer),this._render_timer&&this._render_timer_id!=a?(this._render_timer_id=
null,this._render_timer=webix.delay(function(){this.render()},this)):(this._render_timer_id=a,this._render_timer=webix.delay(function(){this.render(a,-1,c)},this))}},getColumnConfig:function(a){return this._columns_pull[a]||this._hidden_column_hash[a]},_config_options_from_file:function(a){for(var b in a){var c=this.getColumnConfig(b);webix.assert(c,"Orphan collection: "+b);var d=new webix.DataCollection({data:a[b]});this._destroy_with_me.push(d);this._bind_collection(d,c)}},_config_table_from_file:function(a){a.columns&&
this._dtable_fully_ready&&this.refreshColumns(null,!0)},_define_structure:function(){if(this._settings.columns){this._columns=this._settings.columns;this._columns_pull={};for(var a=0;a<this._columns.length;a++){var b=this._columns[a];this._columns_pull[b.id]=b;var c=b.cssFormat;c&&(b.cssFormat=webix.toFunctor(c,this.$scope));b.width=b.width||this._settings.columnWidth;"string"==typeof b.format&&(b.format=webix.i18n[b.format]||window[b.format]);if(b.numberFormat){var d=b.numberFormat;"string"===typeof d&&
(b.numberFormat=d=webix.Number.getConfig(d));b.format=webix.Number.numToStr(d);b.editFormat=b.editFormat||function(a){return webix.Number.format(a,d)};b.editParse=b.editParse||function(a){return webix.Number.parse(a,d)}}webix.isUndefined(b.checkValue)&&(b.checkValue=1);webix.isUndefined(b.uncheckValue)&&(b.uncheckValue=0);b.css&&"object"==typeof b.css&&(b.css=webix.html.createCss(b.css));if(c=b.template)"string"==typeof c&&(c=c.replace(/#\$value#/g,"#"+b.id+"#")),b.template=webix.template(c)}this._normalize_headers("header",
this._headers);this._normalize_headers("footer",this._footers);this.callEvent("onStructureLoad",[])}},_define_structure_and_render:function(){this._apply_headers()},_clean_config_struct:function(){for(var a=0;a<this._columns.length;a++)delete this._columns[a].attached,delete this._columns[a].node},_apply_headers:function(){this._rightSplit=this._columns.length-this._settings.rightSplit;for(var a=this._dtable_width=0;a<this._columns.length;a++){if(!this._columns[a].node){var b=webix.html.create("DIV");
b.style.width=this._columns[a].width+"px";this._columns[a].node=b}a>=this._settings.leftSplit&&a<this._rightSplit&&(this._dtable_width+=this._columns[a].width)}b=[];this._settings.rightSplit&&(a=this._columns.length-this._settings.rightSplit,b[a]=" webix_first",b[a-1]=" webix_last");this._settings.leftSplit&&(a=this._settings.leftSplit,b[a]=" webix_first",b[a-1]=" webix_last");b[0]=(b[0]||"")+" webix_first";a=this._columns.length-1;b[a]=(b[a]||"")+" webix_last";for(a=0;a<this._columns.length;a++){var c=
this._columns[a].node;c.setAttribute("column",a);c.className="webix_column "+(this._columns[a].css||"")+(b[a]||"")}this._create_scrolls();this._set_columns_positions();this._set_split_sizes_x();this._render_header_and_footer();this._dtable_fully_ready=!0},_set_columns_positions:function(){for(var a=0,b=0;b<this._columns.length;b++){var c=this._columns[b];if(b==this._settings.leftSplit||b==this._rightSplit)a=0;c.node&&(c.node.style.left=a+"px",this._settings.leftSplit||this._settings.rightSplit)&&
(webix.html.remove(c.node),c.attached=!1);a+=c.width}},_render_header_and_footer:function(){this._header_fix_width||(this._header_fix_width=0);this._header_height=this._footer_height=0;this._settings.header&&(this._refreshHeaderContent(this._header,0,1),this._normalize_headers("header",this._headers),this._header_height=this._headers._summ,this._render_header_section(this._header,"header",this._headers));this._settings.footer&&(this._refreshHeaderContent(this._footer,0,1),this._normalize_headers("footer",
this._footers),this._footer_height=this._footers._summ,this._render_header_section(this._footer,"footer",this._footers));this.refreshHeaderContent(!1,!1);this._size_header_footer_fix();this._last_sorted&&this.markSorting(this._last_sorted,this._last_order)},_getHeaderHeight:function(a,b,c){b=0;var d=a.colspan||1,e="webix_hcell "+(a.css||"");if(a.rotate)e+=" webix_measure_rotate";else for(var f=0;f<d;f++)b+=this._columns[c+f]?this._columns[c+f].width:this.config.columnWidth;c=webix.html.getTextSize([a.text],
e,b);return(a.rotate?c.width:c.height)+1},_normalize_headers:function(a,b){for(var c=0,d=0;d<this._columns.length;d++){var e=this._columns[d][a];e&&"object"==typeof e&&e.length||(webix.isUndefined(e)&&(e="header"==a?this._columns[d].id:""),e=[e]);for(var f=0;f<e.length;f++)"object"!=typeof e[f]&&(e[f]={text:e[f]}),e[f]&&e[f].height&&(b[f]=e[f].height),e[f]&&e[f].autoheight&&(b[f]=this._getHeaderHeight(e[f],this._columns[d],d));c=Math.max(c,e.length);this._columns[d][a]=e}b._summ=c;for(d=c-1;0<=d;d--)b[d]=
b[d]||this._settings.headerRowHeight,b._summ+=1*b[d];for(d=0;d<this._columns.length;d++)for(e=this._columns[d][a],f=0;f<e.length;f++){if(e[f]&&e[f].rowspan)for(b=1;b<e[f].rowspan;b++)e[f+b]=null;if(e[f]&&e[f].colspan)for(b=1;b<e[f].colspan;b++)this._columns[d+b][a][f]=null}for(d=0;d<this._columns.length;d++)if(e=this._columns[d][a],e.length<c)for(f=e.length-1,e[f].rowspan=c-e.length+1,f+=1;f<c;f++)e[f]=null;return c},_find_header_content:function(a,b){a=a.getElementsByTagName("TD");for(var c=0;c<
a.length;c++)if(a[c].getAttribute("active_id")==b)return a[c]},getHeaderContent:function(a){var b=this._find_header_content(this._header,a);b||(b=this._find_header_content(this._footer,a));if(b){a=this._active_headers[a];var c=webix.ui.datafilter[a.content];return c.getHelper?c.getHelper(b,a):{type:c,getValue:function(){return c.getValue(b)},setValue:function(a){return c.setValue(b,a)}}}},_summ_next:function(a,b,c){var d=c?-1:0;c+=b;for(b;b<c;b++)d+=a[b]+1;return d},_render_subheader:function(a,b,
c,d,e){if(a==b)return"";c="<table role='presentation' style='width:"+c+"px' cellspacing='0' cellpadding='0'>";for(var f=a;f<b;f++){c+="<tr class='webix_size_row'>";for(f=a;f<b;f++)c+="<td style='width:"+this._columns[f].width+"px;'></td>";c+="</tr>"}for(var g=this._columns[0][d].length,h=0;h<g;h++){c+="<tr section='"+d+"' role='row'>";for(f=a;f<b;f++){var k=this._columns[f][d][h];if(null!==k){k.content&&(k.contentId=k.contentId||webix.uid(),k.columnId=this._columns[f].id,k.format=this._columns[f].format,
webix.assert(webix.ui.datafilter,"Filtering extension was not included"),webix.assert(webix.ui.datafilter[k.content],"Unknown content type: "+k.content),k.text=webix.ui.datafilter[k.content].render(this,k),this._active_headers[k.contentId]=k,this._has_active_headers=!0);c+="<td  role='presentation' column='"+(k.colspan?k.colspan-1+f:f)+"'";var l="";f==a&&(l+="webix_first");f+(k.colspan?k.colspan-1:0)>=b-1&&(l+=" webix_last");l&&(c+=' class="'+l+'"');l=e[h];var m="";k.contentId&&(c+=" active_id='"+
k.contentId+"'");k.colspan&&(c+=" colspan='"+k.colspan+"'");k.rowspan&&(c+=" rowspan='"+k.rowspan+"'",l=this._summ_next(this._headers,h,k.rowspan));l!=this._settings.headerRowHeight&&(m=" style='line-height:"+l+"px; height:"+l+"px;'");var n="webix_hcell",p=k.css;p&&("object"==typeof p&&(k.css=p=webix.html.createCss(p)),n+=" "+p);this._columns[f].$selected&&(n+=" webix_sel_hcell");c+="><div role='columnheader' class='"+n+"'"+m+">";m=""===k.text?"&nbsp;":k.text;k.rotate&&(m="<div class='webix_rotate' style='width:"+
(l-10)+"px; transform-origin:center "+(l-15)/2+"px;-webkit-transform-origin:center "+(l-15)/2+"px;'>"+m+"</div>");c+=m+"</div></td>"}}c+="</tr>"}return c+"</tr></table>"},showItemByIndex:function(a,b){var c=this._settings.pager;if(c){var d=Math.floor(a/c.size);d!=c.page&&webix.$$(c.id).select(d)}-1!=a&&(d=this._get_y_range(),a<d[0]+1||a>=d[1]-1)&&(c=this._getHeightByIndexSumm(c?this.data.$min:0,a),a<d[0]+1?c=Math.max(0,c-1)-this._top_split_height:(c+=this._getHeightByIndex(a)-this._dtable_offset_height,
0<a&&(c+=this._getHeightByIndex(a-1)-1)),this._y_scroll.scrollTo(c));if(-1!=b&&!(b<this._settings.leftSplit||b>=this._rightSplit)&&(d=this._get_x_range(),b<d[0]+1||b>=d[1]-1)){c=0;for(a=this._settings.leftSplit;a<b;a++)c+=this._columns[a].width;b<d[0]+1||(c+=this._columns[b].width-this._center_width);this._x_scroll.scrollTo(c)}},showCell:function(a,b){if(!b||!a){var c=this.getSelectedId(!0);1==c.length&&(b=b||c[0].column,a=a||c[0].row)}b=b?this.getColumnIndex(b):-1;a=a?this.getIndexById(a):-1;this.showItemByIndex(a,
b)},scrollTo:function(a,b){if(this._x_scroll){if(this._scrollTo_touch)return this._scrollTo_touch(a,b);null!==a&&this._x_scroll.scrollTo(a);null!==b&&this._y_scroll.scrollTo(b)}},getScrollState:function(){return this._getScrollState_touch?this._getScrollState_touch():{x:this._scrollLeft||0,y:this._scrollTop+(this._render_scroll_shift?0:this._render_scroll_diff||0)}},showItem:function(a){this.showItemByIndex(this.getIndexById(a),-1)},_render_header_section:function(a,b,c){a.childNodes[0].innerHTML=
this._render_subheader(0,this._settings.leftSplit,this._left_width,b,c);a.childNodes[1].innerHTML=this._render_subheader(this._settings.leftSplit,this._rightSplit,this._dtable_width,b,c);a.childNodes[1].onscroll=webix.bind(this._scroll_with_header,this);a.childNodes[2].innerHTML=this._render_subheader(this._rightSplit,this._columns.length,this._right_width,b,c)},_scroll_with_header:function(){var a=this.getScrollState().x,b=this._header.childNodes[1].scrollLeft;b!=a&&this.scrollTo(b,null)},_refresh_tracking_header_content:function(){this.refreshHeaderContent(!0,
!0)},_refresh_any_header_content:function(){this.refreshHeaderContent(!1,!0)},refreshHeaderContent:function(a,b,c){this._settings.header&&(b&&this._refreshHeaderContent(this._header,a,1,c),this._refreshHeaderContent(this._header,a,0,c));this._settings.footer&&(b&&this._refreshHeaderContent(this._footer,a,1,c),this._refreshHeaderContent(this._footer,a,0,c))},refreshFilter:function(a){a&&!this._active_headers[a]||this.refreshHeaderContent(!1,!0,a)},_refreshHeaderContent:function(a,b,c,d){if(this._has_active_headers&&
a){a=a.getElementsByTagName("TD");for(var e=0;e<a.length;e++)if(a[e].getAttribute("active_id")){var f=this._active_headers[a[e].getAttribute("active_id")];if(!d||d==f.columnId){var g=webix.ui.datafilter[f.content];c?g.getValue&&(f.value=g.getValue(a[e])):b&&!g.trackCells||g.refresh(this,a[e],f)}}}},headerContent:[],_set_size_scroll_area:function(a,b,c){this._scrollSizeY?(a.style.height=Math.max(b,1)-1+"px",a.style.width=(this._rightSplit?0:c)+this._scrollSizeY-1+"px"):a.style.display="none"},_size_header_footer_fix:function(){this._settings.header&&
this._set_size_scroll_area(this._header_scroll,this._header_height,this._header_fix_width);this._settings.footer&&this._set_size_scroll_area(this._footer_scroll,this._footer_height,this._header_fix_width)},_update_scroll:function(a,b){this._scrollSizeX=(a=!(this._settings.autowidth||!1===this._settings.scrollX))?webix.ui.scrollSize:0;this._scrollSizeY=(b=!(this._settings.autoheight||!1===this._settings.scrollY))?webix.ui.scrollSize:0;webix.env.touch&&(a=b=!1);this._x_scroll&&(this._x_scroll._settings.scrollSize=
this._scrollSizeX,this._x_scroll._settings.scrollVisible=a);this._y_scroll&&(this._y_scroll._settings.scrollSize=this._scrollSizeY,this._y_scroll._settings.scrollVisible=b)},_create_scrolls:function(){this._scrollLeft=this._scrollTop=0;var a;var b=a=1;if(this._settings.autoheight||!1===this._settings.scrollY)a=this._scrollSizeY=0;if(this._settings.autowidth||!1===this._settings.scrollX)b=this._scrollSizeX=0;webix.env.touch&&(b=a=0);this._x_scroll||(this._x_scroll=new webix.ui.vscroll({container:this._footer.previousSibling,
scrollWidth:this._dtable_width,scrollSize:this._scrollSizeX,scrollVisible:b}),!b||this._scrollSizeX||webix.env.$customScroll||(this._x_scroll._viewobj.style.position="absolute"),this._x_scroll.attachEvent("onScroll",webix.bind(this._onscroll_x,this)));this._y_scroll||(this._header_scroll=this._footer.nextSibling,b=this._header_scroll.nextSibling,this._footer_scroll=b.nextSibling,this._y_scroll=new webix.ui.vscroll({container:b,scrollHeight:100,scroll:"y",scrollSize:this._scrollSizeY,scrollVisible:a}),
this._y_scroll.activeArea(this._body),this._x_scroll.activeArea(this._body,!0),this._y_scroll.attachEvent("onScroll",webix.bind(this._onscroll_y,this)));this._content_width&&this.callEvent("onResize",[this._content_width,this._content_height]);webix.env.$customScroll&&webix.CustomScroll.enable(this);this._create_scrolls=function(){}},columnId:function(a){return this._columns[a].id},getColumnIndex:function(a){for(var b=0;b<this._columns.length;b++)if(this._columns[b].id==a)return b;return-1},_getNodeBox:function(a,
b){var c=0,d=0,e=0,f,g=0;for(f=0;f<this._columns.length;f++){if(this._rightSplit==f||this._settings.leftSplit==f)c=0,g++;if(this._columns[f].id==b)break;c+=this._columns[f].width}b=0+this._columns[f].width;for(f=0;f<this.data.order.length&&this.data.order[f]!=a;f++)e+=this._getHeightByIndex(f);d+=this._getHeightByIndex(f);return[c,b,e-this._scrollTop,d,this._body.childNodes[g]]},_id_to_string:function(){return this.row},locate:function(a,b){if(this._settings.subview&&this!=webix.$$(a))return null;
for(a=a.target||a.srcElement||a;a&&a.getAttribute&&a!==this.$view;){var c=webix.html._getClassName(a).toString(),d=null;-1!=c.indexOf("webix_cell")&&(d=this._locate(a))&&(d.row=this.data.order[d.rind]);-1!=c.indexOf("webix_hcell")&&(d=this._locate(a))&&(d.header=!0);if(d){if(b)return d.header?null:d.row;d.column=this._columns[d.cind].id;d.toString=this._id_to_string;return d}a=a.parentNode}return null},_locate:function(a){var b=a.parentNode;if(!b)return null;var c=1*(a.getAttribute("column")||b.getAttribute("column")),
d=a.getAttribute("row")||0,e=1*(a.getAttribute("colspan")||b.getAttribute("colspan"));if(!d)for(var f=0;f<b.childNodes.length;f++)b.childNodes[f]==a&&(d=f>=this._settings.topSplit?f+this._columns[c]._yr0-this._settings.topSplit:f);return{rind:d,cind:c,span:e}},_correctScrollSize:function(){for(var a=-this._center_width,b=0;b<this._columns.length;b++)a+=this._columns[b].width;this._scrollLeft=Math.min(this._scrollLeft,Math.max(0,a))},_updateColsSizeSettings:function(a){this._dtable_fully_ready&&(this._correctScrollSize(),
this._set_columns_positions(),this._set_split_sizes_x(),this._render_header_and_footer(),a||this._check_rendered_cols(!1,!1))},setColumnWidth:function(a,b,c){return this._setColumnWidth(this.getColumnIndex(a),b,c)},_setColumnWidth:function(a,b,c,d){if(!(isNaN(b)||0>a)){var e=this._columns[a];e.minWidth&&b<e.minWidth?b=e.minWidth:b<this._settings.minColumnWidth&&(b=this._settings.minColumnWidth);var f=e.width;if(f!=b){a>=this._settings.leftSplit&&a<this._rightSplit&&(this._dtable_width+=b-f);e.width=
b;if(e.node)e.node.style.width=b+"px";else return!1;c||this._updateColsSizeSettings();this.callEvent("onColumnResize",[e.id,b,f,!!d]);return!0}return!1}},_getRowHeight:function(a){return(a.$height||this._settings.rowHeight)+(a.$subopen?a.$subHeight:0)},_getHeightByIndex:function(a){return(a=this.data.order[a])?this._getRowHeight(this.data.pull[a]):this._settings.rowHeight},_getHeightByIndexSumm:function(a,b){if(this._settings.fixedRowHeight)return(b-a)*this._settings.rowHeight;for(var c=0;a<b;a++)c+=
this._getHeightByIndex(a);return c},_cellPosition:function(a,b){var c;1==arguments.length&&(b=a.column,a=a.row);var d=this.getItem(a),e=this.getColumnConfig(b),f=0,g=0;for(c=0;c<this._columns.length;c++){if(c==this._settings.leftSplit||c==this._rightSplit)f=0;var h=this._columns[c];if(h.id==b){g=this._body.childNodes[c<this._settings.leftSplit?0:c>=this._rightSplit?2:1].firstChild;break}f+=h.width}c=this.getIndexById(a)<this._settings.topSplit?this._getHeightByIndexSumm(0,this.getIndexById(a)):this._getHeightByIndexSumm((this._render_scroll_top||
0)-this._settings.topSplit,this.getIndexById(a))+(this._render_scroll_shift||0);return{parent:g,top:c,left:f,width:e.width,height:d.$height||this._settings.rowHeight}},_get_total_height:function(){var a=this._settings.pager,b=0,c=this.data.order.length;a&&(b=a.size*a.page,c=Math.min(c,b+a.size),a.level&&(b=this.data.$min,c=this.data.$max));return this._getHeightByIndexSumm(b,c)},setRowHeight:function(a,b){if(!isNaN(b)){b<this._settings.minColumnHeight&&(b=this._settings.minColumnHeight);var c=this.getItem(a),
d=c.$height||this._settings.rowHeight;d!=b&&(c.$height=b,this.config.fixedRowHeight=!1,this.render(),this.callEvent("onRowResize",[a,b,d]))}},_onscroll_y:function(a){var b=this._scrollTop!==a;this._scrollTop=a;if(this._settings.prerender)for(var c=this._body.childNodes,d=0;d<c.length;d++)c[d].scrollTop=a;else this._check_rendered_cols();webix.env.$customScroll&&webix.CustomScroll._update_scroll(this._body);b&&(this.callEvent("onScrollY",[]),this.callEvent("onAfterScroll",[]))},_setLeftScroll:function(a){this._body.childNodes[1].scrollLeft=
this._scrollLeft=a;this._settings.header&&(this._header.childNodes[1].scrollLeft=a);this._settings.footer&&(this._footer.childNodes[1].scrollLeft=a)},_onscroll_x:function(a){var b=this._scrollLeft!==a;this._setLeftScroll(a);!1===this._settings.prerender&&this._check_rendered_cols(this._minimize_dom_changes?!1:!0);webix.env.$customScroll&&webix.CustomScroll._update_scroll(this._body);b&&(this.callEvent("onScrollX",[]),this.callEvent("onAfterScroll",[]))},_get_x_range:function(a){if(a)return[0,this._columns.length];
a=this._scrollLeft;for(var b=this._settings.leftSplit;0<a&&this._columns.length-1>b;)a-=this._columns[b].width,b++;var c=b;a&&b--;for(a+=this._center_width;0<a&&c<this._rightSplit;)a-=this._columns[c].width,c++;return[b,c]},getVisibleCount:function(){return Math.floor(this._dtable_offset_height/this.config.rowHeight)},_get_y_range:function(a){var b=this._scrollTop,c=0,d=this.count(),e=this._settings.pager;e&&(c=e.page*e.size,d=Math.min(d,c+e.size),e.level&&(c=this.data.$min,d=this.data.$max));if(this._settings.autoheight||
a)return[c,d,0];a=c;(c=this._settings.topSplit||0)&&(a+=c);if(c=this._settings.fixedRowHeight?this._settings.rowHeight:0)e=Math.ceil(b/c),b-=e*c,a+=e;else for(;0<b;)b-=this._getHeightByIndex(a),a++;var f=0<a&&b?-(this._getHeightByIndex(a-1)+b):0,g=a;b&&a--;b+=(this._dtable_offset_height||this._content_height)-(this._top_split_height||0);if(c)e=Math.ceil(b/c),g+=e;else for(;0<b&&g<d;)b-=this._getHeightByIndex(g),g++;g>d&&(g=d);return[a,g,f]},_repaint_single_row:function(a){var b=this.getItem(a),c=
this.getIndexById(a),d=this._get_y_range(),e=this.config.topSplit,f="";if(c>=e){if(c<d[0]||c>=d[1])return;c-=d[0]-e}else f=c==e-1?" webix_topcell webix_last_topcell":" webix_topcell";d=this._get_x_range();for(e=0;e<this._columns.length;e++){var g=this._columns[e];e<this._rightSplit&&e>=this._settings.leftSplit&&(e<d[0]||e>d[1])&&(g._yr0=-999);if(g.attached&&g.node){g=g.node.childNodes[c];var h=this._getValue(b,this._columns[e],0);g.innerHTML=h;g.className=this._getCss(this._columns[e],h,b,a)+f}}},
_check_rendered_cols:function(a,b){if(this._columns.length){b&&this._clearColumnCache();webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id);var c=this._get_x_range(this._settings.prerender),d=this._get_y_range(!0===this._settings.prerender);if(a){for(a=this._settings.leftSplit;a<c[0];a++)this._hideColumn(a,b);for(a=c[1];a<this._rightSplit;a++)this._hideColumn(a,b)}this._render_full_rows=[];var e=0;for(a=0;a<this._settings.leftSplit;a++)e+=this._renderColumn(a,d,b);for(a=c[0];a<
c[1];a++)e+=this._renderColumn(a,d,b,a==c[0]);for(a=this._rightSplit;a<this._columns.length;a++)e+=this._renderColumn(a,d,b);this._check_and_render_full_rows(d[0],d[1],b);this._check_load_next(d)}},_delete_full_rows:function(a,b){this._rows_cache_start=a;this._rows_cache_end=b;webix.html.remove(this._rows_cache);this._rows_cache=[]},_adjust_rows:function(){if(this._settings.prerender&&this._rows_body){var a=this.getScrollState();this._rows_body.style.top="-"+(a.y||0)+"px"}},_check_and_render_full_rows:function(a,
b,c){this._rows_body&&(this._rows_body.style.top=this._render_scroll_shift+"px");if(c||a!=this._rows_cache_start||b!=this._rows_cache_end){if(this._delete_full_rows(a,b),this._render_full_row_some)for(this._render_full_row_some=!1,c=0;c<this._render_full_rows.length;c++){a=this._render_full_rows[c];b=this.getItem(a.id);var d="function"==typeof b.$row?b.$row.call(this,b,this.type):this._getValue(b,this.getColumnConfig(b.$row),c);e=this._rows_cache[c]=webix.html.create("DIV",null,d);e.className="webix_cell "+
(b.$sub?"webix_dtable_sub"+(this._settings.subview?"view":"row"):"webix_dtable_colrow"+(b.$row?" webix_topcell":""));e.setAttribute("column",0);e.setAttribute("row",a.index);d=b.$height||this._settings.rowHeight;e.style.height=b.$subopen?b.$subHeight+"px":d+"px";e.style.paddingRight=webix.ui.scrollSize+"px";e.style.top=(this._render_full_rows[c].index<this.config.topSplit?-this._render_scroll_shift:0)+a.top+(b.$subopen?d-1:0)+"px";this._rows_body||(this._rows_body=webix.html.create("DIV"),this._rows_body.style.position=
"relative",this._rows_body.style.top=this._render_scroll_shift+"px",this._body.appendChild(this._rows_body));this._rows_body.appendChild(e);this.attachEvent("onSyncScroll",function(a,b,c){webix.Touch._set_matrix(this._rows_body,0,b,c)});this._settings.subview&&this.callEvent("onSubViewRender",[b,e])}}else if(this.config.topSplit)for(c=0;c<this._render_full_rows.length;c++){var e=this._rows_cache[c];this._render_full_rows[c].index<this.config.topSplit&&(e.style.top=this._render_full_rows[c].top-this._render_scroll_shift+
"px")}},_check_load_next:function(a){var b=this._settings.pager,c=this._settings.datafetch,d=!this._last_valid_render_pos||a[0]>=this._last_valid_render_pos;this._last_valid_render_pos=a[0];if(this._data_request_flag){if(b&&(!c||c>=b.size)&&this._check_rows([0,b.size*b.page],Math.max(c,b.size),!0))return this._data_request_flag=null;this._run_load_next(this._data_request_flag,d);this._data_request_flag=null}else this._settings.loadahead&&this._check_rows(a,this._settings.loadahead,d)},_check_rows:function(a,
b,c){var d=a[1],e=d+b;c||(d=a[0]-b,e=a[0]);0>d&&(d=0);e=Math.min(e,this.data.order.length-1);a=!1;for(b=d;b<e;b++)this.data.order[b]||(a?(a.last=b,a.count=b-d):a={start:b,count:e-d});if(a)return this._run_load_next(a,c),!0},_run_load_next:function(a,b){var c=Math.max(a.count,this._settings.datafetch||this._settings.loadahead||0);b=b?a.start:a.last-c+1;this._maybe_loading_already(a.count,a.start)||this.loadNext(c,b)},_preserveScrollTarget:function(a){if(webix.env.isSafari){var b,c,d=[this._x_scroll,
this._y_scroll];for(b=0;2>b;b++)if((c=d[b])&&c._scroll_trg&&c._scroll_trg.parentNode==a)var e=c._scroll_trg;e&&(this._scrollWheelTrg&&webix.html.remove(this._scrollWheelTrg),this._scrollWheelTrg=e,a=e.cloneNode(!0),e.parentNode.insertBefore(a,e),this._scrollWheelTrg.style.display="none",this._body.appendChild(this._scrollWheelTrg))}},_hideColumn:function(a){a=this._columns[a];this._preserveScrollTarget(a.node);webix.html.remove(a.node);a.attached=!1},_clearColumnCache:function(){for(var a=0;a<this._columns.length;a++)this._columns[a]._yr0=
-1;this._rows_cache.length&&(webix.html.remove(this._rows_cache),this._rows_cache=[])},getText:function(a,b){return this._getValue(this.getItem(a),this.getColumnConfig(b),0)},getCss:function(a,b){var c=this.getItem(a);return this._getCss(this.getColumnConfig(b),c[b],c,a)},_getCss:function(a,b,c,d){var e="webix_cell";a.cssFormat&&(b=a.cssFormat(b,c,d,a.id))&&(e="object"==typeof b?e+(" "+webix.html.createCss(b)):e+(" "+b));if(b=c.$css)"object"==typeof b&&(c.$css=b=webix.html.createCss(b)),e+=" "+b;
if(d=this.data._marks[d])d.$css&&(e+=" "+d.$css),d.$cellCss&&(d=d.$cellCss[a.id])&&(e+=" "+d);c.$cellCss&&(d=c.$cellCss[a.id])&&("object"==typeof d&&(d=webix.html.createCss(d)),e+=" "+d);if((c=this.data.getMark(c.id,"webix_selected"))&&(c.$row||c[a.id])||a.$selected)e+=this._select_css;return e},_getValue:function(a,b,c){if(!a)return"";var d=a[b.id];if(d===webix.undefined||null===d)d="";b.format&&(d=b.format(d));b.template&&(d=b.template(a,this.type,d,b,c));return d},type:{checkbox:function(a,b,c,
d){return"<input class='webix_table_checkbox' type='checkbox' "+(c==d.checkValue?'checked="true"':"")+">"},radio:function(a,b,c,d){return"<input class='webix_table_radio' type='radio' "+(c==d.checkValue?'checked="true"':"")+">"},editIcon:function(){return"<span class='webix_icon fa-pencil'></span>"},trashIcon:function(){return"<span class='webix_icon fa-trash'></span>"}},type_setter:function(a){this.types&&this.types[a]?(this.type=webix.clone(this.types[a]),this.type.css&&(this._contentobj.className+=
" "+this.type.css)):webix.type(this,a);this.type.on_click&&webix.extend(this.on_click,this.type.on_click);return a},_renderColumn:function(a,b,c,d){var e=this._columns[a];if(!e.attached){var f=a<this._settings.leftSplit?0:a>=this._rightSplit?2:1;this._body.childNodes[f].firstChild.appendChild(e.node);e.attached=!0;e.split=f}this._render_scroll_top=b[0];this._render_scroll_shift=0;this._render_scroll_diff=b[2];this._settings.scrollAlignY?b[1]==this.data.order.length||this.data.$pagesize&&0===b[1]%
this.data.$pagesize?e.node.style.top=(this._render_scroll_shift=b[2])+"px":e._yr2&&(e.node.style.top="0px"):(this._render_scroll_shift=b[2],e.node.style.top=b[2]+"px");if(!(c||e._yr0!=b[0]||e._yr1!=b[1]||this._settings.topSplit&&e._render_scroll_shift!=this._render_scroll_shift))return 0;c="";a=this._settings.columns[a];d={row:this._settings.rowHeight,total:0,single:d};for(f=0;f<this._settings.topSplit;f++)c+=this._render_single_cell(f,a,b,d,-this._render_scroll_shift);for(f=Math.max(b[0],this._settings.topSplit);f<
b[1];f++)c+=this._render_single_cell(f,a,b,d,-1);this._preserveScrollTarget(e.node);e.node.innerHTML=c;e._yr0=b[0];e._yr1=b[1];e._yr2=b[2];e._render_scroll_shift=this._render_scroll_shift;return 1},_render_single_cell:function(a,b,c,d,e){var f=this.data.order[a],g=this.data.getItem(f);if(g){c=" role='gridcell' aria-rowindex='"+(a+1)+"' aria-colindex='"+(this.getColumnIndex(b.id)+1)+"'"+(g.$count||g.$sub?" aria-expanded='"+(g.open||g.$subopen?"true":"false")+"'":"")+(g.$level?" aria-level='"+g.$level+
"'":"");if(d.single&&g.$row&&(this._render_full_row_some=!0,this._render_full_rows.push({top:d.total,id:g.id,index:a}),!g.$sub))return a=g.$height||d.row,d.total+=a,"<div"+c+" class='webix_cell' style='height:"+a+"px;'></div>";var h=this._getValue(g,b,a);f=this._getCss(b,h,g,f);-1!==f.indexOf("select")&&(c+=" aria-selected='true' tabindex='0'");var k=(b=!!g.$subopen)?"margin-bottom:"+g.$subHeight+"px;":"";0<=e&&(0<e&&(k+="top:"+e+"px;'"),f="webix_topcell "+f,a==this._settings.topSplit-1&&(f="webix_last_topcell "+
f));g.$height?(e="<div"+c+" class='"+f+"' style='height:"+g.$height+"px;"+k+"'>"+h+"</div>",d.total+=g.$height-d.row):e="<div"+c+" class='"+f+"'"+(k?" style='"+k+"'":"")+">"+h+"</div>";b&&(d.total+=g.$subHeight)}else e="<div role='gridcell' class='webix_cell'></div>",this._data_request_flag?this._data_request_flag.last=a:this._data_request_flag={start:a,count:c[1]-a};d.total+=d.row;return e},_set_split_sizes_y:function(){if(this._columns.length&&!isNaN(1*this._content_height)){webix.debug_size_box(this,
["y-sizing"],!0);var a=this._dtable_height+(this._scrollSizeX?this._scrollSizeX:0);if(!this._settings.autoheight&&!this._settings.yCount||!this.resize()){this._y_scroll.sizeTo(this._content_height,this._header_height,this._footer_height);this._y_scroll.define("scrollHeight",a);this._top_split_height=this._settings.topSplit?this._getHeightByIndexSumm(0,this._settings.topSplit):0;this._dtable_offset_height=Math.max(0,this._content_height-this._scrollSizeX-this._header_height-this._footer_height);for(a=
0;3>a;a++)this._body.childNodes[a].style.height=this._dtable_offset_height+"px",this._body.childNodes[a].firstChild.style.height=this._settings.prerender?this._dtable_height+"px":this._dtable_offset_height+"px";this._header.style.height=this._header_height+"px"}}},_set_split_sizes_x:function(){if(this._columns.length){webix.debug_size&&webix.log("  - "+this.name+"@"+this._settings.id+" X sizing");var a=0;for(this._center_width=this._right_width=this._left_width=0;a<this._settings.leftSplit;)this._left_width+=
this._columns[a].width,a++;for(a=this._columns.length-1;a>=this._rightSplit;)this._right_width+=this._columns[a].width,a--;!this._content_width||this._settings.autowidth&&this.resize()||(this._center_width=this._content_width-this._right_width-this._left_width-this._scrollSizeY,this._body.childNodes[1].firstChild.style.width=this._dtable_width+"px",this._body.childNodes[0].style.width=this._left_width+"px",this._body.childNodes[1].style.width=this._center_width+"px",this._body.childNodes[2].style.width=
this._right_width+"px",this._header.childNodes[0].style.width=this._left_width+"px",this._header.childNodes[1].style.width=this._center_width+"px",this._header.childNodes[2].style.width=this._right_width+"px",this._footer.childNodes[0].style.width=this._left_width+"px",this._footer.childNodes[1].style.width=this._center_width+"px",this._footer.childNodes[2].style.width=this._right_width+"px",a=this._center_width-this._dtable_width,0>a&&(a=0),a!=this._header_fix_width&&(this._header_fix_width=a,this._size_header_footer_fix()),
this._x_scroll.sizeTo(this._content_width-this._scrollSizeY),this._x_scroll.define("scrollWidth",this._dtable_width+this._left_width+this._right_width))}},$getSize:function(a,b){if((this._settings.autoheight||this._settings.yCount)&&this._settings.columns){var c=(this._settings.yCount||0)*this._settings.rowHeight;c||(c=this.isVisible()?this._dtable_height:this.count()*this._settings.rowHeight);this._settings.height=Math.max(c+(this._scrollSizeX?this._scrollSizeX:0)-1,this._settings.minHeight||0)+
this._header_height+this._footer_height}this._settings.autowidth&&this._settings.columns&&(this._settings.width=Math.max(this._dtable_width+this._left_width+this._right_width+this._scrollSizeY,this._settings.minWidth||0));c=this._left_width+this._right_width+this._scrollSizeY;a=webix.ui.view.prototype.$getSize.call(this,a,b);a[0]=Math.max(a[0]||c);return a},_restore_scroll_state:function(){if(this._x_scroll&&!webix.env.touch){var a=this.getScrollState();this._x_scroll._last_scroll_pos=this._y_scroll._last_scroll_pos=
-1;this.scrollTo(a.x,a.y)}},$setSize:function(a,b){var c=this._content_width,d=this._content_height;webix.ui.view.prototype.$setSize.apply(this,arguments)&&(this._dtable_fully_ready&&(this.callEvent("onResize",[this._content_width,this._content_height,c,d]),this._set_split_sizes_x(),this._set_split_sizes_y()),this.render())},_on_header_click:function(a){a=this.getColumnConfig(a);if(a.sort){var b="asc";a.id==this._last_sorted&&(b="asc"==this._last_order?"desc":"asc");this._sort(a.id,b,a.sort)}},markSorting:function(a,
b){this._sort_sign||(this._sort_sign=webix.html.create("DIV"));var c=this._sort_sign.parentNode;c&&(c.removeAttribute("aria-sort"),c.removeAttribute("tabindex"));webix.html.remove(this._sort_sign);if(b){if(c=this._get_header_cell(this.getColumnIndex(a)))this._sort_sign.className="webix_ss_sort_"+b,c.style.position="relative",c.appendChild(this._sort_sign),c.setAttribute("aria-sort",b+"ending"),c.setAttribute("tabindex","0");this._last_sorted=a;this._last_order=b}else this._last_sorted=this._last_order=
null},scroll_setter:function(a){return"string"==typeof a?(this._settings.scrollX=-1!=a.indexOf("x"),this._settings.scrollY=-1!=a.indexOf("y"),a):this._settings.scrollX=this._settings.scrollY=a},_get_header_cell:function(a){for(var b=this._header.getElementsByTagName("TD"),c=null,d=0;d<b.length&&(b[d].getAttribute("column")!=a||b[d].getAttribute("active_id")||(c=b[d].firstChild,!(2>(b[d].colSpan||0))));d++);return c},_sort:function(a,b,c){b=b||"asc";this.markSorting(a,b);"server"==c?(this.callEvent("onBeforeSort",
[a,b,c]),this.loadNext(0,0,{before:function(){this.clearAll(!0)},success:function(){this.callEvent("onAfterSort",[a,b,c])}},0,1)):("text"==c&&(this.data.each(function(b){b.$text=this.getText(b.id,a)},this),c="string",a="$text"),"function"==typeof c?this.data.sort(c,b):this.data.sort(a,b,c||"string"))},_mouseEventCall:function(a,b,c,d){var e;if(a.length)for(e=0;e<a.length;e++){var f=webix.toFunctor(a[e],this.$scope);f=f.call(this,b,c,d);if(!1===f)return!1}},_mouseEvent:function(a,b,c,d){a=a||event;
var e=a.target||a.srcElement;if(!this._settings.subview||this==webix.$$(e)){var f,g=[],h=!1,k=null;for(e=a.target||a.srcElement;e&&e.parentNode&&e!=this._viewobj.parentNode;){if(f=webix.html._getClassName(e)){f=f.toString().split(" ");for(var l=f.length-1;0<=l;l--)b[f[l]]&&g.push(b[f[l]])}if(e.parentNode.getAttribute&&!k&&(l=e.parentNode.getAttribute("column")||e.getAttribute("column"))){f="DIV"==e.parentNode.tagName;if(!this._columns[l])return;h=!0;if(f){k=e.parentNode.getAttribute("row")||e.getAttribute("row");
if(!k){if(e.getAttribute("column"))return;k=webix.html.index(e);k>=this._settings.topSplit&&(k+=this._columns[l]._yr0-this._settings.topSplit)}this._item_clicked=k={row:this.data.order[k],column:this._columns[l].id};k.toString=this._id_to_string}else this._item_clicked=k={column:this._columns[l].id};g=this._mouseEventCall(g,a,k,e);if(!1===g)return;f?this.callEvent("on"+c,[k,a,e])&&d&&this.callEvent("on"+d,[k,a,e]):"ItemClick"==c&&"header"==e.parentNode.parentNode.getAttribute("section")&&this.callEvent("onHeaderClick",
[k,a,e])&&this._on_header_click(k.column);g=[]}e=e.parentNode}this._mouseEventCall(g,a,k,this.$view);return h}},showOverlay:function(a){if(!this._datatable_overlay){var b=webix.html.create("DIV",{"class":"webix_overlay"},"");this._body.appendChild(b);this._datatable_overlay=b}this._datatable_overlay.innerHTML=a},hideOverlay:function(){this._datatable_overlay&&(webix.html.remove(this._datatable_overlay),this._datatable_overlay=null)},mapCells:function(a,b,c,d,e,f){null===a&&0<this.data.order.length&&
(a=this.data.order[0]);null===b&&(b=this.columnId(0));null===c&&(c=this.data.order.length);null===d&&(d=this._settings.columns.length);if(this.exists(a)&&(a=this.getIndexById(a),b=this.getColumnIndex(b),null!==b))for(var g=0;g<c&&a+g<this.data.order.length;g++){var h=this.data.order[a+g];if(h)for(var k=this.getItem(h),l=0;l<d&&b+l<this._settings.columns.length;l++){var m=this.columnId(b+l),n=e(k[m],h,m,g,l);f||(k[m]=n)}}},_call_onparse:function(a,b){!this._settings.columns&&a.getConfig&&this.define("columns",
a.getConfig(b))},_autoDetectConfig:function(){var a=this.getItem(this.getFirstId()),b=this._settings.columns=[],c;for(c in a)"id"!=c&&"$"!=c[0]&&b.push({id:c,header:c[0].toUpperCase()+c.substr(1),sort:"string",editor:"text"});b.length&&(b[0].fillspace=!0);"undefined"==typeof this._settings.select&&this.define("select","row")}},webix.AutoTooltip,webix.Group,webix.DataMarks,webix.DataLoader,webix.MouseEvents,webix.MapCollection,webix.ui.view,webix.EventSystem,webix.Settings);
webix.ui.datafilter={textWaitDelay:500,summColumn:{getValue:function(a){return a.firstChild.innerHTML},setValue:function(){},refresh:function(a,b,c){var d=0;a.mapCells(null,c.columnId,null,1,function(a){a*=1;isNaN(a)||(d+=a)},!0);c.format&&(d=c.format(d));c.template&&(d=c.template({value:d}));b.firstChild.innerHTML=d},trackCells:!0,render:function(a,b){b.template&&(b.template=webix.template(b.template));return""}},masterCheckbox:{getValue:function(){},setValue:function(){},getHelper:function(a,b){return{check:function(){b.checked=
!1;a.onclick()},uncheck:function(){b.checked=!0;a.onclick()},isChecked:function(){return b.checked}}},refresh:function(a,b,c){b.onclick=function(){this.getElementsByTagName("input")[0].checked=c.checked=!c.checked;var b=a.getColumnConfig(c.columnId),e=c.checked?b.checkValue:b.uncheckValue;a.data.each(function(b){b[c.columnId]=e;a.callEvent("onCheck",[b.id,c.columnId,e]);this.callEvent("onStoreUpdated",[b.id,b,"save"])});a.refresh()}},render:function(a,b){return"<input type='checkbox' "+(b.checked?
"checked='1'":"")+">"}},textFilter:{getInputNode:function(a){return a.firstChild?a.firstChild.firstChild:{value:null}},getValue:function(a){return this.getInputNode(a).value},setValue:function(a,b){this.getInputNode(a).value=b},refresh:function(a,b,c){b.component=a._settings.id;a.registerFilter(b,c,this);b._comp_id=a._settings.id;c.value&&this.getValue(b)!=c.value&&this.setValue(b,c.value);b.onclick=webix.html.preventEvent;webix._event(b,"keydown",this._on_key_down)},render:function(a,b){this.init&&
this.init(b);b.css="webix_ss_filter";return"<input "+(b.placeholder?'placeholder="'+b.placeholder+'" ':"")+"type='text'>"},_on_key_down:function(a,b,c){var d=this._comp_id;9!=(a.which||a.keyCode)&&(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){var a=webix.$$(d);a&&a.filterByAll()},webix.ui.datafilter.textWaitDelay))}},selectFilter:{getInputNode:function(a){return a.firstChild?a.firstChild.firstChild:{value:null}},getValue:function(a){return this.getInputNode(a).value},
setValue:function(a,b){this.getInputNode(a).value=b},refresh:function(a,b,c){c.compare=c.compare||function(a,b){return a==b};b.component=a._settings.id;a.registerFilter(b,c,this);var d=c.options;if(d)if("string"==typeof d){var e=c.options=[];webix.ajax(d).then(webix.bind(function(d){c.options=d.json();this.refresh(a,b,c)},this))}else e=d;else e=a.collectValues(c.columnId),e.unshift({id:"",value:""});(d=webix.$$(d))&&d.data&&d.data.getRange&&(e=d.data.getRange());d=document.createElement("select");
for(var f=0;f<e.length;f++){var g=document.createElement("option");g.value=e[f].id;g.text=e[f].value;d.add(g)}b.firstChild.innerHTML="";b.firstChild.appendChild(d);c.value&&this.setValue(b,c.value);b.onclick=webix.html.preventEvent;d._comp_id=a._settings.id;webix._event(d,"change",this._on_change)},render:function(a,b){this.init&&this.init(b);b.css="webix_ss_filter";return""},_on_change:function(a,b,c){webix.$$(this._comp_id).filterByAll()}}};
webix.ui.datafilter.serverFilter=webix.extend({$server:!0,_on_key_down:function(a,b,c){var d=this._comp_id;a=a.which||a.keyCode;9==a||33<=a&&40>=a||(this._filter_timer&&window.clearTimeout(this._filter_timer),this._filter_timer=window.setTimeout(function(){webix.$$(d).filterByAll()},webix.ui.datafilter.textWaitDelay))}},webix.ui.datafilter.textFilter);webix.ui.datafilter.serverSelectFilter=webix.extend({$server:!0,_on_change:function(a,b,c){webix.$$(this._comp_id).filterByAll()}},webix.ui.datafilter.selectFilter);
webix.ui.datafilter.numberFilter=webix.extend({init:function(a){a.prepare=function(b,c){c=-1!=b.indexOf("=")?1:0;var d=this.format(b);if(""===d)return"";-1!=b.indexOf(">")?a.compare=this._greater:-1!=b.indexOf("<")?(a.compare=this._lesser,c*=-1):(a.compare=this._equal,c=0);return d-c}},format:function(a){return a.replace(/[^\-\.0-9]/g,"")},_greater:function(a,b){return 1*a>b},_lesser:function(a,b){return""!==a&&1*a<b},_equal:function(a,b){return 1*a==b}},webix.ui.datafilter.textFilter);
webix.ui.datafilter.dateFilter=webix.extend({format:function(a){if(""===a)return"";var b=new Date;if(-1!=a.indexOf("today"))b=webix.Date.dayStart(b);else if(-1==a.indexOf("now")){b=a.match(/[0-9]+/g);if(!b||!b.length)return"";3>b.length?(b.reverse(),b=new Date(b[0],(b[1]||1)-1,1)):b=webix.i18n.dateFormatDate(a.replace(/^[>< =]+/,""))}return b.valueOf()}},webix.ui.datafilter.numberFilter);
webix.extend(webix.ui.datatable,{filterByAll:function(){var a=!1;this.data.silent(function(){this.filter();var b=!1,c;for(c in this._filter_elements)if(webix.assert(c,"empty column id for column with filtering"),this.isColumnVisible(c)){var d=this._filter_elements[c],e=d[2].getValue(d[0]),f=e;d[1].prepare&&(f=d[1].prepare.call(d[2],f,d[1],this));d[1].value=e;var g=d[1].compare;this.callEvent("onBeforeFilter",[c,f,d[1]])&&(d[2].$server||a?a=!0:""!==f&&(g?(g=this._multi_compare(c,g),this.filter(webix.bind(function(a,
b){return a?g(a[c],b,a):!1},this),f,b)):this.filter(c,f,b),b=!0))}a&&this._runServerFilter()},this);a||(this.refresh(),this.callEvent("onAfterFilter",[]))},_multi_compare:function(a,b){var c=(a=this.getColumnConfig(a))?a.optionslist:null;if(!c)return b;"string"!=typeof c&&(c=",");return function(a,e,f){if(!a)return!0;a=a.split(c);for(var d=0;d<a.length;d++)if(b(a[d],e,f))return!0}},filterMode_setter:function(a){return webix.extend(this.data._filterMode,a,!0)},getFilter:function(a){a=this._filter_elements[a];
webix.assert(a,"Filter doesn't exists for column in question");return a&&a[2].getInputNode?a[2].getInputNode(a[0]):null},registerFilter:function(a,b,c){this._filter_elements[b.columnId]=[a,b,c]},collectValues:function(a){var b=[],c={"":!0},d=this.getColumnConfig(a),e=d.options||d.collection;if(e)if("object"!=typeof e||e.loadNext)"string"===typeof e&&(e=webix.$$(e)),e.getBody&&(e=e.getBody()),this._collectValues.call(e,"id","value",b,c);else{if(webix.isArray(e))for(a=0;a<e.length;a++)b.push({id:e[a],
value:e[a]});else for(var f in e)b.push({id:f,value:e[f]});return b}else this._collectValues(d.id,d.id,b,c);d={values:b};this.callEvent("onCollectValues",[a,d]);return d.values},_collectValues:function(a,b,c,d){this.data.each(function(e){var f=e?e[a]:"";f===webix.undefined||d[f]||(d[f]=!0,f=e[a],0===f&&(f="0"),c.push({id:f,value:e[b]}))},this,!0);c.length&&c.sort(this.data.sorting.create({as:"string"===typeof c[0].value?"string":"raw",by:"value",dir:"asc"}))},_runServerFilter:function(a){this.loadNext(0,
0,{before:function(){this.editStop&&this.editStop();this.clearAll(!0)},success:function(){this.callEvent("onAfterFilter",[])}},0,1)}});
webix.extend(webix.ui.datatable,{hover_setter:function(a){a&&!this._hover_initialized&&(this._enable_mouse_move(),this.config.experimental=!0,this.attachEvent("onMouseMoving",function(a){a=(a=this.locate(a))?a.row:null;this._last_hover!=a&&(this._last_hover&&this.removeRowCss(this._last_hover,this._settings.hover),this._delayed_hover_set(),this._last_hover=a)}),this.attachEvent("onMouseOut",function(){this._last_hover&&(this.removeRowCss(this._last_hover,this._settings.hover),this._last_hover=null)}),
this._hover_initialized=1);return a},_delayed_hover_set:function(){webix.delay(function(){this._last_hover&&this.addRowCss(this._last_hover,this._settings.hover)},this,[],5)},select_setter:function(a){!this.select&&a&&(webix.extend(this,this._selections._commonselect,!0),!0===a?a="row":"multiselect"==a&&(a="row",this._settings.multiselect=!0),webix.assert(this._selections[a],"Unknown selection mode: "+a),webix.extend(this,this._selections[a],!0));return a},getSelectedId:function(a){return a?[]:""},
getSelectedItem:function(a){return webix.SelectionModel.getSelectedItem.call(this,a)},_selections:{_commonselect:{_select_css:" webix_cell_select",$init:function(){this._reinit_selection();this.on_click.webix_cell=webix.bind(this._click_before_select,this);this._data_cleared=this._data_filtered=function(){this.unselect()};this.data.attachEvent("onStoreUpdated",webix.bind(this._data_updated,this));this.data.attachEvent("onSyncApply",webix.bind(this._data_synced,this));this.data.attachEvent("onClearAll",
webix.bind(this._data_cleared,this));this.data.attachEvent("onAfterFilter",webix.bind(this._data_filtered,this));this.data.attachEvent("onIdChange",webix.bind(this._id_changed,this));this.$ready.push(webix.SelectionModel._set_noselect)},_id_changed:function(a,b){for(var c=0;c<this._selected_rows.length;c++)this._selected_rows[c]==a&&(this._selected_rows[c]=b);for(c=0;c<this._selected_areas.length;c++){var d=this._selected_areas[c];d.row==a&&(a=this._select_key(d),d.row=b,b=this._select_key(d),d.id=
b,delete this._selected_pull[a],this._selected_pull[b]=!0)}},_data_updated:function(a,b,c){"delete"==c&&this.unselect(a)},_data_synced:function(){for(var a=this._selected_areas.length-1;0<=a;a--)this.exists(this._selected_areas[a].row)||this._selected_areas.splice(a,1)},_reinit_selection:function(){this._selected_areas=[];this._selected_pull={};this._selected_rows=[]},isSelected:function(a,b){a=webix.isUndefined(b)?"object"===typeof a?this._select_key(a):a:this._select_key({row:a,column:b});return this._selected_pull[a]},
getSelectedId:function(a,b){if(1<this._selected_areas.length||a){if(a=[].concat(this._selected_areas),b)for(b=0;b<a.length;b++)a[b]=a[b].id}else if(a=this._selected_areas[0],b&&a)return a.id;return a},_id_to_string:function(){return this.row},_select:function(a,b){var c=this._select_key(a);if(null!==c){if(-1===b)return this._unselect(a);a.id=c;a.toString=this._id_to_string;if(!this.callEvent("onBeforeSelect",[a,b]))return!1;if(!this._selected_pull[c]||!b&&1!=this._selected_areas.length)return b||
this._clear_selection(),this._selected_areas.push(a),this._selected_pull[c]=!0,this.callEvent("onAfterSelect",[a,b]),this._finalize_select(this._post_select(a)),!0}},_clear_selection:function(){if(!this._selected_areas.length)return!1;for(var a=0;a<this._selected_areas.length;a++)if(!this.callEvent("onBeforeUnSelect",[this._selected_areas[a]]))return!1;for(a=0;a<this._selected_rows.length;a++)this.data.removeMark(this._selected_rows[a],"webix_selected");var b=this._settings.columns;if(b)for(a=0;a<
b.length;a++)b[a].$selected=null;b=this._selected_areas;this._reinit_selection();for(a=0;a<b.length;a++)this.callEvent("onAfterUnSelect",[b[a]]);return!0},unselectAll:function(){this.clearSelection()},selectAll:function(){this.selectRange()},clearSelection:function(){this._clear_selection()&&(this.callEvent("onSelectChange",[]),this.render())},_unselect:function(a){var b=this._select_key(a);!b&&this._selected_areas.length&&(this.clearSelection(),this.callEvent("onSelectChange",[]));if(this._selected_pull[b]){if(!this.callEvent("onBeforeUnSelect",
[a]))return!1;for(var c=0;c<this._selected_areas.length;c++)if(this._selected_areas[c].id==b){this._selected_areas.splice(c,1);break}delete this._selected_pull[b];this.callEvent("onAfterUnSelect",[a]);this._finalize_select(0,this._post_unselect(a))}},_add_item_select:function(a){a=this.getItem(a);return this.data.addMark(a.id,"webix_selected",0,{$count:0},!0)},_finalize_select:function(a){a&&this._selected_rows.push(a);this._silent_selection||(this.render(),this.callEvent("onSelectChange",[]))},_click_before_select:function(a,
b){var c=a.ctrlKey||a.metaKey||"touch"==this._settings.multiselect;a=a.shiftKey;this._settings.multiselect||"multiselect"==this._settings.select||(c=a=!1);a&&this._selected_areas.length?this._selectRange(b,this._selected_areas[this._selected_areas.length-1]):c&&this._selected_pull[this._select_key(b)]?this._unselect(b):this._select({row:b.row,column:b.column},c)},_mapSelection:function(a,b,c){var d=this._settings.columns;if(b){for(var e=[],f=0;f<d.length;f++)d[f].$selected&&e.push(d[f]);d=e}e=this.data.order;
var g=0;for(f=0;f<e.length;f++){var h=this.getItem(e[f]);if(h){var k=this.data.getMark(h.id,"webix_selected");if(k||b){for(var l=0,m=0;m<d.length;m++){var n=d[m].id;if(c||b||k[n]){if(a)h[n]=a(h[n],e[f],n,g,l);else return{row:e[f],column:n};l++}}g++}}}}},row:{_select_css:" webix_row_select",_select_key:function(a){return a.row},select:function(a,b){a&&(a=a.toString());webix.assert(this.data.exists(a),"Incorrect id in select command: "+a);this._select({row:a},b)},_post_select:function(a){this._add_item_select(a.row).$row=
!0;return a.row},unselect:function(a){this._unselect({row:a})},_post_unselect:function(a){this.data.removeMark(a.row,"webix_selected",0,1);return a.row},mapSelection:function(a){return this._mapSelection(a,!1,!0)},_selectRange:function(a,b){return this.selectRange(a.row,b.row)},selectRange:function(a,b,c){webix.isUndefined(c)&&(c=!0);var d=a?this.getIndexById(a):0;b=b?this.getIndexById(b):this.data.order.length-1;if(d>b){var e=d;d=b;b=e}for(this._silent_selection=!0;d<=b;d++){e=this.getIdByIndex(d);
if(!e){a&&this.select(a);break}this.select(e,c)}this._silent_selection=!1;this._finalize_select()}},cell:{_select_key:function(a){return a.column?a.row+"_"+a.column:null},select:function(a,b,c){webix.assert(this.data.exists(a),"Incorrect id in select command: "+a);this._select({row:a,column:b},c)},_post_select:function(a){var b=this._add_item_select(a.row);b.$count++;b[a.column]=!0;return a.row},unselect:function(a,b){this._unselect({row:a,column:b})},_post_unselect:function(a){var b=this._add_item_select(a.row);
b.$count--;b[a.column]=!1;0>=b.$count&&this.data.removeMark(a.row,"webix_selected");return a.row},mapSelection:function(a){return this._mapSelection(a,!1,!1)},_selectRange:function(a,b){return this.selectRange(a.row,a.column,b.row,b.column)},selectRange:function(a,b,c,d,e){webix.isUndefined(e)&&(e=!0);a=a?this.getIndexById(a):0;c=c?this.getIndexById(c):this.data.order.length-1;b=b?this.getColumnIndex(b):0;d=d?this.getColumnIndex(d):this._columns.length-1;if(a>c){var f=a;a=c;c=f}b>d&&(f=b,b=d,d=f);
for(this._silent_selection=!0;a<=c;a++)for(f=b;f<=d;f++)this.select(this.getIdByIndex(a),this.columnId(f),e);this._silent_selection=!1;this._finalize_select()}},column:{_select_css:" webix_column_select",_select_key:function(a){return a.column},_id_to_string:function(){return this.column},select:function(a,b){this._select({column:a},b)},_post_select:function(a){this._settings.columns[this.getColumnIndex(a.column)].$selected=!0;this._silent_selection||this._render_header_and_footer()},unselect:function(a){this._unselect({column:a})},
_post_unselect:function(a){this._settings.columns[this.getColumnIndex(a.column)].$selected=null;this._render_header_and_footer()},mapSelection:function(a){return this._mapSelection(a,!0,!1)},_selectRange:function(a,b){return this.selectRange(a.column,b.column)},selectRange:function(a,b,c){webix.isUndefined(c)&&(c=!0);a=a?this.getColumnIndex(a):0;b=b?this.getColumnIndex(b):this._columns.length-1;if(a>b){var d=a;a=b;b=d}for(this._silent_selection=!0;a<=b;a++)this.select(this.columnId(a),c);this._silent_selection=
!1;this._render_header_and_footer();this._finalize_select()},_data_synced:function(){}},area:{_select_key:function(a){return a.row+"_"+a.column},getSelectedId:function(a){var b=this.getSelectArea(),c=[];if(b)if(!a||b.start.row==b.end.row&&b.start.column==b.end.column)c.push(b.end);else{var d=this.getIndexById(b.start.row),e=this.getIndexById(b.end.row);if(-1==d||-1==e)return c;var f=this.getColumnIndex(b.start.column);for(b=this.getColumnIndex(b.end.column);d<=e;d++)for(var g=f;g<=b;g++)c.push({row:this.getIdByIndex(d),
column:this.columnId(g)})}return a?c:c[0]},unselect:function(a){this._unselect()},_unselect:function(){this.removeSelectArea();this.callEvent("onSelectChange",[])},mapSelection:function(a){var b=this.getSelectArea();if(b){var c=this.getColumnIndex(b.start.column),d=this.getColumnIndex(b.end.column),e=this.getIndexById(b.start.row);b=this.getIndexById(b.end.row);for(var f=e;f<=b;f++)for(var g=this.data.order[f],h=this.getItem(g),k=c;k<=d;k++){var l=this._columns[k].id;if(a)h[l]=a(h[l]||"",g,l,f-e,
k-c);else return{row:g,column:l}}}},select:function(a,b,c){webix.assert(this.data.exists(a),"Incorrect id in select command: "+a);this._select({row:a,column:b},c)},_selectRange:function(a,b){this._extendAreaRange(a,b)},_select:function(a,b){this.addSelectArea(a,a,!1);return!0},_data_synced:function(){this._selected_areas.length&&this.refreshSelectArea()}}}});
webix.extend(webix.ui.datatable,{blockselect_setter:function(a){a&&this._block_sel_flag&&(webix._event(this._viewobj,webix.env.mouse.move,this._bs_move,{bind:this}),webix._event(this._viewobj,webix.env.mouse.down,this._bs_down,{bind:this}),webix.event(document.body,webix.env.mouse.up,this._bs_up,{bind:this}),this._block_sel_flag=this._bs_ready=this._bs_progress=!1,this.attachEvent("onAfterScroll",function(){this._update_block_selection()}),webix.extend(this,webix.AutoScroll,!0),this.attachEvent("onBeforeAutoScroll",
function(){return this._bs_progress}));return a},_block_sel_flag:!0,_childOf:function(a,b){for(a=a.target||a.srcElement;a&&(!a.getAttribute||!a.getAttribute("webixignore"));){if(a==b)return!0;a=a.parentNode}return!1},_bs_down:function(a){this._settings.subview&&this!=webix.$$(a.target||a.srcElement)||!this._childOf(a,this._body)||a.target&&"INPUT"==a.target.tagName||this._rs_process||(this._bs_position=webix.html.offset(this._body),a=webix.html.pos(a),this._bs_ready=[a.x-this._bs_position.x,a.y-this._bs_position.y])},
_bs_up:function(a){this._block_panel&&(this._bs_select("select",!0,a),this._block_panel=webix.html.remove(this._block_panel));webix.html.removeCss(document.body,"webix_noselect");this._bs_ready=this._bs_progress=!1;this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay))},_update_block_selection:function(){this._bs_progress&&this._bs_select(!1,!1)},_bs_select:function(a,b,c){this._bs_ready[2]||(this._bs_ready[2]=this._locate_cell_xy.apply(this,this._bs_ready));
var d=this._bs_ready[2];var e=this._locate_cell_xy.apply(this,this._bs_progress);if(this.callEvent("onBeforeBlockSelect",[d,e,b,c])){if((!this._bs_do_select||!1!==this._bs_do_select(d,e,b,c))&&d.row&&e.row)if("select"===a)this._clear_selection(),this._selectRange(d,e);else{if("box"===a){a=Math.min(this._bs_ready[0],this._bs_progress[0]);var f=Math.max(this._bs_ready[0],this._bs_progress[0]);var g=Math.min(this._bs_ready[1],this._bs_progress[1]);var h=Math.max(this._bs_ready[1],this._bs_progress[1])}else{h=
this._cellPosition(d.row,d.column);var k=this._cellPosition(e.row,e.column);a=this.getScrollState();g=h.width;f=k.width;this._right_width&&this._bs_ready[0]>this._left_width+this._center_width?h.left+=this._left_width+this._center_width:this._left_width?this._bs_ready[0]>this._left_width&&(h.left<a.x?(g-=a.x-h.left,h.left=this._left_width):h.left+=this._left_width-a.x):h.left-=a.x;this._right_width&&this._bs_progress[0]>this._left_width+this._center_width?k.left+=this._left_width+this._center_width:
this._left_width?this._bs_progress[0]>this._left_width&&(k.left<a.x?(f-=a.x-k.left,k.left=this._left_width):k.left+=this._left_width-a.x):k.left-=a.x;this._settings.prerender&&(h.top-=this._scrollTop,k.top-=this._scrollTop);a=Math.min(h.left,k.left);f=Math.max(h.left+g,k.left+f);g=Math.min(h.top,k.top);h=Math.max(h.top+h.height,k.top+k.height);this._settings.topSplit&&(g+=this._getTopSplitOffset(d));this._auto_scroll_delay&&(this._auto_scroll_delay=window.clearTimeout(this._auto_scroll_delay));c&&
(this._auto_scroll_delay=webix.delay(this._auto_scroll,this,[webix.html.pos(c)],250))}c=this._block_panel.style;c.left=a+"px";c.top=g+"px";c.width=f-a+"px";c.height=h-g+"px"}b&&this.callEvent("onAfterBlockSelect",[d,e])}},_bs_start:function(a){this._block_panel=webix.html.create("div",{"class":"webix_block_selection"},"");this._body.appendChild(this._block_panel)},_bs_move:function(a){if(!1!==this._bs_ready){this._bs_progress||webix.html.addCss(document.body,"webix_noselect");var b=webix.html.pos(a);
b=[b.x-this._bs_position.x,b.y-this._bs_position.y];5>Math.abs(this._bs_ready[0]-b[0])&&5>Math.abs(this._bs_ready[1]-b[1])||(!1===this._bs_progress&&this._bs_start(a),this._bs_progress=b,this._bs_select(this.config.blockselect,!1,a))}},_locate_cell_xy:function(a,b){var c=!1,d=null,e=null;if(this._right_width&&a>this._left_width+this._center_width)a+=this._x_scroll.getSize()-this._center_width-this._left_width-this._right_width;else if(!this._left_width||a>this._left_width)a+=this._x_scroll.getScroll();
if(this._settings.topSplit&&this._render_scroll_top>this._settings.topSplit){var f=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),this.columnId(0));f.top+f.height>b&&(c=!0)}c||(b+=this.getScrollState().y);0>a&&(a=0);0>b&&(b=0);var g=this._settings.columns;c=this.data.order;for(var h=f=0;h<g.length;h++)if(f+=g[h].width,f>=a){e=g[h].id;break}e||(e=g[g.length-1].id);f=0;a=this.data.$min||0;if(this._settings.fixedRowHeight)d=c[a+Math.floor(b/this._settings.rowHeight)];else for(h=a;h<
c.length;h++)if(f+=this._getHeightByIndex(h),f>=b){d=c[h];break}d||(d=c[c.length-1]);return{row:d,column:e}},_getTopSplitOffset:function(a,b){var c=0,d=this.getIndexById(a.row);d>=this._settings.topSplit&&(d=this._cellPosition(this.getIdByIndex(d),a.column),a=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),a.column),0<a.top+a.height-d.top&&(c=a.top+a.height-(0<d.top||!b?d.top:0)));return c}});
webix.protoUI({name:"resizearea",defaults:{dir:"x"},$init:function(a){var b=a.dir||"x",c=webix.toNode(a.container),d="x"==b?"width":"height",e=a.margin?a.margin+"px":0;this._key_property="x"==b?"left":"top";this._viewobj=webix.html.create("DIV",{"class":"webix_resize_area webix_dir_"+b});webix._event(this._viewobj,webix.env.mouse.down,webix.html.stopEvent);e&&(e="x"==b?e+" 0 "+e:"0 "+e+" 0 "+e);this._dragobj=webix.html.create("DIV",{"class":"webix_resize_handle_"+b,style:e?"padding:"+e:""},"<div class='webix_handle_content'></div>");
this._originobj=webix.html.create("DIV",{"class":"webix_resize_origin_"+b});a[d]&&(this._originobj.style[d]=a[d]+(a.border?1:0)+"px",this._dragobj.style[d]=a[d]+"px");a.cursor&&(this._dragobj.style.cursor=this._originobj.style.cursor=this._viewobj.style.cursor=a.cursor);this._moveev=webix.event(c,webix.env.mouse.move,this._onmove,{bind:this});this._upev=webix.event(document.body,webix.env.mouse.up,this._onup,{bind:this});this._dragobj.style[this._key_property]=this._originobj.style[this._key_property]=
a.start+"px";c.appendChild(this._viewobj);c.appendChild(this._dragobj);c.appendChild(this._originobj)},_onup:function(){this.callEvent("onResizeEnd",[this._last_result]);webix.eventRemove(this._moveev);webix.eventRemove(this._upev);webix.html.remove(this._viewobj);webix.html.remove(this._dragobj);webix.html.remove(this._originobj);this._viewobj=this._dragobj=this._originobj=null},_onmove:function(a){a=webix.html.pos(a);this._last_result=("x"==this._settings.dir?a.x:a.y)+this._settings.start-this._settings.eventPos;
this._dragobj.style[this._key_property]=this._last_result+"px";this.callEvent("onResize",[this._last_result])}},webix.EventSystem,webix.Settings);
webix.extend(webix.ui.datatable,{resizeRow_setter:function(a){this._settings.scrollAlignY=!1;this._settings.fixedRowHeight=!1;return this.resizeColumn_setter(a)},resizeColumn_setter:function(a){a&&this._rs_init_flag&&(webix._event(this._viewobj,"mousemove",this._rs_move,{bind:this}),webix._event(this._viewobj,"mousedown",this._rs_down,{bind:this}),webix._event(this._viewobj,"mouseup",this._rs_up,{bind:this}),this._rs_init_flag=!1);return a},_rs_init_flag:!0,_rs_down:function(a){this._settings.subview&&
this!=webix.$$(a.target||a.srcElement)||!this._rs_ready||(this._rs_process=[webix.html.pos(a),this._rs_ready[2]],webix.html.addCss(document.body,"webix_noselect"),webix.html.denySelect())},_rs_up:function(){this._rs_process=!1;webix.html.removeCss(document.body,"webix_noselect");webix.html.allowSelect()},_rs_start:function(a){if(!this._rs_progress){a=this._rs_ready[0];var b=this._rs_process[1],c=this._locate(b);if(c){var d=this._rs_process[0];if("x"==a){var e=webix.html.offset(b).x+this._rs_ready[1]-
webix.html.offset(this._body).x;d=d.x;this._rs_ready[1]||(c.cind-=b.parentNode.colSpan||1)}else e=webix.html.offset(b).y+this._rs_ready[1]-webix.html.offset(this._body).y+this._header_height,d=d.y,this._rs_ready[1]||c.rind--;0<=c.cind&&0<=c.rind&&(this._rs_progress=[a,c,e],(new webix.ui.resizearea({container:this._viewobj,dir:a,eventPos:d,start:e,cursor:("x"==a?"col":"row")+"-resize"})).attachEvent("onResizeEnd",webix.bind(this._rs_end,this)));this._rs_down=this._rs_ready=!1}}},_rs_end:function(a){if(this._rs_progress){var b=
this._rs_progress[1];a-=this._rs_progress[2];if("x"==this._rs_progress[0]){this._settings.rightSplit&&b.cind+1>=this._rightSplit&&b.cind!==this._columns.length-1&&(b.cind++,a*=-1);var c=this._columns[b.cind],d=c.width;delete c.fillspace;delete c.adjust;this._setColumnWidth(b.cind,d+a,!0,!0);this._updateColsSizeSettings()}else b=this.getIdByIndex(b.rind),c=this._getRowHeight(this.getItem(b)),this.setRowHeight(b,c+a);this._rs_up()}this._rs_progress=null},_rs_move:function(a){var b=null,c=this._settings;
if(this._rs_ready&&this._rs_process)return this._rs_start(a);a=a||event;var d=a.target||a.srcElement,e=!1;if("TD"!=d.tagName&&"TABLE"!=d.tagName){var f=d.className||"",g="string"===typeof f&&-1!=f.indexOf("webix_cell");if(!g||!c.drag){f="string"===typeof f&&-1!=f.indexOf("webix_hcell");this._rs_ready=!1;if(g||f){f=d.offsetWidth;var h=d.offsetHeight;a=webix.html.posRelative(a);var k=c.resizeRow;"object"==typeof k&&k.headerOnly&&(b=this._locate(d),0<b.cind&&(k=!1));g&&k&&(k="object"==typeof k&&k.size?
k.size:3,a.y<k?(b||(b=this._locate(d)),b.rind&&(this._rs_ready=["y",0,d],e="row-resize")):h-a.y<k+1&&(this._rs_ready=["y",h,d],e="row-resize"));b=c.resizeColumn;"object"==typeof b&&b.headerOnly&&g&&(b=!1);b&&(b="object"==typeof b&&b.size?b.size:3,a.x<b?(this._rs_ready=["x",0,d],e="col-resize"):f-a.x<b+1&&(this._rs_ready=["x",f,d],e="col-resize"))}this._cursor_timer&&window.clearTimeout(this._cursor_timer);this._cursor_timer=webix.delay(this._mark_resize_ready,this,[e],e?100:0)}}},_mark_resize_ready:function(a){this._last_cursor_mode!=
a&&(this._last_cursor_mode=a,this._viewobj.style.cursor=a||"default")}});webix.extend(webix.ui.datatable,webix.PagingAbility);
webix.csv={escape:!0,delimiter:{rows:"\n",cols:"\t"},parse:function(a,b){b=b||this.delimiter;if(!this.escape)return this._split_clip_data(a,b);a=a.replace(/\n$/,"").split(b.rows);for(var c=0;c<a.length-1;)1===this._substr_count(a[c],'"')%2&&(a[c]+=b.rows+a[c+1],delete a[c+1],c++),c++;var d=[];for(c=0;c<a.length;c++)if("undefined"!==typeof a[c]){for(var e=a[c],f=0,g=[],h=!1,k=0;k<=e.length;k++){if(!h&&e[k]===b.cols||k===e.length)f=e.substr(f,k-f),f[0]===f[f.length-1]&&'"'===f[0]&&(f=f.substr(1,f.length-
2).replace('""','"')),g.push(f),f=k+1;'"'===e[k]&&(h=!h)}d.push(g)}return d},_split_clip_data:function(a,b){a=a.split(b.rows);for(var c=0;c<a.length;c++)a[c]=a[c].split(b.cols);return a},_substr_count:function(a,b){return a.split(b).length-1},stringify:function(a,b){b=b||this.delimiter;if(!this.escape){for(var c=0;c<a.length;c++)a[c]=a[c].join(b.cols);return a.join(b.rows)}var d=/\n|"|;|,/;for(c=0;c<a.length;c++){for(var e=0;e<a[c].length;e++)d.test(a[c][e])&&(a[c][e]=a[c][e].replace(/"/g,'""'),a[c][e]=
'"'+a[c][e]+'"');a[c]=a[c].join(b.cols)}return a=a.join(b.rows)}};
webix.TablePaste={clipboard_setter:function(a){if(!0===a||1===a)a="block";webix.clipbuffer.init();this.attachEvent("onSelectChange",this._sel_to_clip);this.attachEvent("onItemClick",function(a,c,d){document.activeElement&&this.$view.contains(document.activeElement)&&(webix.clipbuffer.focus(),webix.UIManager.setFocus(this))});this.attachEvent("onPaste",this._clip_to_sel);return a},templateCopy_setter:webix.template,_sel_to_clip:function(){if(!this.getEditor||!this.getEditor()){var a=this._get_sel_text();
webix.clipbuffer.set(a);webix.UIManager.setFocus(this)}},_get_sel_text:function(){var a=[],b=this._settings.templateCopy;this.mapSelection(function(c,d,e,f,g){a[f]||(a[f]=[]);d=b?b(c,d,e):c;a[f].push(d);return c});return webix.csv.stringify(a,this._settings.delimiter)},_clip_to_sel:function(a){webix.isUndefined(this._paste[this._settings.clipboard])||(a=webix.csv.parse(a,this._settings.delimiter),this._paste[this._settings.clipboard].call(this,a))},_paste:{block:function(a){var b=this.mapSelection(null);
b&&(this.mapCells(b.row,b.column,a.length,null,function(b,d,e,f,g){return a[f]&&a[f].length>g?a[f][g]:b}),this.render())},selection:function(a){this.mapSelection(function(b,c,d,e,f){return a[e]&&a[e].length>f?a[e][f]:b});this.render()},repeat:function(a){this.mapSelection(function(b,c,d,e,f){c=a[e%a.length];return b=c[f%c.length]});this.render()},custom:function(a){}}};webix.extend(webix.ui.datatable,webix.TablePaste);webix.storage||(webix.storage={});
webix.storage.prefix=function(a,b){a+=".";return{put:function(c,d){return b.put(a+c,d)},get:function(c){return b.get(a+c)},remove:function(c){return b.remove(a+c)}}};
webix.storage.local={put:function(a,b){a&&window.JSON&&window.localStorage&&window.localStorage.setItem(a,webix.stringify(b))},get:function(a){return a&&window.JSON&&window.localStorage?(a=window.localStorage.getItem(a))?webix.DataDriver.json.toObject(a):null:null},remove:function(a){a&&window.JSON&&window.localStorage&&window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()}};
webix.storage.session={put:function(a,b){a&&window.JSON&&window.sessionStorage&&window.sessionStorage.setItem(a,webix.stringify(b))},get:function(a){return a&&window.JSON&&window.sessionStorage?(a=window.sessionStorage.getItem(a))?webix.DataDriver.json.toObject(a):null:null},remove:function(a){a&&window.JSON&&window.sessionStorage&&window.sessionStorage.removeItem(a)},clear:function(){window.sessionStorage.clear()}};
webix.storage.cookie={put:function(a,b,c,d){a&&window.JSON&&(document.cookie=a+"="+escape(webix.stringify(b))+(d&&d instanceof Date?";expires="+d.toUTCString():"")+(c?";domain="+c:"")+(webix.env.https?";secure":""))},getRaw:function(a){for(var b=document.cookie.split(";"),c,d,e="",f=0;f<b.length;f++)if(c=b[f].split("="),d=c[0].replace(/^\s+|\s+$/g,""),d==a)return 1<c.length&&(e=unescape(c[1].replace(/^\s+|\s+$/g,""))),e;return null},get:function(a){return a&&window.JSON?(a=this.getRaw(a))?webix.DataDriver.json.toObject(unescape(a)):
null:null},remove:function(a,b){a&&this.getRaw(a)&&(document.cookie=a+"="+(b?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")},clear:function(a){for(var b=document.cookie.split(";"),c=0;c<b.length;c++)document.cookie=/^[^=]+/.exec(b[c])[0]+"="+(a?";domain="+a:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}};
webix.DataState={getState:function(){for(var a=this.config.columns.length,b=this.config.columns,c={ids:[],size:[],select:this.getSelectedId(!0),scroll:this.getScrollState()},d=0;d<a;d++){var e=b[d];c.ids.push(e.id);c.size.push(e.fillspace||e.adjust?-1:e.width)}c.order=[].concat(this._hidden_column_order.length?this._hidden_column_order:c.ids);this._last_sorted&&(c.sort={id:this._last_sorted,dir:this._last_order});if(this._filter_elements&&this._dtable_fully_ready){a={};b=0;for(var f in this._filter_elements)this._hidden_column_hash[f]||
(b=this._filter_elements[f],b[1].value=a[f]=b[2].getValue(b[0]),b=1);b&&(c.filter=a)}c.hidden=[];for(f in this._hidden_column_hash)c.hidden.push(f);return c},setState:function(a){var b=this.config.columns;if(a){this._last_sorted=null;this.blockEvent();if(a.hidden){for(var c={},d=0;d<a.hidden.length;d++)c[a.hidden[d]]=!0,this._hidden_column_order.length||this.hideColumn(a.hidden[d]);if(this._hidden_column_order.length)for(d=0;d<this._hidden_column_order.length;d++){var e=this._hidden_column_order[d];
!!c[e]==!this._hidden_column_hash[e]&&this.hideColumn(e,{},!1,!!c[e])}}if(a.ids){c=!1;e=this.config.columns;for(d=0;d<e.length;d++)e[d].id!=a.ids[d]&&(c=!0);if(c){for(d=0;d<a.ids.length;d++)e[d]=this.getColumnConfig(a.ids[d])||e[d];this.refreshColumns()}}if(a.size)for(c=Math.min(a.size.length,b.length),d=0;d<c;d++)(e=b[d])&&0<a.size[d]&&e.width!=a.size[d]&&(delete e.fillspace,delete e.adjust,this._setColumnWidth(d,a.size[d],!0));this.unblockEvent();this._updateColsSizeSettings(!(this._settings.leftSplit||
this._settings.rightSplit));this.callEvent("onStructureUpdate",[]);a.sort&&(d=b[this.getColumnIndex(a.sort.id)])&&this._sort(a.sort.id,a.sort.dir,d.sort);if(a.filter){d=this.filterByAll;this.filterByAll=function(){};for(var f in a.filter)(b=a.filter[f])&&this._filter_elements[f]&&(c=this._filter_elements[f],c[2].setValue(c[0],b),c=c[1].contentId)&&(this._active_headers[c].value=b);for(f in this._filter_elements)a.filter[f]||(c=this._filter_elements[f],c[2].setValue(c[0],""));this.filterByAll=d;this.filterByAll()}if(a.select&&
this.select)for(f=a.select,this.unselect(),d=0;d<f.length;d++)f[d].row&&!this.exists(f[d].row)||this._select(f[d],!0);a.scroll&&this.scrollTo(a.scroll.x,a.scroll.y)}}};webix.extend(webix.ui.datatable,webix.DataState);
(function(){function a(){if(webix.env.touch)c.$init(),-1==document.body.className.indexOf("webix_full_screen")&&c.limit(!0),window.MSCSSMatrix&&webix.html.addStyle(".webix_view{ -ms-touch-action: none; }");else var e=webix.event(document.body,"touchstart",function(c){if(c.touches.length&&4<c.touches[0].radiusX){webix.env.touch=!0;b(d);a();for(var f in webix.ui.views)(c=webix.ui.views[f])&&c.$touch&&c.$touch()}webix.eventRemove(e)},{capture:!0})}function b(a){a.down="touchstart";a.move="touchmove";
a.up="touchend";a.context=c._get_context}var c=webix.Touch={config:{longTouchDelay:1E3,scrollDelay:150,gravity:500,deltaStep:30,speed:"0ms",finish:1500,ellastic:!0},limit:function(a){c._limited=!1!==a},disable:function(){c._disabled=!0},enable:function(){c._disabled=!1},$init:function(){c.$init=function(){};webix.event(document.body,d.down,c._touchstart);webix.event(document.body,d.move,c._touchmove);webix.event(document.body,d.up,c._touchend);webix.event(document.body,"dragstart",function(a){if(!c._disabled&&
!c._limited)return webix.html.preventEvent(a)});webix.event(document.body,"touchstart",function(a){if(!c._disabled&&!c._limited&&webix.env.isSafari){var b=a.srcElement.tagName.toLowerCase();if("input"==b||"textarea"==b||"select"==b||"label"==b)return!0;c._fire_fast_event=!0;return webix.html.preventEvent(a)}});c._clear_artefacts();c._scroll=[null,null];c.$active=!0},_clear_artefacts:function(){c._start_context=c._current_context=c._prev_context=c._scroll_context=null;c._scroll_mode=c._scroll_node=
c._scroll_stat=this._long_touched=null;c._delta={_x_moment:0,_y_moment:0,_time:0};c._css_button_remove&&(webix.html.removeCss(c._css_button_remove,"webix_touch"),c._css_button_remove=null);window.clearTimeout(c._long_touch_timer);c._was_not_moved=!0;c._axis_x=!0;c._axis_y=!0;c._active_transion||c._scroll_end()},_touchend:function(a){if(c._start_context){if(c._scroll_mode){var b=c._get_matrix(c._scroll_node),d=b.e;b=b.f;var e=c.config.finish,k=c._get_delta(a,!0),l=(a=webix.$$(c._scroll_node))&&a.$scroll?
a.$scroll.gravity:c.config.gravity;if(k._time){a=d+l*k._x_moment/k._time;k=b+l*k._y_moment/k._time;l=c._scroll[0]?c._correct_minmax(a,!1,!1,c._scroll_stat.dx,c._scroll_stat.px):d;var m=c._scroll[1]?c._correct_minmax(k,!1,!1,c._scroll_stat.dy,c._scroll_stat.py):b,n=Math.max(Math.abs(l-d),Math.abs(m-b));150>n&&(e=e*n/150);if(l!=d||m!=b)e=Math.round(e*Math.max((l-d)/(a-d),(m-b)/(k-b)));k={e:l,f:m};(a=webix.$$(c._scroll_node))&&a.adjustScroll&&a.adjustScroll(k);e=Math.max(100,e);d!=k.e||b!=k.f?(c._set_matrix(c._scroll_node,
k.e,k.f,e+"ms"),c._scroll_master&&c._scroll_master._sync_scroll(k.e,k.f,e+"ms"),c._set_scroll(k.e,k.f,e+"ms")):c._scroll_end()}else c._scroll_end()}else if(!this._long_touched)if(c._axis_y&&!c._axis_x)c._translate_event("onSwipeX");else if(c._axis_x&&!c._axis_y)c._translate_event("onSwipeY");else if(webix.env.isSafari&&c._fire_fast_event){c._fire_fast_event=!1;var p=c._start_context.target;webix.delay(function(){var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);p.dispatchEvent(a)})}c._translate_event("onTouchEnd");
c._clear_artefacts()}},_touchmove:function(a){if(c._scroll_context&&c._start_context){var b=c._get_delta(a);c._translate_event("onTouchMove");if(c._scroll_mode)c._set_scroll_pos(b);else if(c._axis_x=c._axis_check(b._x,"x",c._axis_x),c._axis_y=c._axis_check(b._y,"y",c._axis_y),c._scroll_mode){var d=c._get_event_view("onBeforeScroll",!0);if(d){var e={};d.callEvent("onBeforeScroll",[e]);e.update&&(c.config.speed=e.speed,c.config.scale=e.scale)}c._init_scroller(b)}return webix.html.preventEvent(a)}},
_set_scroll_pos:function(){if(c._scroll_node){var a=c._get_matrix(c._scroll_node),b=c._prev_context||c._start_context,d=webix.$$(c._scroll_node);d=d&&d.$scroll?d.$scroll.ellastic:c.config.ellastic;c._scroll[0]&&(a.e=c._correct_minmax(a.e-b.x+c._current_context.x,d,a.e,c._scroll_stat.dx,c._scroll_stat.px));c._scroll[1]&&(a.f=c._correct_minmax(a.f-b.y+c._current_context.y,d,a.f,c._scroll_stat.dy,c._scroll_stat.py));c._set_matrix(c._scroll_node,a.e,a.f,"0ms");c._scroll_master&&c._scroll_master._sync_scroll(a.e,
a.f,"0ms");c._set_scroll(a.e,a.f,"0ms")}},_set_scroll:function(a,b,d){a=c._scroll_stat.px/c._scroll_stat.dx*-a;b=c._scroll_stat.py/c._scroll_stat.dy*-b;c._scroll[0]&&c._set_matrix(c._scroll[0],a,0,d);c._scroll[1]&&c._set_matrix(c._scroll[1],0,b,d)},scrollTo:function(a,b,d,h){c._set_matrix(a,b,d,h)},_set_matrix:function(a,b,d,h){!c._in_anim_frame&&window.setAnimationFrame&&window.setAnimationFrame(function(){c._in_anim_frame=!0;return c._set_matrix(a,b,d,h)});c._in_anim_frame=null;c._active_transion=
!0;if(a){var e=c.config.translate||webix.env.translate;a.style[webix.env.transform]=e+"("+Math.round(b)+"px, "+Math.round(d)+"px"+("translate3d"==e?", 0":"")+")";a.style[webix.env.transitionDuration]=h}},_get_matrix:function(a){a=window.getComputedStyle(a)[webix.env.transform];if("none"==a)a={e:0,f:0};else if(window.WebKitCSSMatrix)a=new WebKitCSSMatrix(a);else if(window.MSCSSMatrix)a=new MSCSSMatrix(a);else{var b=a.replace(/(matrix\()(.*)(\))/gi,"$2");b=b.replace(/\s/gi,"");b=b.split(",");a={};for(var d=
"abcdef".split(""),e=0;e<d.length;e++)a[d[e]]=parseInt(b[e],10)}c._scroll_master&&c._scroll_master._sync_pos(a);return a},_correct_minmax:function(a,b,c,d,k){if(a===c)return a;var e=Math.abs(a-c);if(0<a)return b?c+e/(a-c)*Math.sqrt(e):0;d-=k;return 0>d+a?b?c-Math.sqrt(-(a-c)):-d:a},_init_scroll_node:function(a){if(!a.scroll_enabled){a.scroll_enabled=!0;a.parentNode.style.position="relative";var b=webix.env.cssPrefix;a.style.cssText+=b+"transition: "+b+"transform; "+b+"user-select:none; "+b+"transform-style:flat;";
a.addEventListener(webix.env.transitionEnd,c._scroll_end,!1)}},_init_scroller:function(a){-1!=c._scroll_mode.indexOf("x")&&(c._scroll[0]=c._create_scroll("x",c._scroll_stat.dx,c._scroll_stat.px,"width"));-1!=c._scroll_mode.indexOf("y")&&(c._scroll[1]=c._create_scroll("y",c._scroll_stat.dy,c._scroll_stat.py,"height"));c._init_scroll_node(c._scroll_node);window.setTimeout(c._set_scroll_pos,1)},_create_scroll:function(a,b,d,h){if(2>b-d)return d=c._get_matrix(c._scroll_node),b="y"==a?d.e:0,d="y"==a?0:
d.f,c._scroll_master||c._set_matrix(c._scroll_node,b,d,"0ms"),c._scroll_mode=c._scroll_mode.replace(a,""),"";var e=webix.html.create("DIV",{"class":"webix_scroll_"+a},"");e.style[h]=Math.max(d*d/b-7,10)+"px";c._scroll_stat.left&&("x"===a?e.style.left=c._scroll_stat.left+"px":e.style.right=-c._scroll_stat.left+"px");c._scroll_stat.hidden&&(e.style.visibility="hidden");c._scroll_node.parentNode.appendChild(e);return e},_axis_check:function(a,b,d){return a>c.config.deltaStep?(c._was_not_moved&&(c._long_move(b),
c._locate(b),-1==(c._scroll_mode||"").indexOf(b)&&(c._scroll_mode="")),!1):d},_scroll_end:function(){var a;if(a=webix.$$(c._scroll_node||this)){if(c._scroll_node)var b=c._get_matrix(c._scroll_node);else a.getScrollState&&(b=a.getScrollState(),b={e:b.x,f:b.y});webix.callEvent("onAfterScroll",[b]);a.callEvent&&a.callEvent("onAfterScroll",[b])}c._scroll_mode||(webix.html.remove(c._scroll),c._scroll=[null,null]);c._active_transion=!1},_long_move:function(a){window.clearTimeout(c._long_touch_timer);c._was_not_moved=
!1},_stop_old_scroll:function(a){if(c._scroll[0]||c._scroll[1])c._stop_scroll(a,c._scroll[0]?"x":"y");else return!0},_touchstart:function(a){var b=a.target||event.srcElement;if(!(c._disabled||b.tagName&&"textarea"==b.tagName.toLowerCase()&&b.offsetHeight<b.scrollHeight)){c._long_touched=null;c._scroll_context=c._start_context=d.context(a);var e=webix.$$(a);!c._limited||c._is_scroll()||e&&e.$touchCapture||(c._scroll_context=null);c._translate_event("onTouchStart");c._stop_old_scroll(a)&&(c._long_touch_timer=
window.setTimeout(c._long_touch,c.config.longTouchDelay));!e||!e.touchable||b.className&&0===b.className.indexOf("webix_view")||(c._css_button_remove=e.getNode(a),webix.html.addCss(c._css_button_remove,"webix_touch"))}},_long_touch:function(a){c._start_context&&(c._translate_event("onLongTouch"),webix.callEvent("onClick",[c._start_context]),c._long_touched=!0)},_stop_scroll:function(a,b){c._locate(b);if(b=c._scroll[0]||c._scroll[1]){var e=c._get_event_view("onBeforeScroll",!0);e&&e.callEvent("onBeforeScroll",
[c._start_context,c._current_context])}!b||c._scroll_node&&b.parentNode==c._scroll_node.parentNode||(c._clear_artefacts(),c._scroll_end(),c._start_context=d.context(a));c._touchmove(a)},_get_delta:function(a,b){c._prev_context=c._current_context;c._current_context=d.context(a);c._delta._x=Math.abs(c._start_context.x-c._current_context.x);c._delta._y=Math.abs(c._start_context.y-c._current_context.y);c._prev_context&&(c._current_context.time-c._prev_context.time<c.config.scrollDelay?(c._delta._x_moment=
c._delta._x_moment/1.3+c._current_context.x-c._prev_context.x,c._delta._y_moment=c._delta._y_moment/1.3+c._current_context.y-c._prev_context.y):c._delta._y_moment=c._delta._x_moment=0,c._delta._time=c._delta._time/1.3+(c._current_context.time-c._prev_context.time));return c._delta},_get_sizes:function(a){c._scroll_stat={dx:a.offsetWidth,dy:a.offsetHeight,px:a.parentNode.offsetWidth,py:a.parentNode.offsetHeight}},_is_scroll:function(a){var b=c._start_context.target;if(!webix.env.touch&&!webix.env.transition&&
!webix.env.transform)return null;for(;b&&"BODY"!=b.tagName;){if(b.getAttribute){var d=b.getAttribute("touch_scroll");if(d&&(!a||-1!=d.indexOf(a)))return[b,d]}b=b.parentNode}return null},_locate:function(a){if(a=this._is_scroll(a))c._scroll_mode=a[1],c._scroll_node=a[0],c._get_sizes(a[0]);return a},_translate_event:function(a){webix.callEvent(a,[c._start_context,c._current_context]);var b=c._get_event_view(a);b&&b.callEvent(a,[c._start_context,c._current_context])},_get_event_view:function(a,b){b=
webix.$$(b?c._scroll_node:c._start_context);if(!b)return null;for(;b;){if(b.hasEvent&&b.hasEvent(a))return b;b=b.getParentView()}return null},_get_context:function(a){return a.touches[0]?{target:a.target,x:a.touches[0].pageX,y:a.touches[0].pageY,time:new Date}:(a=c._current_context,a.time=new Date,a)},_get_context_m:function(a){return{target:a.target||a.srcElement,x:a.pageX,y:a.pageY,time:new Date}}};webix.ready(a);var d=webix.env.mouse={down:"mousedown",up:"mouseup",move:"mousemove",context:c._get_context_m};
window.navigator.pointerEnabled?(d.down="pointerdown",d.move="pointermove",d.up="pointerup"):window.navigator.msPointerEnabled?(d.down="MSPointerDown",d.move="MSPointerMove",d.up="MSPointerUp"):webix.env.touch&&b(d)})();webix.attachEvent("onDataTable",function(a,b){webix.env.touch&&(webix.Touch.$init(),b.scrollSize=0,webix.Touch._disabled&&webix.Touch.limit(),a.$ready.push(a.$touch))});
webix.extend(webix.ui.datatable,{$touch:function(){var a=this._settings;a.scrollAlignY=!1;webix.extend(this,!0===a.prerender?this._touchNative:this._touch);var b="";a.autowidth||!1===a.scrollX||(b+="x");a.autoheight||!1===a.scrollY||(b+="y");this._body.setAttribute("touch_scroll",b);webix.Touch._init_scroll_node(this._body.childNodes[1].firstChild);webix.Touch._set_matrix(this._body.childNodes[1].firstChild,0,0,"0ms");this._sync_scroll(0,0,"0ms")},_touchNative:{_scrollTo_touch:function(a,b){webix.Touch._set_matrix(this._body.childNodes[1].firstChild,
0,0,"0ms");this._sync_scroll(a,b,"0ms")},_getScrollState_touch:function(){var a=webix.Touch._get_matrix(this._body.childNodes[1].firstChild);return{x:-a.e,y:-a.f}},$init:function(){this.attachEvent("onBeforeScroll",function(){webix.Touch._scroll_node=this._body.childNodes[1].firstChild;webix.Touch._get_sizes(webix.Touch._scroll_node);webix.Touch._scroll_master=this});this.attachEvent("onTouchEnd",function(){webix.Touch._scroll_master=null})},_sync_scroll:function(a,b,c){this._settings.leftSplit&&
webix.Touch._set_matrix(this._body.childNodes[0].firstChild,0,b,c);this._settings.rightSplit&&webix.Touch._set_matrix(this._body.childNodes[2].firstChild,0,b,c);this._settings.header&&webix.Touch._set_matrix(this._header.childNodes[1].firstChild,a,0,c);this._settings.footer&&webix.Touch._set_matrix(this._footer.childNodes[1].firstChild,a,0,c);this.callEvent("onSyncScroll",[a,b,c])},_sync_pos:function(){}},_touch:{_scrollTo_touch:function(a,b){webix.delay(function(){this.callEvent("onAfterScroll",
[{e:-a,f:-b}])},this)},$scroll:{gravity:0,elastic:!1},$init:function(){this.attachEvent("onAfterColumnHide",function(){this._scrollTo_touch(0,0)});this.attachEvent("onBeforeScroll",function(){var a=webix.Touch;a._scroll_node=this._body.childNodes[1].firstChild;a._get_sizes(a._scroll_node);a._scroll_stat.left=this._scrollLeft;a._scroll_stat.hidden=this._x_scroll._settings.scrollVisible||this._y_scroll._settings.scrollVisible;a._scroll_stat.dy=this._dtable_height;a._scroll_master=this});this.attachEvent("onAfterScroll",
function(a){if(a){var b=this._scrollLeft!=-a.e,c=this._scrollTop!=-a.f;webix.Touch._scroll_master=null;webix.Touch._fix_f=null;this._scrollLeft=this._scrollTop=0;var d=webix.Touch.config.translate;webix.Touch.config.translate="translate";this._sync_scroll(this._x_scroll?0:a.e,0,"0ms");webix.Touch.config.translate=d;this._scrollLeft=-a.e;this._scrollTop=-a.f;this._correctScrollSize();this.render();b&&(this._x_scroll&&this._x_scroll.scrollTo(this._scrollLeft),this.callEvent("onScrollX",[]));c&&(this._y_scroll&&
this._y_scroll.scrollTo(this._scrollTop),this.callEvent("onScrollY",[]));return!1}})},_sync_scroll:function(a,b,c){b+=this._scrollTop;a+=this._scrollLeft;webix.Touch._set_matrix(this._body.childNodes[1].firstChild,a,b,c);this._settings.leftSplit&&webix.Touch._set_matrix(this._body.childNodes[0].firstChild,0,b,c);this._settings.rightSplit&&webix.Touch._set_matrix(this._body.childNodes[2].firstChild,0,b,c);this._settings.header&&webix.Touch._set_matrix(this._header.childNodes[1].firstChild,a,0,c);this._settings.footer&&
webix.Touch._set_matrix(this._footer.childNodes[1].firstChild,a,0,c);this.callEvent("onSyncScroll",[a,b,c])},_sync_pos:function(a){a.f-=this._scrollTop;a.e-=this._scrollLeft}}});
webix.extend(webix.ui.datatable,{$init:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(a){a||this._adjustColumns()},this));this.attachEvent("onStructureLoad",this._adjustColumns);this.attachEvent("onStructureUpdate",this._resizeColumns);this.attachEvent("onColumnResize",function(a,b,c,d){d&&this._resizeColumns()});this.attachEvent("onResize",this._resizeColumns)},_adjustColumns:function(){for(var a=!1,b=this._columns,c=0;c<b.length;c++)b[c].adjust&&("header"==b[c].adjust||this.count())&&
(a=this._adjustColumn(c,b[c].adjust,!0)||a);a&&(this._updateColsSizeSettings(!0),this._resizeColumns())},_resizeColumns:function(){var a=this._settings.columns,b=[],c=0;if(a&&!this._settings.autowidth)for(var d=0;d<a.length;d++){var e=a[d].fillspace;e&&(b[d]=e,c+=1*e||1)}c&&this._fillColumnSize(b,c)},_fillColumnSize:function(a,b){var c=this._settings.columns;if(c){var d=this._content_width-this._scrollSizeY,e=!1;if(0<d){for(var f=0;f<c.length;f++)a[f]||(d-=c[f].width||this.config.columnWidth);for(f=
0;f<a.length;f++)a[f]&&(e=this._setColumnWidth(f,Math.min(d,Math.round(d*a[f]/b)),!0)||e,d-=c[f].width,b-=a[f]);e&&this._updateColsSizeSettings(!0)}}},_getColumnConfigSize:function(a,b){a=this._settings.columns[a];var c=a.minColumnWidth||10;if("header"!=b){var d=this.data.order.length;a.adjustBatch&&a.adjustBatch<d&&(d=a.adjustBatch);for(var e=this.data.order.slice(0,d),f=0;f<d;f++)e[f]=e[f]?this._getValue(this.getItem(e[f]),a,0):"";c=Math.max(c,webix.html.getTextSize(e,"webix_table_cell webix_cell").width)}if("data"!=
b)for(f=0;f<a.header.length;f++)if(b=a.header[f]){d=0;if(b.rotate)for(e=0;e<(b.rowspan||1);e++)d+=this._headers[e];d=webix.html.getTextSize([b.text],"webix_table_cell webix_cell "+(b.css||"")+(b.rotate?"webix_measure_rotate":""),d);c=Math.max(c,b.rotate?d.height:d.width)}return c+1+(webix.env.isIE?webix.skin.$active.layoutPadding.space:0)},_adjustColumn:function(a,b,c){if(0<=a)return b=this._getColumnConfigSize(a,b),this._setColumnWidth(a,b,c)},adjustColumn:function(a,b){this._adjustColumn(this.getColumnIndex(a),
b)},adjustRowHeight:function(a,b){if(a){var c=this.getColumnConfig(a),d=webix.html.create("DIV",{"class":"webix_table_cell webix_measure_size webix_cell"},"");d.style.cssText="width:"+c.width+"px; height:1px; visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;";this.$view.appendChild(d);if(1>d.offsetHeight){var e=this.$view.cloneNode(!0);document.body.appendChild(e);e.appendChild(d)}this.data.each(function(a){d.innerHTML=this._getValue(a,c,0);a.$height=Math.max(d.scrollHeight,
this._settings.rowHeight)},this);d=webix.html.remove(d);e&&webix.html.remove(e)}else{var f=Array(this.data.order.length);a=this.config.columns;var g=0,h;for(h in this.data.pull)f[g]=0,g++;for(h=0;h<a.length;h++)this.adjustRowHeight(a[h].id,!0),g=0,this.data.each(function(a,b){a.$height>f[g]&&(f[g]=a.$height);a.$height=f[g];g++})}b||this.refresh()}});
webix.extend(webix.ui.datatable,{math_setter:function(a){a&&this._math_init();return a},_math_pref:"$",_math_init:function(){webix.env.strict||(this.data.attachEvent("onStoreUpdated",webix.bind(this._parse_row_math,this)),this.data.attachEvent("onStoreLoad",webix.bind(this._parse_math,this)),this.attachEvent("onStructureLoad",this._parse_math))},_parse_row_math:function(a,b,c){if(a&&"delete"!=c&&"paint"!=c){"add"==c&&this._exprs_by_columns(b);for(b=0;b<this._columns.length;b++)this._parse_cell_math(a,
this._columns[b].id,"add"!==c);this._math_recalc={}}},_parse_cell_math:function(a,b,c){var d=this.getItem(a);if(!0===c)var e=d[this._math_pref+b]||d[b];else e=d[b],this._math_recalc={};if("undefined"!==typeof e&&null!==e&&(0<e.length&&"="===e.substr(0,1)?(d[this._math_pref+b]&&!0===c||(d[this._math_pref+b]=d[b]),d[b]=this._calculate(e,a,b)):("undefined"!==typeof d[this._math_pref+b]&&delete d[this._math_pref+b],this._remove_old_triggers(a,b)),"undefined"!==typeof d.depends&&"undefined"!==typeof d.depends[b]))for(var f in d.depends[b])a=
d.depends[b][f][0]+"__"+d.depends[b][f][1],"undefined"===typeof this._math_recalc[a]&&(this._math_recalc[a]=!0,this._parse_cell_math(d.depends[b][f][0],d.depends[b][f][1],!0))},_set_original_value:function(a,b){a=this.getItem(a);"undefined"!==typeof a[this._math_pref+b]&&(a[b]=a[this._math_pref+b])},_parse_math:function(){if(this._columns&&this.count()){this._exprs_by_columns();for(var a=0;a<this._columns.length;a++){var b=this.columnId(a);this.data.each(function(a){this._parse_cell_math(a.id,b)},
this)}this._math_recalc={}}},_exprs_by_columns:function(a){for(var b=0;b<this._columns.length;b++)if(this._columns[b].math){var c=this.columnId(b),d="="+this._columns[b].math;d=d.replace(/\$r/g,"#$r#");d=d.replace(/\$c/g,"#$c#");a?a[c]=this._parse_relative_expr(d,a.id,c):this.data.each(function(a){a[c]=this._parse_relative_expr(d,a.id,c)},this)}},_parse_relative_expr:function(a,b,c){return webix.template(a)({$r:b,$c:c})},_get_calc_value:function(a,b){if(this.exists(a))var c=this.getItem(a);else return"#out_of_range";
var d=c[this._math_pref+b]||c[b]||0;d=d.toString();if("="!==d.substring(0,1))return d;"undefined"===typeof c[this._math_pref+b]&&(c[this._math_pref+b]=c[b]);c[b]=this._calculate(d,a,b,!0);return c[b]},_calculate:function(a,b,c,d){if(!0===d){if(this._in_math_trace(b,c))return"#selfreference"}else this._start_math_trace();this._to_math_trace(b,c);this.getItem(b);a=a.substring(1);var e=this._get_operations(a);d=this._get_refs(a);e?(a=this._replace_refs(a,d),a=this._parse_args(a,e)):a=this._replace_refs(a,
d,!0);e=this._math_exception(a);if(!1!==e)return e;this._from_math_trace(b,c);this._remove_old_triggers(b,c);for(e=0;e<d.length;e++)this._add_trigger([b,c],d[e]);e=this._math_exception(a);if(!1!==e)return e;if(!a)return a;a=this._compute(a);e=this._math_exception(a);return!1!==e?e:a},_get_operations:function(a){return a.replace(/\[[^)]*?\]/g,"").match(/(\+|\-|\*|\/)/g)},_get_refs:function(a){a=a.match(/\[([^\]]+),([^\]]+)\]/g);null===a&&(a=[]);for(var b=0;b<a.length;b++){var c=a[b],d=c;c=c.substr(1,
c.length-2);c=c.split(",");c[0]=this._trim(c[0]);c[1]=this._trim(c[1]);":"===c[0].substr(0,1)&&(c[0]=this.getIdByIndex(c[0].substr(1)));":"===c[1].substr(0,1)&&(c[1]=this.columnId(c[1].substr(1)));c[2]=d;a[b]=c}return a},_replace_refs:function(a,b,c){var d="(",e=")";c&&(d=e="");for(c=0;c<b.length;c++){var f=b[c],g=this._get_calc_value(f[0],f[1]);isNaN(g)&&(g='"'+g+'"');a=a.replace(f[2],d+g+e)}return a},_parse_args:function(a,b){for(var c=[],d=0;d<b.length;d++)a=this._split_by(a,b[d]),c.push(a[0]),
a=a[1];c.push(a);for(d=0;d<c.length;d++)a=this._trim(c[d]),c[d]=a;a="";for(d=0;d<c.length-1;d++)a+=c[d]+b[d];return a+=c[c.length-1]},_compute:function(a){try{webix.temp_value="",a="webix.temp_value = "+a,eval(a)}catch(b){webix.assert(!1,"Math error in datatable<br>"+a),webix.temp_value=""}a=webix.temp_value;webix.temp_value=null;return a.toString()},_split_by:function(a,b){var c=a.indexOf(b);b=a.substr(0,c);a=a.substr(c+1);return[b,a]},_trim:function(a){a=a.replace(/^ */g,"");return a=a.replace(/ *$/g,
"")},_start_math_trace:function(){this._math_trace=[]},_to_math_trace:function(a,b){this._math_trace[a+"__"+b]=!0},_from_math_trace:function(a,b){"undefined"!==typeof this._math_trace[a+"__"+b]&&delete this._math_trace[a+"__"+b]},_in_math_trace:function(a,b){return"undefined"!==typeof this._math_trace[a+"__"+b]?!0:!1},_add_trigger:function(a,b){var c=this.getItem(b[0]);"undefined"===typeof c.depends&&(c.depends={});"undefined"===typeof c.depends[b[1]]&&(c.depends[b[1]]={});c.depends[b[1]][a[0]+"__"+
a[1]]=a;c=this.getItem(a[0]);"undefined"===typeof c.triggers&&(c.triggers={});"undefined"===typeof c.triggers[a[1]]&&(c.triggers[a[1]]={});c.triggers[a[1]][b[0]+"__"+b[1]]=b},_remove_old_triggers:function(a,b){if(this.exists(a,b)){var c=this.getItem(a,b);if("undefined"!==typeof c.triggers)for(var d in c.triggers[b]){var e=c.triggers[b][d];delete this.getItem(e[0]).depends[e[1]][a+"__"+b]}}},_math_exception:function(a){a=a.match(/#\w+/);return null!==a&&0<a.length?a[0]:!1}});
webix.extend(webix.ui.datatable,{_get_editor_type:function(a){return this.getColumnConfig(a.column).editor},getEditor:function(a,b){if(!a)return this._last_editor;1==arguments.length&&(b=a.column,a=a.row);return(this._editors[a]||{})[b]},_for_each_editor:function(a){for(var b in this._editors){var c=this._editors[b],d;for(d in c)"$count"!=d&&a.call(this,c[d])}},_init_editor:function(a,b,c){var d=a.row,e=a.column,f=b.config=this.getColumnConfig(e);!1!==c&&this.showCell(d,e);c=b.render();b.$inline&&
(c=this._locateInput(a));b.node=c;d=this.getItem(d);f=f.editFormat;var g;this._settings.editMath&&(g=d["$"+e]);g=g||d[e];webix.isUndefined(g)&&(g="");b.setValue(f?f(g):g,d);b.value=d[e];this._addEditor(a,b);b.$inline||this._sizeToCell(a,c,!0);b.afterRender&&b.afterRender();this._settings.liveValidation&&(webix._event(b.node,"keyup",this._bind_live_validation(a,this)),this.validateEditor(a));return c},_bind_live_validation:function(a,b){return function(){b.validateEditor(a)}},_set_new_value:function(a,
b,c){var d=this.getColumnConfig(a.column).editParse;c=c?{}:this.getItem(a.row);c[a.column]=d?d(b):b;this._settings.editMath&&(c["$"+a.column]=null);return c},_addEditor:function(a,b,c){c=this._editors[a.row]=this._editors[a.row]||{};c.$count=(c.$count||0)+1;b.row=a.row;b.column=a.column;this._last_editor=c[a.column]=b;this._in_edit_mode++;this._last_editor_scroll=this.getScrollState()},_removeEditor:function(a){this._last_editor==a&&(this._last_editor=0);a.destroy&&a.destroy();var b=this._editors[a.row];
delete b[a.column];b.$count--;b.$count||delete this._editors[a.row];this._in_edit_mode--},_changeEditorId:function(a,b){var c=this._editors[a];if(c){this._editors[b]=c;delete this._editors[a];for(var d in c)c[d].row=b}},_locate_cell:function(a){var b,c,d,e=this.getColumnConfig(a.column),f=0;if(e&&e.node&&e.attached){var g=this.getIndexById(a.row);if(this._spans_pull&&(b=this.getSpan(a.row,a.column)))for(c=0;3>c;c++)for(b=this._spans_areas[c],d=0;!f&&d<b.childNodes.length;d++){var h=b.childNodes[d];
h.getAttribute("row")==g&&h.getAttribute("column")==this.getColumnIndex(a.column)&&(f=h)}!f&&g>=e._yr0-this._settings.topSplit&&g<e._yr1&&(f=e.node.childNodes[g-e._yr0+this._settings.topSplit])}return f},editCell:function(a,b,c,d){b=b||this._settings.columns[0].id;return webix.EditAbility.edit.call(this,{row:a,column:b},c,d)},editRow:function(a,b){a&&a.row&&(a=a.row);var c=!1;this.eachColumn(function(b){this.edit({row:a,column:b},c,!c);c=!0})},editColumn:function(a,b){a&&a.column&&(a=a.column);var c=
!1;this.eachRow(function(b){this.edit({row:b,column:a},c,!c);c=!0})},eachRow:function(a,b){var c=this.data.order;b&&(c=this.data._filter_order||c);for(b=0;b<c.length;b++)a.call(this,c[b])},eachColumn:function(a,b){for(var c in this._columns_pull){var d=this._columns_pull[c];a.call(this,d.id,d)}if(b)for(c in this._hidden_column_hash)d=this._hidden_column_hash[c],a.call(this,d.id,d)},_after_edit_next:function(a){if(this.getSelectedId&&1==this.getSelectedId(!0).length)return this._select(a),!1},_custom_tab_handler:function(a,
b){if(this._settings.editable&&!this._in_edit_mode){if(b.target&&"INPUT"==b.target.tagName)return!0;var c=this.getSelectedId(!0);if(1==c.length)return c=c[0],"row"==this._settings.select&&(c.column=this._settings.columns[b.shiftKey?0:this._settings.columns.length-1].id),this.editNext(a,c),!1}return!0},_find_cell_next:function(a,b,c){var d=this.getIndexById(a.row),e=this.getColumnIndex(a.column),f=this.data.order,g=this._columns;if(c)for(c=d;c<f.length;c++){for(e+=1;e<g.length;e++)if(d={row:f[c],column:g[e].id},
b.call(this,d)&&(!this._checkCellMerge||!this._checkCellMerge(a,d)))return d;e=-1}else for(c=d;0<=c;c--){for(--e;0<=e;e--)if(d={row:f[c],column:g[e].id},b.call(this,d))return d;e=g.length}return null},_correct_after_focus_y:function(){this._in_edit_mode&&(this._ignore_after_focus_scroll?this._ignore_after_focus_scroll=!1:(this._y_scroll.scrollTo(this.getScrollState().y+this._body.childNodes[1].firstChild.scrollTop),this._body.childNodes[1].firstChild.scrollTop=0,this._ignore_after_focus_scroll=!0))},
_correct_after_focus_x:function(){this._in_edit_mode&&this._x_scroll.scrollTo(this._body.childNodes[1].scrollLeft)},_component_specific_edit_init:function(){this.attachEvent("onScrollY",this._update_editor_y_pos);this.attachEvent("onScrollX",this._update_editor_y_pos);this.attachEvent("onScrollY",this._refocus_inline_editor);this.attachEvent("onColumnResize",function(){this.editStop()});this.attachEvent("onAfterFilter",function(){this.editStop()});this.attachEvent("onRowResize",function(){this.editStop()});
this.attachEvent("onAfterScroll",function(){this._settings.topSplit&&this.editStop()});this._body.childNodes[1].firstChild.onscroll=webix.bind(this._correct_after_focus_y,this);this._body.childNodes[1].onscroll=webix.bind(this._correct_after_focus_x,this)},_update_editor_y_pos:function(){if(this._in_edit_mode){var a=this._last_editor_scroll;this._last_editor_scroll=this.getScrollState();var b=this._last_editor_scroll.y-a.y;this._for_each_editor(function(a){if(a.getPopup){var c=this.getItemNode(a);
c?a.getPopup().show(c):a.getPopup().show({x:-1E4,y:-1E4})}else a.$inline||(a.node.top-=b,a.node.style.top=a.node.top+"px")})}}});webix.extend(webix.ui.datatable,webix.EditAbility);
webix.extend(webix.ui.datatable,{$init:function(){this._clear_hidden_state();this.attachEvent("onStructureLoad",this._hideInitialColumns)},_clear_hidden_state:function(){this._hidden_column_hash={};this._hidden_column_order=webix.toArray();this._hidden_split=[0,0]},_hideInitialColumns:function(){for(var a=this._columns,b=0;b<a.length;b++)a[b].header&&this._getInitialSpans(a,a[b].header),a[b].footer&&this._getInitialSpans(a,a[b].footer);for(b=a.length-1;0<=b;b--)a[b].hidden?this.hideColumn(a[b].id,
{},!0,!0):a[b].batch&&this.config.visibleBatch&&a[b].batch!=this.config.visibleBatch&&this.hideColumn(a[b].id,{},!0,!0)},_getInitialSpans:function(a,b){for(a=0;a<b.length;a++){var c=b[a];c&&c.colspan&&!c.$colspan&&(c.$colspan=c.colspan)}},moveColumn:function(a,b){a=this.getColumnIndex(a);if(a!=b){var c=this._settings.columns,d=c.splice(a,1);webix.PowerArray.insertAt.call(c,d[0],b-(b>a?1:0));this._refresh_columns()}},_init_horder:function(){var a=this._hidden_column_order,b=this._settings.columns;
if(!a.length){for(var c=0;c<b.length;c++)a[c]=b[c].id;this._hidden_split=[this._settings.leftSplit,this._rightSplit]}},isColumnVisible:function(a){return!this._hidden_column_hash[a]},hideColumn:function(a,b,c,d){var e=this._settings.columns,f=this._hidden_column_order,g=this._hidden_column_hash,h=1;b=b||{};if(!1!==d){var k=this.getColumnIndex(a);webix.assert(-1!=k,"hideColumn: invalid ID or already hidden");if(-1===k||!this.callEvent("onBeforeColumnHide",[a])||-1==k)return;this._init_horder();if(b.spans){b=
e[k].header;for(var l=0;l<b.length;l++)b[l]&&(b[l].$groupSpan=b[l].colspan||1,h=Math.max(h,b[l].$groupSpan))}k<this._settings.leftSplit&&(this._settings.leftSplit-=h);k>=this._rightSplit?this._settings.rightSplit-=h:this._rightSplit-=h;for(l=k+h-1;l>=k;l--){this._hideColumn(k);var m=e.splice(k,1)[0];g[m.id]=m;m._yr0=-1;delete this._columns_pull[m.id]}this.callEvent("onAfterColumnHide",[a])}else{m=g[a];webix.assert(m,"showColumn: invalid ID or already visible");if(!m||!this.callEvent("onBeforeColumnShow",
[a]))return;k=null;for(var n=l=0;l<f.length;l++){if(f[l]==a){n=l;break}g[f[l]]||(k=f[l])}k=k?this.getColumnIndex(k)+1:0;if(b.spans)for(b=m.header,l=0;l<b.length;l++)b[l]&&(b[l].colspan=b[l].$groupSpan||b[l].colspan,delete b[l].$groupSpan,h=Math.max(h,b[l].colspan||1));for(l=n+h-1;l>=n;l--)(m=g[f[l]])?(webix.PowerArray.insertAt.call(e,m,k),delete m.hidden,delete g[m.id],this._columns_pull[m.id]=m):h--;n<this._hidden_split[0]&&(this._settings.leftSplit+=h);n>=this._hidden_split[1]?this._settings.rightSplit+=
h:this._rightSplit+=h;this.callEvent("onAfterColumnShow",[a])}m.header&&this._fixColspansHidden(m,!1!==d?0:1,"header");m.footer&&this._fixColspansHidden(m,!1!==d?0:1,"footer");c||this._refresh_columns()},_fixColspansHidden:function(a,b,c){for(b=a[c].length-1;0<=b;b--)for(var d=this._hidden_column_order,e,f=!1,g=0,h=0;h<d.length;h++){a=this.getColumnConfig(d[h]);var k=a[c][b];this.isColumnVisible(d[h])?(f&&0<g&&e&&0<e.colspan?e=k=a[c][b]=e:k&&k.$colspan&&0>=g&&(g=k.colspan=k.$colspan,e=k),f=null):
(k&&k.$colspan&&0>=g&&(g=k.colspan=k.$colspan,f=e=k),e&&0<g&&e.colspan--);g--}},refreshColumns:function(a,b){if(a&&a!=this.config.columns||b)this._clear_hidden_state(),this._filter_elements={},a&&(this._rightSplit=a.length-(this.config.rightSplit||0));this._columns_pull={};for(b=0;b<this._columns.length;b++){var c=this._columns[b];this._columns_pull[c.id]=c;c.attached=c.node=null}for(b=0;3>b;b++)this._header.childNodes[b].innerHTML="",this._body.childNodes[b].firstChild.innerHTML="";this._columns=
this.config.columns=a||this.config.columns;this._rightSplit=this._columns.length-this._settings.rightSplit;this._dtable_fully_ready=0;this._define_structure();this.callEvent("onStructureUpdate");this._update_scroll();this.render()},_refresh_columns:function(){this._dtable_fully_ready=0;this.callEvent("onStructureUpdate");this._apply_headers();this.render()},showColumn:function(a,b,c){return this.hideColumn(a,b,c,!1)},showColumnBatch:function(a,b){var c="undefined"!=typeof b;b=!1!==b;this.eachColumn(function(d,
e){e.batch&&(d=this._hidden_column_hash[e.id],b||(d=!d),e.batch==a&&d?this.hideColumn(e.id,{spans:!0},!0,!b):c||e.batch==a||d||this.hideColumn(e.id,{spans:!0},!0,b))},!0);this._refresh_columns()}});
webix.extend(webix.ui.datatable,{$init:function(){this.attachEvent("onAfterScroll",this._set_focusable_item)},_set_focusable_item:function(){if(!this._getVisibleSelection()){var a=this._dataobj.querySelector(".webix_cell");a&&a.setAttribute("tabindex","0")}},_getVisibleSelection:function(){for(var a=this.getSelectedId(!0),b=0;b<a.length;b++)if(this.isColumnVisible(a[b].column))return this.getItemNode(a[b]);return null},moveSelection:function(a,b,c){if(!this._settings.disabled){b=b||{};var d=this.getSelectedId(!0),
e=d.length-1,f=this._settings.multiselect||this._settings.areaselect?b.shift:!1;1<d.length&&"cell"!==this._settings.select&&(d=d.sort(webix.bind(function(a,b){return this.getIndexById(a.row)>this.getIndexById(b.row)||this.getColumnIndex(a.column)>this.getColumnIndex(b.column)?1:-1},this)),"up"==a||"left"==a||"top"==a||"pgup"==a)&&(e=0);if(0>e&&this.count()){if("down"==a||"right"==a)a="top";else if("up"==a||"left"==a)a="bottom";else return;e=0;d=[{row:1,column:1}]}if(0<=e){var g=d[e].row;d=d[e].column;
if("top"==a||"bottom"==a)g&&("top"==a?g=this.data.getFirstId():"bottom"==a&&(g=this.data.getLastId())),d&&(e=0,"bottom"==a&&(e=this.config.columns.length-1),d=this.columnId(e));else if("up"==a||"down"==a||"pgup"==a||"pgdown"==a){if(g){e=this.getIndexById(g);g="pgup"==a||"pgdown"==a?Math.round(this._dtable_offset_height/this._settings.rowHeight):1;if("up"==a||"pgup"==a)e-=g;else if("down"==a||"pgdown"==a)e+=g;0>e&&(e=0);e>=this.data.order.length&&(e=this.data.order.length-1);g=this.getIdByIndex(e);
!g&&this._settings.pager&&this.showItemByIndex(e)}}else if("right"==a||"left"==a)if(d&&"row"!=this.config.select)e=this.getColumnIndex(d),"right"==a?e++:"left"==a&&e--,0>e&&(e=0),e>=this.config.columns.length&&(e=this.config.columns.length-1),d=this.columnId(e);else{if((this.open||this._subViewStorage)&&"right"==a)return this.open?this.open(g):this.openSub(g);if((this.close||this._subViewStorage)&&"left"==a)return this.close?this.close(g):this.closeSub(g)}else{webix.assert(!1,"Not supported selection moving mode");
return}g&&(this.showCell(g,d),this.select||(webix.extend(this,this._selections._commonselect,!0),this._settings.select=this.open||this._subViewStorage?"row":"cell",webix.extend(this,this._selections[this._settings.select],!0)),e={row:g,column:d},f&&"area"==this._settings.select?this._extendAreaRange(e,this._selected_areas[this._selected_areas.length-1],a,b):this._select(e,f),this._settings.clipboard||!1===c||(a=this.getItemNode(e))&&a.focus())}return!1}}});webix.extend(webix.ui.datatable,webix.KeysNavigation);
webix.extend(webix.ui.datatable,webix.DataMove);
webix.extend(webix.ui.datatable,{drag_setter:function(a){this.attachEvent("onBeforeDrag",function(a){return this._checkDragTopSplit(a.source)});this.attachEvent("onBeforeDragIn",function(a){return this._checkDragTopSplit(a.target)});this.attachEvent("onBeforeDropOrder",function(a,c){return 0>c||c>=this._settings.topSplit});return webix.DragItem.drag_setter.call(this,a)},_checkDragTopSplit:function(a){var b;var c=!1;if(this._settings.topSplit&&a)for(webix.isArray(a)||(a=[a]),b=0;!c&&b<a.length;b++)c=
this.getIndexById(a[b]),c=c<this._settings.topSplit;return!c},$dragHTML:function(a,b){b="<div class='webix_dd_drag' style='width:"+(this._content_width-this._scrollSizeY-2)+"px;'>";for(var c=this._settings.columns,d=0;d<c.length;d++){var e=this._getValue(a,c[d]);b+="<div style='width:"+c[d].width+"px;'>"+e+"</div>"}return b+"</div>"},getHeaderNode:function(a,b){return this._getHeaderNode(a,b,this._header)},getFooterNode:function(a,b){return this._getHeaderNode(a,b,this._footer)},_getHeaderNode:function(a,
b,c){if(this.isColumnVisible(a)){a=this.getColumnIndex(a);var d=this._settings.leftSplit>a?0:this._rightSplit<=a?2:1;b=b||0;c=c.childNodes[d].getElementsByTagName("TR");if(c.length)for(b=c[b+1].childNodes,c=0;c<b.length;c++)if(b[c].getAttribute("column")==a)return b[c].firstChild}return null},getItemNode:function(a,b){if(a&&!a.header){b=this.getIndexById(a.row||a);var c=this._get_y_range(),d=c[0]-this._settings.topSplit;if(!(b<d&&b>c[1])){c=this._get_x_range();var e=this._settings.leftSplit?0:c[0];
if(a.column&&(e=this.getColumnIndex(a.column),e<this._rightSplit&&e>=this._settings.leftSplit&&(e<c[0]||e>c[1])))return;a=this._settings.columns[e];if(a.attached&&a.node)return a.node.childNodes[b<this._settings.topSplit?b:b-d]}}},dragColumn_setter:function(a){var b;"order"==a?b={$drag:webix.bind(function(a,d){a=this.locate(d);if(this._rs_process||!a||!this.callEvent("onBeforeColumnDrag",[a.column,d]))return!1;webix.DragControl._drag_context={from:b,start:a,custom:"column_dnd"};a=this.getColumnConfig(a.column);
this._relative_column_drag=webix.html.posRelative(d);this._limit_column_drag=a.width;return"<div class='webix_dd_drag_column' style='width:"+a.width+"px'>"+(a.header[0].text||"&nbsp;")+"</div>"},this),$dragPos:webix.bind(function(a,b,e){var c=webix.DragControl.getContext(),d=webix.html.offset(this.$view);e.style.display="none";var h=document.elementFromPoint(a.x,d.y+1),k=h?this.locate(h):null,l=webix.DragControl.getContext().start.column;if(k&&k.column!=l&&(!this._column_dnd_temp_block||k.column!=
this._last_sort_dnd_node)&&"column_dnd"==c.custom&&webix.$$(h)==this){if(!this.callEvent("onBeforeColumnDropOrder",[l,k.column,b]))return;c=this.getColumnIndex(l);h=this.getColumnIndex(k.column);b.touches&&(this._dragTarget=b.target,this._dragTarget.style.display="none",this.$view.parentNode.appendChild(this._dragTarget));this.moveColumn(l,h+(c<h?1:0));this._last_sort_dnd_node=k.column;this._column_dnd_temp_block=!0}k&&k.column==l&&(this._column_dnd_temp_block=!1);e.style.display="block";a.x-=this._relative_column_drag.x;
a.y=d.y;a.x<d.x?a.x=d.x:(b=d.x+this.$view.offsetWidth-this._scrollSizeY-this._limit_column_drag,a.x>b&&(a.x=b));webix.DragControl._skip=!0},this),$dragDestroy:webix.bind(function(a,b){webix.html.remove(b);this._dragTarget&&webix.html.remove(this._dragTarget);b=webix.DragControl.getContext().start;this.callEvent("onAfterColumnDropOrder",[b.column,this._last_sort_dnd_node,a])},this),$drop:function(){}}:a&&(b={_inner_drag_only:!0,$drag:webix.bind(function(a,d){a=this.locate(d);if(this._rs_process||!a||
!this.callEvent("onBeforeColumnDrag",[a.column,d]))return!1;webix.DragControl._drag_context={from:b,start:a,custom:"column_dnd"};d=this.getColumnConfig(a.column).header;a="&nbsp;";for(var c=0;c<d.length;c++)if(d[c]){a=d[c].text;break}return"<div class='webix_dd_drag_column'>"+a+"</div>"},this),$drop:webix.bind(function(a,b,e){a=e;e.touches&&this._drag_column_last&&(a=this._drag_column_last);a=this.locate(a);if(!a)return!1;b=webix.DragControl.getContext().start.column;if(b!=a.column&&this.callEvent("onBeforeColumnDrop",
[b,a.column,e])){var c=this.getColumnIndex(b),d=this.getColumnIndex(a.column);this.moveColumn(b,d+(c<d?1:0));this.callEvent("onAfterColumnDrop",[b,a.column,e])}},this),$dragIn:webix.bind(function(a,d,e){a=webix.DragControl.getContext();if("column_dnd"!=a.custom||a.from!=b)return!1;for(e=e.target||e.srcElement;-1==(e.className||"").indexOf("webix_hcell");)if(e=e.parentNode,!e)return;e!=this._drag_column_last&&(this._drag_column_last&&webix.html.removeCss(this._drag_column_last,"webix_dd_over_column"),
webix.html.addCss(e,"webix_dd_over_column"));return this._drag_column_last=e},this),$dragDestroy:webix.bind(function(a,b){this._drag_column_last&&webix.html.removeCss(this._drag_column_last,"webix_dd_over_column");webix.html.remove(b)},this)});a&&(webix.DragControl.addDrag(this._header,b),webix.DragControl.addDrop(this._header,b,!0))}});webix.extend(webix.ui.datatable,webix.DragItem);
webix.extend(webix.ui.datatable,{clearValidation:function(){for(var a in this.data._marks)this._clear_invalid_css(a);this.data.clearMark("webix_invalid",!0)},_mark_invalid:function(a,b){this._clear_invalid_css(a);for(var c in b)this.addCellCss(a,c,"webix_invalid_cell");this.addCss(a,"webix_invalid")},_clear_invalid:function(a){this._clear_invalid_css(a);this.removeCss(a,"webix_invalid")},_clear_invalid_css:function(a){this.getItem(a);if(a=this.data.getMark(a,"$cellCss"))for(var b in a)a[b]=a[b].replace("webix_invalid_cell",
"").replace("  "," ")},addRowCss:function(a,b,c){this.addCss(a,b,c)},removeRowCss:function(a,b,c){this.removeCss(a,b,c)},addCellCss:function(a,b,c,d){var e=this.data.getMark(a,"$cellCss"),f=e||{};f[b]=(f[b]||"").replace(c,"").replace("  "," ")+" "+c;e||this.data.addMark(a,"$cellCss",!1,f,!0);d||this.refresh(a)},removeCellCss:function(a,b,c,d){var e=this.data.getMark(a,"$cellCss");if(e){var f=e[b]||"";f&&(e[b]=f.replace(c,"").replace("  "," "));d||this.refresh(a)}}});
webix.extend(webix.ui.datatable,webix.ValidateCollection);
(function(){function a(a){for(var b=[],c=a.length-1;0<=c;c--){var f=a[c];b[c]="object"===typeof f?f.value:f}return b}var b=webix.Sparklines=function(){};b.types={};b.getTemplate=function(a){var b=a||{};"string"==typeof a&&(b={type:a});webix.extend(b,{type:"line"});a=this.types[b.type];webix.assert(a,"Unknown sparkline type");return webix.bind(this._template,new a(b))};b._template=function(b,d,e,f){return f?this.draw(a(e),f.width,33):this.draw(b.data||b,d.width,d.height)}})();
webix.attachEvent("onDataTable",function(a){a.type.sparklines=webix.Sparklines.getTemplate()});
(function(){function a(a){var b=" ";if(a)for(var c in a)b+=c+'="'+a[c]+'" ';return b}var b={draw:function(b,d,e,f){return"<svg "+a({xmlns:"http://www.w3.org/2000/svg",version:"1.1",height:"100%",width:"100%",viewBox:"0 0 "+d+" "+e,"class":f||""})+">"+b+"</svg>"},styleMap:{lineColor:"stroke",color:"fill"},group:function(a){return"<g>"+a+"</g>"},_handlers:{M:function(a){return" M "+a.x+" "+a.y},L:function(a){return" L "+a.x+" "+a.y},C:function(a,b,e){return" C "+a.x+" "+a.y+" "+b.x+" "+b.y+" "+e.x+
" "+e.y},A:function(a,b,e,f){return" A "+b+" "+b+" 0 "+(f-e>=Math.PI?1:0)+" 1 "+(a.x+Math.cos(f)*b)+" "+(a.y+Math.sin(f)*b)}},definePath:function(a,b){for(var c="",d=0;d<a.length;d++){webix.assert(a[d][0]&&"string"==typeof a[d][0],"Path type must be a string");var g=a[d][0].toUpperCase();webix.assert(this._handlers[g],"Incorrect path type");c+=this._handlers[g].apply(this,a[d].slice(1))}b&&(c+=" Z");return c},_linePoints:function(a){for(var b=[],c=0;c<a.length;c++)b.push([c?"L":"M",a[c]]);return b},
setOpacity:function(a,b){a=webix.color.toRgb(a);a.push(b);return"rgba("+a.join(",")+")"},_curvePoints:function(a){for(var b=[],c=0;c<a.length;c++){var f=a[c];c||b.push(["M",f[0]]);b.push(["C",f[1],f[2],f[3]])}return b},getPath:function(b,d,e){e=a(e);return'<path class="'+d+'" vector-effect="non-scaling-stroke" d="'+b+'" '+e+"/>"},getSector:function(c,d,e,f,g,h){h=a(h);return'<path class="'+g+'" vector-effect="non-scaling-stroke" d="'+b.definePath([["M",c],["L",{x:c.x+Math.cos(e)*d,y:c.y+Math.sin(e)*
d}],["A",c,d,e,f],["L",c]],!0)+'" '+h+"/>"},getCurve:function(b,d,e){e=a(e);b=this.definePath(this._curvePoints(b));return'<path fill="none" class="'+d+'" vector-effect="non-scaling-stroke" d="'+b+'" '+e+"/>"},getLine:function(a,b,e,f){return this.getPath(this.definePath(this._linePoints([a,b]),!0),e,f)},getCircle:function(b,d,e,f){f=a(f);return'<circle class="'+e+'" cx="'+b.x+'" cy="'+b.y+'" r="'+d+'" '+f+"/>"},getRect:function(b,d,e,f,g,h){h=a(h);return'<rect class="'+g+'" rx="0" ry="0" x="'+b+
'" y="'+d+'" width="'+e+'" height="'+f+'" '+h+"/>"}};webix._SVG=b})();
(function(){function a(a){this.config=webix.extend(webix.copy(b),a||{},!0)}var b={paddingX:3,paddingY:4,radius:1,minHeight:4,eventRadius:8};a.prototype.draw=function(a,b,e){var c,d=this.config,h=webix.Sparklines.types.line.prototype,k=webix._SVG;var l=this.getPoints(a,b,e);var m=k.definePath(h._getLinePoints(l),!0);d.color&&(c=this._applyColor(k,d.color));var n=k.group(k.getPath(m,"webix_sparklines_area"+(c?" "+c.area:"")));l.splice(l.length-3,3);m=k.definePath(h._getLinePoints(l));n+=k.group(k.getPath(m,
"webix_sparklines_line"+(c?" "+c.line:"")));n+=h._drawItems(k,l,d.radius,"webix_sparklines_item"+(c?" "+c.item:""));n+=h._drawEventItems(k,l,Math.min(a.length?(b-2*(d.paddingX||0))/a.length:0,d.eventRadius));return k.draw(n,b,e,"webix_sparklines_area_chart"+(d.css?" "+d.css:""))};a.prototype._applyColor=function(a,b){var c={area:{},line:{},item:{}},d=a.styleMap;if(b){c.area[d.color]=a.setOpacity(b,.2);c.line[d.lineColor]=b;c.item[d.color]=b;for(var g in c)c[g]=webix.html.createCss(c[g])}return c};
a.prototype.getPoints=function(a,b,e){a=webix.Sparklines.types.line.prototype.getPoints.call(this,a,b,e);var c=this.config.paddingX||0,d=this.config.paddingY||0;a.push({x:b-c,y:e-d},{x:c,y:e-d},{x:c,y:a[0].y});return a};webix.Sparklines.types.area=a})();
(function(){function a(a){this.config=webix.extend(webix.copy(b),a||{},!0)}var b={paddingX:3,paddingY:4,width:20,margin:4,minHeight:4,eventRadius:8,origin:0,itemCss:function(a){return a<(this.config.origin||0)?" webix_sparklines_bar_negative":""}};a.prototype.draw=function(a,b,e){var c,d=this.config,h="",k=[],l=this.getPoints(a,b,e),m=webix._SVG;for(c=0;c<l.length;c++){var n="function"==typeof d.itemCss?d.itemCss.call(this,a[c]):d.itemCss||"";d.negativeColor&&a[c]<d.origin?n+=" "+this._applyColor(m,
d.negativeColor):d.color&&(n+=" "+this._applyColor(m,d.color));var p=l[c];k.push(m.getRect(p.x,p.y,p.width,p.height,"webix_sparklines_bar "+n))}h+=m.group(k.join(""));c=parseInt(this._getOrigin(a,b,e),10)+.5;p=d.paddingX||0;h+=m.group(m.getLine({x:p,y:c},{x:b-p,y:c},"webix_sparklines_origin"));a=this._getEventPoints(a,b,e);n=[];for(c=0;c<a.length;c++)p=a[c],n.push(m.getRect(p.x,p.y,p.width,p.height,"webix_sparklines_event_area ",{webix_area:c}));h+=m.group(n.join(""));return m.draw(h,b,e,"webix_sparklines_bar_chart"+
(d.css?" "+d.css:""))};a.prototype._applyColor=function(a,b){var c={};a=a.styleMap;b&&(c[a.color]=b);return webix.html.createCss(c)};a.prototype._getOrigin=function(a,b,e){var c=this.config;b=c.paddingY||0;e=(e||100)-2*b;var d=b+e;if(!1!==c.origin){var h=Math.min.apply(null,a);a=Math.max.apply(null,a);c=c.origin||-1E-6;c>=a?d=b:c>h&&(d-=e/(a-h)*(c-h))}return d};a.prototype._getEventPoints=function(a,b,e){var c=[],d=this.config.paddingX||0,h=this.config.paddingY||0;e=(e||100)-2*h;if(a.length){b=((b||
100)-2*d)/a.length;for(var k=0;k<a.length;k++)c.push({x:Math.ceil(b*k)+d,y:h,height:e,width:b})}return c};a.prototype.getPoints=function(a,b,e){var c=this.config,d=Math.min.apply(null,a);c.origin<d&&(d=c.origin);var h=Math.max.apply(null,a),k=[],l=c.paddingX,m=c.paddingY,n=c.margin,p=c.width||20,q=this._getOrigin(a,b,e);if(a.length){b=((b||100)-2*l)/a.length;var r=c.scale||h-d;p=Math.min(b-n,p);n=b-p;h=0;var v=d;!1!==c.origin&&c.origin>d?v=c.origin||0:h=c.minHeight;e=((e||100)-2*m-h)/(r?r:1);for(c=
0;c<a.length;c++)d=Math.ceil(e*(a[c]-v)),k.push({x:Math.ceil(b*c)+l+n/2,y:q-(a[c]>=v?d:0)-h,height:Math.abs(d)+h,width:p})}return k};webix.Sparklines.types.bar=a})();
(function(){function a(a){this.config=webix.extend(webix.copy(b),a||{},!0)}var b={paddingX:6,paddingY:6,radius:2,minHeight:4,eventRadius:8};a.prototype.draw=function(a,b,e){var c=this.getPoints(a,b,e),d=this.config,h=webix._SVG,k=d.color?this._applyColor(h,d.color):null,l=h.definePath(this._getLinePoints(c));l=h.group(h.getPath(l,"webix_sparklines_line"+(k?" "+k.line:"")));l+=this._drawItems(h,c,d.radius,"webix_sparklines_item"+(k?" "+k.item:""));l+=this._drawEventItems(h,c,Math.min(a.length?(b-2*
(d.paddingX||0))/a.length:0,d.eventRadius));return h.draw(l,b,e,"webix_sparklines_line_chart"+(d.css?" "+d.css:""))};a.prototype._applyColor=function(a,b){var c={line:{},item:{}};a=a.styleMap;if(b){c.line[a.lineColor]=b;c.item[a.color]=b;for(var d in c)c[d]=webix.html.createCss(c[d])}return c};a.prototype._drawItems=function(a,b,e,f,g){for(var c=[],d=0;d<b.length;d++)c.push(a.getCircle(b[d],e,f,g));return a.group(c.join(""))};a.prototype._drawEventItems=function(a,b,e){for(var c=[],d=0;d<b.length;d++)c.push(a.getCircle(b[d],
e,"webix_sparklines_event_area",{webix_area:d}));return a.group(c.join(""))};a.prototype._getLinePoints=function(a){var b,c=[];for(b=0;b<a.length;b++){var f=b?"L":"M";c.push([f,a[b]])}return c};a.prototype.getPoints=function(a,b,e){var c=this.config,d=Math.min.apply(null,a);"undefined"!==typeof c.origin&&(d=Math.min(c.origin,d));var h=Math.max.apply(null,a),k=[],l=c.paddingX||0,m=c.paddingY||0;b=(b||100)-2*l;var n=c.minHeight||0;e=(e||100)-2*m;if(a.length)if(1==a.length)k.push({x:b/2+l,y:e/2+l});
else for(b/=a.length-1,h=c.scale||h-d,c=(e-n)/(h?h:1),h||(e/=2),h=0;h<a.length;h++)k.push({x:Math.ceil(b*h)+l,y:e-Math.ceil(c*(a[h]-d))+m-n});return k};webix.Sparklines.types.line=a})();
(function(){function a(a){this.config=webix.extend(b,a||{},!0)}var b={paddingY:2};a.prototype._defColorsCursor=0;a.prototype._defColors="#f55b50 #ff6d3f #ffa521 #ffc927 #ffee54 #d3e153 #9acb61 #63b967 #21a497 #21c5da #3ea4f5 #5868bf #7b53c0 #a943ba #ec3b77 #9eb0b8".split(" ");a.prototype._getColor=function(a,b){b=b.length;var c=this._defColors.length;c>b?(a&&(a=a<c-b?this._defColorsCursor+2:this._defColorsCursor+1),this._defColorsCursor=a):a%=c;return this._defColors[a]};a.prototype.draw=function(a,
b,e){var c,d=this.config,h=d.color||this._getColor,k=this.getAngles(a),l=webix._SVG,m=e/2-(d.paddingY||0),n=b/2,p=e/2;"function"!=typeof h&&(h=function(){return h});var q="";for(c=0;c<k.length;c++){var r={};r[l.styleMap.color]=h.call(this,c,a,this._context);q+=l.getSector({x:n,y:p},m,k[c][0],k[c][1],"webix_sparklines_sector",r)}a=l.group(q);q="";for(c=0;c<k.length;c++)q+=l.getSector({x:n,y:p},m,k[c][0],k[c][1],"webix_sparklines_event_area",{webix_area:c});a+=l.group(q);return l.draw(a,b,e,"webix_sparklines_pie_chart"+
(d.css?" "+d.css:""))};a.prototype.getAngles=function(a){var b=-Math.PI/2,c,f=[],g=this._getRatios(a);for(c=0;c<a.length;c++){var h=-Math.PI/2+g[c]-1E-4;f.push([b,h]);b=h}return f};a.prototype._getTotalValue=function(a){for(var b=0,c=0;c<a.length;c++)b+=1*a[c];return b};a.prototype._getRatios=function(a){var b,c=[],f=0,g=this._getTotalValue(a);for(b=0;b<a.length;b++){var h=1*a[b];c[b]=2*Math.PI*(g?(h+f)/g:1/a.length);f+=h}return c};webix.Sparklines.types.pie=a})();
(function(){function a(a){this.config=webix.extend(webix.copy(c),a||{},!0)}function b(a){this.config=webix.extend(webix.copy(d),a||{},!0)}var c={paddingX:3,paddingY:6,radius:2,minHeight:4,eventRadius:8};a.prototype.draw=function(a,b,c){var d=this.config,e="",f=webix.Sparklines.types.line.prototype,g=this.getPoints(a,b,c),n=webix._SVG,p=d.color?this._applyColor(n,d.color):null;e+=n.group(n.getCurve(g,"webix_sparklines_line"+(p?" "+p.line:"")));g=f.getPoints.call(this,a,b,c);e+=f._drawItems(n,g,d.radius,
"webix_sparklines_item"+(p?" "+p.item:""));e+=f._drawEventItems(n,g,Math.min(a.length?(b-2*(d.paddingX||0))/a.length:0,d.eventRadius));return n.draw(e,b,c,"webix_sparklines_line_chart"+(d.css?" "+d.css:""))};a.prototype._applyColor=function(a,b){var c={line:{},item:{}};a=a.styleMap;if(b){c.line[a.lineColor]=b;c.item[a.color]=b;for(var d in c)c[d]=webix.html.createCss(c[d])}return c};a.prototype.getPoints=function(a,b,c){var d=[];var e=[];var f=[];b=webix.Sparklines.types.line.prototype.getPoints.call(this,
a,b,c);for(a=0;a<b.length;a++)e.push(b[a].x),f.push(b[a].y);e=this._getControlPoints(e);f=this._getControlPoints(f);for(a=0;a<b.length-1;a++)d.push([b[a],{x:e[0][a],y:f[0][a]},{x:e[1][a],y:f[1][a]},b[a+1]]);return d};a.prototype._getControlPoints=function(a){var b=[],c=[],d=[],e=[],l=[],m=[],n,p=a.length-1;b[0]=0;c[0]=2;d[0]=1;e[0]=a[0]+2*a[1];for(n=1;n<p-1;n++)b[n]=1,c[n]=4,d[n]=1,e[n]=4*a[n]+2*a[n+1];b[p-1]=2;c[p-1]=7;d[p-1]=0;e[p-1]=8*a[p-1]+a[p];for(n=1;n<p;n++){var q=b[n]/c[n-1];c[n]-=q*d[n-
1];e[n]-=q*e[n-1]}l[p-1]=e[p-1]/c[p-1];for(n=p-2;0<=n;--n)l[n]=(e[n]-d[n]*l[n+1])/c[n];for(n=0;n<p-1;n++)m[n]=2*a[n+1]-l[n+1];m[p-1]=.5*(a[p]+l[p-1]);return[l,m]};webix.Sparklines.types.spline=a;var d={paddingX:3,paddingY:6,radius:1,minHeight:4,eventRadius:8};b.prototype=webix.copy(a.prototype);b.prototype.draw=function(a,b,c){var d=this.config,e=webix.Sparklines.types.line.prototype,f=webix._SVG,g=d.color?this._applyColor(f,d.color):null,n=this.getPoints(a,b,c),p=n.splice(n.length-3,3);p=f._linePoints(p);
p[0][0]="L";p=f._curvePoints(n).concat(p);p=f.group(f.getPath(f.definePath(p),"webix_sparklines_area"+(g?" "+g.area:""),!0));p+=f.group(f.getPath(f.definePath(f._curvePoints(n)),"webix_sparklines_line"+(g?" "+g.line:"")));n=e.getPoints.call(this,a,b,c);p+=e._drawItems(f,n,d.radius,"webix_sparklines_item"+(g?" "+g.item:""));p+=e._drawEventItems(f,n,Math.min(a.length?(b-2*(d.paddingX||0))/a.length:0,d.eventRadius));return f.draw(p,b,c,"webix_sparklines_splinearea_chart"+(d.css?" "+d.css:""))};b.prototype._applyColor=
function(a,b){var c={area:{},line:{},item:{}},d=a.styleMap;if(b){c.area[d.color]=a.setOpacity(b,.2);c.line[d.lineColor]=b;c.item[d.color]=b;for(var e in c)c[e]=webix.html.createCss(c[e])}return c};b.prototype.getPoints=function(b,c,d){b=a.prototype.getPoints.call(this,b,c,d);var e=this.config.paddingX||0,f=this.config.paddingY||0;b.push({x:c-e,y:d-f},{x:e,y:d-f},{x:e,y:b[0][0].y});return b};webix.Sparklines.types.splineArea=b})();
webix.extend(webix.ui.datatable,{_prePrint:function(a,b){if(a.scroll&&!b)return!0;a.header=webix.isUndefined(a.header)?this.config.header?!0:!1:a.header;a.footer=webix.isUndefined(a.footer)?this.config.footer?!0:!1:a.footer;a.xCorrection=a.xCorrection||0},_findIndex:function(a,b){for(var c=-1,d=0;0>c&&d<a.length;d++)b(a[d])&&(c=d);return c},_getTableHeader:function(a,b,c){var d={},e=0;a.forEach(webix.bind(function(f,g){var h=f[0],k=[],l=h.length;h.forEach(webix.bind(function(a,f){a=b[f+e];for(var h=
0;h<a[c].length;h++){var m=a[c][h];if(m||d[g]&&d[g][h]){m=webix.copy(m||{text:""});d[g]&&d[g][h]&&0===f&&(m.colspan=d[g][h],d[g][h]=0);if(m.colspan){var n=Math.min(m.colspan,l-f);d[g+1]=d[g+1]||{};d[g+1][h]=m.colspan-n;m.colspan=n}m.rowspan&&1===l&&(m.height=(m.height||this.config.headerRowHeight)*m.rowspan,m.rowspan=null);m={txt:m.rotate?this.getHeaderNode(a.id,h).innerHTML:m.text||(m.contentId?this.getHeaderContent(m.contentId).getValue():""),className:"webix_hcell webix_"+c+"_cell "+(m.css||""),
style:{height:(m.height||this.config.headerRowHeight)+"px",width:m.colspan?"auto":a.width+"px"},span:m.colspan||m.rowspan?{colspan:m.colspan||1,rowspan:m.rowspan||1}:null};k[h]=k[h]||[];k[h][f]=m}}},this));a[g]="header"==c?k.concat(f):f.concat(k);e+=l},this));return a},_getTableArray:function(a,b,c){var d=this.config.columns,e=this.getSelectedId(!0),f=this._getPageWidth(a),g=0,h=0,k=[],l=0;c=c||0+a.xCorrection;b=b||[];this.eachRow(webix.bind(function(b){for(var m=0,p=this.getItem(b),q=this.getIndexById(b),
r=[],v=!1,t=c;t<d.length;t++){var u=d[t].id,y=this.getColumnIndex(u)-c;if(d[t]){m+=d[t].width;if(m>f&&t>c){l=t;break}if("selection"!==a.data||"selection"==a.data&&-1!==this._findIndex(e,function(a){return a.column==u&&a.row==b})){var w=this.getSpan(b,u);if(w&&this.getColumnIndex(u)===c){var z=this.getColumnIndex(w[1]);z<c&&(w[2]-=c-z,w[4]=w[4]?w[4]:p[w[1]]?this.getText(b,w[1]):null,w[1]=u)}if(!w||w&&w[0]==b&&w[1]==u){z=w&&w[4]?w[4]:this._columns_pull[u]?this.getText(b,u):"";var x=this.getCss(b,u)+
" "+(d[t].css||"")+(w?" webix_dtable_span "+(w[5]||""):"");r.push({txt:z,className:x,style:{height:w&&1<w[3]?"auto":(p.$height||this.config.rowHeight)+"px",width:w&&1<w[2]?"auto":d[t].width+"px"},span:w?{colspan:w[2],spanStart:this.getColumnIndex(w[1]),rowspan:w[3]}:null});z&&(g=Math.max(y+1,g),h=Math.max(q+1,h));v=v||!!z}else w&&(r.push({$inspan:!0}),g=Math.max(y+1,g),h=Math.max(q+1,h))}}}a.skiprows&&!v||k.push(r)},this));h&&g&&(a.trim&&(k.length=h,k=k.map(function(a){for(var b=a.length-1;0<=b;b--)if(a[b].span&&
a[b].span.colspan){a[b].span.colspan=Math.min(a[b].span.colspan,a.length-b);break}a.length=g;return a})),b.push(k));l?this._getTableArray(a,b,l):(a.footer&&(b=this._getTableHeader(b,d,"footer")),a.header&&(b=this._getTableHeader(b,d,"header")));return b},_getTableHTML:function(a,b){var c=webix.html.create("div");a.forEach(webix.bind(function(d,e){var f=webix.html.create("table",{"class":"webix_table_print "+this.$view.className+(b.borderless?" borderless":""),style:"border-collapse:collapse"});d.forEach(function(a){var b=
webix.html.create("tr");a.forEach(function(a,c){if(!a.$inspan){c=webix.html.create("td");c.innerHTML=a.txt;c.className=a.className;for(var d in a.style)c.style[d]=a.style[d];a.span&&(c.colSpan=a.span.colspan,c.rowSpan=a.span.rowspan);b.appendChild(c)}});f.appendChild(b)});c.appendChild(f);e+1<a.length&&(d=webix.html.create("DIV",{"class":"webix_print_pagebreak"}),c.appendChild(d))},this));return c}});webix.extend(webix.ui.datatable,webix.CustomPrint);
webix.extend(webix.ui.datatable,{$exportView:function(a){this.isBranchOpen&&webix.extend(a,{filterHTML:!0});if("excel"!==a.export_mode||a.dataOnly||!a.styles)return this;a.dataOnly=!0;a.heights=webix.isUndefined(a.heights)?"all":a.heights;var b=webix.toExcel(this,a);b[0].styles=this._getExportStyles(a);delete a.dataOnly;return b},_getExportStyles:function(a){var b=this.config.columns,c=[];this._style_hash=this._style_hash||{};a.docHeader&&(c=[{0:this._getExportDocStyle(a.docHeader.css)},{0:{}}]);
!1!==a.header&&(c=this._getExportHStyles(a,"header",c));this.data.each(function(a){for(var d={},f=0;f<b.length;f++){var g=this.getCss(a.id,b[f].id),h=b[f].node.className,k="",l=this.getIndexById(a.id)%2?"even":"odd",m=null;if(this._spans_pull&&(m=this.getSpan(a.id,b[f].id))){var n=this.getSpanNode({row:m[0],column:m[1]});k="webix_dtable_span "+(m[5]||"")}else n=this.getItemNode({row:a.id,column:b[f].id});n||(n=webix.html.create("div",{"class":g,style:"visibility:hidden"}),m=b[f].node,b[f].attached||
(m=webix.html.create("div",{"class":h,style:"visibility:hidden"}),this._body.appendChild(m)),m.appendChild(n));d[f]=this._getExportCellStyle(n,[g,h,k,l].join(":"))}c[c.length]=d},this);!1!==a.footer&&this.config.footer&&(c=this._getExportHStyles(a,"footer",c));a.docFooter&&(c=c.concat([{0:{}},{0:this._getExportDocStyle(a.docFooter.css)}]));return c},_getExportHStyles:function(a,b,c){a=this.config.columns;for(var d=[],e=0;e<a[0][b].length;e++){for(var f={},g=0;g<a.length;g++){var h=a[g][b][e];if(h){var k=
h.colspan?a[g+h.colspan-1].id:a[g].id;if(k="header"==b?this.getHeaderNode(k,e):this.getFooterNode(k,e))f[g]=this._getExportCellStyle(k,[k.parentNode.className,h.css||"","webix_hcell",b].join(":")),(h.colspan||h.rowspan)&&d.push([e,g,{colspan:h.colspan-1||0,rowspan:h.rowspan-1||0},f[g]])}else for(h=0;h<d.length;h++){k=d[h][2];var l=d[h][0];d[h][1]+k.colspan>=g&&l+k.rowspan>=e&&(f[g]=d[h][3])}}c[c.length]=f}return c},_getExportCellStyle:function(a,b){if(this._style_hash[b])return this._style_hash[b];
var c=this._getRules(a),d={font:{},alignment:{},border:{}};d.font.name=c["font-family"].replace(/,.*$/,"");d.font.sz=.75*c["font-size"].replace("px","");d.font.color={rgb:webix.color.rgbToHex(c.color)};"normal"!==c["font-weight"]&&(d.font.bold=!0);"underline"===c["text-decoration-line"]&&(d.font.underline=!0);"italic"===c["font-style"]&&(d.font.italic=!0);"line-through"===c["text-decoration-line"]&&(d.font.strike=!0);d.alignment.horizontal=c["text-align"];d.alignment.vertical=c.height==c["line-height"]?
"center":"top";"normal"==c["white-space"]&&(d.alignment.wrapText=!0);a.firstChild&&a.firstChild.className&&-1!==a.firstChild.className.indexOf("webix_rotate")&&(d.alignment.textRotation=90);var e=webix.color.rgbToHex(c["background-color"]);e&&(d.fill={fgColor:{rgb:e}});-1!==c["background-image"].indexOf("gradient")&&(d.fill={fgColor:{rgb:webix.color.rgbToHex(c["background-image"].substring(c["background-image"].lastIndexOf("(")))}});a.parentNode&&"TD"==a.parentNode.nodeName&&(c=this._getRules(a.parentNode));
"0px"!==c["border-right-width"]&&(d.border.right={style:"thin",color:{rgb:webix.color.rgbToHex(c["border-right-color"])}});"0px"!==c["border-bottom-width"]&&(d.border.bottom={style:"thin",color:{rgb:webix.color.rgbToHex(c["border-bottom-color"])}});"0px"!==c["border-left-width"]&&(d.border.left={style:"thin",color:{rgb:webix.color.rgbToHex(c["border-left-color"])}});"0px"!==c["border-top-width"]&&(d.border.top={style:"thin",color:{rgb:webix.color.rgbToHex(c["border-top-color"])}});return this._style_hash[b]=
d},_getExportDocStyle:function(a){a=webix.extend(a||{},{visibility:"hidden","white-space":"nowrap","text-align":"left"});var b="",c;for(c in a)b+=c+":"+a[c]+";";a=webix.html.create("div",{style:b});this._body.appendChild(a);b=this._getExportCellStyle(a,b);webix.html.remove(a);return b},_getRules:function(a){return window.getComputedStyle?window.getComputedStyle(a):a.currentStyle}});
webix.extend(webix.ui.datatable,{topSplit_setter:function(a){this.data&&(this.data.$freeze=a);return a},freezeRow:function(a,b){function c(a,b,c,e,f){var g;if(c&&a>=d){f||d++;for(g=a;g>=d;g--)e[g]=e[g-1];e[d-1]=b}if(!c&&a<d){f||d--;for(g=a;g<d;g++)e[g]=e[g+1];e[d]=b}}var d=this._settings.topSplit,e=this.data.order,f=this.data._filter_order;if(a){var g=this.getIndexById(a);a=a.toString();c(g,a,b,e);f&&c(f.find(a),a,b,f,!0)}else b||(d=0);this.define("topSplit",d);this.refresh()}});
webix.TreeTableClick={};webix.TreeTablePaste={insert:function(a){for(var b=this.getSelectedId(!0,!0),c=0;c<a.length;c++){for(var d={},e=0;e<this._settings.columns.length;e++)d[this._settings.columns[e].id]=a[c][e]||"";!webix.isUndefined(d.id)&&this.exists(d.id)&&(d.id=webix.uid());this.add(d,null,b[0])}}};
webix.protoUI({name:"treetable",$init:function(){webix.extend(this.data,webix.TreeStore,!0);webix.extend(this.type,webix.TreeType);webix.extend(this,webix.TreeDataMove,!0);for(var a in webix.TreeClick)this.on_click[a]||(this.on_click[a]=this._unwrap_id(webix.TreeClick[a]));this.type.treetable=webix.template("{common.space()}{common.icon()} {common.folder()}");this.type.treecheckbox=function(a,c){return a.indeterminate&&!a.nocheckbox?"<div class='webix_tree_checkbox webix_indeterminate'></div>":webix.TreeType.checkbox.apply(this,
arguments)};this.data.provideApi(this,!0);this._viewobj.setAttribute("role","treegrid")},_drag_order_complex:!1,_unwrap_id:function(a){return function(b,c){c=c.row;return a.call(this,b,c)}},getState:function(){var a=webix.DataState.getState.call(this);webix.extend(a,webix.TreeAPI.getState.call(this));return a},setState:function(a){webix.TreeAPI.setState.call(this,a)&&webix.DataState.setState.call(this,a)},clipboard_setter:function(a){webix.extend(this._paste,webix.TreeTablePaste);return webix.TablePaste.clipboard_setter.call(this,
a)},_run_load_next:function(a,b){for(var c=0;c<a.start;c++){var d=this.data.order[c];d&&1!=this.getItem(d).$level&&a.start--}return webix.ui.datatable.prototype._run_load_next.call(this,a,b)}},webix.TreeAPI,webix.TreeStateCheckbox,webix.TreeDataLoader,webix.ui.datatable);
webix.extend(webix.ui.datatable,{spans_setter:function(a){a&&!this._spans_pull&&this._init_spans_once();return a},_init_spans_once:function(){this._spans_pull={};this._spans_areas=[];this.data.attachEvent("onStoreLoad",webix.bind(function(a,b){b&&b.spans&&this.addSpan(b.spans)},this));this.data.attachEvent("onClearAll",webix.bind(function(){this._spans_pull={}},this));this.attachEvent("onScrollY",this._adjust_spans_xy);this.attachEvent("onScrollX",this._adjust_spans_xy);this.attachEvent("onAfterRender",
this._paint_spans);this.attachEvent("onSelectChange",this._paint_spans_selection)},addSpan:function(a,b,c,d,e,f){if("object"==typeof a)for(b=0;b<a.length;b++)this.addSpan.apply(this,a[b]);else this._spans_pull[a]||(this._spans_pull[a]={}),this._spans_pull[a][b]=[c||1,d||1,e,f]},removeSpan:function(a,b){arguments.length||(this._spans_pull={});var c=this._spans_pull[a];c&&delete c[b]},getSpan:function(a,b){if(!a)return this._spans_pull;var c=this._spans_pull;var d=this.getIndexById(a);var e=this.getColumnIndex(b);
for(a in c)for(b in c[a]){var f=c[a][b];var g=this.getIndexById(a);var h=this.getColumnIndex(b);if(!(d>g+f[1]-1||d<g||e>h+f[0]-1||e<h))return[a,b].concat(f)}return null},_paint_spans:function(){var a,b=this._columns.length-this._settings.rightSplit;webix.html.remove(this._spans_areas);for(a=0;3>a;a++){var c=this._spans_areas[a]=webix.html.create("DIV",{"class":"webix_span_layer"});this._body.childNodes[a].appendChild(c)}this.attachEvent("onSyncScroll",function(a,b,c){for(var d=0;3>d;d++)webix.Touch._set_matrix(this._spans_areas[d],
1==d?a:0,b,c)});this._adjust_spans_xy();this._settings.leftSplit&&this._paint_spans_area(this._spans_areas[0],0,this._settings.leftSplit);this._settings.rightSplit&&this._paint_spans_area(this._spans_areas[2],b,this._columns.length);this._paint_spans_area(this._spans_areas[1],this._settings.leftSplit,b);this._settings.topSplit&&!webix.env.touch&&this._paintSpansTop()},_getSplitSizesX:function(){for(var a=0,b=0,c=0,d=0,e;a<this._settings.leftSplit;)b+=this._columns[a].width,a++;a=this._columns.length-
1;for(e=a-this._settings.rightSplit;a>=e;)d+=this._columns[a].width,a--;for(a=this._settings.leftSplit;a<this._columns.length-this._settings.rightSplit;a++)c+=this._columns[a].width;return[b,c,d]},_paintSpansTop:function(){var a;var b=this._columns.length-this._settings.rightSplit;for(a=3;6>a;a++){var c=this._spans_areas[a]=webix.html.create("DIV",{"class":"webix_span_layer_top"});this._body.childNodes[a-3].appendChild(c)}a=this._getSplitSizesX();this._settings.leftSplit&&(this._spans_areas[3].style.width=
a[0]+"px",this._paint_spans_area(this._spans_areas[3],0,this._settings.leftSplit));this._settings.rightSplit&&(this._spans_areas[5].style.width=a[2]+"px",this._paint_spans_area(this._spans_areas[5],b,this._columns.length));this._spans_areas[4].style.width=a[1]+"px";this._paint_spans_area(this._spans_areas[4],this._settings.leftSplit,b);for(a=b=0;a<this._settings.topSplit;a++)(c=this.getItem(this.getIdByIndex(a)))&&(b+=this._getRowHeight(c));for(a=3;6>a;a++)this._spans_areas[a].style.height=b+"px"},
_paint_spans_area:function(a,b,c){for(var d=0,e=this.data.$max||this.data.order.length,f=this.data.$min||0;f<e;f++){var g=this.data.order[f];if(g){var h=this._spans_pull[g];if(h)for(var k=b;k<c;k++){var l=this._columns[k].id;h[l]&&this._add_span_to_area(a,f,k,h,d,b,g,l)}d+=this._getRowHeight(this.getItem(g))}}},_paint_spans_selection:function(){var a=this.config.select;a="cell"==a||"column"==a;for(var b=this.getSelectedId(!0),c=[],d=this._last_selected||[],e=webix.uid()+"",f=!1,g=0;g<b.length;g++){var h=
this._spans_pull[b[g]];!h||a&&!h[b[g].column]||(h.$selected&&h.$selected.id==b[g].id||(f=!0),h.$selected=b[g],h.$time=e,c.push(b[g].id))}for(g=0;g<d.length;g++)(h=this._spans_pull[d[g]])&&h.$time!==e&&(delete h.$selected,f=!0);this._last_selected=[].concat(b);f&&this._paint_spans()},_span_sum_width:function(a,b){for(var c=0;a<b;a++){var d=this._columns[a];c+=d?d.width:0}return c},_span_sum_height:function(a,b){for(var c=0;a<b;a++){var d=this.getItem(this.data.order[a]);c+=d?this._getRowHeight(d):
this._settings.rowHeight}return c},_add_span_to_area:function(a,b,c,d,e,f,g,h){var k=d[h];g=k[2]||this.getText(g,h);var l="";!d.$selected||"row"!==this._settings.select&&d.$selected.column!==h||(l="webix_selected ");d={column:c,row:b,"class":l+"webix_cell webix_table_cell webix_dtable_span "+(k[3]||""),"aria-colindex":c+1,"aria-rowindex":b+1};1<k[0]&&(d["aria-colspan"]=k[0]);1<k[1]&&(d["aria-rowspan"]=k[1]);d=webix.html.create("DIV",d,""+g);d.style.top=e+"px";d.style.left=this._span_sum_width(f,c)+
"px";d.style.width=this._span_sum_width(c,c+k[0])+"px";d.style.height=this._span_sum_height(b,b+k[1])+"px";a.appendChild(d)},_adjust_spans_xy:function(){if(!this._settings.prerender)for(var a=this.getScrollState(),b=0;3>b;b++)this._spans_areas[b].style.top="-"+(a.y||0)+"px"},_checkCellMerge:function(a,b){var c=!1;this._spans_pull&&(a=this.getSpan(a.row,a.column),b=this.getSpan(b.row,b.column),a&&b&&a[0]==b[0]&&a[1]==b[1]&&(c=!0));return c},getSpanNode:function(a){var b=this._spans_areas,c=this.getIndexById(a.row);
a=this.getColumnIndex(a.column);for(var d=0;d<b.length;d++)for(var e=b[d].childNodes,f=0;f<e.length;f++)if(e[f].getAttribute("row")==c&&e[f].getAttribute("column")==a)return e[f];return null}});
webix.extend(webix.ui.datatable,{subrow_setter:function(a){return a?(this._init_subrow_once(),this._settings.fixedRowHeight=!1,webix.template(a)):!1},subview_setter:function(a){a&&(this._settings.subrow=this.subrow_setter("<div></div>"));return a},defaults:{subRowHeight:35},_refresh_sub_all:function(){this.data.each(function(a){a&&(a.$sub=this._settings.subrow(a,this.type))},this);this._resize_sub_all()},_resize_sub_all:function(a){"auto"===this._settings.subRowHeight&&this._content_width&&this._adjustSubRowHeight();
if(a&&this._settings.subview)for(var b in this._subViewStorage)a=webix.$$(this._subViewStorage[b]),a._settings.hidden||a.adjust()},_refresh_sub_one:function(a){a=this.getItem(a);a.$sub=this._settings.subrow(a,this.type);"auto"===this._settings.subRowHeight&&this._adjustSubRowHeight(a.id,a.$sub)},$init:function(){this._init_subrow_once=webix.once(function(){var a="#"+this._top_id+" .webix_cell.webix_dtable_subview { line-height:normal;}";this._settings.fixedRowHeight&&(a+="#"+this._top_id+" .webix_column .webix_cell { white-space: nowrap;}");
webix.html.addStyle(a);this._subViewStorage={};this.attachEvent("onSubViewRender",this._render_sub_view);this.data.attachEvent("onStoreUpdated",webix.bind(function(a,c,d){a?"update"!=d&&"add"!=d||this._refresh_sub_one(a):this._refresh_sub_all()},this));this.attachEvent("onResize",function(a,c,d){d!=a&&this._resize_sub_all(!0)})});this.type.subrow=function(a){return a.$sub?a.$subopen?"<div class='webix_tree_open webix_sub_open'></div>":"<div class='webix_tree_close webix_sub_close'></div>":"<div class='webix_tree_none'></div>"};
this.on_click.webix_sub_open=function(a,b){this.closeSub(b);return!1};this.on_click.webix_sub_close=function(a,b){this.openSub(b);return!1}},openSub:function(a){var b=this.getItem(a);if(!b.$subopen){b.$row=this._settings.subrow;b.$subHeight=b.$subHeight||this._settings.subRowHeight;b.$subopen=!0;if(b=this._subViewStorage[b.$subContent])b.repaintMe=!0;this.refresh(a);this.callEvent("onSubViewOpen",[a])}},getSubView:function(a){if(a=this.getItem(a))if(a=this._subViewStorage[a.$subContent])return webix.$$(a);
return null},resizeSubView:function(a){var b=this.getSubView(a);b&&this._resizeSubView(this.getItem(a),b)},_resizeSubView:function(a,b){b=b.$getSize(0,0)[2];2<Math.abs(b-(a.$subHeight||this._settings.subRowHeight||0))&&(a.$subHeight=b,this.refresh(a.id))},_checkSubWidth:function(a){var b=a.$width;if(a._layout_sizes){var c=a._cells.length-a._hiddencells;b=a._vertical_orientation?b-(2*a._paddingX+2):b-(a._margin*(c-1)+2*a._paddingX+2*c)}return 0<b},_render_sub_view:function(a,b){var c=this._subViewStorage[a.$subContent];
c?(b.firstChild.appendChild(c),b=webix.$$(a.$subContent),this._checkSubWidth(b)||b.adjust(),c.repaintMe&&(delete c.repaintMe,b.config.hidden=!1,b._render_hidden_views())):(b=webix.ui(webix.copy(this._settings.subview),b.firstChild),b.getMasterView=webix.bind(function(){return this},this),a.$subContent=b.config.id,this._subViewStorage[a.$subContent]=b.$view,b.attachEvent("onResize",webix.bind(function(b,c,f,g){c&&c!=g&&this.refresh(a.id)},this)),this.callEvent("onSubViewCreate",[b,a]));this._resizeSubView(a,
b||webix.$$(c))},_destroy_sub_view:function(a){a=this.getItem(a);var b=this._subViewStorage[a.$subContent];b&&(delete a.$subContent,(a=webix.$$(b))&&a!=this&&a.destructor())},_adjustSubRowHeight:function(a,b){var c=webix.html.create("DIV",{"class":"webix_measure_size webix_cell webix_dtable_subrow"},"");c.style.cssText="width:"+this._content_width+"px; height:auto; visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;";this.$view.appendChild(c);this.data.each(function(d){if(d&&
!a||d.id==a&&d.$sub)c.innerHTML=b||this._settings.subrow(d,this.type),d.$subHeight=c.offsetHeight},this);c=webix.html.remove(c)},closeSub:function(a){var b=this.getItem(a);if(b.$subopen){b.$row=!1;b.$subopen=!1;if(b=this._subViewStorage[b.$subContent])webix.$$(b).config.hidden=!0;this.refresh(a);this.callEvent("onSubViewClose",[a])}}});
webix.extend(webix.ui.datatable,{headermenu_setter:function(a){a&&(a.data&&(this._preconfigured_hmenu=!0),a=this._init_hmenu_once(a));return a},_init_hmenu_once:function(a){var b={view:"contextmenu",template:"<span class='webix_icon {common.hidden()}'></span> &nbsp; #value#",type:{hidden:function(a){return a.hidden?"fa-empty":"fa-eye"}},on:{onMenuItemClick:webix.bind(function(b,d){d=webix.$$(this._settings.headermenu);var c=d.getItem(b).hidden;d.getItem(b).hidden=!c;d.refresh(b);d.$blockRender=!0;
var f={spans:"object"==typeof a&&a.spans};c?this.showColumn(b,f):this.hideColumn(b,f);return d.$blockRender=!1},this)},data:[]};"object"==typeof a&&webix.extend(b,a,!0);b=webix.ui(b);b.attachTo(this._header);this._destroy_with_me.push(b);this.attachEvent("onStructureLoad",this._generate_menu_columns);this.attachEvent("onStructureUpdate",this._generate_menu_columns);this._init_hmenu_once=function(a){return a};return b._settings.id},_generate_menu_columns:function(){var a,b=webix.$$(this._settings.headermenu);
var c=this.getState().hidden;if(!b.$blockRender)if(this._preconfigured_hmenu)b.data.each(function(a){for(var b=a.hidden=0;b<c.length;b++)if(c[b]===a.id){a.hidden=1;break}}),b.refresh();else{var d=[];for(a=0;a<this._columns.length;a++){var e=this._columns[a];var f=e.header[0];!1!==e.headermenu&&f&&d.push({id:e.id,value:f.groupText||f.text})}for(a=c.length-1;0<=a;a--)e=this.getColumnConfig(c[a]),f=e.header[0],!1!==e.headermenu&&f&&d.push({id:c[a],value:f.text,hidden:1});d.length&&b.data.importData(d)}}});
webix.ui.datafilter.headerMenu={getValue:function(){},setValue:function(){},refresh:function(a,b,c){a._settings.headermenu||(a.define("headermenu",!0),a._generate_menu_columns());b.onclick=function(){webix.$$(a.config.headermenu).show(b)}},render:function(a,b){return"<span class='webix_icon fa-columns' role='button' tabindex='0' aria-label='"+webix.i18n.aria.headermenu+"'>"}};
webix.ui.datafilter.richSelectFilter={getInputNode:function(a){return webix.$$(a.$webix)||null},getValue:function(a){return(a=this.getInputNode(a))?a.getValue():""},setValue:function(a,b){return(a=this.getInputNode(a))?a.setValue(b):""},compare:function(a,b){return a==b},refresh:function(a,b,c){if(!a.$destructed){var d=webix.$$(c.richselect);d.$view.parentNode||webix.html.create("div",{"class":"webix_richfilter"}).appendChild(d.$view);b.$webix=c.richselect;b.style.marginLeft="-10px";c.compare=c.compare||
this.compare;c.prepare=c.prepare||this.prepare;a.registerFilter(b,c,this);var e=c.options;if(e)if("string"==typeof e){var f=c.options=[];webix.ajax(e).then(webix.bind(function(b){c.options=b.json();var d=document.body.contains(d)?d:document.body.querySelector('[active_id="'+c.contentId+'"]');this.refresh(a,d,c)},this))}else f=e;else f=a.collectValues(c.columnId);var g=d.getPopup().getList();(e=webix.$$(e))&&e.data&&e.data.getRange&&(f=e.data.getRange());b.firstChild.appendChild(d.$view.parentNode);
g.parse&&(g.clearAll(),g.parse(f),(!this.$noEmptyOption&&!1!==c.emptyOption||c.emptyOption)&&g.add({id:"",value:c.emptyOption||"",$empty:!0},0));c.value&&this.setValue(b,c.value);d.render();webix.delay(d.resize,d)}},render:function(a,b){if(!b.richselect){var c={container:webix.html.create("div",{"class":"webix_richfilter"}),view:this.inputtype,options:[]},d=webix.extend(this.inputConfig||{},b.inputConfig||{},!0);webix.extend(c,d);b.separator&&(c.separator=b.separator);b.suggest&&(c.suggest=b.suggest);
c=webix.ui(c);c.attachEvent("onChange",function(){a.filterByAll()});b.richselect=c._settings.id;a._destroy_with_me.push(c)}b.css="webix_div_filter";return" "},inputtype:"richselect"};webix.ui.datafilter.serverRichSelectFilter=webix.extend({$server:!0},webix.ui.datafilter.richSelectFilter);
webix.ui.datafilter.multiSelectFilter=webix.extend({$noEmptyOption:!0,inputtype:"multiselect",prepare:function(a,b){if(!a)return a;var c={};a=a.toString().split(b.separator||",");for(b=0;b<a.length;b++)c[a[b]]=1;return c},compare:function(a,b){return!b||b[a]}},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.serverMultiSelectFilter=webix.extend({$server:!0,_on_change:function(a,b,c){webix.$$(this._comp_id).filterByAll()}},webix.ui.datafilter.multiSelectFilter);
webix.ui.datafilter.multiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:!1}},webix.ui.datafilter.multiSelectFilter);webix.ui.datafilter.serverMultiComboFilter=webix.extend({inputtype:"multicombo",inputConfig:{tagMode:!1}},webix.ui.datafilter.serverMultiSelectFilter);webix.ui.datafilter.datepickerFilter=webix.extend({prepare:function(a){return a||""},compare:function(a,b){return 1*a==1*b},inputtype:"datepicker"},webix.ui.datafilter.richSelectFilter);
webix.ui.datafilter.columnGroup={getValue:function(){},setValue:function(){},getHelper:function(a,b){return{open:function(){b.closed=!0;a.onclick()},close:function(){b.closed=!1;a.onclick()},isOpened:function(){return b.closed}}},refresh:function(a,b,c){b.onclick=function(b){webix.html.stopEvent(b);b=this.firstChild.firstChild;c.closed?(c.closed=!1,b.className="webix_tree_open"):(c.closed=!0,b.className="webix_tree_close");webix.delay(function(){a.callEvent("onColumnGroupCollapse",[c.columnId,c.batch,
!c.closed]);a.showColumnBatch(c.batch,!c.closed)})};c.firstRun||(c.firstRun=1,c.closed&&a.showColumnBatch(c.batch,!1))},render:function(a,b){return"<div role='button' tabindex='0' aria-label='"+webix.i18n.aria[b.closed?"openGroup":"closeGroup"]+"' class='"+(b.closed?"webix_tree_close":"webix_tree_open")+"'></div>&nbsp;"+(b.groupText||"")}};
webix.ui.datafilter.dateRangeFilter=webix.extend({prepare:function(a){return webix.ui.daterange.prototype._correct_value(a)},compare:function(a,b){return(!b.start||a>=b.start)&&(!b.end||a<=b.end)},inputtype:"daterangepicker"},webix.ui.datafilter.richSelectFilter);webix.ui.datafilter.serverDateRangeFilter=webix.extend({$server:!0},webix.ui.datafilter.dateRangeFilter);webix.editors.$popup.multiselect={view:"multisuggest",suggest:{button:!0}};
webix.Canvas=webix.proto({$init:function(a){this._canvas_labels=[];this._canvas_series=webix.isUndefined(a.series)?a.name:a.series;this._obj=webix.toNode(a.container||a);var b=a.width*(window.devicePixelRatio||1),c=a.height*(window.devicePixelRatio||1),d=a.style||"";d+=";width:"+a.width+"px;height:"+a.height+"px;";this._prepareCanvas(a.name,d,b,c,a.title)},_prepareCanvas:function(a,b,c,d,e){this._canvas=webix.html.create("canvas",{title:e,width:c,height:d,canvas_id:a,style:b||""});this._obj.appendChild(this._canvas);
this._canvas.getContext||(webix.env.isIE?(webix.require("legacy/excanvas/excanvas.js",!0),G_vmlCanvasManager.init_(document),G_vmlCanvasManager.initElement(this._canvas)):webix.assert(this._canvas.getContext,"Canvas is not supported in the browser"));return this._canvas},getCanvas:function(a){a=(this._canvas||this._prepareCanvas(this._contentobj)).getContext(a||"2d");this._webixDevicePixelRatio||(this._webixDevicePixelRatio=!0,a.scale(window.devicePixelRatio||1,window.devicePixelRatio||1));return a},
_resizeCanvas:function(a,b){this._canvas&&(this._canvas.setAttribute("width",a*(window.devicePixelRatio||1)),this._canvas.setAttribute("height",b*(window.devicePixelRatio||1)),this._canvas.style.width=a+"px",this._canvas.style.height=b+"px",this._webixDevicePixelRatio=!1)},renderText:function(a,b,c,d,e){if(c)return e&&(e=Math.max(e,0)),b&&(b=Math.max(b,0)),a=webix.html.create("DIV",{"class":"webix_canvas_text"+(d?" "+d:""),style:"left:"+a+"px; top:"+b+"px;","aria-hidden":"true"},c),this._obj.appendChild(a),
this._canvas_labels.push(a),e&&(a.style.width=e+"px"),a},renderTextAt:function(a,b,c,d,e,f,g){if(e=this.renderText.call(this,c,d,e,f,g))a&&(e.style.top="middle"==a?parseInt(d-e.offsetHeight/2,10)+"px":d-e.offsetHeight+"px"),b&&(e.style.left="left"==b?c-e.offsetWidth+"px":parseInt(c-e.offsetWidth/2,10)+"px");return e},clearCanvas:function(a){webix.html.remove(this._canvas_labels);this._canvas_labels=[];if(!a&&this._obj._htmlmap){for(a=this._getMapAreas();a.length;)a[0].parentNode.removeChild(a[0]),
a.splice(0,1);this._obj._htmlmap.getElementsByTagName("AREA").length||(this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap),this._obj._htmlmap=null)}this.getCanvas().clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight)},toggleCanvas:function(){this._toggleCanvas("none"==this._canvas.style.display)},showCanvas:function(){this._toggleCanvas(!0)},hideCanvas:function(){this._toggleCanvas(!1)},_toggleCanvas:function(a){var b;for(b=0;b<this._canvas_labels.length;b++)this._canvas_labels[b].style.display=
a?"":"none";if(this._obj._htmlmap){var c=this._getMapAreas();for(b=0;b<c.length;b++)a?c[b].removeAttribute("disabled"):c[b].setAttribute("disabled","true")}this._canvas.style.display=a?"":"none"},_getMapAreas:function(){var a=[],b;var c=this._obj._htmlmap.getElementsByTagName("AREA");for(b=0;b<c.length;b++)c[b].getAttribute("userdata")==this._canvas_series&&a.push(c[b]);return a}});
webix.color={_toHex:"0123456789ABCDEF".split(""),toHex:function(a,b){a=parseInt(a,10);for(var c="";0<a;)c=this._toHex[a%16]+c,a=Math.floor(a/16);for(;c.length<b;)c="0"+c;return c},rgbToHex:function(a){var b=[];"string"===typeof a?a.replace(/[\d+\.]+/g,function(a){b.push(parseFloat(a))}):webix.isArray(a)&&(b=a);return 0===b[3]?"":b.slice(0,3).map(function(a){return webix.color.toHex(Math.floor(a),2)}).join("")},hexToDec:function(a){return parseInt(a,16)},toRgb:function(a){if("string"!=typeof a){var b=
a[0];var c=a[1];a=a[2]}else-1!=a.indexOf("rgb")?(a=a.substr(a.indexOf("(")+1,a.lastIndexOf(")")-a.indexOf("(")-1).split(","),b=a[0],c=a[1],a=a[2]):("#"==a.substr(0,1)&&(a=a.substr(1)),b=this.hexToDec(a.substr(0,2)),c=this.hexToDec(a.substr(2,2)),a=this.hexToDec(a.substr(4,2)));b=parseInt(b,10)||0;c=parseInt(c,10)||0;a=parseInt(a,10)||0;if(0>b||255<b)b=0;if(0>c||255<c)c=0;if(0>a||255<a)a=0;return[b,c,a]},hsvToRgb:function(a,b,c){var d;var e=Math.floor(a/60)%6;var f=a/60-e;a=c*(1-b);var g=c*(1-f*b);
b=c*(1-(1-f)*b);var h=d=f=0;switch(e){case 0:f=c;d=b;h=a;break;case 1:f=g;d=c;h=a;break;case 2:f=a;d=c;h=b;break;case 3:f=a;d=g;h=c;break;case 4:f=b;d=a;h=c;break;case 5:f=c,d=a,h=g}f=Math.floor(255*f);d=Math.floor(255*d);h=Math.floor(255*h);return[f,d,h]},rgbToHsv:function(a,b,c){a/=255;b/=255;c/=255;var d=Math.min(a,b,c);var e=Math.max(a,b,c);var f=0;e==d?f=0:e==a&&b>=c?f=60*(b-c)/(e-d):e==a&&b<c?f=60*(b-c)/(e-d)+360:e==b?f=60*(c-a)/(e-d)+120:e==c&&(f=60*(a-b)/(e-d)+240);return[f,0===e?0:1-d/e,
e]}};
webix.HtmlMap=webix.proto({$init:function(a){this._id="map_"+webix.uid();this._key=a;this._map=[];this._areas=[]},addRect:function(a,b,c){this._createMapArea(a,"RECT",b,c)},addPoly:function(a,b,c){this._createMapArea(a,"POLY",b,c)},_createMapArea:function(a,b,c,d){var e="";4==arguments.length&&(e="userdata='"+d+"'");this._map.push("<area "+this._key+"='"+a+"' shape='"+b+"' coords='"+c.join()+"' "+e+"></area>");this._areas.push({index:d,points:c})},addSector:function(a,b,c,d,e,f,g,h){var k=[];k.push(d);
for(k.push(Math.floor(e*g));b<c;b+=Math.PI/18)k.push(Math.floor(d+f*Math.cos(b))),k.push(Math.floor((e+f*Math.sin(b))*g));k.push(Math.floor(d+f*Math.cos(c)));k.push(Math.floor((e+f*Math.sin(c))*g));k.push(d);k.push(Math.floor(e*g));return this.addPoly(a,k,h)},hide:function(a,b,c){if(a.querySelectorAll)for(a=a.querySelectorAll('area[userdata="'+b+'"]'),b=0;b<a.length;b++){var d=a[b];c?d.getAttribute("coords")&&(d.coordsdis=d.getAttribute("coords"),d.setAttribute("coords",""),d.coords=""):!c&&d.coordsdis&&
(d.setAttribute("coords",d.coordsdis),d.coords=d.coordsdis,d.coordsdis="");a[b].style.display=c?"none":""}},render:function(a){var b=webix.html.create("DIV");b.style.cssText="position:absolute; width:100%; height:100%; top:0px; left:0px;";a.appendChild(b);var c=webix.env.isIE?"":"src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='";b.innerHTML="<map id='"+this._id+"' name='"+this._id+"'>"+this._map.join("\n")+"</map><img "+c+" class='webix_map_img' usemap='#"+
this._id+"'>";a._htmlmap=b;this._map=[]}});
webix.protoUI({name:"chart",$init:function(a){this._series=[this._settings];this._legend_labels=[];this._contentobj.className+=" webix_chart";this.$ready.push(this._after_init_call);a.preset&&this._definePreset(a);if(a.series){var b=a.series;delete a.series;a.series=b}this.attachEvent("onMouseMove",this._switchSeries);this.data.provideApi(this,!0)},_after_init_call:function(){this.data.attachEvent("onStoreUpdated",webix.bind(function(){this.render.apply(this,arguments)},this))},defaults:{ariaLabel:"chart",
color:"default",alpha:"1",label:!1,value:"{obj.value}",padding:{},type:"pie",lineColor:"#ffffff",cant:.5,barWidth:30,line:{width:2,color:"#1293f8"},item:{radius:3,borderColor:"#636363",borderWidth:1,color:"#ffffff",alpha:1,type:"r",shadow:!1},shadow:!0,gradient:!1,border:!0,labelOffset:20,origin:"auto",scale:"linear"},_id:"webix_area_id",on_click:{webix_chart_legend_item:function(a,b,c){b=c.getAttribute("series_id");if(this.callEvent("onLegendClick",[a,b,c])&&"undefined"!=typeof b&&1<this._series.length){a=
this._settings;var d=a.legend.values;if(d&&d[b].toggle||a.legend.toggle)-1!=c.className.indexOf("hidden")?this.showSeries(b):this.hideSeries(b)}}},on_dblclick:{},on_mouse_move:{},locate:function(a){return webix.html.locate(a,this._id)},$setSize:function(a,b){if(a=webix.ui.view.prototype.$setSize.call(this,a,b)){for(var c in this.canvases)this.canvases[c]._resizeCanvas(this._content_width,this._content_height);this.render()}return a},type_setter:function(a){webix.assert(this["$render_"+a],"Chart type is not supported, or extension is not loaded: "+
a);"undefined"==typeof this._settings.offset&&(this._settings.offset=-1==a.toLowerCase().indexOf("area"));"radar"!=a||this._settings.yAxis||this.define("yAxis",{});"scatter"==a&&(this._settings.yAxis||this.define("yAxis",{}),this._settings.xAxis||this.define("xAxis",{}));return a},destructor:function(){this.removeAllSeries();webix.Destruction.destructor.apply(this,arguments)},removeAllSeries:function(){this.clearCanvas();this._legendObj&&(this._legendObj.innerHTML="",this._legendObj.parentNode.removeChild(this._legendObj),
this._legendObj=null);this.canvases&&(this.canvases={});this._contentobj.innerHTML="";for(var a=0;a<this._series.length;a++)this._series[a].tooltip&&this._series[a].tooltip.destructor();this._series=[]},clearCanvas:function(){if(this.canvases&&"object"==typeof this.canvases)for(var a in this.canvases)this.canvases[a].clearCanvas()},render:function(a,b,c){var d;if(this.isVisible(this._settings.id)&&(b=this._getChartData(),this.callEvent("onBeforeRender",[b,c]))){if(this.canvases&&"object"==typeof this.canvases)for(d in this.canvases)this.canvases[d].clearCanvas();
else this.canvases={};this._settings.legend&&(this.canvases.legend||(this.canvases.legend=this._createCanvas("legend")),this._drawLegend(this.data.getRange(),this._content_width,this._content_height));this._map=c=new webix.HtmlMap(this._id);var e=this._settings;a=this._getChartBounds(this._content_width,this._content_height);if(this._series)for(d=0;d<this._series.length;d++)this._settings=this._series[d],this.canvases[d]||(this.canvases[d]=this._createCanvas(this.name+" "+d,"z-index:"+(2+d),null,
d,this._settings.ariaLabel)),this["$render_"+this._settings.type](this.canvases[d].getCanvas(),b,a.start,a.end,d,c);c.render(this._contentobj);this._contentobj.lastChild.style.zIndex=100;this._applyBounds(this._contentobj.lastChild,a);this.callEvent("onAfterRender",[b]);this._settings=e}},_applyBounds:function(a,b){var c={};c.left=b.start.x;c.top=b.start.y;c.width=b.end.x-b.start.x;c.height=b.end.y-b.start.y;for(var d in c)a.style[d]=c[d]+"px"},_getChartData:function(){var a,b;var c=this.data.getRange();
var d=-1!=this._settings.type.toLowerCase().indexOf("barh")?"yAxis":"xAxis";if((a=this._settings[d])&&a.units&&"object"==typeof a.units){var e=a.units;d=[];if("undefined"!=typeof e.start&&"undefined"!=typeof e.end&&"undefined"!=typeof e.next)for(b=e.start;b<=e.end;)d.push(b),b=e.next.call(this,b);else"[object Array]"===Object.prototype.toString.call(e)&&(d=e);e=[];if(d.length){b=a.value;var f={};for(a=0;a<c.length;a++)f[b(c[a])]=a;for(a=0;a<d.length;a++)"undefined"!=typeof f[d[a]]?(c[f[d[a]]].$unit=
d[a],e.push(c[f[d[a]]])):e.push({$unit:d[a]})}return e}return c},series_setter:function(a){if("object"!=typeof a)webix.assert(a,"Chart :: Series must be an array or object");else{this._parseSettings(a.length?a[0]:a);this._series=[this._settings];for(var b=1;b<a.length;b++)this.addSeries(a[b])}return a},value_setter:webix.template,xValue_setter:webix.template,yValue_setter:function(a){this.define("value",a)},alpha_setter:webix.template,label_setter:webix.template,lineColor_setter:webix.template,borderColor_setter:webix.template,
pieInnerText_setter:webix.template,gradient_setter:function(a){"function"!=typeof a&&a&&!0===a&&(a="light");return a},colormap:{RAINBOW:function(a){a=Math.floor(this.getIndexById(a.id)/this.count()*1536);1536==a&&--a;return this._rainbow[Math.floor(a/256)](a%256)},"default":function(a){var b=this.count(),c=this._defColors.length;a=this.getIndexById(a.id);c>b?(a&&(a=a<c-b?this._defColorsCursor+2:this._defColorsCursor+1),this._defColorsCursor=a):a%=c;return this._defColors[a]}},color_setter:function(a){return this.colormap[a]||
webix.template(a)},fill_setter:function(a){return a&&"0"!=a?webix.template(a):!1},_definePreset:function(a){this.define("preset",a.preset);delete a.preset},preset_setter:function(a){var b,c;this.defaults=webix.extend({},this.defaults);var d=this.presets[a];if("object"==typeof d){for(b in d)if("object"==typeof d[b])if(this.defaults[b]&&"object"==typeof this.defaults[b])for(c in this.defaults[b]=webix.extend({},this.defaults[b]),d[b])this.defaults[b][c]=d[b][c];else this.defaults[b]=webix.extend({},
d[b]);else this.defaults[b]=d[b];return a}return!1},legend_setter:function(a){if(!a)return this._legendObj&&(this._legendObj.innerHTML="",this._legendObj=null),!1;"object"!=typeof a&&(a={template:a});this._mergeSettings(a,{width:150,height:18,layout:"y",align:"left",valign:"bottom",template:"",toggle:-1!=this._settings.type.toLowerCase().indexOf("stacked")?"":"hide",marker:{type:"square",width:15,height:15,radius:3},margin:4,padding:3});a.template=webix.template(a.template);return a},item_setter:function(a){"object"!=
typeof a&&(a={color:a,borderColor:a});this._mergeSettings(a,webix.extend({},this.defaults.item));this._converToTemplate(["alpha","borderColor","color","radius"],a);return a},line_setter:function(a){"object"!=typeof a&&(a={color:a});a=webix.extend(a,this.defaults.line);a.color=webix.template(a.color);return a},padding_setter:function(a){"object"!=typeof a&&(a={left:a,right:a,top:a,bottom:a});this._mergeSettings(a,{left:50,right:20,top:35,bottom:40});return a},xAxis_setter:function(a){if(!a)return!1;
"object"!=typeof a&&(a={template:a});this._mergeSettings(a,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:!0});this._converToTemplate(["lineColor","template","lines"],a);this._configXAxis=webix.extend({},a);return a},yAxis_setter:function(a){this._mergeSettings(a,{title:"",color:"#000000",lineColor:"#cfcfcf",template:"{obj}",lines:!0,bg:"#ffffff"});this._converToTemplate(["lineColor","template","lines","bg"],a);this._configYAxis=webix.extend({},a);return a},_converToTemplate:function(a,
b){for(var c=0;c<a.length;c++)b[a[c]]=webix.template(b[a[c]])},_createCanvas:function(a,b,c,d,e){a={container:c||this._contentobj,name:a,title:webix.isUndefined(e)?a:e||"",series:d,style:b||"",width:this._content_width,height:this._content_height};return new webix.Canvas(a)},_drawScales:function(a,b,c,d,e,f){var g=0;this._settings.yAxis&&(this.canvases.y||(this.canvases.y=this._createCanvas("axis_y")),g=this._drawYAxis(this.canvases.y.getCanvas(),a,b,c,d,e));this._settings.xAxis&&(this.canvases.x||
(this.canvases.x=this._createCanvas("axis_x")),d=this.canvases.x.getCanvas(),this.callEvent("onBeforeXAxis",[d,a,b,c,f,g])&&this._drawXAxis(d,a,b,c,f,g));return g},_drawXAxis:function(a,b,c,d,e,f){var g=this._settings,h=c.x-.5,k=parseInt(f?f:d.y,10)+.5,l=d.x,m=!0,n="stackedBar"==g.type?d.y+.5:k;for(f=0;f<b.length;f++){if(!0===g.offset)var p=h+e/2+f*e;else p=f!=b.length-1||g.cellWidth?h+f*e:d.x,m=!!f;p=Math.ceil(p)-.5;var q="auto"!=g.origin&&"bar"==g.type&&parseFloat(g.value(b[f]))<g.origin;this._drawXAxisLabel(p,
n,b[f],m,q);(g.offset||f||g.cellWidth)&&g.xAxis.lines.call(this,b[f])&&this._drawXAxisLine(a,p,d.y,c.y,b[f])}this.canvases.x.renderTextAt(!0,!1,h,d.y+g.padding.bottom-3,g.xAxis.title,"webix_axis_title_x",d.x-c.x);this._drawLine(a,h,k,l,k,g.xAxis.color,1);g.xAxis.lines.call(this,{})&&g.offset&&this._drawLine(a,l+.5,d.y,l+.5,c.y+.5,g.xAxis.color,.2)},_drawYAxis:function(a,b,c,d,e,f){var g;b={};if(this._settings.yAxis){var h=c.x-.5,k=d.y,l=c.y,m=d.y+.5;this._settings.yAxis.step&&(g=parseFloat(this._settings.yAxis.step));
"undefined"==typeof this._configYAxis.step||"undefined"==typeof this._configYAxis.start||"undefined"==typeof this._configYAxis.end?(b=this._calculateScale(e,f),e=b.start,f=b.end,g=b.step,this._settings.yAxis.end=f,this._settings.yAxis.start=e):"logarithmic"==this.config.scale&&(this._logScaleCalc=!0);this._setYAxisTitle(c,d);if(0!==g){if(f==e)return k;for(var n=(k-l)*g/(f-e),p=0,q=e;q<=f;q+=g){var r=this._logScaleCalc?Math.pow(10,q):q;b.fixNum&&(r=parseFloat(r).toFixed(b.fixNum));var v=Math.floor(k-
p*n)+.5;q==e&&"auto"==this._settings.origin||!this._settings.yAxis.lines.call(this,q)||this._drawLine(a,h,v,d.x,v,this._settings.yAxis.lineColor.call(this,q),1);q==this._settings.origin&&(m=v);1>g&&!this._logScaleCalc&&(q=Math.min(Math.floor(this._log10(g)),0>=e?0:Math.floor(this._log10(e))),q=Math.pow(10,-q),q=r=Math.round(r*q)/q);this.canvases.y.renderText(0,v-5,this._settings.yAxis.template(r.toString()),"webix_axis_item_y",c.x-5);p++}this._drawLine(a,h,k+1,h,l,this._settings.yAxis.color,1);return m}}},
_setYAxisTitle:function(a,b){var c="webix_axis_title_y"+(webix._isIE&&9!=webix._isIE?" webix_ie_filter":"");if(a=this.canvases.y.renderTextAt("middle",!1,0,parseInt((b.y-a.y)/2+a.y,10),this._settings.yAxis.title,c))a.style.left=(webix.env.transform?(a.offsetHeight-a.offsetWidth)/2:0)+"px"},_calculateLogScale:function(a,b){a=Math.floor(this._log10(a));b=Math.ceil(this._log10(b));return{start:a,step:1,end:b}},_normStep:function(a){var b=Math.floor(this._log10(a));b=Math.pow(10,b);return parseInt(5<
a/b?10:5,10)*b},_calculateScale:function(a,b){this._logScaleCalc=!1;if("logarithmic"==this._settings.scale){var c=Math.floor(this._log10(a)),d=Math.ceil(this._log10(b));if(0<a&&0<b&&1<d-c)return this._logScaleCalc=!0,this._calculateLogScale(a,b)}"auto"!=this._settings.origin&&this._settings.origin<a&&(a=this._settings.origin);c=this._normStep((b-a)/8||1);if(c>Math.abs(a))d=0>a?-c:0;else{var e=Math.abs(a);d=Math.floor(this._log10(e));d=Math.ceil(e/Math.pow(10,d)*10)/10*Math.pow(10,d)-c;for(1<e&&.1<
c&&(d=Math.ceil(d));0>a?d<=a:d>=a;)d-=c;0>a&&(d=-d-2*c)}10<b-d&&(c=this._normStep((b-d)/8||1));a=d;for(e=Math.floor(this._log10(c));a<b;)a+=c,a=parseFloat((1*a).toFixed(Math.abs(e)));return{start:d,end:a,step:c,fixNum:0>e?Math.abs(e):0}},_getLimits:function(a,b){var c=this.data._obj_array();var d=arguments.length&&"h"==a?this._configXAxis:this._configYAxis;b=b||"value";if(d&&"undefined"!=typeof d.end&&"undefined"!=typeof d.start&&d.step){var e=parseFloat(d.end);d=parseFloat(d.start)}else if(e=webix.GroupMethods.max(this._series[0][b],
c),d=d&&"undefined"!=typeof d.start?parseFloat(d.start):webix.GroupMethods.min(this._series[0][b],c),1<this._series.length)for(var f=1;f<this._series.length;f++){var g=webix.GroupMethods.max(this._series[f][b],c),h=webix.GroupMethods.min(this._series[f][b],c);g>e&&(e=g);h<d&&(d=h)}return{max:e,min:d}},_log10:function(a){return Math.log(a)/Math.LN10},_drawXAxisLabel:function(a,b,c,d,e){this._settings.xAxis&&(a=this.canvases.x.renderTextAt(e,d,a,b-(e?2:0),this._settings.xAxis.template(c)))&&(a.className+=
" webix_axis_item_x")},_drawXAxisLine:function(a,b,c,d,e){this._settings.xAxis&&this._settings.xAxis.lines&&this._drawLine(a,b,c,b,d,this._settings.xAxis.lineColor.call(this,e),1)},_drawLine:function(a,b,c,d,e,f,g){a.strokeStyle=f;a.lineWidth=g;a.beginPath();a.moveTo(b,c);a.lineTo(d,e);a.stroke();a.lineWidth=1},_getRelativeValue:function(a,b){return[b!=a?b-a:a,1]},_rainbow:[function(a){return"#FF"+webix.color.toHex(a/2,2)+"00"},function(a){return"#FF"+webix.color.toHex(a/2+128,2)+"00"},function(a){return"#"+
webix.color.toHex(255-a,2)+"FF00"},function(a){return"#00FF"+webix.color.toHex(a,2)},function(a){return"#00"+webix.color.toHex(255-a,2)+"FF"},function(a){return"#"+webix.color.toHex(a,2)+"00FF"}],_defColors:"#f55b50 #ff6d3f #ffa521 #ffc927 #ffee54 #d3e153 #9acb61 #63b967 #21a497 #21c5da #3ea4f5 #5868bf #7b53c0 #a943ba #ec3b77 #9eb0b8".split(" "),_defColorsCursor:0,addSeries:function(a){var b=webix.extend({},this._settings);this._settings=webix.extend({},b);this._parseSettings(a,{});this._series.push(this._settings);
this._settings=b},_switchSeries:function(a,b,c){if(c.getAttribute("userdata")&&(this._active_serie=1==this._series.length?this._getActiveSeries(b):c.getAttribute("userdata"),this._series[this._active_serie])){for(b=0;b<this._series.length;b++)(a=this._series[b].tooltip)&&a.disable();c.getAttribute("disabled")||(a=this._series[this._active_serie].tooltip)&&a.enable()}},_getActiveSeries:function(a){var b;var c=this._map._areas;var d=webix.html.offset(this._contentobj._htmlmap);var e=webix.html.pos(a);
a=e.x-d.x;var f=e.y-d.y;for(e=0;e<c.length;e++)d=c[e].points,a<=d[2]&&a>=d[0]&&f<=d[3]&&f>=d[1]&&(b?c[e].index>b.index&&(b=c[e]):b=c[e]);return b?b.index:0},hideSeries:function(a){this.canvases[a].hideCanvas();var b=this._settings.legend;b&&b.values&&b.values[a]&&(b.values[a].$hidden=!0,this._drawLegend());this._map.hide(this._contentobj,a,!0)},showSeries:function(a){this.canvases[a].showCanvas();var b=this._settings.legend;b&&b.values&&b.values[a]&&(delete b.values[a].$hidden,this._drawLegend());
this._map.hide(this._contentobj,a,!1)},_drawLegend:function(a,b){var c,d=0,e=0;a=a||[];b=b||this._content_width;var f=this.canvases.legend.getCanvas();var g=this._settings.legend;var h="x"!=this._settings.legend.layout?"width:"+g.width+"px":"";this._legendObj&&(this._legendObj.innerHTML="",this._legendObj.parentNode.removeChild(this._legendObj));this.canvases.legend.clearCanvas(!0);var k=webix.html.create("DIV",{"class":"webix_chart_legend",style:"left:"+d+"px; top:"+e+"px;"+h},"");g.padding&&(k.style.padding=
g.padding+"px");this._legendObj=k;this._contentobj.appendChild(k);h=[];if(g.values)for(c=0;c<g.values.length;c++)h.push(this._drawLegendText(k,g.values[c].text,"undefined"!=typeof g.values[c].id?typeof g.values[c].id:c,g.values[c].$hidden));else for(c=0;c<a.length;c++)h.push(this._drawLegendText(k,g.template(a[c]),a[c].id));0===k.offsetWidth&&(k.style.width="auto");var l=k.offsetWidth;c=k.offsetHeight;l<b&&("x"==g.layout&&"center"==g.align&&(d=(b-l)/2),"right"==g.align&&(d=b-l),g.margin&&"center"!=
g.align&&(d+=("left"==g.align?1:-1)*g.margin));c<this._content_height&&("middle"==g.valign&&"center"!=g.align&&"x"!=g.layout?e=(this._content_height-c)/2:"bottom"==g.valign&&(e=this._content_height-c),g.margin&&"middle"!=g.valign&&(e+=("top"==g.valign?1:-1)*g.margin));k.style.left=d+"px";k.style.top=e+"px";f.save();for(c=0;c<h.length;c++)l=h[c],g.values&&g.values[c].$hidden?(k=!0,b=g.values[c].disableColor?g.values[c].disableColor:"#d9d9d9"):(k=!1,b=g.values?g.values[c].color:this._settings.color.call(this,
a[c])),this._drawLegendMarker(f,l.offsetLeft+d,l.offsetTop+e,b,l.offsetHeight,k,c);f.restore()},_drawLegendText:function(a,b,c,d){var e="";"x"==this._settings.legend.layout&&(e="float:left;");e=webix.html.create("DIV",{style:e+"padding-left:"+(10+this._settings.legend.marker.width)+"px","class":"webix_chart_legend_item"+(d?" hidden":""),role:"button",tabindex:"0","aria-label":webix.i18n.aria[(d?"show":"hide")+"Chart"]+" "+b},b);2<arguments.length&&e.setAttribute("series_id",c);a.appendChild(e);return e},
_drawLegendMarker:function(a,b,c,d,e,f,g){var h=this._settings.legend.marker,k=this._settings.legend.values;k=k&&k[g].markerType?k[g].markerType:h.type;d&&(a.strokeStyle=a.fillStyle=d);if("round"!=k&&h.radius)if("item"==k){if(this._settings.line&&"scatter"!=this._settings.type&&!this._settings.disableLines){a.beginPath();a.lineWidth=this._series[g].line.width;a.strokeStyle=f?d:this._series[g].line.color.call(this,{});var l=b+5;k=c+e/2;a.moveTo(l,k);l+=h.width;a.lineTo(l,k);a.stroke()}g=this._series[g].item;
if(k=parseInt(g.radius.call(this,{}),10)||0)a.beginPath(),f?(a.lineWidth=g.borderWidth,a.strokeStyle=d,a.fillStyle=d):(a.lineWidth=g.borderWidth,a.fillStyle=g.color.call(this,{}),a.strokeStyle=g.borderColor.call(this,{}),a.globalAlpha=g.alpha.call(this,{})),a.beginPath(),b+=h.width/2+5,this._strokeChartItem(a,b,c+e/2,k+1,g.type),a.fill(),a.stroke();a.globalAlpha=1}else a.beginPath(),a.lineWidth=1,b+=5,c+=e/2-h.height/2,b=[[b+h.radius,c+h.radius,h.radius,Math.PI,3*Math.PI/2,!1],[b+h.width-h.radius,
c],[b+h.width-h.radius,c+h.radius,h.radius,-Math.PI/2,0,!1],[b+h.width,c+h.height-h.radius],[b+h.width-h.radius,c+h.height-h.radius,h.radius,0,Math.PI/2,!1],[b+h.radius,c+h.height],[b+h.radius,c+h.height-h.radius,h.radius,Math.PI/2,Math.PI,!1],[b,c+h.radius]],this._path(a,b),a.stroke(),a.fill();else a.beginPath(),a.lineWidth=h.height,a.lineCap=h.type,b+=a.lineWidth/2+5,c+=e/2,a.moveTo(b,c),l=b+h.width-h.height+1,a.lineTo(l,c),a.stroke(),a.fill()},_getChartBounds:function(a,b){var c=this._settings.padding.left;
var d=this._settings.padding.top;a-=this._settings.padding.right;b-=this._settings.padding.bottom;if(this._settings.legend){var e=this._settings.legend,f=this._settings.legend.width,g=this._settings.legend.height;"x"==e.layout?"center"==e.valign?"right"==e.align?a-=f:"left"==e.align&&(c+=f):"bottom"==e.valign?b-=g:d+=g:"right"==e.align?a-=f:"left"==e.align&&(c+=f)}return{start:{x:c,y:d},end:{x:a,y:b}}},_getStackedLimits:function(a){var b;if(this._settings.yAxis&&"undefined"!=typeof this._settings.yAxis.end&&
"undefined"!=typeof this._settings.yAxis.start&&this._settings.yAxis.step){var c=parseFloat(this._settings.yAxis.end);var d=parseFloat(this._settings.yAxis.start)}else{for(b=0;b<a.length;b++)for(a[b].$sum=0,a[b].$min=Infinity,c=0;c<this._series.length;c++)d=Math.abs(parseFloat(this._series[c].value(a[b])||0)),isNaN(d)||(-1!=this._series[c].type.toLowerCase().indexOf("stacked")&&(a[b].$sum+=d),d<a[b].$min&&(a[b].$min=d));c=-Infinity;d=Infinity;for(b=0;b<a.length;b++)a[b].$sum>c&&(c=a[b].$sum),a[b].$min<
d&&(d=a[b].$min);0<d&&(d=0)}return{max:c,min:d}},_setBarGradient:function(a,b,c,d,e,f,g,h){if("light"==f){a="x"==h?a.createLinearGradient(b,c,d,c):a.createLinearGradient(b,c,b,e);var k=[[0,"#FFFFFF"],[.9,g],[1,g]];f=2}else"falling"==f||"rising"==f?(a="x"==h?a.createLinearGradient(b,c,d,c):a.createLinearGradient(b,c,b,e),b=webix.color.toRgb(g),b=webix.color.rgbToHsv(b[0],b[1],b[2]),b[1]*=.5,b="rgb("+webix.color.hsvToRgb(b[0],b[1],b[2])+")","falling"==f?k=[[0,b],[.7,g],[1,g]]:"rising"==f&&(k=[[0,g],
[.3,g],[1,b]]),f=0):(a.globalAlpha=.37,f=0,a="x"==h?a.createLinearGradient(b,e,b,c):a.createLinearGradient(b,c,d,c),k=[[0,"#9d9d9d"],[.3,"#e8e8e8"],[.45,"#ffffff"],[.55,"#ffffff"],[.7,"#e8e8e8"],[1,"#9d9d9d"]]);this._gradient(a,k);return{gradient:a,offset:f}},_getPositionByAngle:function(a,b,c,d){a*=-1;b+=Math.cos(a)*d;c-=Math.sin(a)*d;return{x:b,y:c}},_gradient:function(a,b){for(var c=0;c<b.length;c++)a.addColorStop(b[c][0],b[c][1])},_path:function(a,b){var c;for(c=0;c<b.length;c++){var d=c?"lineTo":
"moveTo";2<b[c].length&&(d="arc");a[d].apply(a,b[c])}},_addMapRect:function(a,b,c,d,e){a.addRect(b,[c[0].x-d.x,c[0].y-d.y,c[1].x-d.x,c[1].y-d.y],e)}},webix.Group,webix.AutoTooltip,webix.DataLoader,webix.MouseEvents,webix.EventSystem,webix.ui.view);
webix.extend(webix.ui.chart,{$render_pie:function(a,b,c,d,e,f){this._renderPie(a,b,c,d,1,f,e)},_renderPie:function(a,b,c,d,e,f,g){if(b.length){var h=this._getPieParameters(c,d);d=this._settings.radius?this._settings.radius:h.radius;if(!(0>d)){var k=this._getValues(b),l=this._getTotalValue(k),m=this._getRatios(k,l),n=this._settings.x?this._settings.x:h.x;h=this._settings.y?this._settings.y:h.y;1==e&&this._settings.shadow&&this._addShadow(a,n,h,d);h/=e;var p=-Math.PI/2,q=[];a.scale(1,e);this._settings.gradient&&
this._showRadialGradient(a,n,h,d,1!=e?n+d/3:n,1!=e?h+d/3:h);for(var r=0;r<b.length;r++)if(k[r]){a.strokeStyle=this._settings.lineColor.call(this,b[r]);a.beginPath();a.moveTo(n,h);q.push(p);var v=-Math.PI/2+m[r]-1E-4;a.arc(n,h,d,p,v,!1);a.lineTo(n,h);var t=this._settings.color.call(this,b[r]);a.fillStyle=t;a.fill();this._settings.pieInnerText&&this._drawSectorLabel(n,h,5*d/6,p,v,e,this._settings.pieInnerText(b[r],l),!0);this._settings.label&&this._drawSectorLabel(n,h,d+this._settings.labelOffset,p,
v,e,this._settings.label(b[r]));1!=e&&(this._createLowerSector(a,n,h,p,v,d,!0),a.fillStyle="#000000",a.globalAlpha=.2,this._createLowerSector(a,n,h,p,v,d,!1),a.globalAlpha=1,a.fillStyle=t);f.addSector(b[r].id,p,v,n-c.x,h-c.y/e,d,e,g);p=v}a.globalAlpha=.8;for(r=0;r<q.length;r++)c=this._getPositionByAngle(q[r],n,h,d),this._drawLine(a,n,h,c.x,c.y,this._settings.lineColor.call(this,b[r]),2);1==e&&(a.lineWidth=2,a.strokeStyle="#ffffff",a.beginPath(),a.arc(n,h,d+1,0,2*Math.PI,!1),a.stroke());a.globalAlpha=
1;a.scale(1,1/e)}}},_getValues:function(a){for(var b=[],c=0;c<a.length;c++)b.push(Math.abs(parseFloat(this._settings.value(a[c])||0)));return b},_getTotalValue:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b},_getRatios:function(a,b){var c=[],d=0;b=b||this._getTotalValue(a);for(var e=0;e<a.length;e++){var f=a[e];c[e]=2*Math.PI*(b?(f+d)/b:1/a.length);d+=f}return c},_getPieParameters:function(a,b){var c=b.x-a.x;b=b.y-a.y;return{x:a.x+c/2,y:a.y+b/2,radius:Math.min(c/2,b/2)}},_createLowerSector:function(a,
b,c,d,e,f,g){a.lineWidth=1;if(0>=d&&0<=e||0<=d&&e<=Math.PI||.003<Math.abs(d-Math.PI)&&d<=Math.PI&&e>=Math.PI){0>=d&&0<=e&&(d=0,g=!1,this._drawSectorLine(a,b,c,f,d,e));d<=Math.PI&&e>=Math.PI&&(e=Math.PI,g=!1,this._drawSectorLine(a,b,c,f,d,e));var h=(this._settings.pieHeight||Math.floor(f/4))/this._settings.cant;a.beginPath();a.arc(b,c,f,d,e,!1);a.lineTo(b+f*Math.cos(e),c+f*Math.sin(e)+h);a.arc(b,c+h,f,e,d,!0);a.lineTo(b+f*Math.cos(d),c+f*Math.sin(d));a.fill();g&&a.stroke()}},_drawSectorLine:function(a,
b,c,d,e,f){a.beginPath();a.arc(b,c,d,e,f,!1);a.stroke()},_addShadow:function(a,b,c,d){a.globalAlpha=.5;for(var e="#c4c4c4 #c6c6c6 #cacaca #dcdcdc #dddddd #e0e0e0 #eeeeee #f5f5f5 #f8f8f8".split(" "),f=e.length-1;-1<f;f--)a.beginPath(),a.fillStyle=e[f],a.arc(b+1,c+1,d+f,0,2*Math.PI,!0),a.fill();a.globalAlpha=1},_getGrayGradient:function(a){a.addColorStop(0,"#ffffff");a.addColorStop(.7,"#7a7a7a");a.addColorStop(1,"#000000");return a},_showRadialGradient:function(a,b,c,d,e,f){a.beginPath();if("function"!=
typeof this._settings.gradient){var g=a.createRadialGradient(e,f,d/4,b,c,d);g=this._getGrayGradient(g)}else g=this._settings.gradient(g);a.fillStyle=g;a.arc(b,c,d,0,2*Math.PI,!0);a.fill();a.globalAlpha=.7},_drawSectorLabel:function(a,b,c,d,e,f,g,h){if(g=this.canvases[0].renderText(0,0,g,0,1)){var k=g.scrollWidth;g.style.width=k+"px";k>a&&(k=a);var l=.2>e-d?4:8;h&&(l=k/1.8);var m=d+(e-d)/2;c-=(l-8)/2;var n=-l,p="right";if(m>=Math.PI/2&&m<Math.PI||m<=3*Math.PI/2&&m>=Math.PI)n=-k-n+1,p="left";var q=
0;!h&&1>f&&0<m&&m<Math.PI&&(q=(this._settings.height||Math.floor(c/4))/f);b=(b+Math.floor((c+q)*Math.sin(m)))*f+-8;c=a+Math.floor((c+l/2)*Math.cos(m))+n;e=e<Math.PI/2+.01;(d=d<Math.PI/2)&&e?c=Math.max(c,a+3):d||e?!h&&(m>=Math.PI/2&&m<Math.PI||m<=3*Math.PI/2&&m>=Math.PI)&&(c+=k/3):c=Math.min(c,a-k);g.style.top=b+"px";g.style.left=c+"px";g.style.width=k+"px";g.style.textAlign=p;g.style.whiteSpace="nowrap"}},$render_pie3D:function(a,b,c,d,e,f){this._renderPie(a,b,c,d,this._settings.cant,f)},$render_donut:function(a,
b,c,d,e,f){b.length&&(this._renderPie(a,b,c,d,1,f,e),b=this._settings,c=this._getPieParameters(c,d),d=b.radius?b.radius:c.radius,d=b.innerRadius&&b.innerRadius<d?b.innerRadius:d/3,e=b.x?b.x:c.x,b=b.y?b.y:c.y,a.fillStyle="#ffffff",a.beginPath(),a.arc(e,b,d,0,2*Math.PI,!0),a.fill())}});
webix.extend(webix.ui.chart,{$render_bar:function(a,b,c,d,e,f){var g=d.y-c.y;var h=!!this._settings.yAxis;var k=!!this._settings.xAxis;var l=this._getLimits();var m=l.max;var n=l.min;l=(d.x-c.x)/b.length;e||"auto"!=this._settings.origin&&!h||this._drawScales(b,c,d,n,m,l);h&&(m=parseFloat(this._settings.yAxis.end),n=parseFloat(this._settings.yAxis.start));var p=this._getRelativeValue(n,m);var q=p[0];p=p[1];var r=q?g/q:q;if(!(h||"auto"!=this._settings.origin&&k)){var v=10;r=q?(g-v)/q:v}!e&&"auto"!=
this._settings.origin&&!h&&this._settings.origin>n&&this._drawXAxis(a,b,c,d,l,d.y-r*(this._settings.origin-n));g=parseInt(this._settings.barWidth,10);var t=0,u=0;for(q=0;q<this._series.length;q++)q==e&&(u=t),"bar"==this._series[q].type&&t++;this._series&&g*t+4>l&&(g=parseInt(l/t-4,10));t=(l-g*t)/2;var y="undefined"!=typeof this._settings.radius?parseInt(this._settings.radius,10):Math.round(g/5),w=!1,z=this._settings.gradient;z&&"function"!=typeof z?(w=z,z=!1):z&&(z=a.createLinearGradient(0,d.y,0,
c.y),this._settings.gradient(z));k||this._drawLine(a,c.x,d.y+.5,d.x,d.y+.5,"#000000",1);for(q=0;q<b.length;q++){var x=parseFloat(this._settings.value(b[q])||0);this._logScaleCalc&&(x=this._log10(x));x>m&&(x=m);x-=n;x*=p;var B=c.x+t+q*l+(g+1)*u,A=d.y,F=z||this._settings.color.call(this,b[q]),D=this._settings.border?1:0,E=this._settings.label(b[q]);x==this._settings.origin||"auto"==this._settings.origin&&this._settings.value(b[q])==n?(D=0,E=""):0>x||this._settings.yAxis&&0===x&&!("auto"!=this._settings.origin&&
this._settings.origin>n)?(x=D=0,E=""):h||"auto"!=this._settings.origin&&k||(x+=v/r);a.globalAlpha=this._settings.alpha.call(this,b[q]);var C=this._drawBar(a,c,B,A,g,n,y,r,x,F,z,w,D);w&&this._drawBarGradient(a,B,A,g,n,y,r,x,F,w,D);D&&this._drawBarBorder(a,B,A,g,n,y,r,x,F);a.globalAlpha=1;C[0]!=B?this.canvases[e].renderTextAt(!1,!0,B+Math.floor(g/2),C[1],E):this.canvases[e].renderTextAt(!0,!0,B+Math.floor(g/2),C[3],E);f.addRect(b[q].id,[B-c.x,C[3]-c.y,C[2]-c.x,C[1]-c.y],e)}},_correctBarParams:function(a,
b,c,d,e,f,g){var h=c;this._settings.xAxis&&"auto"!=this._settings.origin&&this._settings.origin>g&&(h=c-=(this._settings.origin-g)*e,d-=this._settings.origin-g,0>d&&(d*=-1,a.translate(b+f,c),a.rotate(Math.PI),c=b=0),c-=.5);return{value:d,x0:b,y0:c,start:h}},_drawBar:function(a,b,c,d,e,f,g,h,k,l,m,n,p){a.save();a.fillStyle=l;d=this._correctBarParams(a,c,d,k,h,e,f);e=this._setBarPoints(a,d.x0,d.y0,e,g,h,d.value,p);m&&!n&&a.lineTo(d.x0+p,b.y);a.fill();a.restore();return[d.x0,d.x0!=c?d.start-e[1]-d.y0:
d.y0,d.x0!=c?c+e[0]:e[0],d.x0!=c?d.start-d.y0:e[1]]},_setBorderStyles:function(a,b){b=webix.color.toRgb(b);b=webix.color.rgbToHsv(b[0],b[1],b[2]);b[2]/=1.4;b="rgb("+webix.color.hsvToRgb(b[0],b[1],b[2])+")";a.strokeStyle=b;1==a.globalAlpha&&(a.globalAlpha=.9)},_drawBarBorder:function(a,b,c,d,e,f,g,h,k){a.save();b=this._correctBarParams(a,b,c,h,g,d,e);this._setBorderStyles(a,k);this._setBarPoints(a,b.x0,b.y0,d,f,g,b.value,a.lineWidth/2,1);a.stroke();a.restore()},_drawBarGradient:function(a,b,c,d,e,
f,g,h,k,l,m){a.save();b=this._correctBarParams(a,b,c,h,g,d,e);k=this._setBarGradient(a,b.x0,b.y0,b.x0+d,b.y0-g*b.value+2,l,k,"y");a.fillStyle=k.gradient;this._setBarPoints(a,b.x0+k.offset,b.y0,d-2*k.offset,f,g,b.value,k.offset+m);a.fill();a.restore()},_setBarPoints:function(a,b,c,d,e,f,g,h,k){a.beginPath();var l=0;if(e>f*g){var m=(e-f*g)/e;1>=m&&-1<=m&&(l=-Math.acos(m)+Math.PI/2)}a.moveTo(b+h,c);m=c-Math.floor(f*g)+e+(e?0:h);e<f*g&&a.lineTo(b+h,m);e&&0<e&&a.arc(b+e,m,Math.max(e-h,0),-Math.PI+l,-Math.PI/
2,!1);g=b+d-e-h;f=m-e+(e?h:0);a.lineTo(g,f);e&&0<e&&a.arc(g+h,m,Math.max(e-h,0),-Math.PI/2,0-l,!1);d=b+d-h;a.lineTo(d,c);k||a.lineTo(b+h,c);return[d,f]}});
webix.extend(webix.ui.chart,{$render_line:function(a,b,c,d,e,f){var g,h;var k=this._calculateLineParams(a,b,c,d,e);var l=this._settings;if(b.length){var m=l.offset?c.x+.5*k.cellWidth:c.x;var n=[];for(g=0;g<b.length;g++)if((h=this._getPointY(b[g],c,d,k))||"0"==h){var p=g?k.cellWidth*g-.5+m:m;var q="object"==typeof h?h.y0:h;if(g&&this._settings.fixOverflow){var r=this._getPointY(b[g-1],c,d,k);if(r.out&&r.out==h.out)continue;var v=k.cellWidth*(g-1)-.5+m;var t="object"==typeof r?r.y0:r;r.out&&(r="min"==
r.out?d.y:c.y,n.push({x:this._calcOverflowX(v,p,t,q,r),y:r}));h.out&&(r="min"==h.out?d.y:c.y,n.push({x:this._calcOverflowX(v,p,t,q,r),y:r}))}h.out||n.push({x:p,y:h,index:g})}this._mapStart=c;for(g=1;g<=n.length;g++)v=n[g-1].x,t=n[g-1].y,g<n.length&&(p=n[g].x,q=n[g].y,this._drawLine(a,v,t,p,q,l.line.color.call(this,b[g-1]),l.line.width),l.line&&l.line.shadow&&(a.globalAlpha=.3,this._drawLine(a,v+2,t+l.line.width+8,p+2,q+l.line.width+8,"#eeeeee",l.line.width+3),a.globalAlpha=1)),"undefined"!=typeof n[g-
1].index&&this._drawItem(a,v,t,b[n[g-1].index],l.label(b[n[g-1].index]),e,f,c)}},_calcOverflowX:function(a,b,c,d,e){return a+(e-c)*(b-a)/(d-c)},_drawItem:function(a,b,c,d,e,f,g){var h=this._settings.item,k=parseInt(h.radius.call(this,d),10)||0,l=this._mapStart;if(k){a.save();if(h.shadow){a.lineWidth=1;a.strokeStyle="#bdbdbd";a.fillStyle="#bdbdbd";for(var m=[.1,.2,.3],n=m.length-1;0<=n;n--)a.globalAlpha=m[n],a.strokeStyle="#d0d0d0",a.beginPath(),this._strokeChartItem(a,b,c+2*k/3,k+n+1,h.type),a.stroke();
a.beginPath();a.globalAlpha=.3;a.fillStyle="#bdbdbd";this._strokeChartItem(a,b,c+2*k/3,k+1,h.type);a.fill()}a.restore();a.lineWidth=h.borderWidth;a.fillStyle=h.color.call(this,d);a.strokeStyle=h.borderColor.call(this,d);a.globalAlpha=h.alpha.call(this,d);a.beginPath();this._strokeChartItem(a,b,c,k+1,h.type);a.fill();a.stroke();a.globalAlpha=1}e&&this.canvases[f].renderTextAt(!1,!0,b,c-k-this._settings.labelOffset,this._settings.label.call(this,d));g&&(a=this._settings.eventRadius||k+1,g.addRect(d.id,
[b-a-l.x,c-a-l.y,b+a-l.x,c+a-l.y],f))},_strokeChartItem:function(a,b,c,d,e){!e||"square"!=e&&"s"!=e?!e||"diamond"!=e&&"d"!=e?b=!e||"triangle"!=e&&"t"!=e?[[b,c,d,0,2*Math.PI,!0]]:[[b,c-d],[b+Math.sqrt(3)*d/2,c+d/2],[b-Math.sqrt(3)*d/2,c+d/2],[b,c-d]]:(e=1<a.lineWidth?a.lineWidth*Math.sqrt(2)/4:0,b=[[b,c-d],[b+d,c],[b,c+d],[b-d,c],[b+e,c-d-e]]):(d*=Math.sqrt(2)/2,b=[[b-d-a.lineWidth/2,c-d],[b+d,c-d],[b+d,c+d],[b-d,c+d],[b-d,c-d]]);this._path(a,b)},_getPointY:function(a,b,c,d){var e=d.minValue,f=d.maxValue,
g=d.unit,h=d.valueFactor;a=this._settings.value(a);this._logScaleCalc&&(a=this._log10(a));h*=parseFloat(a||0)-e;this._settings.yAxis||(h+=d.startValue/g);d=c.y-g*h;if(!this._settings.fixOverflow||"line"!=this._settings.type&&"area"!=this._settings.type){if(a>f&&(d=b.y),0>h||a<e)d=c.y}else if(a>f)d={y:b.y,y0:d,out:"max"};else if(0>h||a<e)d={y:c.y,y0:d,out:"min"};return d},_calculateLineParams:function(a,b,c,d,e){a={};a.totalHeight=d.y-c.y;a.cellWidth=this._settings.cellWidth?Math.min(d.x-c.x,this._settings.cellWidth):
(d.x-c.x)/(this._settings.offset?b.length:b.length-1);var f=!!this._settings.yAxis,g=-1!=this._settings.type.indexOf("stacked")?this._getStackedLimits(b):this._getLimits();a.maxValue=g.max;a.minValue=g.min;e||this._drawScales(b,c,d,a.minValue,a.maxValue,a.cellWidth);f&&(a.maxValue=parseFloat(this._settings.yAxis.end),a.minValue=parseFloat(this._settings.yAxis.start));c=this._getRelativeValue(a.minValue,a.maxValue);b=c[0];a.valueFactor=c[1];a.unit=b?a.totalHeight/b:10;a.startValue=0;f||(a.startValue=
10,a.unit!=a.totalHeight&&(a.unit=b?(a.totalHeight-a.startValue)/b:10));return a}});
webix.extend(webix.ui.chart,{$render_barH:function(a,b,c,d,e,f){var g,h;var k=(d.y-c.y)/b.length;var l=this._getLimits("h");var m=l.max;l=l.min;var n=d.x-c.x;var p=!!this._settings.xAxis;e||this._drawHScales(a,b,c,d,l,m,k);p&&(m=parseFloat(this._settings.xAxis.end),l=parseFloat(this._settings.xAxis.start));var q=this._getRelativeValue(l,m);var r=q[0];q=q[1];var v=r?n/r:10;if(!p){var t=10;v=r?(n-t)/r:10}n=parseInt(this._settings.barWidth,10);n*this._series.length+4>k&&(n=k/this._series.length-4);r=
Math.floor((k-n*this._series.length)/2);var u="undefined"!=typeof this._settings.radius?parseInt(this._settings.radius,10):Math.round(n/5);var y=!1;(g=this._settings.gradient)&&"function"!=typeof g?(y=g,g=!1):g&&(g=a.createLinearGradient(c.x,c.y,d.x,c.y),this._settings.gradient(g));p||this._drawLine(a,c.x-.5,c.y,c.x-.5,d.y,"#000000",1);for(h=0;h<b.length;h++){var w=parseFloat(this._settings.value(b[h]||0));this._logScaleCalc&&(w=this._log10(w));if(w&&!isNaN(w)){w>m&&(w=m);w-=l;w*=q;var z=c.x;var x=
c.y+r+h*k+(n+1)*e;if(0>w&&"auto"==this._settings.origin||this._settings.xAxis&&0===w&&!("auto"!=this._settings.origin&&this._settings.origin>l))this.canvases[e].renderTextAt("middle","right",z+10,x+n/2+r,this._settings.label(b[h]));else{0>w&&"auto"!=this._settings.origin&&this._settings.origin>l&&(w=0);p||(w+=t/v);var B=g||this._settings.color.call(this,b[h]);this._settings.border&&this._drawBarHBorder(a,z,x,n,l,u,v,w,B);a.globalAlpha=this._settings.alpha.call(this,b[h]);var A=this._drawBarH(a,d,
z,x,n,l,u,v,w,B,g,y);y&&this._drawBarHGradient(a,z,x,n,l,u,v,w,B,y);a.globalAlpha=1;A[3]==x?(this.canvases[e].renderTextAt("middle","left",A[0]-5,A[3]+Math.floor(n/2),this._settings.label(b[h])),f.addRect(b[h].id,[A[0]-c.x,A[3]-c.y,A[2]-c.x,A[3]+n-c.y],e)):(this.canvases[e].renderTextAt("middle",!1,A[2]+5,A[1]+Math.floor(n/2),this._settings.label(b[h])),f.addRect(b[h].id,[A[0]-c.x,x-c.y,A[2]-c.x,A[3]-c.y],e))}}}},_setBarHPoints:function(a,b,c,d,e,f,g,h,k){var l=0;e>f*g&&(l=-Math.asin((e-f*g)/e)+Math.PI/
2);a.moveTo(b,c+h);var m=Math.max(b,b+f*g-e-(e?0:h));e<f*g&&a.lineTo(m,c+h);e&&0<e&&a.arc(m,c+e,e-h,-Math.PI/2+l,0,!1);g=c+d-e-(e?0:h);f=m+e-(e?h:0);a.lineTo(f,g);e&&0<e&&a.arc(m,g,e-h,0,Math.PI/2-l,!1);d=c+d-h;a.lineTo(b,d);k||a.lineTo(b,c+h);return[f,d]},_drawHScales:function(a,b,c,d,e,f,g){a=0;this._settings.xAxis&&(this.canvases.x||(this.canvases.x=this._createCanvas("axis_x")),a=this._drawHXAxis(this.canvases.x.getCanvas(),b,c,d,e,f));this._settings.yAxis&&(this.canvases.y||(this.canvases.y=
this._createCanvas("axis_y")),this._drawHYAxis(this.canvases.y.getCanvas(),b,c,d,g,a))},_drawHYAxis:function(a,b,c,d,e,f){if(this._settings.yAxis){var g=parseInt(f?f:c.x,10)-.5,h=c.y;this._drawLine(a,g,d.y+.5,g,h,this._settings.yAxis.color,1);for(var k=0;k<b.length;k++){var l="auto"!=this._settings.origin&&"barH"==this._settings.type&&parseFloat(this._settings.value(b[k]))<this._settings.origin;f=h+e/2+k*e;this.canvases.y.renderTextAt("middle",l?!1:"left",l?g+5:g-5,f,this._settings.yAxis.template(b[k]),
"webix_axis_item_y",l?0:g-10);this._settings.yAxis.lines.call(this,b[k])&&this._drawLine(a,c.x,f,d.x,f,this._settings.yAxis.lineColor.call(this,b[k]),1)}this._settings.yAxis.lines.call(this,{})&&this._drawLine(a,c.x+.5,h+.5,d.x,h+.5,this._settings.yAxis.lineColor.call(this,{}),1);this._setYAxisTitle(c,d)}},_drawHXAxis:function(a,b,c,d,e,f){var g;b={};var h=this._settings.xAxis;if(h){var k=d.y+.5,l=c.x-.5,m=d.x-.5,n=c.x;this._drawLine(a,l,k,m,k,h.color,1);h.step&&(g=parseFloat(h.step));if("undefined"==
typeof this._configXAxis.step||"undefined"==typeof this._configXAxis.start||"undefined"==typeof this._configXAxis.end)b=this._calculateScale(e,f),e=b.start,f=b.end,g=b.step,this._settings.xAxis.end=f,this._settings.xAxis.start=e,this._settings.xAxis.step=g;if(0!==g){for(var p=(m-l)*g/(f-e),q=0,r=e;r<=f;r+=g){var v=this._logScaleCalc?Math.pow(10,r):r;b.fixNum&&(v=parseFloat(v).toFixed(b.fixNum));var t=Math.floor(l+q*p)+.5;r==e&&"auto"==this._settings.origin||!h.lines.call(this,r)||this._drawLine(a,
t,k,t,c.y,this._settings.xAxis.lineColor.call(this,r),1);r==this._settings.origin&&(n=t+1);1>g&&!this._logScaleCalc&&(r=Math.min(Math.floor(this._log10(g)),0>=e?0:Math.floor(this._log10(e))),r=Math.pow(10,-r),r=v=Math.round(v*r)/r);this.canvases.x.renderTextAt(!1,!0,t,k+2,h.template(v.toString()),"webix_axis_item_x");q++}this.canvases.x.renderTextAt(!0,!1,l,d.y+this._settings.padding.bottom-3,this._settings.xAxis.title,"webix_axis_title_x",d.x-c.x);h.lines.call(this,{})||this._drawLine(a,l,c.y-.5,
m,c.y-.5,this._settings.xAxis.color,.2);return n}}},_correctBarHParams:function(a,b,c,d,e,f,g){var h=b;this._settings.yAxis&&"auto"!=this._settings.origin&&this._settings.origin>g&&(h=b+=(this._settings.origin-g)*e,d-=this._settings.origin-g,0>d&&(d*=-1,a.translate(b,c+f),a.rotate(Math.PI),b=.5,c=0),b+=.5);return{value:d,x0:b,y0:c,start:h}},_drawBarH:function(a,b,c,d,e,f,g,h,k,l,m,n){a.save();c=this._correctBarHParams(a,c,d,k,h,e,f);a.fillStyle=l;a.beginPath();e=this._setBarHPoints(a,c.x0,c.y0,e,
g,h,c.value,this._settings.border?1:0);m&&!n&&a.lineTo(b.x,c.y0+(this._settings.border?1:0));a.fill();a.restore();return[c.y0!=d?c.start-e[0]:c.start,c.y0,c.y0!=d?c.start:e[0],c.y0!=d?d:e[1]]},_drawBarHBorder:function(a,b,c,d,e,f,g,h,k){a.save();b=this._correctBarHParams(a,b,c,h,g,d,e);a.beginPath();this._setBorderStyles(a,k);a.globalAlpha=.9;this._setBarHPoints(a,b.x0,b.y0,d,f,g,b.value,a.lineWidth/2,1);a.stroke();a.restore()},_drawBarHGradient:function(a,b,c,d,e,f,g,h,k,l){a.save();b=this._correctBarHParams(a,
b,c,h,g,d,e);k=this._setBarGradient(a,b.x0,b.y0+d,b.x0+g*b.value,b.y0,l,k,"x");a.fillStyle=k.gradient;a.beginPath();this._setBarHPoints(a,b.x0,b.y0+k.offset,d-2*k.offset,f,g,b.value,k.offset);a.fill();a.globalAlpha=1;a.restore()}});
webix.extend(webix.ui.chart,{$render_stackedBar:function(a,b,c,d,e,f){var g,h=this._settings,k=d.y-c.y;var l=!!h.yAxis;var m=!!h.xAxis;var n=this._getStackedLimits(b);var p=0===h.origin;var q=n.max;n=n.min;var r=Math.floor((d.x-c.x)/b.length);e||(g=this._drawScales(b,c,d,n,q,r));l&&(q=parseFloat(h.yAxis.end),n=parseFloat(h.yAxis.start));q=this._getRelativeValue(n,q);l=q[0];q=q[1];k=l?k/l:10;l=parseInt(h.barWidth,10);l+4>r&&(l=r-4);var v=Math.floor((r-l)/2),t=h.gradient?h.gradient:!1;m||this._drawLine(a,
c.x,d.y+.5,d.x,d.y+.5,"#000000",1);for(var u=0;u<b.length;u++){var y=Math.abs(parseFloat(h.value(b[u]||0)));this._logScaleCalc&&(y=this._log10(y));m=c.x+v+u*r;var w=p&&0>y;if(e)var z=w?b[u].$startYN:b[u].$startY;else z=g-1,b[u].$startY=z,p&&(w&&(z=g+1),b[u].$startYN=g+1);if(y&&!isNaN(y)&&(e||p||(y-=n),y*=q,!(z<c.y+1))){var x=this._settings.color.call(this,b[u]),B=3>Math.abs(z-(p?d.y+n*k:d.y));a.globalAlpha=h.alpha.call(this,b[u]);a.fillStyle=a.strokeStyle=h.color.call(this,b[u]);a.beginPath();y=z-
k*y+(B?w?-1:1:0);var A=this._setStakedBarPoints(a,m-(h.border?.5:0),z,l+(h.border?.5:0),y,0,c.y);a.fill();a.stroke();t&&(a.save(),A=this._setBarGradient(a,m,z,m+l,A[1],t,x,"y"),a.fillStyle=A.gradient,a.beginPath(),A=this._setStakedBarPoints(a,m+A.offset,z,l-2*A.offset,y,h.border?1:0,c.y),a.fill(),a.restore());h.border&&(a.save(),"string"==typeof h.border?a.strokeStyle=h.border:this._setBorderStyles(a,x),a.beginPath(),this._setStakedBarPoints(a,m-.5,parseInt(z,10)+.5,l+1,parseInt(y,10)+.5,0,c.y,B),
a.stroke(),a.restore());a.globalAlpha=1;this.canvases[e].renderTextAt(!1,!0,m+Math.floor(l/2),A[1]+(z-A[1])/2-7,this._settings.label(b[u]));f.addRect(b[u].id,[m-c.x,A[1]-c.y,A[0]-c.x,b[u][w?"$startYN":"$startY"]-c.y],e);b[u][w?"$startYN":"$startY"]=A[1]}}},_setStakedBarPoints:function(a,b,c,d,e,f,g,h){a.moveTo(b,c);e<g&&(e=g);a.lineTo(b,e);a.lineTo(b+d,e);d=b+d;a.lineTo(d,c);h||a.lineTo(b,c);return[d,e]}});
webix.extend(webix.ui.chart,{$render_stackedBarH:function(a,b,c,d,e,f){var g=d.x-c.x,h=!!this._settings.yAxis;var k=this._getStackedLimits(b);var l=k.max;k=k.min;var m=Math.floor((d.y-c.y)/b.length);e||this._drawHScales(a,b,c,d,k,l,m);h&&(l=parseFloat(this._settings.xAxis.end),k=parseFloat(this._settings.xAxis.start));var n=this._getRelativeValue(k,l);var p=n[0];n=n[1];var q=p?g/p:10,r=0;h||(r=10,q=p?(g-r)/p:10);p=parseInt(this._settings.barWidth,10);p+4>m&&(p=m-4);var v=(m-p)/2,t=!1,u=this._settings.gradient;
u&&(t=!0);h||this._drawLine(a,c.x-.5,c.y,c.x-.5,d.y,"#000000",1);var y=0;for(w=d=0;w<this._series.length;w++)w==e&&(d=y),"stackedBarH"==this._series[w].type&&y++;for(var w=0;w<b.length;w++){d||(b[w].$startX=c.x);y=Math.abs(parseFloat(this._settings.value(b[w]||0)));y>l&&(y=l);y-=k;y*=n;var z=c.x,x=c.y+v+w*m;d?z=b[w].$startX:b[w].$startX=z;if(y&&!isNaN(y)){h||(y+=r/q);var B=this._settings.color.call(this,b[w]);a.globalAlpha=this._settings.alpha.call(this,b[w]);a.fillStyle=this._settings.color.call(this,
b[w]);a.beginPath();var A=this._setBarHPoints(a,z,x,p,0,q,y,0);u&&!t&&a.lineTo(c.x+g,x+(this._settings.border?1:0));a.fill();t&&(A=this._setBarGradient(a,z,x+p,z,x,t,B,"x"),a.fillStyle=A.gradient,a.beginPath(),A=this._setBarHPoints(a,z,x,p,0,q,y,0),a.fill());this._settings.border&&this._drawBarHBorder(a,z,x,p,k,0,q,y,B);a.globalAlpha=1;this.canvases[e].renderTextAt("middle",!0,b[w].$startX+(A[0]-b[w].$startX)/2-1,x+(A[1]-x)/2,this._settings.label(b[w]));f.addRect(b[w].id,[b[w].$startX-c.x,x-c.y,A[0]-
c.x,A[1]-c.y],e);b[w].$startX=A[0]}}}});
webix.extend(webix.ui.chart,{$render_spline:function(a,b,c,d,e,f){var g,h;var k=this._calculateLineParams(a,b,c,d,e);var l=this._settings;this._mapStart=c;var m=[];if(b.length){var n=l.offset?c.x+.5*k.cellWidth:c.x;for(g=0;g<b.length;g++)if((h=this._getPointY(b[g],c,d,k))||"0"==h){var p=g?k.cellWidth*g-.5+n:n;m.push({x:p,y:h,v:this._settings.value(b[g]),index:g})}p=this._getSplineParameters(m);for(g=0;g<m.length;g++){n=m[g].x;var q=m[g].y;if(g<m.length-1){h=m[g+1].x;var r=m[g+1].y;for(k=n;k<h;k++){var v=
this._getSplineYPoint(k,n,g,p.a,p.b,p.c,p.d);v<c.y&&(v=c.y);v>d.y&&(v=d.y);var t=this._getSplineYPoint(k+1,n,g,p.a,p.b,p.c,p.d);t<c.y&&(t=c.y);t>d.y&&(t=d.y);this._drawLine(a,k,v,k+1,t,l.line.color(b[g]),l.line.width)}this._drawLine(a,h-1,this._getSplineYPoint(k,n,g,p.a,p.b,p.c,p.d),h,r,l.line.color(b[g]),l.line.width)}this._drawItem(a,n,q,b[m[g].index],l.label(b[m[g].index]),e,f)}}},_getSplineParameters:function(a){var b,c=[];var d=[];var e=a.length;for(b=0;b<e-1;b++)c[b]=a[b+1].x-a[b].x,d[b]=(a[b+
1].y-a[b].y)/c[b];var f=[];var g=[];f[0]=0;f[1]=2*(c[0]+c[1]);g[0]=0;g[1]=6*(d[1]-d[0]);for(b=2;b<e-1;b++)f[b]=2*(c[b-1]+c[b])-c[b-1]*c[b-1]/f[b-1],g[b]=6*(d[b]-d[b-1])-c[b-1]*g[b-1]/f[b-1];d=[];d[e-1]=d[0]=0;for(b=e-2;1<=b;b--)d[b]=(g[b]-c[b]*d[b+1])/f[b];f=[];g=[];var h=[];var k=[];for(b=0;b<e-1;b++)f[b]=a[b].y,g[b]=-c[b]*d[b+1]/6-c[b]*d[b]/3+(a[b+1].y-a[b].y)/c[b],h[b]=d[b]/2,k[b]=(d[b+1]-d[b])/(6*c[b]);for(b=0;b<a.length-1;b++)0===a[b].v&&0===a[b+1].v&&(f[b]=a[b].y,k[b]=h[b]=g[b]=0);return{a:f,
b:g,c:h,d:k}},_getSplineYPoint:function(a,b,c,d,e,f,g){return d[c]+(a-b)*(e[c]+(a-b)*(f[c]+(a-b)*g[c]))}});
webix.extend(webix.ui.chart,{$render_area:function(a,b,c,d,e,f){var g;var h=this._calculateLineParams(a,b,c,d,e);var k=this._settings;var l=k.eventRadius||Math.floor(h.cellWidth/2);if(b.length){var m=[];var n=k.offset?c.x+.5*h.cellWidth:c.x;for(g=0;g<b.length;g++){var p=b[g];var q=this._getPointY(p,c,d,h);var r=n+h.cellWidth*g;if(q){var v="object"==typeof q?q.y0:q;if(g&&this._settings.fixOverflow){var t=this._getPointY(b[g-1],c,d,h);if(t.out&&t.out==q.out)continue;var u=h.cellWidth*(g-1)-.5+n;var y=
"object"==typeof t?t.y0:t;t.out&&(t="min"==t.out?d.y:c.y,m.push([this._calcOverflowX(u,r,y,v,t),t]));q.out&&(t="min"==q.out?d.y:c.y,m.push([this._calcOverflowX(u,r,y,v,t),t]),g==b.length-1&&t==c.y&&m.push([r,c.y]))}q.out||(m.push([r,v]),f.addRect(p.id,[r-l-c.x,v-l-c.y,r+l-c.x,v+l-c.y],e));k.yAxis||(q=k.offset||g!=b.length-1?"center":"left",this.canvases[e].renderTextAt(!1,q,r,v-k.labelOffset,k.label(p)))}}m.length&&(m.push([r,d.y]),m.push([m[0][0],d.y]));a.globalAlpha=this._settings.alpha.call(this,
b[0]);a.fillStyle=this._settings.color.call(this,b[0]);a.beginPath();this._path(a,m);a.fill();a.lineWidth=1;a.globalAlpha=1;k.border&&(a.lineWidth=k.borderWidth||1,k.borderColor?a.strokeStyle=k.borderColor.call(this,b[0]):this._setBorderStyles(a,a.fillStyle),a.beginPath(),this._path(a,m),a.stroke())}},$render_stackedArea:function(a,b,c,d,e,f){var g;var h=this._calculateLineParams(a,b,c,d,e);var k=this._settings;var l=k.eventRadius||Math.floor(h.cellWidth/2);if(b.length){var m=[];var n=[];var p=k.offset?
c.x+.5*h.cellWidth:c.x;var q=function(a,c){return e?b[a].$startY?c-d.y+b[a].$startY:0:c},r=function(a,b,c){c=(c.y-b.y)/(c.x-b.x);return c*a+b.y-c*b.x};for(g=0;g<b.length;g++){var v=b[g];if(g)p+=h.cellWidth;else{var t=q(g,d.y);m.push([p,t])}t=q(g,this._getPointY(v,c,d,h));n.push(isNaN(t)&&!g?b[g].$startY||d.y:t);t&&(m.push([p,t]),f.addRect(v.id,[p-l-c.x,t-l-c.y,p+l-c.x,t+l-c.y],e),k.yAxis||this.canvases[e].renderTextAt(!1,"center",p,t-k.labelOffset,k.label(v)))}m.push([p,q(g-1,d.y)]);if(e)for(g=b.length-
2;0<g;g--)p-=h.cellWidth,(t=b[g].$startY)&&m.push([p,t]);m.push([m[0][0],m[0][1]]);a.globalAlpha=this._settings.alpha.call(this,b[0]);a.fillStyle=this._settings.color.call(this,b[0]);a.beginPath();this._path(a,m);a.fill();for(g=0;g<b.length;g++){t=n[g];if(!t)for(g==b.length-1&&(t=b[g].$startY),a=g+1;a<b.length;a++)if(n[a]){t={x:c.x,y:n[0]};a={x:c.x+h.cellWidth*a,y:n[a]};t=r(c.x+h.cellWidth*g,t,a);break}b[g].$startY=t}}}});
webix.extend(webix.ui.chart,{$render_radar:function(a,b,c,d,e,f){this._renderRadarChart(a,b,c,d,e,f)},_renderRadarChart:function(a,b,c,d,e,f){if(b.length){var g=this._getPieParameters(c,d);d=this._settings.radius?this._settings.radius:g.radius;var h=this._settings.x?this._settings.x:g.x;g=this._settings.y?this._settings.y:g.y;for(var k=[],l=0;l<b.length;l++)k.push(1);k=this._getRatios(k,b.length);this._mapStart=c;e||this._drawRadarAxises(k,h,g,d,b);this._drawRadarData(a,k,h,g,d,b,e,f)}},_drawRadarData:function(a,
b,c,d,e,f,g,h){var k,l,m;var n=this._settings;var p=n.yAxis.start;var q=this._getRelativeValue(p,n.yAxis.end);e=(k=q[0])?e/k:e/2;var r=q[1];q=m=-Math.PI/2;var v=[];for(k=l=0;k<f.length;k++){if(!t){var t=n.value(f[k]);this._logScaleCalc&&(t=this._log10(t));t=(parseFloat(t||0)-p)*r}var u=Math.floor(e*t);t=n.value(k!=f.length-1?f[k+1]:f[0]);this._logScaleCalc&&(t=this._log10(t));t=(parseFloat(t||0)-p)*r;var y=Math.floor(e*t);var w=q;q=k!=f.length-1?m+b[k]-1E-4:m;u=l||this._getPositionByAngle(w,c,d,u);
l=this._getPositionByAngle(q,c,d,y);v.push(u)}n.fill&&this._fillRadarChart(a,v,f);!n.disableLines&&2<f.length&&this._strokeRadarChart(a,v,f);(!n.disableItems||3>f.length)&&this._drawRadarItemMarkers(a,v,f,g,h)},_drawRadarItemMarkers:function(a,b,c,d,e){for(var f=0;f<b.length;f++)this._drawItem(a,b[f].x,b[f].y,c[f],this._settings.label.call(this,c),d,e)},_fillRadarChart:function(a,b,c){a.globalAlpha=this._settings.alpha.call(this,{});a.beginPath();for(var d=0;d<b.length;d++){a.fillStyle=this._settings.fill.call(this,
c[d]);var e=b[d];var f=b[d+1]||b[0];d||a.moveTo(e.x,e.y);a.lineTo(f.x,f.y)}a.fill();a.globalAlpha=1},_strokeRadarChart:function(a,b,c){for(var d,e,f=0;f<b.length;f++)d=b[f],e=b[f+1]||b[0],this._drawLine(a,d.x,d.y,e.x,e.y,this._settings.line.color.call(this,c[f]),this._settings.line.width)},_drawRadarAxises:function(a,b,c,d,e){var f=this._settings.yAxis,g=this._settings.xAxis,h=f.start,k=f.end,l=f.step,m={},n=this._configYAxis;if("undefined"==typeof n.step||"undefined"==typeof n.start||"undefined"==
typeof n.end)h=this._getLimits(),m=this._calculateScale(h.min,h.max),h=m.start,k=m.end,l=m.step,f.end=k,f.start=h;var p=[],q=0,r=d*l/(k-h);if(1>l){var v=Math.min(this._log10(l),0>=h?0:this._log10(h));v=Math.pow(10,-v)}var t=[];this.canvases.scale||(this.canvases.scale=this._createCanvas("radar_scale"));for(var u=this.canvases.scale.getCanvas();k>=h;k-=l){var y=this._logScaleCalc?Math.pow(10,k):k;m.fixNum&&(y=parseFloat(k).toFixed(m.fixNum));p.push(Math.floor(q*r)+.5);v&&!this._logScaleCalc&&(k=y=
Math.round(y*v)/v);this.canvases.scale.renderTextAt("middle","left",b,c-d+p[p.length-1],f.template(y.toString()),"webix_axis_item_y webix_radar");if(2>a.length){this._drawScaleSector(u,"arc",b,c,d-p[p.length-1],-Math.PI/2,3*Math.PI/2,k);return}var w=-Math.PI/2,z=w;for(y=0;y<a.length;y++){q||t.push(z);var x=w+a[y]-1E-4;this._drawScaleSector(u,2<a.length?n.lineShape||"line":"arc",b,c,d-p[p.length-1],z,x,k,y,e[k]);z=x}q++}for(k=0;k<t.length;k++)a=this._getPositionByAngle(t[k],b,c,d),g.lines.call(this,
e[k],k)&&this._drawLine(u,b,c,a.x,a.y,g?g.lineColor.call(this,e[k]):"#cfcfcf",1),this._drawRadarScaleLabel(u,b,c,d,t[k],g?g.template.call(this,e[k]):"&nbsp;")},_drawScaleSector:function(a,b,c,d,e,f,g,h,k){if(0>e)return!1;var l=this._getPositionByAngle(f,c,d,e);var m=this._getPositionByAngle(g,c,d,e);var n=this._settings.yAxis;n.bg&&(a.beginPath(),a.moveTo(c,d),"arc"==b?a.arc(c,d,e,f,g,!1):(a.lineTo(l.x,l.y),a.lineTo(m.x,m.y)),a.fillStyle=n.bg(h,k),a.moveTo(c,d),a.fill(),a.closePath());n.lines.call(this,
h)&&(a.lineWidth=1,a.beginPath(),"arc"==b?a.arc(c,d,e,f,g,!1):(a.moveTo(l.x,l.y),a.lineTo(m.x,m.y)),a.strokeStyle=n.lineColor.call(this,h),a.stroke())},_drawRadarScaleLabel:function(a,b,c,d,e,f){if(!f)return!1;a=this.canvases.scale.renderText(0,0,f,"webix_axis_radar_title",1);f=a.scrollWidth;var g=a.offsetHeight;b=this._getPositionByAngle(e,b,c,d+5);d=c=0;if(0>e||e>Math.PI)d=-g;e>Math.PI/2&&(c=-f);if(.001>Math.abs(e+Math.PI/2)||.001>Math.abs(e-Math.PI/2))c=-f/2;else if(.001>Math.abs(e)||.001>Math.abs(e-
Math.PI))d=-g/2;a.style.top=b.y+d+"px";a.style.left=b.x+c+"px";a.style.width=f+"px";a.style.whiteSpace="nowrap"}});
webix.extend(webix.ui.chart,{$render_scatter:function(a,b,c,d,e,f){if(!this._settings.xValue)return webix.log("warning","Undefined propery: xValue");var g=this._getLimits(),h=this._getLimits("h","xValue");e||(this.canvases.x||(this.canvases.x=this._createCanvas("axis_x")),this.canvases.y||(this.canvases.y=this._createCanvas("axis_y")),this._drawYAxis(this.canvases.y.getCanvas(),b,c,d,g.min,g.max),this._drawHXAxis(this.canvases.x.getCanvas(),b,c,d,h.min,h.max));g={min:this._settings.yAxis.start,max:this._settings.yAxis.end};
h={min:this._settings.xAxis.start,max:this._settings.xAxis.end};var k=this._getScatterParams(a,b,c,d,h,g);this._mapStart=c;for(var l=0;l<b.length;l++)this._drawScatterItem(a,f,c,d,k,h,g,b[l],e)},_getScatterParams:function(a,b,c,d,e,f){a={};a.totalHeight=d.y-c.y;a.totalWidth=d.x-c.x;this._calcScatterUnit(a,e.min,e.max,a.totalWidth,"X");this._calcScatterUnit(a,f.min,f.max,a.totalHeight,"Y");return a},_drawScatterItem:function(a,b,c,d,e,f,g,h,k){f=this._calculateScatterItemPosition(e,d,c,f,h,"X");c=
this._calculateScatterItemPosition(e,c,d,g,h,"Y");this._drawItem(a,f,c,h,this._settings.label.call(this,h),k,b)},_calculateScatterItemPosition:function(a,b,c,d,e,f){e=this._settings["X"==f?"xValue":"value"].call(this,e);var g=a["valueFactor"+f];g*=parseFloat(e||0)-d.min;a=a["unit"+f];a=c[f.toLowerCase()]-("X"==f?-1:1)*Math.floor(a*g);0>g&&(a=c[f.toLowerCase()]);e>d.max&&(a=b[f.toLowerCase()]);e<d.min&&(a=c[f.toLowerCase()]);return a},_calcScatterUnit:function(a,b,c,d,e){b=this._getRelativeValue(b,
c);e=e||"";a["relValue"+e]=b[0];a["valueFactor"+e]=b[1];a["unit"+e]=a["relValue"+e]?d/a["relValue"+e]:10}});
webix.extend(webix.ui.chart,{presets:{simple:{item:{borderColor:"#ffffff",color:"#2b7100",shadow:!1,borderWidth:2},line:{color:"#8ecf03",width:2}},plot:{color:"#1293f8",item:{borderColor:"#636363",borderWidth:1,color:"#ffffff",type:"r",shadow:!1},line:{color:"#1293f8",width:2}},diamond:{color:"#b64040",item:{borderColor:"#b64040",color:"#b64040",type:"d",radius:3,shadow:!0},line:{color:"#ff9000",width:2}},point:{color:"#fe5916",disableLines:!0,fill:!1,disableItems:!1,item:{color:"#feb916",borderColor:"#fe5916",
radius:2,borderWidth:1,type:"r"},alpha:1},line:{line:{color:"#3399ff",width:2},item:{color:"#ffffff",borderColor:"#3399ff",radius:2,borderWidth:2,type:"d"},fill:!1,disableItems:!1,disableLines:!1,alpha:1},area:{fill:"#3399ff",line:{color:"#3399ff",width:1},disableItems:!0,alpha:.2,disableLines:!1},round:{item:{radius:3,borderColor:"#3f83ff",borderWidth:1,color:"#3f83ff",type:"r",shadow:!1,alpha:.6}},square:{item:{radius:3,borderColor:"#447900",borderWidth:2,color:"#69ba00",type:"s",shadow:!1,alpha:1}},
column:{color:"RAINBOW",gradient:!1,barWidth:45,radius:0,alpha:1,border:!0},stick:{barWidth:5,gradient:!1,color:"#67b5c9",radius:2,alpha:1,border:!1},alpha:{color:"#b9a8f9",barWidth:70,gradient:"falling",radius:0,alpha:.5,border:!0}}});
webix.extend(webix.ui.chart,{$render_splineArea:function(a,b,c,d,e,f){var g,h,k=this._settings,l=[];var m=this._calculateLineParams(a,b,c,d,e);var n=k.eventRadius||Math.floor(m.cellWidth/2);var p=[];if(b.length){var q=c.x;for(g=0;g<b.length;g++)if((h=this._getPointY(b[g],c,d,m))||"0"==h){var r=g?m.cellWidth*g-.5+q:q;p.push({x:r,y:h,index:g});f.addRect(b[g].id,[r-n-c.x,h-n-c.y,r+n-c.x,h+n-c.y],e)}f=this._getSplineParameters(p);for(g=0;g<p.length;g++)if(n=p[g].x,g<p.length-1){var v=p[g+1].x;m=p[g+1].y;
for(e=n;e<v;e++)r=this._getSplineYPoint(e,n,g,f.a,f.b,f.c,f.d),r<c.y&&(r=c.y),r>d.y&&(r=d.y),q=this._getSplineYPoint(e+1,n,g,f.a,f.b,f.c,f.d),q<c.y&&(q=c.y),q>d.y&&(q=d.y),l.push([e,r]),l.push([e+1,q]);l.push([v,m])}c=this._settings.color.call(this,b[0]);l.length&&(l.push([v,d.y]),l.push([l[0][0],d.y]));a.globalAlpha=this._settings.alpha.call(this,b[0]);a.fillStyle=c;a.beginPath();this._path(a,l);a.fill();a.lineWidth=1;a.globalAlpha=1;k.border&&(a.lineWidth=k.borderWidth||1,k.borderColor?a.strokeStyle=
k.borderColor.call(this,b[0]):this._setBorderStyles(a,c),a.beginPath(),l.splice(l.length-3),this._path(a,l),a.stroke())}}});
(function(){function a(a){if(!a._stockRenderHandler){var c=a._settings;c.cellWidth||(c.cellWidth=30);c.animateDuration||(c.animateDuration=400);c.offset=!1;a._stockRenderHandler=a.attachEvent("onBeforeRender",function(d,e){var f=a._getChartBounds(a._content_width,a._content_height);g(a);var h=c.cellWidth;h&&d.length&&(f=Math.ceil((f.end.x-f.start.x)/h),d.length>f+1&&d.splice(0,d.length-f-1));"add"==e&&b(a)});a._stockXAxisHandler=a.attachEvent("onBeforeXAxis",function(b,c,d,e,f,g){var h,k=a._settings,
l=d.x-.5,m=parseInt(g?g:e.y,10)+.5,n=e.x;if(k.dynamic){var p=(c.length-1)*f>n-l||c.length<a.count();for(h=0;h<c.length;h++){var q=l+h*f;g=p?1<h:!!h;q=Math.ceil(q)-.5;a._drawXAxisLabel(q,m,c[h],g);h&&k.xAxis.lines.call(a,c[h])&&a._drawXAxisLine(b,q,e.y,d.y,c[h])}a.canvases.x.renderTextAt(!0,!1,l,e.y+k.padding.bottom-3,k.xAxis.title,"webix_axis_title_x",e.x-d.x);a._drawLine(b,l,m,n+(p?a._stockAnimationOffset:0),m,k.xAxis.color,1)}return!1})}}function b(a){var b=a._settings.cellWidth;a._stockAnimationOffset!=
b&&(a._stockAnimationOffset=b,a.render());a._stockAnimationOffset=0;a._stockAnimationStart=null;window.requestAnimationFrame&&!document.hidden&&window.requestAnimationFrame(function(b){c(a,b)});a._stockAnimateHandler||(a._stockAnimateHandler=a.attachEvent("onAfterRender",function(b){d(a,b)}))}function c(a,b){var d=a._settings.animateDuration,e=a._settings.cellWidth;e&&1<a.count()&&(a._stockAnimationStart||(a._stockAnimationStart=b),b-=a._stockAnimationStart,a._stockAnimationOffset=Math.min(Math.max(b/
d*e,1),e),a.render(),b<d&&window.requestAnimationFrame(function(b){c(a,b)}))}function d(a,b){var c=a.count(),d=a._getChartBounds(a._content_width,a._content_height),g=a._settings.cellWidth,k=a._stockAnimationOffset||0,l=b.length<c||(b.length-1)*g>d.end.x-d.start.x;f(a,function(a,f){var h=d.start.x,l=d.end.x,m="x"==a,n=f.getCanvas(),p=f._canvas;a=f._canvas_labels;f=f._canvas_series;if(k&&(b.length<c||(b.length-1)*g>l-h)){if(p.style.left=-k+"px",1<b.length){if(a.length)for(webix.html.remove(a[0]),m=
1;m<a.length;m++)e(f,a[m])||(a[m].style.left=a[m].offsetLeft-k+"px");n.clearRect(0,0,h+k,p.offsetHeight);n.clearRect(l+k,0,p.offsetWidth,p.offsetHeight)}}else p.style.left="0px",m||k==g||n.clearRect(h+(b.length-1)*g-g+k,0,p.offsetWidth,p.offsetHeight);1<a.length&&k&&k!=g&&(h=a.length-1,e(f,a[h])&&--h,a[h].style.display="none")});h(a,d,l?k:0)}function e(a,b){return"axis_x"===a&&-1!==b.className.indexOf("webix_axis_title_x")}function f(a,b){if(a.canvases){for(var c=0;c<a._series.length;c++)a.canvases[c]&&
b(c,a.canvases[c]);a.canvases.x&&b("x",a.canvases.x)}}function g(a){f(a,function(b,c){c._resizeCanvas(a._content_width+2*a._settings.cellWidth,a._content_height)})}function h(a,b,c){a._contentobj._htmlmap.style.left=b.start.x-c+"px";a._contentobj._htmlmap.style.width=b.end.x-b.start.x+c+"px"}webix.extend(webix.ui.chart,{dynamic_setter:function(b){b&&a(this);return b}})})();
webix.protoUI({name:"calendar",defaults:{date:new Date,select:!1,navigation:!0,monthSelect:!0,weekHeader:!0,weekNumber:!1,skipEmptyWeeks:!1,calendarHeader:"%F %Y",calendarWeekHeader:"W#",events:webix.Date.isHoliday,minuteStep:5,icons:!1,timepickerHeight:30,headerHeight:70,dayTemplate:function(a){return a.getDate()},width:260,height:250},dayTemplate_setter:webix.template,calendarHeader_setter:webix.Date.dateToStr,calendarWeekHeader_setter:webix.Date.dateToStr,calendarTime_setter:function(a){this._calendarTime=
a;return webix.Date.dateToStr(a)},date_setter:function(a){return this._string_to_date(a)},maxDate_setter:function(a){return this._string_to_date(a)},minDate_setter:function(a){return this._string_to_date(a)},minTime_setter:function(a){"string"==typeof a&&(a=webix.i18n.parseTimeFormatDate(a),a=[a.getHours(),a.getMinutes()]);return a},maxTime_setter:function(a){"string"==typeof a&&(a=webix.i18n.parseTimeFormatDate(a),a=[a.getHours(),a.getMinutes()]);return a},_ariaFocus:function(){var a="focus"+(webix.env.isIE?
"in":"");webix.env.touch||webix._event(this.$view,a,webix.bind(function(a){var b=a.target.className;b=-1!==b.indexOf("webix_cal_day")?"webix_cal_day":-1!==b.indexOf("webix_cal_block")?"webix_cal_block":"";if(300<new Date-webix.UIManager._tab_time&&100<new Date-webix.UIManager._mouse_time&&b){var d=a.relatedTarget;d&&!webix.isUndefined(d.className)&&(a="webix_cal_day"==b?this._locate_day(a.target):this._locate_date(a.target),this._moveSelection(a))}},this),{capture:!webix.env.isIE})},$init:function(){this._viewobj.className+=
" webix_calendar";this._viewobj.setAttribute("role","region");this._viewobj.setAttribute("aria-label",webix.i18n.aria.calendar);this._special_dates={};this._selected_days={};this._zoom_level=0;this._ariaFocus();this.attachEvent("onKeyPress",this._onKeyPress);this.attachEvent("onAfterZoom",function(a){0<=a&&this.$view.querySelector(".webix_cal_month_name").blur()})},type_setter:function(a){"time"==a?(this._zoom_in=!0,this._zoom_level=-1):"year"==a&&(this._fixed=!0);return a},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,
a,b)&&this.render()},$getSize:function(a,b){if(this._settings.cellHeight){var c=this._getDateBoundaries(this._settings.date);this._settings.height=this._settings.cellHeight*c._rows+(webix.skin.$active.calendarHeight||70)}return webix.ui.view.prototype.$getSize.call(this,a,b)},moveSelection:function(a,b,c){this.config.master||(b=this.getSelectedDate(),this.config.multiselect&&(b=b[0]),b=webix.Date.copy(b||this.getVisibleDate()),this._moveSelection(b,a,c))},_moveSelection:function(a,b,c){a=this._zoom_logic[this._zoom_level]._keyshift(a,
b,this);!1!==c&&(c=this._viewobj.querySelector("."+a+"[tabindex='0']"))&&c.focus()},_getDateBoundaries:function(a,b){if(!this._set_date_bounds||b){b=a.getMonth();var c=a.getFullYear();a=new Date(c,b+1,1);c=webix.Date.weekStart(new Date(c,b,1));var d=Math.round((a.valueOf()-c.valueOf())/864E5);this._set_date_bounds={_month:b,_start:c,_next:a,_rows:this._settings.skipEmptyWeeks?Math.ceil(d/7):6}}return this._set_date_bounds},$skin:function(){webix.skin.$active.calendar&&(webix.skin.$active.calendar.width&&
(this.defaults.width=webix.skin.$active.calendar.width),webix.skin.$active.calendar.height&&(this.defaults.height=webix.skin.$active.calendar.height),webix.skin.$active.calendar.headerHeight&&(this.defaults.headerHeight=webix.skin.$active.calendar.headerHeight),webix.skin.$active.calendar.timepickerHeight&&(this.defaults.timepickerHeight=webix.skin.$active.calendar.timepickerHeight))},_getColumnConfigSizes:function(a){var b=this._getDateBoundaries(a);a=[];for(var c=[],d=this._content_width-36,e=this._content_height-
this._settings.headerHeight-10-(this._settings.timepicker||this._icons?this._settings.timepickerHeight:0),f=this._settings.weekNumber?8:7,g=0;g<f;g++)c[g]=Math.ceil(d/(f-g)),d-=c[g];b=b._rows;for(d=0;d<b;d++)a[d]=Math.ceil(e/(b-d)),e-=a[d];return[c,a]},icons_setter:function(a){this._icons=a?"object"==typeof a?a:this._icons2:null},_icons:[],_icons2:[{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_today webix_cal_icon'>"+webix.i18n.calendar.today+"</span>"},on_click:{webix_cal_icon_today:function(){this.setValue(new Date);
this.callEvent("onTodaySet",[this.getSelectedDate()])}}},{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_clear webix_cal_icon'>"+webix.i18n.calendar.clear+"</span>"},on_click:{webix_cal_icon_clear:function(){this.setValue("");this.callEvent("onDateClear",[this.getSelectedDate()])}}}],refresh:function(){this.render()},render:function(){this._zoom_level=0;this._zoom_size=!1;var a=this._settings;if(this.isVisible(a.id)){this._current_time=webix.Date.datePart(new Date);
webix.debug_render&&webix.log("Render: "+this.name+"@"+a.id);this.callEvent("onBeforeRender",[]);var b=this._settings.date,c=this._getDateBoundaries(b,!0),d=this._getColumnConfigSizes(b),e=d[0];d=d[1];var f="<div class='webix_cal_month'><span role='button' tabindex='0' aria-live='assertive' aria-atomic='true' class='webix_cal_month_name"+(this._settings.monthSelect?"":" webix_readonly")+"'>"+a.calendarHeader(b)+"</span>";a.navigation&&(f+="<div role='button' tabindex='0' aria-label='"+webix.i18n.aria.navMonth[0]+
"' class='webix_cal_prev_button'></div><div role='button' tabindex='0' aria-label='"+webix.i18n.aria.navMonth[1]+"' class='webix_cal_next_button'></div>");f+="</div>";a.weekHeader&&(f+="<div class='webix_cal_header' aria-hidden='true'>"+this._week_template(e)+"</div>");f+="<div class='webix_cal_body'>"+this._body_template(e,d,c)+"</div>";if(this._settings.timepicker||this._icons)f+="<div class='webix_cal_footer'>",this._settings.timepicker&&(f+=this._timepicker_template(b)),this._icons&&(f+=this._icons_template()),
f+="</div>";this._contentobj.innerHTML=f;if("time"==this._settings.type){if(a=this._settings.date)"string"==typeof a?b=webix.i18n.parseTimeFormatDate(a):webix.isArray(a)&&(b.setHours(a[0]),b.setMinutes(a[1]));this._changeZoomLevel(-1,b)}else"month"==this._settings.type?this._changeZoomLevel(1,b):"year"==this._settings.type&&this._changeZoomLevel(2,b);this.callEvent("onAfterRender",[])}},_icons_template:function(a){for(var b="<div class='webix_cal_icons'>",c=this._icons,d=0;d<c.length;d++){if(c[d].template){var e=
"function"==typeof c[d].template?c[d].template:webix.template(c[d].template);b+=e.call(this,a)}c[d].on_click&&webix.extend(this.on_click,c[d].on_click)}return b+"</div>"},_timepicker_template:function(a){var b=this._settings.calendarTime||webix.i18n.timeFormatStr,c="";if(this._settings.master){var d=webix.copy(webix.$$(this._settings.master)._settings.value);webix.Date.equal(d.end,a)&&(d.start=d.end);for(var e in d)c+="<div role='button' tabindex='0' class='webix_range_time_"+e+" webix_cal_time'><span class='webix_icon fa-clock-o'></span> "+
b(d[e])+"</div>"}else c="<div role='button' tabindex='0' class='webix_cal_time"+(this._icons?" webix_cal_time_icons":"")+"'><span class='webix_icon fa-clock-o'></span> "+b(a)+"</div>";return c},_week_template:function(a){var b=this._settings,c="",d=0;b.weekNumber&&(d=1,c+="<div class='webix_cal_week_header' style='width: "+a[0]+"px;' >"+b.calendarWeekHeader()+"</div>");b=webix.Date.startOnMonday?1:0;for(var e=0;7>e;e++){var f=(b+e)%7;c+="<div day='"+f+"' style='width: "+a[e+d]+"px;' >"+webix.i18n.calendar.dayShort[f]+
"</div>"}return c},blockDates_setter:function(a){return webix.toFunctor(a,this.$scope)},_day_css:function(a,b){var c="";webix.Date.equal(a,this._current_time)&&(c+=" webix_cal_today");this._checkDate(a)||(c+=" webix_cal_day_disabled");this._selectedDay(a)&&(c+=" webix_cal_select");a.getMonth()!=b._month&&(c+=" webix_cal_outside");this._settings.events&&(c+=" "+(this._settings.events(a)||""));return c+" webix_cal_day"},_body_template:function(a,b,c){var d=this._settings,e="",f=webix.Date.datePart(webix.Date.copy(c._start));
d=d.weekNumber?1:0;for(var g=webix.Date.getISOWeek(webix.Date.add(f,2,"day",!0)),h=0;h<b.length;h++){e+="<div class='webix_cal_row' style='height:"+b[h]+"px;line-height:"+b[h]+"px'>";d&&(!f.getMonth()&&7>f.getDate()&&(g=webix.Date.getISOWeek(webix.Date.add(f,2,"day",!0))),e+="<div class='webix_cal_week_num' aria-hidden='true' style='width:"+a[0]+"px'>"+g+"</div>");for(var k=d;k<a.length;k++){var l=this._day_css(f,c),m=this._settings.dayTemplate.call(this,f),n=this._selectedDay(f),p="";"object"==typeof m?
(p=m.aria||p,m=m.text):p=webix.Date.dateToStr(webix.i18n.aria.dateFormat)(f);e+="<div day='"+k+"' role='gridcell' "+(f.getMonth()!=c._month?"aria-hidden='true'":"")+" aria-label='"+p+"' tabindex='"+(n?"0":"-1")+"' aria-selected='"+(n?"true":"false")+"' class='"+l+"' style='width:"+a[k]+"px'><span aria-hidden='true' class='webix_cal_day_inner'>"+m+"</span></div>";f=webix.Date.add(f,1,"day");f.getHours()&&(f=webix.Date.datePart(f))}e+="</div>";g++}return e},_changeDate:function(a,b,c){c=this._settings.date;
b||(b=this._zoom_logic[this._zoom_level]._changeStep);this._zoom_level||(c=webix.Date.copy(c),c.setDate(1));a=webix.Date.add(c,a*b,"month",!0);this._changeDateInternal(c,a)},_changeDateInternal:function(a,b){this.callEvent("onBeforeMonthChange",[a,b])&&(this._zoom_level?this._update_zoom_level(b):this.showCalendar(b),this.callEvent("onAfterMonthChange",[b,a]))},_zoom_logic:{"-2":{_isBlocked:function(a){var b=this._settings,c=b.date,d=!1,e=b.minTime?b.minTime[0]:0,f=b.maxTime?b.maxTime[0]+(b.maxTime[1]?
1:0):24;e=b.minTime&&c.getHours()==e?b.minTime[1]:0;b=b.maxTime&&b.maxTime[1]&&c.getHours()==f-1?b.maxTime[1]:60;this._settings.blockTime&&(c=webix.Date.copy(c),c.setMinutes(a),d=this._settings.blockTime(c));return a<e||a>=b||d},_setContent:function(a,b){a.setMinutes(b)},_findActive:function(a,b,c){if(this._isBlocked.call(c,a.getMinutes())){var d=c._settings.minuteStep;d=webix.Date.add(a,"right"==b?d:-d,"minute",!0);if(a.getHours()===d.getHours())return this._findActive(d,b,c)}else return a}},"-1":{_isBlocked:function(a){var b=
this._settings,c=b.date,d=b.minTime?b.minTime[0]:0,e=b.maxTime?b.maxTime[0]+(b.maxTime[1]?1:0):24;if(a<d||a>=e)return!0;if(b.blockTime){c=webix.Date.copy(c);c.setHours(a);e=b.maxTime&&b.maxTime[1]&&a==e-1?b.maxTime[1]:60;for(a=b.minTime&&a==d?b.minTime[1]:0;a<e;a+=b.minuteStep)if(c.setMinutes(a),!b.blockTime(c))return!1;return!0}},_setContent:function(a,b){a.setHours(b)},_keyshift:function(a,b,c){var d=c._settings.minuteStep;if("bottom"===b||"top"===b){a.setHours("bottom"===b?23:0);a.setMinutes("bottom"===
b?55:0);a.setSeconds(0);a.setMilliseconds(0);var e=a}else"left"===b||"right"===b?(e="right"===b?d:-d,"left"===b&&a.getMinutes()<d&&(e=60-d),"right"===b&&a.getMinutes()>=60-d&&(e=d-60),e-=a.getMinutes()%d,e=c._zoom_logic["-2"]._findActive(webix.Date.add(a,e,"minute"),b,c)):"up"===b||"down"===b?(e="down"===b?1:-1,"down"===b&&23===a.getHours()&&(e=-23),"up"===b&&0===a.getHours()&&(e=23),e=this._findActive(webix.Date.add(a,e,"hour"),b,c)):!1===b&&(e=this._findActive(a,b,c));c.selectDate(e,!1);e&&(c._update_zoom_level(e),
c.selectDate(e,!1));return"webix_cal_block"+("left"===b||"right"===b?"_min":"")},_findActive:function(a,b,c){if(this._isBlocked.call(c,a.getHours())){var d=webix.Date.add(a,"down"==b?1:-1,"hour",!0);if(a.getDate()===d.getDate())return this._findActive(d,b,c)}else return a}},0:{_changeStep:1,_keyshift:function(a,b,c){var d=a;if("pgup"===b||"pgdown"===b)d=webix.Date.add(a,"pgdown"===b?1:-1,"month");else if("bottom"===b)d=new Date(a.getFullYear(),a.getMonth()+1,0);else if("top"===b)d=new Date(a.setDate(1));
else if("left"===b||"right"===b)d=webix.Date.add(a,"right"===b?1:-1,"day");else if("up"===b||"down"===b)d=webix.Date.add(a,"down"===b?1:-1,"week");c._checkDate(d)||(d=c._findActive(a,b));d&&c.selectDate(d,!0);return"webix_cal_day"}},1:{_isBlocked:function(a,b){var c=!1,d=b._settings.minDate||null,e=b._settings.maxDate||null,f=b._settings.date.getFullYear();if(d&&e){b=d.getFullYear();var g=e.getFullYear();if(f<b||f==b&&d.getMonth()>a||f>g||f==g&&e.getMonth()<a)c=!0}return c},_correctDate:function(a,
b){a<b._settings.minDate?a=webix.Date.copy(b._settings.minDate):a>b._settings.maxDate&&(a=webix.Date.copy(b._settings.maxDate));return a},_getTitle:function(a){return a.getFullYear()},_getContent:function(a){return webix.i18n.calendar.monthShort[a]},_setContent:function(a,b){b!=a.getMonth()&&a.setDate(1);a.setMonth(b)},_changeStep:12,_keyshift:function(a,b,c){var d=a;if("pgup"===b||"pgdown"===b)d=webix.Date.add(a,"pgdown"===b?1:-1,"year");else if("bottom"===b)d=new Date(a.setMonth(11));else if("top"===
b)d=new Date(a.setMonth(0));else if("left"===b||"right"===b)d=webix.Date.add(a,"right"===b?1:-1,"month");else if("up"===b||"down"===b)d=webix.Date.add(a,"down"===b?4:-4,"month");c._checkDate(d)||(d=c._findActive(a,b));d&&(c._update_zoom_level(d),c.selectDate(d,!1));return"webix_cal_block"}},2:{_isBlocked:function(a,b){a+=b._zoom_start_date;var c=!1,d=b._settings.minDate;b=b._settings.maxDate;d&&b&&(d.getFullYear()>a||b.getFullYear()<a)&&(c=!0);return c},_correctDate:function(a,b){a<b._settings.minDate?
a=webix.Date.copy(b._settings.minDate):a>b._settings.maxDate&&(a=webix.Date.copy(b._settings.maxDate));return a},_getTitle:function(a,b){a=a.getFullYear();b._zoom_start_date=a=a-a%10-1;return a+" - "+(a+10+1)},_getContent:function(a,b){return b._zoom_start_date+a},_setContent:function(a,b,c){a.setFullYear(c._zoom_start_date+b)},_changeStep:120,_keyshift:function(a,b,c){var d=a;if("pgup"===b||"pgdown"===b)d=webix.Date.add(a,"pgdown"===b?10:-10,"year");else if("bottom"===b)d=new Date(a.setYear(c._zoom_start_date+
10));else if("top"===b)d=new Date(a.setYear(c._zoom_start_date));else if("left"===b||"right"===b)d=webix.Date.add(a,"right"===b?1:-1,"year");else if("up"===b||"down"===b)d=webix.Date.add(a,"down"===b?4:-4,"year");c._checkDate(d)||(d=c._findActive(a,b));d&&(c._update_zoom_level(d),c.selectDate(d,!1));return"webix_cal_block"}}},_correctBlockedTime:function(){var a;if(this._zoom_logic[-1]._isBlocked.call(this,this._settings.date.getHours()))for(a=0;24>a;a++)if(!this._zoom_logic[-1]._isBlocked.call(this,
a)){this._settings.date.setHours(a);break}if(this._zoom_logic[-2]._isBlocked.call(this,this._settings.date.getMinutes()))for(a=0;60>a;a+=this._settings.minuteStep)if(!this._zoom_logic[-2]._isBlocked.call(this,a)){this._settings.date.setMinutes(a);break}},_update_zoom_level:function(a){var b,c="";var d=this._settings;var e=d.weekHeader?2:1;var f=this._zoom_logic[this._zoom_level];var g=this._contentobj.childNodes;a&&(d.date=a);var h=d.type;this._zoom_size||(this._reserve_box_height=this._contentobj.offsetHeight-
d.headerHeight,"year"!=h&&"month"!=h?this._reserve_box_height-=d.timepickerHeight:this._icons&&(this._reserve_box_height-=10),this._reserve_box_width=g[e].offsetWidth,this._zoom_size=1);if(this._zoom_in){a=this._reserve_box_height/6;var k=6;(e=(this._calendarTime||webix.i18n.timeFormat).match(/%([a,A])/))&&k++;var l=parseInt((this._reserve_box_width-3)/k,10);c+="<div class='webix_time_header'>"+this._timeHeaderTemplate(l,e)+"</div>";c+="<div  class='webix_cal_body' style='height:"+this._reserve_box_height+
"px'>";this._correctBlockedTime();c+="<div class='webix_hours'>";k=d.date.getHours();g=webix.Date.copy(d.date);for(b=0;24>b;b++){var m="";e&&0===b%4&&(f=b?12==b?webix.i18n.pm[0]:"":webix.i18n.am[0],c+="<div class='webix_cal_block_empty"+m+"' style='"+this._getCalSizesString(l,a)+"clear:both;'>"+f+"</div>");this._zoom_logic[-1]._isBlocked.call(this,b)?m+=" webix_cal_day_disabled":k==b&&(m+=" webix_selected");g.setHours(b);c+="<div aria-label='"+webix.Date.dateToStr(webix.i18n.aria.hourFormat)(g)+"' role='gridcell' tabindex='"+
(k==b?"0":"-1")+"' aria-selected='"+(k==b?"true":"false")+"' class='webix_cal_block"+m+"' data-value='"+b+"' style='"+this._getCalSizesString(l,a)+(0!==b%4||e?"":"clear:both;")+"'>"+webix.Date.toFixed(e?b&&12!=b?b%12:12:b)+"</div>"}c+="</div><div class='webix_minutes'>";k=d.date.getMinutes();g=webix.Date.copy(d.date);for(b=0;60>b;b+=d.minuteStep)m="",this._zoom_logic[-2]._isBlocked.call(this,b)?m=" webix_cal_day_disabled":k==b&&(m=" webix_selected"),g.setMinutes(b),c+="<div aria-label='"+webix.Date.dateToStr(webix.i18n.aria.minuteFormat)(g)+
"' role='gridcell' tabindex='"+(k==b?"0":"-1")+"' aria-selected='"+(k==b?"true":"false")+"' class='webix_cal_block webix_cal_block_min"+m+"' data-value='"+b+"' style='"+this._getCalSizesString(l,a)+(0===b%2?"clear:both;":"")+"'>"+webix.Date.toFixed(b)+"</div>";c=c+"</div></div><div  class='webix_time_footer'>"+(this._timeButtonsTemplate()+"</div>");this._contentobj.innerHTML=c}else{a=g[0].childNodes;m=webix.i18n.aria["nav"+(1==this._zoom_level?"Year":"Decade")];a[0].innerHTML=f._getTitle(d.date,this);
a[1].setAttribute("aria-label",m[0]);a[2].setAttribute("aria-label",m[1]);a=this._reserve_box_height/3;l=this._reserve_box_width/4;this._checkDate(d.date)&&(k=1==this._zoom_level?d.date.getMonth():d.date.getFullYear());for(b=0;12>b;b++)m=k==(1==this._zoom_level?b:f._getContent(b,this))?" webix_selected":"",f._isBlocked(b,this)&&(m+=" webix_cal_day_disabled"),c+="<div role='gridcell' aria-label='"+webix.Date.dateToStr(webix.i18n.aria[(1==this._zoom_level?"month":"year")+"Format"])(d.date)+"' tabindex='"+
(-1!==m.indexOf("selected")?"0":"-1")+"' aria-selected='"+(-1!==m.indexOf("selected")?"true":"false")+"' class='webix_cal_block"+m+"' data-value='"+b+"' style='"+this._getCalSizesString(l,a)+"'>"+f._getContent(b,this)+"</div>";e-1&&(g[e-1].style.display="none");g[e].innerHTML=c;"year"!=h&&"month"!=h&&(g[e+1]?g[e+1].innerHTML=this._timeButtonsTemplate():this._contentobj.innerHTML+="<div  class='webix_time_footer'>"+this._timeButtonsTemplate()+"</div>");g[e].style.height=this._reserve_box_height+"px"}},
_getCalSizesString:function(a,b){return"width:"+a+"px; height:"+b+"px; line-height:"+b+"px;"},_timeButtonsTemplate:function(){return"<input type='button' style='width:100%' class='webix_cal_done' value='"+webix.i18n.calendar.done+"'>"},_timeHeaderTemplate:function(a,b){return"<div class='webix_cal_hours' style='width:"+a*(b?5:4)+"px'>"+webix.i18n.calendar.hours+"</div><div class='webix_cal_minutes' style='width:"+2*a+"px'>"+webix.i18n.calendar.minutes+"</div>"},_changeZoomLevel:function(a,b){var c=
this._zoom_level;this.callEvent("onBeforeZoom",[a,c])&&((this._zoom_level=a)?this._update_zoom_level(b):this.showCalendar(b),this.callEvent("onAfterZoom",[a,c]))},_correctDate:function(a){!this._checkDate(a)&&this._zoom_logic[this._zoom_level]._correctDate&&(a=this._zoom_logic[this._zoom_level]._correctDate(a,this));return a},_mode_selected:function(a){a=this._locate_date(a);var b=this._zoom_level-(this._fixed?0:1);a=this._correctDate(a);this._checkDate(a)&&(this._changeZoomLevel(b,a),b=this._settings.type,
"month"!=b&&"year"!=b||this._selectDate(a))},_selectDate:function(a,b){this.callEvent("onBeforeDateSelect",[a])&&(this.selectDate(a,!0,b),this.callEvent("onDateSelect",[a]),this.callEvent("onAfterDateSelect",[a]))},_locate_day:function(a){var b=webix.html.index(a)-(this._settings.weekNumber?1:0);a=webix.html.index(a.parentNode);b=webix.Date.add(this._getDateBoundaries()._start,b+7*a,"day",!0);this._settings.timepicker&&(b.setHours(this._settings.date.getHours()),b.setMinutes(this._settings.date.getMinutes()));
return b},_locate_date:function(a){var b=1*a.getAttribute("data-value");a=-1!=a.className.indexOf("webix_cal_block_min")?this._zoom_level-1:this._zoom_level;var c=webix.Date.copy(this._settings.date);this._zoom_logic[a]._setContent(c,b,this);return c},on_click:{webix_cal_prev_button:function(a,b,c){this._changeDate(-1)},webix_cal_next_button:function(a,b,c){this._changeDate(1)},webix_cal_day_disabled:function(){return!1},webix_cal_outside:function(){if(!this._settings.navigation)return!1},webix_cal_day:function(a,
b,c){b=this._locate_day(c);this._selectDate(b,"touch"===this._settings.multiselect||a.ctrlKey||a.metaKey)},webix_cal_time:function(a){this._zoom_logic[this._zoom_level-1]&&(this._zoom_in=!0,this._changeZoomLevel(this._zoom_level-1))},webix_range_time_start:function(){webix.$$(this._settings.master)._time_mode="start"},webix_range_time_end:function(){webix.$$(this._settings.master)._time_mode="end"},webix_cal_done:function(a){a=webix.Date.copy(this._settings.date);a=this._correctDate(a);this._selectDate(a)},
webix_cal_month_name:function(a){this._zoom_in=!1;2!=this._zoom_level&&this._settings.monthSelect&&this._changeZoomLevel(Math.max(this._zoom_level,0)+1)},webix_cal_block:function(a,b,c){if(this._zoom_in){if(-1!==c.className.indexOf("webix_cal_day_disabled"))return!1;a=this._locate_date(c);this._update_zoom_level(a)}else-1==c.className.indexOf("webix_cal_day_disabled")&&this._mode_selected(c)}},_string_to_date:function(a,b){if(!a)return webix.Date.datePart(new Date);"string"==typeof a&&(a=b?webix.Date.strToDate(b)(a):
webix.i18n.parseFormatDate(a));return a},_checkDate:function(a){var b=this._settings.blockDates&&this._settings.blockDates.call(this,a),c=this._settings.minDate,d=this._settings.maxDate;return!b&&!(a<c||a>d)},_findActive:function(a,b){var c=webix.Date.add(a,"top"===b||"left"===b||"pgup"===b||"up"===b?-1:1,"day",!0);if(this._checkDate(c))return c;var d;0===this._zoom_level?d=a.getMonth()===c.getMonth():1===this._zoom_level?d=a.getFullYear()===c.getFullYear():2===this._zoom_level&&(d=c.getFullYear()>
this._zoom_start_date&&c.getFullYear()<this._zoom_start_date+10);if(d)return this._findActive(c,b)},showCalendar:function(a){a=this._string_to_date(a);this._settings.date=a;this.render();this.resize()},_selectedDay:function(a){return a&&this._selected_days[a.valueOf()]},getSelectedDate:function(){var a=[],b;for(b in this._selected_days)a.push(webix.Date.copy(this._selected_days[b]));return this.config.multiselect?a:a[0]||null},getVisibleDate:function(){return webix.Date.copy(this._settings.date)},
setValue:function(a,b){this.selectDate(a,!0)},getValue:function(a){var b=this.getSelectedDate();a&&(b=webix.Date.dateToStr(a)(b));return b},selectDate:function(a,b,c){a&&c&&this.config.multiselect||(this._selected_days={});if(a){webix.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++){var e=this._string_to_date(a[d]),f=webix.Date.datePart(webix.Date.copy(e)).valueOf();this._selected_days[f]&&c?delete this._selected_days[f]:this._selected_days[f]=e;if(!this.config.multiselect)break}}b?a&&this.showCalendar(a[0]):
!1!==b&&this.render();this.callEvent("onChange",[a])},locate:function(){return null}},webix.KeysNavigation,webix.MouseEvents,webix.ui.view,webix.EventSystem);
webix.protoUI({name:"property",$init:function(){this._contentobj.className+=" webix_property";this._contentobj.setAttribute("role","listbox");this._destroy_with_me=[]},defaults:{nameWidth:100,editable:!0},on_render:{checkbox:function(a,b){return"<input type='checkbox' class='webix_property_check' "+(a?"checked":"")+">"},color:function(a,b){return'<div class="webix_property_col_val"><div class=\'webix_property_col_ind\' style="background-color:'+(a||"#FFFFFF")+';"></div><span>'+a+"</span></div>"}},
on_edit:{label:!1},_id:"webix_f_id",on_click:{webix_property_check:function(a){a=this.locate(a);this.getItem(a).value=!this.getItem(a).value;this.callEvent("onCheck",[a,this.getItem(a).value]);return!1}},on_dblclick:{},registerType:function(a,b){b.template&&(this.on_render[a]=b.template);b.editor&&(this.on_edit[a]=b.editor);if(b.click)for(var c in b.click)this.on_click[c]=b.click[c]},elements_setter:function(a){this._idToLine={};for(var b=0;b<a.length;b++){var c=a[b];"multiselect"==c.type&&(c.optionslist=
!0);c.id=c.id||webix.uid();c.label=c.label||"";c.value=c.value||"";this._idToLine[c.id]=b;this.template=this._map_options(a[b])}return a},showItem:function(a){webix.RenderStack.showItem.call(this,a)},locate:function(a){return webix.html.locate(a,this._id)},getItemNode:function(a){return this._dataobj.childNodes[this._idToLine[a]]},getItem:function(a){return this._settings.elements[this._idToLine[a]]},_get_editor_type:function(a){a=this.getItem(a).type;if("checkbox"==a)return"inline-checkbox";var b=
this.on_edit[a];return!1===b?!1:b||a},_get_edit_config:function(a){return this.getItem(a)},_find_cell_next:function(a,b,c){var d=this._idToLine[a.id];a=this._settings.elements;if(c)for(c=d+1;c<a.length;c++){if(b.call(this,a[c].id))return a[c].id}else for(c=d-1;0<=c;c--)if(b.call(this,a[c].id))return a[c].id;return null},updateItem:function(a,b){b=b||{};(a=this.getItem(a))&&webix.extend(a,b,!0);this.refresh()},_cellPosition:function(a){a=this.getItemNode(a);return{left:a.offsetLeft+this._settings.nameWidth,
top:a.offsetTop,height:a.firstChild.offsetHeight,width:this._data_width,parent:this._contentobj}},setValues:function(a,b){this._settings.complexData&&(a=webix.CodeParser.collapseNames(a));b||this._clear();for(var c in a)if(b=this.getItem(c))b.value=a[c];this._props_dataset=a;this.refresh()},_clear:function(){for(var a=this._settings.elements,b=0;b<a.length;b++)a[b].value=""},getValues:function(){for(var a=webix.clone(this._props_dataset||{}),b=0;b<this._settings.elements.length;b++){var c=this._settings.elements[b];
"label"!=c.type&&(a[c.id]=c.value)}this._settings.complexData&&(a=webix.CodeParser.expandNames(a));return a},refresh:function(){this.render()},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&(this._data_width=this._content_width-this._settings.nameWidth,this.render())},$getSize:function(a,b){this._settings.autoheight&&(this._settings.height=Math.max(this.type.height*this._settings.elements.length,this._settings.minHeight||0));return webix.ui.view.prototype.$getSize.call(this,
a,b)},_toHTML:function(){var a=[],b=this._settings.elements;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.css&&"object"==typeof d.css&&(d.css=webix.html.createCss(d.css));var e='<div webix_f_id="'+d.id+'"'+("label"!==d.type?'role="option" tabindex="0"':"")+' class="webix_property_line '+(d.css||"")+'">';if("label"==d.type)a[c]=e+"<div class='webix_property_label_line'>"+d.label+"</div></div>";else{var f=this.on_render[d.type],g="<div class='webix_property_label' style='width:"+this._settings.nameWidth+
"px'>"+d.label+"</div><div class='webix_property_value' style='width:"+this._data_width+"px'>";var h=d.collection||d.options?d.template(d,d.value):d.format?d.format(d.value):d.value;f&&(h=f.call(this,d.value,d));a[c]=e+g+h+"</div></div>"}}return a.join("")},type:{height:24,templateStart:webix.template(""),templateEnd:webix.template("</div>")},$skin:function(){this.type.height=webix.skin.$active.propertyItemHeight||24}},webix.AutoTooltip,webix.EditAbility,webix.MapCollection,webix.MouseEvents,webix.Scrollable,
webix.SingleRender,webix.AtomDataLoader,webix.EventSystem,webix.ui.view);
webix.protoUI({name:"colorboard",defaults:{template:'<div style="width:100%;height:100%;background-color:{obj.val}"></div>',palette:null,height:220,width:220,cols:12,rows:10,minLightness:.15,maxLightness:1,navigation:!0},$init:function(a){webix._event(this._viewobj,"click",webix.bind(function(a){var b=webix.html.locate(a,"webix_val");this.setValue(b);this.callEvent("onItemClick",[this._settings.value,a]);this.callEvent("onSelect",[this._settings.value])},this));this.$view.setAttribute("role","grid");
this._viewobj.setAttribute("aria-readonly","true")},_findIndex:function(a){var b=this._settings.palette;a=(a||"").toUpperCase();for(var c=0,d=b.length;c<d;c++)for(var e=0,f=b[c].length;e<f;e++)if(b[c][e].toUpperCase()==a)return{row:c,col:e};return null},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&this.render()},getValue:function(){return this._settings.value},_getBox:function(){return this._viewobj.firstChild},setValue:function(a){a&&"#"!=a.toString().charAt(0)&&(a="#"+
a);var b=this._settings.value;this._settings.value=a;this.$setValue(a,b);return a},_selectBox:null,_getSelectBox:function(){if(this._selectBox&&this._selectBox.parentNode)return this._selectBox;var a=this._selectBox=document.createElement("div");a.className="webix_color_selector";this._viewobj.lastChild.appendChild(a);return a},$setValue:function(a,b){if(this.isVisible(this._settings.id)){var c,d;b&&(d=this._findIndex(b));d||(d={row:0,col:0});this._viewobj.lastChild.childNodes[d.row].childNodes[d.col].setAttribute("tabindex",
"-1");(d=this._findIndex(a))&&(c=this._viewobj.lastChild.childNodes[d.row].childNodes[d.col]);c&&c.parentNode&&c.parentNode.parentNode?(a=c.parentNode,b=c.offsetLeft-a.offsetLeft,d=-(this.$height-(c.offsetTop-a.parentNode.offsetTop)),c.setAttribute("tabindex","0"),c.setAttribute("aria-selected","true"),c.setAttribute("tabindex","0"),c.setAttribute("aria-selected","true"),a=this._getSelectBox(),c=["left:"+b+"px","top:"+d+"px","width:"+c.style.width,"height:"+c.style.height].join(";"),"undefined"!==
typeof a.style.cssText?a.style.cssText=c:a.setAttribute("style",c)):(this._selectBox&&(this._selectBox.style.left="-100px"),this._viewobj.lastChild.childNodes[0].childNodes[0].setAttribute("tabindex","0"))}},_initPalette:function(a){function b(a,b,c){return"#"+webix.color.toHex(Math.floor(a),2)+webix.color.toHex(Math.floor(b),2)+webix.color.toHex(Math.floor(c),2)}function c(a,b,c){if(b){var e=.5>c?c*(1+b):c+b-c*b,f=2*c-e;c=d(f,e,a+1/3);b=d(f,e,a);a=d(f,e,a-1/3)}else c=b=a=c;return{r:255*c,g:255*b,
b:255*a}}function d(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>=c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e=[],f=a.rows-1,g=1/a.cols,h=(a.maxLightness-a.minLightness)/f,k=null;e.push(function(a){for(var c=[],d=255,e=d/a,f=0;f<a;f++)d=Math.round(0<d?d:0),c.push(b(d,d,d)),d-=e;c[c.length-1]="#000000";return c}(a.cols));for(var l=0,m=a.minLightness;l<f;l++){k=[];for(var n=0,p=0;n<a.cols;n++){var q=c(p,1,m);k.push(b(q.r,q.g,q.b));p+=g}e.push(k);m+=h}this._settings.palette=e},moveSelection:function(a,
b,c){b=this.getValue();var d,e;b&&(d=this._findIndex(b));d||(d={row:0,col:0});d&&("up"==a||"down"==a?d.row+="up"==a?-1:1:"right"==a||"left"==a?d.col+="right"==a?1:-1:"top"==a?d.row=d.col=0:"bottom"==a&&(d.row=this._viewobj.lastChild.querySelectorAll(".webix_color_row").length-1,d.col=this._viewobj.lastChild.childNodes[d.row].childNodes.length-1),0<=d.row&&(e=this._viewobj.lastChild.childNodes[d.row].childNodes[d.col]),e&&(b=e.getAttribute("webix_val"),this.setValue(b),this.callEvent("onSelect",[this._settings.value]),
!1!==c&&(a=this._viewobj.querySelector("div[tabindex='0']"))&&a.focus()))},render:function(){function a(a,b,e){for(var f='<div class="webix_color_row" role="row">',g=0;g<a.length;g++)d.width=b[g],d.height=e,d.val=a[g],f+=c(d);return f+"</div>"}if(this.isVisible(this._settings.id)){this._settings.palette||this._initPalette(this._settings);var b=this._settings.palette;this.callEvent("onBeforeRender",[]);for(var c=webix.template('<div role=\'gridcell\' tabindex=\'-1\' aria-label="{obj.val}" style="width:{obj.width}px;height:{obj.height}px;" webix_val="{obj.val}">'+
(this._settings.template||"")+"</div>"),d={width:0,height:0,val:0},e=this.$width,f=this.$height,g=[],h='<div class="webix_color_palette"role="rowgroup">',k="object"==typeof b[0]?b[0]:b,l=0;l<k.length;l++)g[l]=Math.floor(e/(k.length-l)),e-=g[l];if("object"==typeof b[0])for(e=0;e<b.length;e++)k=Math.floor(f/(b.length-e)),f-=k,h+=a(b[e],g,k);else h+=a(b,g,f);this._viewobj.innerHTML=h+"</div>";this._selectBox=null;this._settings.value?this.$setValue(this._settings.value):this._viewobj.lastChild.childNodes[0].childNodes[0].setAttribute("tabindex",
"0");this.callEvent("onAfterRender",[])}},refresh:function(){this.render()}},webix.KeysNavigation,webix.ui.view,webix.EventSystem);
webix.protoUI({name:"daterange",defaults:{button:!1,icons:!1,calendarCount:2,borderless:!1},$init:function(a){a.calendar=a.calendar||{};a.value=this._correct_value(a.value);delete a.calendar.type;this._viewobj.className+=" webix_daterange";this._zoom_level=this._types[a.calendar.type]||0;var b=[],c=webix.skin.$active.calendar,d=c&&c.width?c.width:250;c=webix.extend({view:"calendar",width:d,height:c&&c.height?c.height:250},a.calendar||{},!0);for(var e=a.calendarCount=0===this._zoom_level?a.calendarCount||
this.defaults.calendarCount:this.defaults.calendarCount,f=(c.css?c.css+" ":"")+"webix_range_",g=a.value.start||new Date,h=0;h<e;h++){var k=webix.Date.add(g,this._steps[this._zoom_level]*h,"month",!0);webix.extend(c,{events:webix.bind(this._isInRange,this),css:f+(1===e?"":0===h?"0":h+1==e?"N":"1"),timepicker:0===this._zoom_level?a.timepicker:!1,borderless:!0,date:k,master:a.id},!0);b.push(webix.copy(c))}a.rows=[{type:"clean",cols:b},this._footer_row(a,d*e)];a.height=a.height||c.height+(a.icons||a.button?
35:0);a.type="line";this.$ready.push(this._after_init);webix.event(this.$view,"keydown",webix.bind(function(a){this._onKeyPress(a.which||a.keyCode,a)},this))},value_setter:function(a){return this._correct_value(a)},getValue:function(){return this._settings.value},setValue:function(a,b){a=this._correct_value(a);this._settings.value=a;var c=a.start||a.end||new Date;if(!b)for(this._cals[0].showCalendar(a.start),b=1;b<this._cals.length;b++)this._cals[b]._settings.date=c,this._changeDateSilent(this._cals[b],
1,b);this.callEvent("onChange",[a]);this.refresh()},refresh:function(){for(var a=0;a<this._cals.length;a++)if(this._cals[a]._zoom_level===this._zoom_level){webix.html.removeCss(this._cals[a].$view,"webix_cal_timepicker");webix.html.removeCss(this._cals[a].$view,"webix_range_timepicker");var b=this._related_date(this._cals[a].getVisibleDate());b.start||b.end?(this._cals[a]._settings.date=b.start||b.end,this._settings.timepicker&&webix.html.addCss(this._cals[a].$view,"webix_"+(b.start&&b.end?"range":
"cal")+"_timepicker")):webix.Date.datePart(this._cals[a]._settings.date);this._cals[a].refresh()}},addToRange:function(a){a=this._add_date(this._string_to_date(a));this.setValue(a)},_icons:[{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_today webix_cal_icon'>"+webix.i18n.calendar.today+"</span>"},on_click:{webix_cal_icon_today:function(){this.addToRange(new Date);this.callEvent("onTodaySet",[this.getValue()])}}},{template:function(){return"<span role='button' tabindex='0' class='webix_cal_icon_clear webix_cal_icon'>"+
webix.i18n.calendar.clear+"</span>"},on_click:{webix_cal_icon_clear:function(){this.setValue("");this.callEvent("onDateClear",[])}}}],_icons_template:function(a){if(a){a="object"==typeof a?a:this._icons;for(var b={css:"webix_cal_footer ",borderless:!0,height:30,template:"<div class='webix_cal_icons'>",onClick:{}},c=0;c<a.length;c++){if(a[c].template){var d="function"==typeof a[c].template?a[c].template:webix.template(a[c].template);b.template+=d.call(this)}if(a[c].on_click)for(var e in a[c].on_click)b.onClick[e]=
webix.bind(a[c].on_click[e],this)}b.template+="</div>";b.width=webix.html.getTextSize(b.template).width+30;return b}return{width:0}},_footer_row:function(a,b){var c={view:"button",value:webix.i18n.calendar.done,minWidth:100,maxWidth:230,align:"center",height:30,click:function(){this.getParentView().getParentView().hide()}},d=this._icons_template(a.icons),e={css:"webix_range_footer",cols:[{width:d.width}]};(a.button||a.icons)&&2*d.width+c.minWidth>b&&(e.cols[0].width=0);e.cols.push(a.button?c:{});
e.cols.push(d);return e},_types:{time:-1,month:1,year:2},_steps:{0:1,1:12,2:120},_correct_value:function(a){a||(a={start:null,end:null});a.start||a.end||(a={start:a});a.end=this._string_to_date(a.end)||null;a.start=this._string_to_date(a.start)||null;if(a.end&&a.end<a.start||!a.start)a.end=[a.start,a.start=a.end][0];return a},_string_to_date:function(a,b){"string"==typeof a&&(a=b?webix.Date.strToDate(b)(a):webix.i18n.parseFormatDate(a));return isNaN(1*a)?null:a},_isInRange:function(a){var b=this._settings.value,
c=b.start?webix.Date.datePart(webix.Date.copy(b.start)):null,d=b.end?webix.Date.datePart(webix.Date.copy(b.end)):null,e=webix.Date.datePart(a);b="";e>=c&&d&&e<=d&&(b="webix_cal_range");webix.Date.equal(e,c)&&(b="webix_cal_range_start");webix.Date.equal(e,d)&&(b="webix_cal_range_end");a=webix.Date.isHoliday(a)+" "||"";return b+" "+a},_after_init:function(){var a=this._cals=this.getChildViews()[0].getChildViews(),b=this;this._cals_hash={};for(var c=0;c<a.length;c++)if(this._cals_hash[a[c].config.id]=
c,a[c].attachEvent("onBeforeDateSelect",function(a){return b._on_date_select(this,a)}),a[c].attachEvent("onBeforeZoom",function(a){return b._before_zoom(this,a)}),0===c||c===a.length-1)a[c].attachEvent("onAfterMonthChange",webix.bind(this._month_change,this)),a[c].attachEvent("onAfterZoom",function(a,c){b._after_zoom(this,a,c)});this._settings.timepicker&&this.refresh()},_before_zoom:function(a,b){var c=this._getIndexById(a.config.id);if(0<=b&&0<c&&c!==this._cals.length-1)return!1;-1===b&&(b=this._related_date(a.getVisibleDate()),
b.start&&b.end&&(a._settings.date=b[this._time_mode]));return!0},_month_change:function(a,b){var c=a>b?this._cals[this._cals.length-1]:this._cals[0];this._shift(a>b?1:-1,c._zoom_logic[c._zoom_level]._changeStep,c);this.refresh()},_after_zoom:function(a,b,c){var d=a._zoom_logic[a._zoom_level]._changeStep,e=this._getIndexById(a.config.id),f=0===e?1:-1;if(this._cals[e+f]&&(e=this._cals[e+f]._settings.date,c>b&&0<=b)){c=0;if(1===b){b=e.getFullYear();if(this._zoom_level||-1===f&&11===e.getMonth()||1===
f&&0===e.getMonth())b-=f;c=a._settings.date.getFullYear()-b}else if(0===b){f=e.getMonth()-f;if(12===f||-1==f)f=-1===f?11:0;c=a._settings.date.getMonth()-f}this._shift(c,d,a);this.refresh()}},_changeDateSilent:function(a,b,c){a.blockEvent();0<=a._zoom_level&&a._changeDate(b,c);a.unblockEvent()},_getIndexById:function(a){return this._cals_hash[a]},_shift:function(a,b,c){for(var d=0;d<this._cals.length;d++){var e=this._cals[d];c&&e.config.id===c.config.id||this._changeDateSilent(e,a,b)}},_related_date:function(a){var b=
this._settings.value,c={};b.start&&b.start.getYear()===a.getYear()&&b.start.getMonth()===a.getMonth()&&(c.start=b.start);b.end&&b.end.getYear()===a.getYear()&&b.end.getMonth()===a.getMonth()&&(c.end=b.end);return c},_set_time:function(a,b){a.setHours(b.getHours());a.setMinutes(b.getMinutes());a.setSeconds(b.getSeconds());a.setMilliseconds(b.getMilliseconds())},_add_date:function(a,b){var c=webix.copy(this._settings.value);0===this._zoom_level||webix.isUndefined(b)?c.start&&!c.end?c.end=a:(c.start=
a,c.end=null):c[b?"end":"start"]=a;return c},_on_date_select:function(a,b){if(this.callEvent("onBeforeDateSelect",[b])){var c=this._settings.value;if(0>a._zoom_level){var d=webix.copy(this._related_date(b)),e;(e=d.start&&d.end?d[this._time_mode]:d.start||d.end)&&this._set_time(e,b);a._zoom_level=0;c=webix.extend(webix.copy(c),d,!0)}else c=a.getVisibleDate(),d=this._getIndexById(a.config.id),b.getMonth()===c.getMonth()||0!==d&&d!==this._cals.length-1||this._shift(b>c?1:-1,1),c=this._add_date(b,d);
a._zoom_level!==this._zoom_level&&a.showCalendar(b);this.setValue(c,!0);this.callEvent("onAfterDateSelect",[this.getValue()])}return!1}},webix.ui.layout);
webix.protoUI({name:"daterangesuggest",defaults:{type:"daterange",body:{view:"daterange",icons:!0,button:!0,borderless:!0}},getValue:function(){return this.getRange().getValue()},setValue:function(a){this.getRange().setValue(webix.copy(a))},getRange:function(){return this.getBody()},getButton:function(){return this.getBody().getChildViews()[1].getChildViews()[1]},_setValue:function(a,b){var c=webix.$$(this._settings.master);c?(c.setValue(a),b&&this.hide()):this.setValue(a)},_set_on_popup_click:function(){var a=
this.getRange();a.attachEvent("onAfterDateSelect",webix.bind(function(a){this._setValue(a)},this));a.attachEvent("onDateClear",webix.bind(function(a){this._setValue(a)},this));a.attachEvent("onTodaySet",webix.bind(function(a){this._setValue(a)},this))}},webix.ui.suggest);
webix.protoUI({$cssName:"datepicker",name:"daterangepicker",$init:function(){this._settings.value={}},_init_popup:function(){var a=this._settings;a.suggest?a.popup=a.suggest:a.popup||(a.popup=a.suggest=this.suggest_setter({view:"daterangesuggest",body:{timepicker:a.timepicker,calendarCount:a.calendarCount,height:250+(a.button||a.icons?30:0)}}));this._init_once=function(){}},$prepareValue:function(a){a=a||{};a.start=webix.ui.datepicker.prototype.$prepareValue.call(this,a.start?a.start:null);a.end=
webix.ui.datepicker.prototype.$prepareValue.call(this,a.end?a.end:null);return a},$compareValue:function(a,b){var c=webix.ui.datepicker.prototype.$compareValue,d=c.call(this,a.start,b.start);a=c.call(this,a.end,b.end);return d&&a},$setValue:function(a){a=a||{};webix.$$(this._settings.popup.toString()).getRange();this._settings.text=(a.start?this._get_visible_text(a.start):"")+(a.end?" - "+this._get_visible_text(a.end):"");this._set_visible_text()},$render:function(a){a.value=this.$prepareValue(a.value);
this.$setValue(a.value)},getValue:function(){var a=this._settings.type,b=this._settings.value;if(this._settings.stringResult){var c=webix.i18n.parseFormatStr;"time"==a&&(c=webix.i18n.parseTimeFormatStr);!this._formatStr||"month"!=a&&"year"!=a||(c=this._formatStr);return this._formatValue(c,b)}return b||null},_formatValue:function(a,b){var c=webix.$$(this._settings.popup.toString()).getRange();b=webix.copy(c._correct_value(b));b.start&&(b.start=a(b.start));b.end&&(b.end=a(b.end));return b}},webix.ui.datepicker);
webix.protoUI({name:"resizer",defaults:{width:7,height:7},$init:function(a){webix.assert(this.getParentView(),"Resizer can't be initialized outside a layout");this._viewobj.className+=" webix_resizer";var b=this.getParentView()._margin;webix._event(this._viewobj,webix.env.mouse.down,this._rsDown,{bind:this});webix.event(document.body,webix.env.mouse.up,this._rsUp,{bind:this});var c=this._getResizeDir();this._rs_started=!1;this._resizer_dir=c;this._resizer_dim="x"==c?"width":"height";"x"==c?a.height=
0:a.width=0;0<b?(this._viewobj.className+=" webix_resizer_v"+c,this._viewobj.style.marginRight="-"+b+"px","x"==c?a.width=b:a.height=b,this.$nospace=!0):this._viewobj.className+=" webix_resizer_"+c;this._viewobj.innerHTML="<div class='webix_resizer_content'></div>";"y"==c&&0<b&&(this._viewobj.style.marginBottom="-"+(a.height||this.defaults.height)+"px");this._viewobj.setAttribute("tabindex","-1");this._viewobj.setAttribute("aria-grabbed","false")},_rsDown:function(a){var b=this._getResizerCells();
if(b&&!this._settings.disabled){a=a||event;this._rs_started=!0;this._rs_process=webix.html.pos(a);this._rsLimit=[];this._viewobj.setAttribute("aria-grabbed","true");for(var c=0;2>c;c++)b[c].$view.setAttribute("aria-dropeffect","move");this._viewobj.setAttribute("aria-dropeffect","move");this._rsStart(a,b[0])}},_rsUp:function(){this._rs_process=this._rs_started=!1},_rsStart:function(a,b){a=this._resizer_dir;this.getParentView()._viewobj.style.position="relative";var c=webix.html.offset(this._viewobj);
var d=webix.html.offset(this.getParentView()._viewobj);d=c[a]-d[a];c=webix.html.offset(b.$view)[a]-webix.html.offset(this.getParentView().$view)[a];this._rs_progress=[a,b,d,c];this._resizeStick=new webix.ui.resizearea({container:this.getParentView()._viewobj,dir:a,eventPos:this._rs_process[a],start:d-1,height:this.$height,width:this.$width,border:1,margin:this.getParentView()["_padding"+a.toUpperCase()]});this._resizeStick.attachEvent("onResizeEnd",webix.bind(this._rsEnd,this));this._resizeStick.attachEvent("onResize",
webix.bind(this._rsResizeHandler,this));webix.html.addCss(document.body,"webix_noselect",1)},_getResizeDir:function(){return this.getParentView()._vertical_orientation?"y":"x"},_rsResizeHandler:function(){var a;if(this._rs_progress){var b=this._getResizerCells();var c=this._rs_progress[0];var d=this._resizeStick._last_result-this._rs_progress[2];var e=this._rsGetDiffCellSizes(b,c,d);var f=b[0]["$"+this._resizer_dim]+b[1]["$"+this._resizer_dim];var g="y"==c?["minHeight","maxHeight"]:["minWidth","maxWidth"];
for(a=0;2>a;a++){var h=b[a]._settings;var k=a?-d:d;var l=h[g[0]];h=h[g[1]];if(0<k&&h&&h<=e[a]||0>k&&(l||3)>=e[a]){this._rsLimit[a]=0<k?h:l||3;b=this._rsGetLimitCellSizes(b,c);this._resizeStick._dragobj.style["y"==c?"top":"left"]=this._rs_progress[3]+b[0]+"px";break}else 3>e[a]?this._resizeStick._dragobj.style["y"==c?"top":"left"]=this._rs_progress[3]+a*f+1+"px":this._rsLimit[a]=null}}},_getResizerCells:function(){var a;var b=this.getParentView()._cells;for(a=0;a<b.length;a++)if(b[a]==this)return!b[a-
1]||b[a-1]._settings.$noresize||!b[a+1]||b[a+1]._settings.$noresize?null:[b[a-1],b[a+1]]},_rsEnd:function(a){if("undefined"!=typeof a){var b=this.getParentView()._vertical_orientation;this._resizerStick=null;if(this._rs_progress){var c=this._rs_progress[0];var d=a-this._rs_progress[2];a=this._getResizerCells();if(a[0]&&a[1]){d=this._rsGetCellSizes(a,c,d);for(c=0;2>c;c++){var e=a[c].$getSize(0,0);(b?e[2]==e[3]:3>Math.abs(e[1]-e[0]))?(a[c]._settings[this._resizer_dim]=d[c],a[c]._bubble_size&&a[c]._bubble_size(this._resizer_dim,
d[c],b)):a[c]._settings.gravity*=d[c]/a[c].$view[b?"offsetHeight":"offsetWidth"]}a[0].resize();for(c=0;2>c;c++)a[c].callEvent&&a[c].callEvent("onViewResize",[]),a[c].$view.removeAttribute("aria-dropeffect");webix.callEvent("onLayoutResize",[a])}this._rs_progress=!1}this._rs_started=this._rs_progress=!1;this._rsLimit=null;webix.html.removeCss(document.body,"webix_noselect");this._viewobj.setAttribute("aria-grabbed","false");this._viewobj.removeAttribute("aria-dropeffect")}},_rsGetLimitCellSizes:function(a){a=
a[0]["$"+this._resizer_dim]+a[1]["$"+this._resizer_dim];if(this._rsLimit[0]){var b=this._rsLimit[0];var c=a-b}else this._rsLimit[1]&&(c=this._rsLimit[1],b=a-c);return[b,c]},_rsGetDiffCellSizes:function(a,b,c){b=[];for(var d="height"==this._resizer_dim?"offsetHeight":"offsetWidth",e=0;2>e;e++)b[e]=a[e].$view[d]+(e?-1:1)*c;return b},_rsGetCellSizes:function(a,b,c){if(this._rsLimit[0]||this._rsLimit[1])b=this._rsGetLimitCellSizes(a,b);else for(b=this._rsGetDiffCellSizes(a,b,c),a=0;2>a;a++)0>b[a]&&(c=
b[0]+b[1],b[a]=1,b[1-a]=c-1);return b}},webix.MouseEvents,webix.Destruction,webix.ui.view);
webix.protoUI({name:"multiview",defaults:{animate:{}},setValue:function(a){webix.$$(a).show()},getValue:function(){return this.getActiveId()},$init:function(){this._active_cell=0;this._vertical_orientation=1;this._viewobj.style.position="relative";this._viewobj.className+=" webix_multiview";this._back_queue=[]},_ask_render:function(a,b){a=webix.$$(a);a._render_hash||(a._render_queue=[],a._render_hash={});a._render_hash[b]||(a._render_hash[b]=!0,a._render_queue.push(b))},_render_activation:function(a){var b=
webix.$$(a);this._settings.keepViews&&(b._viewobj.style.display="");this._back_queue[this._back_queue.length-2]!=a?(10==this._back_queue.length&&this._back_queue.splice(0,1),this._back_queue.push(a)):this._back_queue.splice(this._back_queue.length-1,1);if(b._render_hash){for(a=0;a<b._render_queue.length;a++){var c=webix.$$(b._render_queue[a]);c&&c.render()}b._render_queue=[];b._render_hash={}}},addView:function(){var a=webix.ui.baselayout.prototype.addView.apply(this,arguments);this._settings.keepViews?
webix.$$(a)._viewobj.style.display="none":webix.html.remove(webix.$$(a)._viewobj);return a},_beforeRemoveView:function(a,b){a==this._active_cell&&(b=Math.max(a-1,0),this._cells[b]&&(this._in_animation=!1,this._show(this._cells[b],!1)));a<this._active_cell&&this._active_cell--},_hide:function(){},_parse_cells:function(a){a=a||this._collection;for(var b=0;b<a.length;b++)a[b]._inner=this._settings.borderless?{top:1,left:1,right:1,bottom:1}:this._settings._inner||{};webix.ui.baselayout.prototype._parse_cells.call(this,
a);for(b=1;b<this._cells.length;b++)this._settings.keepViews?this._cells[b]._viewobj.style.display="none":webix.html.remove(this._cells[b]._viewobj);for(b=0;b<a.length;b++){var c=this._cells[b];if(!c._cells||c._render_borders){var d=c._settings._inner;d.top&&(c._viewobj.style.borderTopWidth="0px");d.left&&(c._viewobj.style.borderLeftWidth="0px");d.right&&(c._viewobj.style.borderRightWidth="0px");d.bottom&&(c._viewobj.style.borderBottomWidth="0px");c._viewobj.setAttribute("role","tabpanel")}}this._render_activation(this.getActiveId())},
cells_setter:function(a){webix.assert(a&&a.length,"Multiview must have at least one view in 'cells'");this._collection=a},_getDirection:function(a,b){var c=(this._settings.animate||{}).direction;c="top"==c||"bottom"==c;return a<b?c?"bottom":"right":c?"top":"left"},_show:function(a,b){var c=this.getParentView();c&&c.getTabbar&&c.getTabbar().setValue(a._settings.$id||a._settings.id);if(this._in_animation)return webix.delay(this._show,this,[a,b],100);c=-1;for(var d=0;d<this._cells.length;d++)if(this._cells[d]==
a){c=d;break}if(!(0>c||c==this._active_cell)){a=this._cells[this._active_cell];var e=this._cells[c];a.$getSize(0,0);if((b||"undefined"==typeof b)&&webix.animate.isSupported()&&this._settings.animate){var f=webix.extend({},this._settings.animate);this._settings.keepViews&&(f.keepViews=!0);f.direction=this._getDirection(c,this._active_cell);f=webix.Settings._mergeSettings(b||{},f);var g=webix.animate.formLine(e._viewobj,a._viewobj,f);e.$getSize(0,0);e.$setSize(this._content_width,this._content_height);
var h=f.callback;f.callback=function(){webix.animate.breakLine(g,this._settings.keepViews);this._in_animation=!1;h&&h.call(this);h=f.master=f.callback=null;this.resize()};f.master=this;this._active_cell=c;this._render_activation(this.getActiveId());webix.animate(g,f);this._in_animation=!0}else this._settings.keepViews?a._viewobj.style.display="none":(webix.html.remove(a._viewobj),this._viewobj.appendChild(this._cells[d]._viewobj)),this._active_cell=c,a.resize(),this._render_activation(this.getActiveId());
e.callEvent&&(e.callEvent("onViewShow",[]),webix.ui.each(e,this._signal_hidden_cells));this.callEvent("onViewChange",[a._settings.id,e._settings.id])}},$getSize:function(a,b){if(!this._cells.length)return webix.ui.baseview.prototype.$getSize.call(this,0,0);webix.debug_size_box_start(this,!0);var c=this._cells[this._active_cell].$getSize(0,0);if(this._settings.fitBiggest)for(var d=0;d<this._cells.length;d++)if(d!=this._active_cell)for(var e=this._cells[d].$getSize(0,0),f=0;4>f;f++)c[f]=Math.max(c[f],
e[f]);d=webix.ui.baseview.prototype.$getSize.call(this,0,0);1E5<=d[1]&&(d[1]=0);1E5<=d[3]&&(d[3]=0);d[0]=(d[0]||c[0])+a;d[1]=(d[1]||c[1])+a;d[2]=(d[2]||c[2])+b;d[3]=(d[3]||c[3])+b;webix.debug_size_box_end(this,d);return d},$setSize:function(a,b){this._cells.length&&(this._layout_sizes=[a,b],webix.ui.baseview.prototype.$setSize.call(this,a,b),this._cells[this._active_cell].$setSize(a,b))},isVisible:function(a,b){return b&&b!=this.getActiveId()?(a&&this._ask_render(b,a),!1):webix.ui.view.prototype.isVisible.call(this,
a,this._settings.id)},getActiveId:function(){return this._cells.length?this._cells[this._active_cell]._settings.id:null},back:function(a){a=a||1;return this.callEvent("onBeforeBack",[this.getActiveId(),a])&&this._back_queue.length>a?(a=this._back_queue[this._back_queue.length-a-1],webix.$$(a).show(),a):null}},webix.ui.baselayout);
webix.protoUI({name:"form",defaults:{type:"form",autoheight:!0},_default_height:-1,_form_classname:"webix_form",_form_vertical:!0,$init:function(){this._viewobj.setAttribute("role","form")},$getSize:function(a,b){this._scroll_y&&!this._settings.width&&(a+=webix.ui.scrollSize);a=webix.ui.layout.prototype.$getSize.call(this,a,b);if(this._settings.scroll||!this._settings.autoheight)a[2]=this._settings.height||this._settings.minHeight||0,a[3]+=1E5;return a}},webix.ui.toolbar);
(function(){var a={},b;for(b in webix.UIManager._controls)a[webix.UIManager._controls[b]]=b;var c={9:"tab",38:"up",40:"down",37:"left",39:"right"};webix.patterns={phone:{mask:"+# (###) ###-####",allow:/[0-9]/g},card:{mask:"#### #### #### ####",allow:/[0-9]/g},date:{mask:"####-##-## ##:##",allow:/[0-9]/g}};webix.extend(webix.ui.text,{$init:function(b){if(b.pattern||b.format&&!this.format_setter)if(this.attachEvent("onKeyPress",function(b,d){d.ctrlKey||d.altKey||this._custom_format||(105<b&&112>b&&
(b-=64),a[b]&&8!==b&&46!==b?c[b]||webix.html.preventEvent(d):(webix.html.preventEvent(d),this._on_key_pressed(d,b)))}),this.attachEvent("onAfterRender",this._after_render),this.getText=function(){return this.getInputNode().value},this._pattern=function(a,b){return!1===b?this._getRawValue(a):this._matchPattern(a)},b.invalidMessage=b.invalidMessage||webix.i18n.controls.invalidMessage,b.format){var d=webix.Number.getConfig(b.format);this._custom_format=[function(a){return webix.Number.parse(a,d)},function(a){return webix.Number.format(a,
d)}]}},pattern_setter:function(a){a=webix.patterns[a]||a;"string"==typeof a&&(a={mask:a});a.allow=a.allow||/[A-Za-z0-9]/g;this._patternScheme(a);return a},_init_validation:function(){this.config.validate=this.config.validate||webix.bind(function(){var a=this.getText(),b=a.replace(this._pattern_chars,"");return(a.toString().match(this._pattern_allows)||[]).join("").length==b.length&&a.length==this._settings.pattern.mask.length},this)},_after_render:function(){var a=webix.env.isIE8?"propertychange":
"input";this._custom_format||webix._event(this.getInputNode(),a,function(a){a=(new Date).valueOf();if(!this._property_stamp||100<a-this._property_stamp)this._property_stamp=a,this.$setValue(this.getText())},{bind:this});webix._event(this.getInputNode(),"blur",function(a){this._applyChanges()},{bind:this})},_patternScheme:function(a){for(var b=a.mask,c={},d="",h=0,k=0;k<b.length;k++)"#"===b[k]?(c[k]=h,h++):(c[k]=!1,-1===d.indexOf(b[k])&&(d+="\\"+b[k]));this._pattern_allows=a.allow;this._pattern_chars=
new RegExp("["+d+"]","g");this._pattern_scheme=c;this._init_validation()},_on_key_pressed:function(a,b){var c=this.getInputNode(),d=c.value,e=webix.html.getSelectionRange(c),k="";8==b||46==b?e.start==e.end&&(8==b?e.start--:e.end++):(k=String.fromCharCode(b),a.shiftKey||(k=k.toLowerCase()));d=d.substr(0,e.start)+k+d.substr(e.end);e=this._getCaretPos(k,d.length,e.start,b);this._input_code=b;this.$setValue(d);webix.html.setSelectionRange(c,e)},_getCaretPos:function(a,b,c,g){a&&a.match(this._pattern_allows)||
8==g||46==g?c=this._fixCaretPos(a?c+1:c,g):b-1==c&&8!==g&&46!==g&&(a=this._settings.pattern.mask.indexOf("#",c),0<a&&(c+=a));return c},_fixCaretPos:function(a,b){return!1===this._pattern_scheme[a-1*(46!==b)]?this._fixCaretPos(a+(8==b?-1:1),b):!1===this._pattern_scheme[a]&&8!==b?this._fixCaretPos(a+1,b)-1:a},_getRawValue:function(a){return this._custom_format?this._custom_format[0](a):((a||"").toString().match(this._pattern_allows)||[]).join("").replace(this._pattern_chars,"")},_matchPattern:function(a){if(this._custom_format)return this._custom_format[1](this._custom_format[0](a));
var b=this._getRawValue(a),c=a=this._settings.pattern.mask,d=this._pattern_scheme,h=!1,k=0,l=0,m=0,n;for(n in d)if(!1!==d[n]){if(!h){k=1*n;l=d[n];var p=b[l]||"",q=b[l+1];a=(p?a.substr(0,k):"")+p+(p&&q?a.substr(k+1):"");q||(h=!0)}m++}if((n=this._input_code)&&8!==n||!n&&m-1===l&&a.length<c.length)b?(b=k+1,"#"!==c.charAt(b)&&a.length<c.length&&(k=c.indexOf("#",b),0>k&&(k=c.length),a+=c.substr(b,k-b))):46!==n&&(a+=c.substr(0,c.indexOf("#")));this._input_code=null;return a}})})();
webix.protoUI({name:"gridsuggest",defaults:{type:"datatable",fitMaster:!1,width:0,body:{navigation:!0,autoheight:!0,autowidth:!0,select:!0},filter:function(a,b){return 0===this.config.template(a).toString().toLowerCase().indexOf(b.toLowerCase())?!0:!1}},$init:function(a){a.body.columns||(a.body.autoConfig=!0);a.template||(a.template=webix.bind(this._getText,this))},_getText:function(a,b){b=this.getBody();return b.getText(a.id,this.config.textValue||b.config.columns[0].id)}},webix.ui.suggest);
webix.protoUI({name:"datasuggest",defaults:{type:"dataview",fitMaster:!1,width:0,body:{xCount:3,autoheight:!0,select:!0}}},webix.ui.suggest);
webix.protoUI({name:"multiselect",$cssName:"richselect",defaults:{separator:","},_suggest_config:function(a){var b=!webix.isArray(a)&&"object"==typeof a&&!a.name,c={view:"checksuggest",separator:this.config.separator,buttonText:this.config.buttonText,button:this.config.button};this._settings.optionWidth?c.width=this._settings.optionWidth:c.fitMaster=!0;b&&webix.extend(c,a,!0);var d=webix.ui(c);c=d.getList();"string"==typeof a?c.load(a):b||c.parse(a);d.attachEvent("onShow",function(a,b,c){d.setValue(webix.$$(d._settings.master).config.value)});
return d},$setValue:function(a){if(this._rendered_input){var b=this.getPopup(),c="";b&&(c=b.setValue(a),"object"==typeof c&&(c=c.join(this.config.separator+" ")));this._settings.text=c;this.getInputNode().innerHTML=c||this._get_div_placeholder()}},getValue:function(){return this._settings.value||""}},webix.ui.richselect);webix.editors.multiselect=webix.extend({popupType:"multiselect"},webix.editors.richselect);
webix.type(webix.ui.list,{name:"multilist",templateStart:webix.template('<div webix_l_id="#!id#" class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden;" {common.aria()}>')},"default");
webix.type(webix.ui.list,{name:"checklist",templateStart:webix.template('<div webix_l_id="#!id#" {common.aria()} class="{common.classname()}" style="width:{common.widthSize()}; height:{common.heightSize()}; overflow:hidden; white-space:nowrap;">{common.checkbox()}'),checkbox:function(a,b){return"<span role='checkbox' tabindex='-1' aria-checked='"+(a.$checked?"true":"false")+"' class='webix_icon "+(a.$checked?"fa-check-square":"fa-square-o")+"'></span>"},aria:function(a){return"role='option' tabindex='-1' "+
(a.$checked?"aria-selected='true'":"")},template:webix.template("#value#")},"default");
webix.protoUI({name:"multisuggest",defaults:{separator:",",type:"layout",button:!0,width:0,filter:function(a,b){return-1<this.getItemText(a.id).toString().toLowerCase().indexOf(b.toLowerCase())},body:{rows:[{view:"list",type:"multilist",borderless:!0,autoheight:!0,yCount:5,multiselect:"touch",select:!0,on:{onItemClick:function(a){var b=this.getParentView().getParentView();webix.delay(function(){b._toggleOption(a)})}}},{view:"button",click:function(){var a=this.getParentView().getParentView();a.setMasterValue({id:a.getValue()});
a.hide()}}]}},_toggleOption:function(a,b,c){var d=this.getValue();d=c||webix.toArray(d?this.getValue().split(this._settings.separator):[]);var e=webix.$$(this._settings.master);c||(0>d.find(a)?d.push(a):d.remove(a));e?e.setValue(d.join(this._settings.separator)):(c=this.setValue(d),this._last_input_target&&(this._last_input_target.value=c.join(this._settings.separator)));b&&(a=this.getList().getItemNode(a).getElementsByTagName("SPAN"))&&a.length&&a[0].focus()},_get_extendable_cell:function(a){return a.rows[0]},
_set_on_popup_click:function(){var a=this.getButton(),b=this._settings.button?this._settings.buttonText||webix.i18n.controls.select:0;a&&(b?(a._settings.value=b,a.refresh()):a.hide());if(this._settings.selectAll)return this.getBody().getChildViews()[0].show();this.getList().data.attachEvent("onAfterFilter",webix.bind(function(){return this._suggest_after_filter()},this))},_show_selection:function(){var a=this.getList(),b=this.getMasterValue();if(b&&(b=b.toString().split(this.config.separator),b[0]))for(var c=
0;c<b.length;c++)a.exists(b[c])&&a.select(b[c],!0)},getButton:function(){return this.getBody().getChildViews()[1]},getList:function(){return this.getBody().getChildViews()[0]},setValue:function(a){var b=[],c=this.getList();c.unselect();if(a&&(webix.isArray(a)||(a=a.toString().split(this.config.separator)),a[0]))for(var d=0;d<a.length;d++)c.getItem(a[d])&&(c.exists(a[d])&&c.select(a[d],!0),b.push(this.getItemText(a[d])));this._settings.value=a?a.join(this.config.separator):"";return b},getValue:function(){return this._settings.value}},
webix.ui.suggest);
webix.protoUI({name:"checksuggest",defaults:{button:!1,selectAll:!1,body:{rows:[{view:"checkbox",hidden:!0,customCheckbox:!1,borderless:!1,css:"webix_checksuggest_select_all",labelRight:webix.i18n.combo.selectAll,labelWidth:0,value:0,height:28,inputHeight:17,on:{onItemClick:function(a){for(var b=this.getParentView().getParentView(),c=b.getList(),d=c.data.order,e=0;e<d.length;e++)c.getItem(d[e]).$checked=this.getValue();e=this.getValue()?[].concat(d):[];b._toggleOption(d[0],a,e);c.refresh()},onChange:function(){var a=
this.$view.querySelector("label");this.getValue()?a.textContent=webix.i18n.combo.unselectAll:a.textContent=webix.i18n.combo.selectAll}}},{view:"list",css:"webix_multilist",borderless:!0,autoheight:!0,yCount:5,select:!0,type:"checklist",on:{onItemClick:function(a,b){var c=this.getItem(a);c.$checked=c.$checked?0:1;this.refresh(a);var d=this.getParentView().getParentView();d._click_stamp=new Date;d._toggleOption(a,b);d.config.selectAll&&(c.$checked?(d.getValue()||"").split(",").length===this.count()&&
d.getBody()._cells[0].setValue(1):d.getBody()._cells[0].setValue(0))}}},{view:"button",click:function(){var a=this.getParentView().getParentView();a.setMasterValue({id:a.getValue()});a.hide()}}]}},_get_extendable_cell:function(a){return a.rows[1]},getButton:function(){return this.getBody().getChildViews()[2]},getList:function(){return this.getBody().getChildViews()[1]},$init:function(){this._valueHistory={};this.$ready.push(this._onReady)},_onReady:function(){var a=this.getList();if(a.config.dataFeed){var b=
this;a.attachEvent("onAfterLoad",function(){b.setValue(b._settings.value)});a.getItem=function(a){return this.data.pull[a]||b._valueHistory[a]}}this.config.master&&!this.config.selectAll&&this.getBody().getChildViews()[0].hide()},$enterKey:function(a,b){b.count&&b.count()?a.isVisible()?((b=b.getSelectedId(!1,!0))&&this._toggleOption(b),a.hide(!0)):a.show(this._last_input_target):a.isVisible()&&a.hide(!0)},_show_selection:function(){var a=this.getList();a.select&&a.unselect()},setValue:function(a){var b,
c=this.getList(),d=[],e={},f=[];a=a||[];webix.isArray(a)?c.config.dataFeed&&(a=this._toMultiValue(a)):a=a.toString().split(this.config.separator);for(b=0;b<a.length;b++)e[a[b]]=1,c.getItem(a[b])&&(this._valueHistory&&(this._valueHistory[a[b]]=webix.copy(c.getItem(a[b]))),d.push(this.getItemText(a[b])));c.data.each(function(a){a.$checked?e[a.id]||(a.$checked=0,f.push(a.id)):e[a.id]&&(a.$checked=1,f.push(a.id))},this,!0);for(b=0;b<f.length;b++)c.refresh(f[b]);this._settings.value=a.length?a.join(this.config.separator):
"";return d},getValue:function(){return this._settings.value},_preselectMasterOption:function(){if(this._settings.master){var a=webix.$$(this._settings.master);a=a.getInputNode()}(a=a||this._last_input_target)&&a.focus()},_toMultiValue:function(a){if(a&&webix.isArray(a)){for(var b=[],c=0;c<a.length;c++)a[c].id?(this._valueHistory[a[c].id]=webix.copy(a[c]),b.push(a[c].id)):b.push(a[c]);a=b}return a}},webix.ui.multisuggest);
webix.protoUI({name:"multicombo",$cssName:"text",defaults:{keepText:!1,separator:",",icon:!1,iconWidth:0,tagMode:!0,tagTemplate:function(a){return a.length?a.length+" item(s)":""},template:function(a,b){return b._render_value_block(a,b)}},$init:function(){this.$view.className+=" webix_multicombo";this.attachEvent("onBeforeRender",function(){this._inputHeight||(this._inputHeight=webix.skin.$active.inputHeight);return!0});this.attachEvent("onAfterRender",function(){this._last_size=null});this._renderCount=
0},on_click:{webix_multicombo_delete:function(a,b,c){var d;!this._settings.readonly&&c&&(d=c.parentNode.getAttribute("optvalue"))&&this._removeValue(d);return!1}},_onBlur:function(){var a=this.getInputNode().value;a&&this._settings.newValues&&100<new Date-(this.getPopup()._click_stamp||0)&&this._addNewValue(a);this._settings.keepText||(this._inputValue="");this.refresh()},_removeValue:function(a){var b=this._settings.value,c=webix.$$(this.config.suggest);"string"==typeof b&&(b=b.split(this._settings.separator));
b=webix.toArray(webix.copy(b));b.remove(a);this.setValue(b.join(this._settings.separator));c&&c._settings.selectAll&&c.getBody()._cells[0].setValue(0)},_addValue:function(a){var b=webix.$$(this.config.suggest);if(b.getList().getItem(a)){var c=b.getValue();c&&"string"==typeof c&&(c=c.split(b.config.separator));c=webix.toArray(c||[]);0>c.find(a)&&(c.push(a),b.setValue(c),this.setValue(b.getValue()))}},_addNewValue:function(a){var b=webix.$$(this.config.suggest),c=b.getList(),d;if(a=a.replace(/^\s+|\s+$/g,
""))for(var e in c.data.pull)b.getItemText(e)==a&&(d=e);!d&&a&&(d=c.add({id:a,value:a}));this._addValue(d)},_suggest_config:function(a){var b=!webix.isArray(a)&&"object"==typeof a&&!a.name,c={view:"checksuggest",separator:this.config.separator,buttonText:this.config.buttonText,button:this.config.button},d=this;this._settings.optionWidth&&(c.width=this._settings.optionWidth);b&&webix.extend(c,a,!0);c=webix.ui(c);this._settings.optionWidth||(c.$customWidth=function(a){this.config.width=d._get_input_width(d._settings)});
c.attachEvent("onBeforeShow",function(a,b,c){if(this._settings.master&&(this.setValue(webix.$$(this._settings.master).config.value),webix.$$(this._settings.master).getInputNode().value?(this.getList().refresh(),this._dont_unfilter=!0):this.getList().filter(),a.tagName&&"input"==a.tagName.toLowerCase()))return webix.ui.popup.prototype.show.apply(this,[a.parentNode,b,c]),!1});var e=c.getList();"string"==typeof a?e.load(a):b||e.parse(a);c._suggest_after_filter=function(){};return c},_render_value_block:function(a,
b){var c="",d="top"==this._settings.labelPosition;var e="x"+webix.uid();var f=b._get_input_width(a);var g=a.inputAlign||"left";var h=this._inputHeight-2*webix.skin.$active.inputPadding-2;var k=this._inputValue||"";var l="<ul class='webix_multicombo_listbox' style='line-height:"+h+"px'></ul>";var m="width: "+Math.min(f,b._inputWidth||7)+"px;height:"+h+"px;max-width:"+(f-20)+"px";var n=a.readonly?" readonly ":"";m="<input id='"+e+"' role='combobox' aria-multiline='true' aria-label='"+webix.template.escape(a.label)+
"' tabindex='0' type='text' class='webix_multicombo_input' "+n+" style='"+m+"' value='"+k+"'/>";g="<div class='webix_inp_static' onclick='' style='line-height:"+h+"px;width: "+f+"px;  text-align: "+g+";height:auto' >"+l+m+"</div>";b=b.$renderLabel(a,e);e=this._settings.awidth-f-2*webix.skin.$active.inputPadding;(a=(a.invalid?a.invalidMessage:"")||a.bottomLabel)&&(c="<div class='webix_inp_bottom_label' style='width:"+f+"px;margin-left:"+Math.max(e,webix.skin.$active.inputPadding)+"px;'>"+a+"</div>");
return d?b+"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; '>"+g+c+"</div>":"<div class='webix_el_box' style='width:"+this._settings.awidth+"px; min-height:"+this._settings.aheight+"px;'>"+b+g+c+"</div>"},_getValueListBox:function(){return this._getBox().getElementsByTagName("UL")[0]},_set_inner_size:function(){var a=this.getPopup();if(a){var b=a?a.setValue(this._settings.value):null;a._toMultiValue&&(this._settings.value=a._toMultiValue(this._settings.value));var c="";a=this._getValueListBox();
var d=b&&b.length;if(d){var e=this._inputHeight-2*webix.skin.$active.inputPadding-8,f=this._settings.value;"string"==typeof f&&(f=f.split(this._settings.separator));if(this._settings.tagMode)for(var g=0;g<b.length;g++)c+="<li class='webix_multicombo_value' style='line-height:"+e+"px;' optvalue='"+f[g]+"'><span>"+(b[g]+"</span><span class='webix_multicombo_delete' role='button' aria-label='"+webix.i18n.aria.removeItem+"'>x</span></li>");else c+="<li class='webix_multicombo_tag' style='line-height:"+
e+"px;'>"+this._settings.tagTemplate(f)+"</li>"}a.innerHTML=c;b=this.getInputNode();this._settings.placeholder&&(d?(b.placeholder="",!b.value&&20<b.offsetWidth&&(b.style.width="20px")):b.value||(b.placeholder=this._settings.placeholder,b.style.width=this._get_input_width(this._settings)+"px"));!this._settings.tagMode&&a.firstChild&&(b.style.width=this._getMultiComboInputWidth()+"px")}this._resizeToContent()},_focusAtEnd:function(a){if(a=a||this.getInputNode())if(a.value.length)if(a.createTextRange){var b=
a.createTextRange();b.moveStart("character",a.value.length);b.collapse();b.select()}else{if(a.selectionStart||"0"==a.selectionStart)b=a.value.length,a.selectionStart=b,a.selectionEnd=b,a.focus()}else a.focus()},_resizeToContent:function(){var a="top"==this._settings.labelPosition,b=this._getInputDiv(),c=Math.max(b.offsetHeight+2*webix.skin.$active.inputPadding,this._inputHeight);a&&(c+=this._labelTopHeight);c+=this._settings.bottomPadding||0;var d=this.$getSize(0,0);if(c!=d[2]){a=b.offsetHeight+(a?
this._labelTopHeight:0);a==this._calcHeight?this._renderCount++:this._renderCount=0;if(10<this._renderCount)return!1;this._calcHeight=a;a=this.getTopParentView();clearTimeout(a._template_resize_timer);a._template_resize_timer=webix.delay(function(){this.config.height=this._calcHeight+2*webix.skin.$active.inputPadding;this.resize();this._typing&&(this._focusAtEnd(this.getInputNode()),this._typing=!1);this._enter&&(this._settings.keepText?this.getInputNode().select():this.getInputNode().value="",this._enter=
!1);(this.getPopup().isVisible()||this._typing)&&this.getPopup().show(this._getInputDiv())},this)}this._enter&&this.getInputNode().select()},_getInputDiv:function(){for(var a=this._getBox(),b=a.childNodes,c=0;c<b.length;c++)if(b[c].className&&-1!=b[c].className.indexOf("webix_inp_static"))return b[c];return a},getInputNode:function(){return this._getBox().getElementsByTagName("INPUT")[0]},$setValue:function(){this._rendered_input&&this._set_inner_size()},getValue:function(a){return"object"==typeof a&&
a.options?this._getSelectedOptions():(a=this._settings.value)?"string"!=typeof a?a.join(this._settings.separator):a:""},getText:function(){var a=this._settings.value;if(!a)return"";"string"==typeof a&&(a=a.split(this._settings.separator));for(var b=[],c=0;c<a.length;c++)b.push(this.getPopup().getItemText(a[c]));return b.join(this._settings.separator)},_getSelectedOptions:function(){var a,b,c=[],d=this._settings.value;if(!d)return[];"string"==typeof d&&(d=d.split(this._settings.separator));var e=this.getPopup();
for(a=0;a<d.length;a++)(b=e.getList().getItem(d[a])||(e._valueHistory?e._valueHistory[d[a]]:null))&&c.push(b);return c},$setSize:function(a,b){var c=this._settings;webix.ui.view.prototype.$setSize.call(this,a,b)&&a&&b&&("top"==c.labelPosition&&(c.labelWidth=0),this.render())},_calcInputWidth:function(a){var b=document.createElement("span");b.className="webix_multicombo_input";b.style.visibility="visible";b.style.height="0px";b.innerHTML=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
document.body.appendChild(b);a=b.offsetWidth+10;document.body.removeChild(b);return a},_getMultiComboInputWidth:function(){var a=this._getValueListBox();return a.offsetWidth-a.firstChild.offsetWidth-17},_init_onchange:function(){webix._event(this._getBox(),"click",function(){this.getInputNode().focus()},{bind:this});webix._event(this.getInputNode(),"focus",function(){-1==this._getBox().className.indexOf("webix_focused")&&(this._getBox().className+=" webix_focused")},{bind:this});webix._event(this.getInputNode(),
"blur",function(){this._getBox().className=this._getBox().className.replace(" webix_focused","")},{bind:this});webix._event(this.getInputNode(),"input",function(){!this.getInputNode().value&&this._inputValue&&(this.getInputNode().style.width="20px",this._inputWidth=20,this._inputValue="",this._typing=!0,this.getPopup().show(this._getInputDiv()),this._resizeToContent())},{bind:this});webix._event(this.getInputNode(),"keyup",function(a){var b=this.getInputNode(),c;a=a||event;if(!this._settings.placeholder||
this._settings.value||b.value){var d=c=this._calcInputWidth(b.value)+10;!this._settings.tagMode&&this._getValueListBox().firstChild&&(d=this._getMultiComboInputWidth())}else d=this._get_input_width(this._settings);b.style.width=d+"px";c!=this._inputWidth?(this._inputValue=this._settings.keepText||13!=a.keyCode?b.value:!1,this._typing=!0,this._inputWidth&&this.getPopup().show(this._getInputDiv()),this._inputWidth=c||d,this._resizeToContent()):this._windowHeight!=this.getPopup().$height&&this.getPopup().show(this._getInputDiv());
if(-1<b.value.indexOf(this._settings.separator)&&this._settings.tagMode){if(a=b.value.replace(this._settings.separator,""))this._settings.newValues?this._addNewValue(a):(c=this.getPopup().getItemId(a))&&this._addValue(c);this._settings.keepText?(this._inputValue=a,b.value=a,this._typing=this._enter=!0,this._resizeToContent()):b.value=""}},{bind:this});webix._event(this.getInputNode(),"keydown",function(a){this._enter=!1;if(this.isVisible()){a=a||event;var b=this._getValueListBox().lastChild;this._windowHeight=
this.getPopup().$height;8==a.keyCode&&b&&(!this.getInputNode().value&&100<(new Date).valueOf()-(this._backspaceTime||0)?(this._typing=!0,this._removeValue(b.getAttribute("optvalue"))):this._backspaceTime=(new Date).valueOf());if(13==a.keyCode||9==a.keyCode){b=this.getInputNode();var c="",d=webix.$$(this._settings.suggest);d.getList().getSelectedId()||(b.value&&(c=d.getSuggestion()),this._settings.newValues?(13==a.keyCode&&(this._enter=!0),this._addNewValue(b.value),this._settings.keepText?this._inputValue=
b.value:b.value=""):c&&(9==a.keyCode?(this._typing=!1,this._inputValue="",this._inputWidth=10,b.value="",this._addValue(c)):(this._enter=!0,this._addValue(c),this._settings.keepText?this._inputValue=b.value:b.value="")));13==a.keyCode&&(this._typing=this._enter=!0,this._settings.keepText?this._inputValue=b.value:b.value="")}}},{bind:this});webix.$$(this._settings.suggest).linkInput(this)}},webix.ui.richselect);
webix.protoUI({name:"menu",_listClassName:"webix_menu",$init:function(a){this.data._scheme_init=webix.bind(function(a){a.disabled&&this.data.addMark(a.id,"webix_disabled",!0,1,!0)},this);a.autowidth&&(this._autowidth_submenu=!0,delete a.autowidth);this.data.attachEvent("onStoreUpdated",webix.bind(function(){this._hide_sub_menu()},this));this.attachEvent("onMouseMove",this._mouse_move_menu);this.attachEvent("onMouseOut",function(a){this._menu_was_activated()&&"click"==this._settings.openAction||!this._child_menu_active&&
a.relatedTarget&&this._hide_sub_menu()});this.attachEvent("onItemClick",function(a,c,d){var b=this.getItem(a);if(b&&!b.$template){var f=this.getTopMenu();this.data.getMark(a,"webix_disabled")||(f.callEvent("onMenuItemClick",[a,c,d])?(this!=f&&f._call_onclick(a,c,d),b.submenu?(this!==f&&!webix.env.touch||"click"!=f._settings.openAction||this._mouse_move_activation(a,d),c.showpopup=!0):(f._hide_sub_menu(!0),f._hide_on_item_click&&f.hide())):c.showpopup=!0)}});this.attachEvent("onKeyPress",function(a,
c){if(9===a)this.getTopMenu()._hide_sub_menu();else if(13===a||32===a){a=this.getSelectedId();var b;a&&(b=this.getItemNode(a));b&&webix.html.triggerEvent(b,"MouseEvents","click")}});this.data.attachEvent("onClearAll",function(){this._hidden_items=[]});this.data._hidden_items=[];this._viewobj.setAttribute("role","menubar")},sizeToContent:function(){if("y"==this._settings.layout){var a=[],b=!1;this.data.each(function(c){a.push(this._toHTML(c));c.submenu&&(b=!0)},this);this.config.width=webix.html.getTextSize(a,
this.$view.className).width+16+2+(b?15:0);this.resize()}else webix.assert(!1,"sizeToContent will work for vertical menu only")},getTopMenu:function(){for(var a=this;a._parent_menu;)a=webix.$$(a._parent_menu);return a},_auto_height_calc:function(a){this._settings.autoheight&&(a=this.count());for(var b=0,c=0;c<a;c++){var d=this.data.pull[this.data.order[c]];b=d&&"Separator"==d.$template?b+4:b+this.type.height}return b},on_mouse_move:{},type:{css:"menu",width:"auto",aria:function(a,b,c){return'role="menuitem"'+
(c&&c.webix_selected?' aria-selected="true" tabindex="0"':'tabindex="-1"')+(a.submenu?'aria-haspopup="true"':"")+(c&&c.webix_disabled?' aria-disabled="true"':"")},templateStart:function(a,b,c){if("Separator"===a.$template||"Spacer"===a.$template)return'<div webix_l_id="#id#" role="separator" tabindex="-1" class="webix_context_'+a.$template.toLowerCase()+'">';var d=(a.href?" href='"+a.href+"' ":"")+(a.target?" target='"+a.target+"' ":"");return webix.ui.list.prototype.type.templateStart(a,b,c).replace(/^<div/,
"<a "+d)+(a.submenu&&b.subsign?"<div class='webix_submenu_icon'></div>":"")},templateEnd:function(a,b,c){return"Separator"===a.$template||"Spacer"===a.$template?"</div>":"</a>"},templateSeparator:webix.template("<div class='sep_line'></div>"),templateSpacer:webix.template("<div></div>")},getMenu:function(a){if(this.data.pull[a])return this;for(var b in this.data.pull){var c=this.getItem(b);if(c.submenu&&(c=this._get_submenu(c).getMenu(a)))return c}},getSubMenu:function(a){var b=this.getMenu(a);a=
b.getItem(a);return a.submenu?b._get_submenu(a):null},getMenuItem:function(a){return this.getMenu(a).getItem(a)},_get_submenu:function(a){var b=webix.$$(a.submenu);b||(a.submenu=this._create_sub_menu(a),b=webix.$$(a.submenu));return b},_mouse_move_menu:function(a,b,c){this._menu_was_activated()&&this._mouse_move_activation(a,c)},_menu_was_activated:function(){var a=this.getTopMenu();return"click"==a._settings.openAction?webix.env.touch?!1:(a=a._open_sub_menu)&&webix.$$(a).isVisible()?!0:!1:!0},_mouse_move_activation:function(a,
b){var c=this.getItem(a);if(c&&(this._child_menu_active=null,this._open_sub_menu&&c.submenu!=this._open_sub_menu&&this._hide_sub_menu(!0),c.submenu&&!this.config.hidden)){var d=this._get_submenu(c);this.data.getMark(a,"webix_disabled")||(d.show(b,{pos:this._settings.subMenuPos}),d._parent_menu=this._settings.id,this._open_sub_menu=c.submenu)}},disableItem:function(a){this.getMenu(a).addCss(a,"webix_disabled")},enableItem:function(a){this.getMenu(a).removeCss(a,"webix_disabled")},_set_item_hidden:function(a,
b){var c=this.data;c._hidden_items[a]!=b&&(c._hidden_items[a]=b,c.filter(function(a){return!c._hidden_items[a.id]}),this.resize())},hideItem:function(a){var b=this.getMenu(a);b&&b._set_item_hidden(a,!0)},showItem:function(a){var b=this.getMenu(a);if(b)return b._set_item_hidden(a,!1),webix.ui.list.prototype.showItem.call(b,a)},_hide_sub_menu:function(a){if(this._open_sub_menu){var b=webix.$$(this._open_sub_menu);b._hide_sub_menu&&b._hide_sub_menu(a);if(a||!b._show_on_mouse_out)b.hide(),this._open_sub_menu=
null}},_create_sub_menu:function(a){var b={view:"submenu",data:a.submenu},c=this.getTopMenu()._settings.submenuConfig;c&&webix.extend(b,c,!0);(a=this.getMenuItem(a.id))&&a.config&&webix.extend(b,a.config,!0);b=webix.ui(b);b._parent_menu=this;return b._settings.id},_skip_item:function(a,b,c){var d=this.getItem(a);return"Separator"==d.$template||"Spacer"==d.$template||this.data.getMark(a,"webix_disabled")?(a=this.getIndexById(a)+("up"==c?-1:1),(a=0<=a?this.getIdByIndex(a):null)?this._skip_item(a,b,
c):b):a},$skin:function(){webix.ui.list.prototype.$skin.call(this);this.type.height=webix.skin.$active.menuHeight},defaults:{scroll:"",layout:"x",mouseEventDelay:100,subMenuPos:"bottom"}},webix.ui.list);
webix.protoUI({name:"submenu",$init:function(){this._body_cell=webix.clone(this._dummy_cell_interface);this._body_cell._view=this;this.attachEvent("onMouseOut",function(a){"click"!=this.getTopMenu()._settings.openAction&&(this._child_menu_active||this._show_on_mouse_out||!a.relatedTarget||this.hide())});this.attachEvent("onMouseMoving",function(){this._parent_menu&&(webix.$$(this._parent_menu)._child_menu_active=!0)});this.attachEvent("onBeforeShow",function(){this.getTopMenu()._autowidth_submenu&&
this.sizeToContent&&!this.isVisible()&&this.sizeToContent()});this._dataobj.setAttribute("role","menu")},$skin:function(){webix.ui.menu.prototype.$skin.call(this);webix.ui.popup.prototype.$skin.call(this);this.type.height=webix.skin.$active.menuHeight},_dummy_cell_interface:{$getSize:function(a,b){var c=1*this._view._settings.height,d=1*this._view._settings.width;a=webix.ui.menu.prototype.$getSize.call(this._view,a,b);this._view._settings.height=c;this._view._settings.width=d;return a},$setSize:function(a,
b){this._view._settings.scroll&&(this._view._bodyobj.style.height=b+"px")},destructor:function(){this._view=null}},body_setter:function(){},getChildViews:function(){return[]},defaults:{width:150,subMenuPos:"right",layout:"y",autoheight:!0},type:{height:webix.skin.menuHeight,subsign:!0}},webix.ui.menu,webix.ui.popup);
webix.ContextHelper={defaults:{padding:"4",hidden:!0},body_setter:function(a){a=webix.ui.window.prototype.body_setter.call(this,a);this._body_cell._viewobj.style.borderWidth="0px";return a},attachTo:function(a){webix.assert(a,"Invalid target for Context::attach");var b=a.on_context?a.attachEvent("onAfterContextMenu",webix.bind(this._show_at_ui,this)):webix.event(a,"contextmenu",this._show_at_node,{bind:this});this.attachEvent("onDestruct",function(){a.callEvent?a.detachEvent(b):webix.eventRemove(b);
a=null})},getContext:function(){return this._area},setContext:function(a){this._area=a},_show_at_node:function(a){this._area=webix.toNode(a||event);return this._show_at(a)},_show_at_ui:function(a,b,c){this._area={obj:webix.$$(b),id:a};return this._show_at(b)},_show_at:function(a){var b=this.show(a,null,!0);if(!1===b)return b;webix.callEvent("onClick",[]);return webix.html.preventEvent(a)},_show_on_mouse_out:!0,master_setter:function(a){this.attachTo(a);return null}};
webix.protoUI({name:"context"},webix.ContextHelper,webix.ui.popup);webix.protoUI({name:"contextmenu",_hide_on_item_click:!0,$init:function(a){a.submenuConfig&&webix.extend(a,a.submenuConfig)}},webix.ContextHelper,webix.ui.submenu);
webix.protoUI({name:"tabbar",$init:function(){this.attachEvent("onKeyPress",this._onKeyPress)},$skin:function(){var a=webix.skin.$active,b=this.defaults;b.topOffset=a.tabTopOffset||0;b.tabOffset="undefined"!=typeof a.tabOffset?a.tabOffset:10;b.bottomOffset=a.tabBottomOffset||0;b.height=a.tabbarHeight;b.tabMargin=a.tabMargin;b.inputPadding=a.inputPadding;b.tabMinWidth=a.tabMinWidth||100;b.tabMoreWidth=a.tabMoreWidth||40},_getTabbarSizes:function(){var a=this._settings,b=this._tabs||a.options,c=this._input_width-
2*a.tabOffset;var d=a.optionWidth||a.tabMinWidth;var e=b.length;if(a.tabMinWidth&&c/e<d)return{max:parseInt(c/d,10)||1};if(!a.optionWidth)for(d=0;d<e;d++)b[d].width&&(c-=b[d].width+(d||a.type?0:a.tabMargin),e--);return{width:e?c/e:a.tabMinWidth}},_init_popup:function(){var a=this._settings;if(!a.tabbarPopup){var b=webix.ui({view:"popup",width:a.popupWidth||200,body:{view:"list",borderless:!0,select:!0,css:"webix_tab_list",autoheight:!0,yCount:a.yCount,type:{template:a.popupTemplate}}});b.getBody().attachEvent("onBeforeSelect",
webix.bind(function(a){if(a&&this.callEvent("onBeforeTabClick",[a]))return this.setValue(a),webix.$$(this._settings.tabbarPopup).hide(),this.callEvent("onAfterTabClick",[a]),!0},this));b.getBody().attachEvent("onAfterSelect",webix.bind(function(a){this.refresh()},this));a.tabbarPopup=b._settings.id;this._destroy_with_me.push(b)}this._init_popup=function(){}},getPopup:function(){this._init_popup();return webix.$$(this._settings.tabbarPopup)},moreTemplate_setter:webix.template,popupTemplate_setter:webix.template,
defaults:{popupWidth:200,popupTemplate:"#value#",yCount:7,moreTemplate:'<span class="webix_icon fa-ellipsis-h"></span>',template:function(a,b){var c,d;b._tabs=c=b._filterOptions(a.options);if(c.length){b._check_options(c);!a.value&&c.length&&(a.value=c[0].id);var e="";a.tabOffset&&(e+="<div class='webix_tab_filler' style='width:"+a.tabOffset+"px;'>&nbsp;</div>");var f=a.topOffset+a.bottomOffset;var g=b._getTabbarSizes();if(g.max&&g.max<c.length){var h=b.getPopup();h.hide();if(d=h.getBody()||null)if(g.max){var k=
!1;for(h=0;h<c.length&&!k;h++)if(c[h].id==a.value&&(k=!0,h+1>g.max)){var l=c.splice(h,1);c=c.splice(0,g.max-1).concat(l).concat(c)}d.clearAll();d.parse(c.slice(g.max))}else d.clearAll()}else b._settings.tabbarPopup&&webix.$$(b._settings.tabbarPopup).hide();d=a.tabOffset;k=!1;for(h=0;h<c.length&&!k;h++)g&&g.max?(g.max==h+1&&(k=!0),l=b._input_width-2*a.tabOffset-(!a.type&&1<g.max?a.tabMargin*(g.max-1):0),l=(l-a.tabMoreWidth)/g.max):l=g.width,l=c[h].width||a.optionWidth||l,d+=l+(h&&!a.type?a.tabMargin:
0),0<a.tabMargin&&h&&!a.type&&(e+="<div class='webix_tab_filler' style='width:"+a.tabMargin+"px;'></div>"),e+=b._getTabHTML(c[h],l),k&&(e+='<div role="button" tabindex="0" aria-label="'+webix.i18n.aria.showTabs+'" class="webix_tab_more_icon" style="width:'+a.tabMoreWidth+'px;">'+a.moreTemplate(a,b)+"</div>",d+=a.tabMoreWidth);c=b._content_width-d;0<c&&!a.type&&(e+="<div class='webix_tab_filler' style='width:"+c+"px;'>&nbsp;</div>")}else e="<div class='webix_tab_filler' style='width:"+b._input_width+
"px; border-right:0px;'></div>";c="";b=f&&!a.type?"height:"+(b._content_height-f)+"px":"";a.topOffset&&!a.type&&(c+="<div class='webix_before_all_tabs' style='width:100%;height:"+a.topOffset+"px'></div>");c+="<div style='"+b+"' role='tablist' class='webix_all_tabs "+(a.type?"webixtype_"+a.type:"")+"'>"+e+"</div>";a.bottomOffset&&!a.type&&(c+="<div class='webix_after_all_tabs' style='width:100%;height:"+a.bottomOffset+"px'></div>");return c}},_getInputNode:function(){return this.$view.querySelectorAll(".webix_item_tab")},
_getTabHTML:function(a,b){var c="",d=this.config;a.id==d.value&&(c=" webix_selected");a.css&&(c+=" "+a.css);b=a.width||b;b='<div class="webix_item_tab'+c+'" button_id="'+a.id+'" role="tab" aria-selected="'+(a.id==d.value?"true":"false")+'" tabindex="'+(a.id==d.value?"0":"-1")+'" style="width:'+b+'px;">';this._tabTemplate?(c=webix.extend({cheight:this._content_height-2*d.inputPadding-2,aheight:this._content_height-2},a),b+=this._tabTemplate(c)):b+=(a.icon?"<span class='webix_icon fa-"+a.icon+"'></span> ":
"")+a.value;if(a.close||d.close)b+="<span role='button' tabindex='0' aria-label='"+webix.i18n.aria.closeTab+"' class='webix_tab_close webix_icon fa-times'></span>";return b+"</div>"},_types:{image:"<div class='webix_img_btn_top' style='height:#cheight#px;background-image:url(#image#);'><div class='webix_img_btn_text'>#value#</div></div>",icon:"<div class='webix_img_btn' style='line-height:#cheight#px;height:#cheight#px;'><span class='webix_icon_btn fa-#icon#' style='max-width:#cheight#px;max-height:#cheight#px;'></span>#value#</div>",
iconTop:"<div class='webix_img_btn_top' style='height:#cheight#px;width:100%;top:0px;text-align:center;'><span class='webix_icon fa-#icon#'></span><div class='webix_img_btn_text'>#value#</div></div>"},type_setter:function(a){this._settings.tabOffset=0;this._types[a]&&(this._tabTemplate=webix.template(this._types[a]));return a}},webix.ui.segmented);
webix.protoUI({name:"tabview",defaults:{type:"clean"},setValue:function(a){this._cells[0].setValue(a)},getValue:function(){return this._cells[0].getValue()},getTabbar:function(){return this._cells[0]},getMultiview:function(){return this._cells[1]},addView:function(a){var b=a.body.id=a.body.id||webix.uid();this.getMultiview().addView(a.body);a.id=a.body.id;a.value=a.header;delete a.body;delete a.header;this.getTabbar().addOption(a);return b},removeView:function(a){var b=this.getTabbar();b.removeOption(a);
b.refresh()},$init:function(a){this.$ready.push(this._init_tabview_handlers);var b=a.cells,c=[];webix.assert(b&&b.length,"tabview must have cells collection");for(var d=b.length-1;0<=d;d--){var e=b[d].body||b[d];e.id||(e.id="view"+webix.uid());c[d]={value:b[d].header,id:e.id,close:b[d].close,width:b[d].width,hidden:!!b[d].hidden};b[d]=e}d={view:"tabbar",multiview:!0};b={view:"multiview",cells:b,animate:!!a.animate};a.value&&(d.value=a.value);a.tabbar&&webix.extend(d,a.tabbar,!0);a.multiview&&webix.extend(b,
a.multiview,!0);d.options=d.options||c;a.rows=[d,b];delete a.cells;delete a.tabs},_init_tabview_handlers:function(){this.getTabbar().attachEvent("onOptionRemove",function(a){if(a=webix.$$(a)){var b=a.getParentView();b&&b.removeView(a)}})}},webix.ui.layout);
webix.protoUI({name:"fieldset",defaults:{borderless:!0,$cssName:"webix_fieldset",paddingX:18,paddingY:30},$init:function(a){webix.assert(a.body,"fieldset must have not-empty body");this._viewobj.className+=" "+this.defaults.$cssName;this._viewobj.innerHTML="<fieldset><legend></legend><div></div></fieldset>"},label_setter:function(a){return this._viewobj.firstChild.childNodes[0].innerHTML=a},getChildViews:function(){return[this._body_view]},body_setter:function(a){this._body_view=webix.ui(a,this._viewobj.firstChild.childNodes[1]);
this._body_view._parent_cell=this;return a},getBody:function(){return this._body_view},resizeChildren:function(){var a=this.$width-this._settings.paddingX,b=this.$height-this._settings.paddingY,c=this._body_view.$getSize(0,0);c[0]>a&&(a=c[0]);c[2]>b&&(b=c[2]);this._body_view.$setSize(a,b);this.resize()},$getSize:function(a,b){webix.debug_size_box_start(this,!0);a+=this._settings.paddingX;b+=this._settings.paddingY;var c=this._body_view.$getSize(a,b);a=this._last_body_size=webix.ui.view.prototype.$getSize.call(this,
a,b);a[0]<c[0]&&(a[0]=c[0]);a[2]<c[2]&&(a[2]=c[2]);a[1]>c[1]&&(a[1]=c[1]);a[3]>c[3]&&(a[3]=c[3]);webix.debug_size_box_end(this,a);return a},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&(a=Math.min(this._last_body_size[1],a),b=Math.min(this._last_body_size[3],b),this._body_view.$setSize(a-this._settings.paddingX,b-this._settings.paddingY))}},webix.ui.view);
webix.protoUI({name:"forminput",defaults:{$cssName:"webix_forminput",labelWidth:80,labelAlign:"left"},setValue:function(a){this._body_view.setValue&&this._body_view.setValue(a)},focus:function(){this._body_view.focus()},getValue:function(){if(this._body_view.setValue)return this._body_view.getValue()},value_setter:function(a){this.setValue(a)},getBody:function(){return this._body_view},$skin:function(){this._inputPadding=webix.skin.$active.inputPadding;this._inputSpacing=webix.skin.$active.inputSpacing},
$init:function(a){this.$ready.push(function(){var a=this._viewobj.firstChild.childNodes[0];a.style.width=this._settings.paddingX+"px";a.style.textAlign=this._settings.labelAlign;this._settings.labelWidth||(a.style.display="none")});var b=webix.isUndefined(a.labelWidth)?this.defaults.labelWidth:a.labelWidth;a.paddingX=b-2*this._inputPadding+2*this._inputSpacing},setBottomText:function(a){var b=this._settings;if("undefined"!=typeof a){if(b.bottomLabel==a)return;b.bottomLabel=a}a=(b.invalid?b.invalidMessage:
"")||b.bottomLabel;this._invalidMessage&&webix.html.remove(this._invalidMessage);a&&(this.$view.style.position="relative",this._invalidMessage=webix.html.create("div",{"class":"webix_inp_bottom_label",role:b.invalid?"alert":"","aria-relevant":"all",style:"position:absolute; bottom:0px; padding:2px; background: white; left:"+this._settings.labelWidth+"px; "},a),this._viewobj.appendChild(this._invalidMessage))}},webix.ui.fieldset);
webix.protoUI({name:"dbllist",defaults:{borderless:!0},$init:function(a){this._moved={};this._inRight=webix.bind(function(a){return this._moved[a.id]},this);this._inLeft=webix.bind(function(a){return!this._moved[a.id]},this);this.$view.className+=" webix_dbllist";this.$ready.unshift(this._setLayout)},$onLoad:function(a,b){this._updateAndResize(function(){this.$$("left").data.driver=b;this.$$("left").parse(a);this.$$("right").data.driver=b;this.$$("right").parse(a)});this._refresh()},_getButtons:function(){if(!1===
this._settings.buttons)return{width:10};var a=webix.i18n.dbllist;a=[this._getButton("deselect_all",a.deselectAll),this._getButton("select_all",a.selectAll),this._getButton("deselect_one",a.deselectOne),this._getButton("select_one",a.selectOne)];a={width:120,template:a.join(""),onClick:{dbllist_button:function(a,c,d){this.getTopParentView()._update_list(d.getAttribute("action"))}}};this._settings.buttons&&(a.template=this._settings.buttons);return a},_getButton:function(a,b){return"<button class='dbllist_button' action='"+
a+"'>"+b+"</button>"},_getList:function(a,b,c,d){a={view:"list",select:"multiselect",multiselect:"touch",id:a,action:b,drag:!0,type:{margin:3,id:a},on:{onBeforeDrop:function(a){var b=a.to,c=a.from.getTopParentView();c===this.getTopParentView()&&c.select(a.source,"select_one"!=b._settings.action);return!1},onItemDblClick:function(){return this.getTopParentView()._update_list(this.config.action)}}};this._settings.list&&webix.extend(a,this._settings.list,!0);c&&(a={rows:[{view:"label",label:c},a]});
return d?{rows:[a,{view:"label",height:20,label:d,css:"bottom_label"}]}:a},_setLayout:function(){var a=[{margin:10,type:"clean",cols:[this._getList("left","select_one",this._settings.labelLeft,this._settings.labelBottomLeft),this._getButtons(),this._getList("right","deselect_one",this._settings.labelRight,this._settings.labelBottomRight)]}];this.cols_setter(a)},_update_list:function(a){var b=null,c=!1;"select_all"===a?(b=this.$$("left").data.order,c=!0):"select_one"===a?(b=this.$$("left").getSelectedId(!0),
c=!0):"deselect_all"===a?(b=this.$$("right").data.order,c=!1):"deselect_one"===a&&(b=this.$$("right").getSelectedId(!0),c=!1);this.select(b,c)},select:function(a,b){"object"!==typeof a&&(a=[a]);if(b)for(b=0;b<a.length;b++)this._moved[a[b]]=!0;else for(b=0;b<a.length;b++)delete this._moved[a[b]];this._refresh();this.callEvent("onChange",[])},_updateAndResize:function(a,b){webix.ui.freeze(webix.bind(a,this),!1);b&&(this.$$("left")._settings.autoheight||this.$$("right")._settings.autoheight)&&this.resize()},
_refresh:function(){var a=this.$$("left"),b=this.$$("right");a&&this._updateAndResize(function(){a.filter(this._inLeft);b.filter(this._inRight)},!0)},focus:function(){webix.UIManager.setFocus(this)},value_setter:function(a){this.setValue(a)},setValue:function(a){this._moved={};"object"!==typeof a&&(a=a.toString().split(","));for(var b=0;b<a.length;b++)this._moved[a[b]]=!0;this._refresh()},getValue:function(){var a=[],b;for(b in this._moved)a.push(b);return a.join(",")}},webix.AtomDataLoader,webix.IdSpace,
webix.ui.layout);webix.i18n.dbllist={selectAll:"<span class='webix_icon fa-angle-double-right'></span>",selectOne:"<span class='webix_icon fa-angle-right'></span>",deselectAll:"<span class='webix_icon fa-angle-double-left'></span>",deselectOne:"<span class='webix_icon fa-angle-left'></span>"};
(function(){function a(a,b){return a.getAttribute?(a=a.getAttribute(b))?a.toLowerCase():null:null}function b(){var a=this.tagName?this.tagName.toLowerCase():null;return d[a]?d[a](this):d.other(this)}function c(a){var b=this.tagName?this.tagName.toLowerCase():null;return e[b]?e[b](this,a):e.other(this,a)}var d={radio:function(a){for(var b=0;b<a.length;b++)if(a[b].checked)return a[b].value;return""},input:function(b){return"checkbox"===a(b,"type")?b.checked:b.value},textarea:function(a){return a.value},
select:function(a){return a.options[a.selectedIndex].value},other:function(a){return a.innerHTML}},e={radio:function(a,b){for(var c=0;c<a.length;c++)a[c].checked=a[c].value==b},input:function(b,c){"checkbox"===a(b,"type")?b.checked=c?!0:!1:b.value=c},textarea:function(a,b){a.value=b},select:function(a,b){a.value=b?b:a.firstElementChild.value||b},other:function(a,b){a.innerHTML=b}};webix.protoUI({name:"htmlform",$init:function(a){this.elements={};this._default_values=!1;a.content&&(a.container==a.content||
!a.container&&a.content==document.body)&&(this._copy_inner_content=!0)},content_setter:function(a){a=webix.toNode(a);if(this._copy_inner_content)for(;1<a.childNodes.length;)this._viewobj.childNodes[0].appendChild(a.childNodes[0]);else this._viewobj.childNodes[0].appendChild(a);this._parse_inputs();return!0},render:function(){webix.ui.template.prototype.render.apply(this,arguments);this._parse_inputs()},_parse_inputs:function(){var d=this._viewobj.querySelectorAll("[name]");this.elements={};for(var e=
0;e<d.length;e++){var h=d[e],k=a(h,"name");if(k){var l="button"===(h.tagName?h.tagName.toLowerCase():null),m=a(h,"type");l=l||"button"===m||"submit"===m;"radio"===m&&(m=this.elements[k]||[],m.tagName="radio",m.push(h),h=m);this.elements[k]=h;h.getValue=b;h.setValue=c;h._allowsClear=!l;h._settings={defaultValue:h.getValue()}}}return this.elements},_mark_invalid:function(a,b){this._clear_invalid(a,b);(a=this._viewobj.querySelector('[name="'+a+'"]'))&&webix.html.addCss(a,"invalid")},_clear_invalid:function(a,
b){(a=this._viewobj.querySelector('[name="'+a+'"]'))&&webix.html.removeCss(a,"invalid")}},webix.ui.template,webix.Values)})();
(function(){var a,b;webix.protoUI({name:"google-map",$init:function(a){this.$view.innerHTML="<div class='webix_map_content' style='width:100%;height:100%'></div>";this._contentobj=this.$view.firstChild;this._waitMap=webix.promise.defer();this.data.provideApi(this,!0);this.$ready.push(this.render)},getMap:function(a){return a?this._waitMap:this._map},_getCallBack:function(b){return webix.bind(function(){"function"===typeof b&&b();a=a||window.google;this._initMap.call(this)},this)},render:function(){if("undefined"==
typeof window.google||"undefined"==typeof window.google.maps){if(!b){b=document.createElement("script");b.type="text/javascript";var a=this._settings,d=a.src||"//maps.google.com/maps/api/js";d+=-1===d.indexOf("?")?"?":"&";a.key&&(d+="&key="+a.key);a.libraries&&(d+="&libraries="+a.libraries);b.src=d;document.getElementsByTagName("head")[0].appendChild(b)}b.onload=this._getCallBack(b.onload)}else this._getCallBack()()},_initMap:function(){var b=this.config;this.isVisible(b.id)&&(this._map=new a.maps.Map(this._contentobj,
{zoom:b.zoom,center:new a.maps.LatLng(b.center[0],b.center[1]),mapTypeId:a.maps.MapTypeId[b.mapType]}),this._waitMap.resolve(this._map))},center_setter:function(b){this._map&&this._map.setCenter(new a.maps.LatLng(b[0],b[1]));return b},mapType_setter:function(b){this._map&&this._map.setMapTypeId(a.maps.MapTypeId[b]);return b},zoom_setter:function(a){this._map&&this._map.setZoom(a);return a},layerType_setter:function(a){"heatmap"==a&&(this.config.libraries="visualization");this._layerApi[a]&&(webix.extend(this,
this._layerApi[a],!0),this.data.attachEvent("onStoreUpdated",webix.bind(function(){this._waitMap.then(webix.bind(function(){this.drawData.call(this,arguments)},this))},this)));return a},defaults:{zoom:5,center:[39.5,-98.5],mapType:"ROADMAP",layerType:"marker"},$setSize:function(){webix.ui.view.prototype.$setSize.apply(this,arguments);this._map&&a.maps.event.trigger(this._map,"resize")},$onLoad:function(a){return this._map?!1:(this._waitMap.then(webix.bind(function(){this.parse(a)},this)),!0)},_layerApi:{marker:{drawData:function(a,
b,e){switch(e){case "add":b.$marker=this._getItemConfig(b);break;case "update":b.$marker.setMap(null);b.$marker=this._getItemConfig(b);break;case "delete":b.$marker.setMap(null);break;default:this.data.each(function(a){a.$marker=this._getItemConfig(a)},this)}},clearAll:function(a){this.data.each(function(a){a.$marker.setMap(null)});this.data.clearAll(a)},showItem:function(b){b=this.getItem(b);this._map.setCenter(new a.maps.LatLng(b.lat,b.lng))},_getItemConfig:function(b){var c={},e;for(e in b)c[e]=
b[e];c.position=new a.maps.LatLng(b.lat,b.lng);c.map=b.hidden?null:this._map;c=new a.maps.Marker(c);this._events(c);this.callEvent("onItemRender",[b]);return c},_events:function(a){var b=this;a.addListener("click",function(){b.callEvent("onItemClick",[this.id,this])});a.getDraggable()&&(a.addListener("dragend",function(){b._onDrag(this,!0)}),a.addListener("drag",function(){b._onDrag(this)}))},_onDrag:function(a,b){var c=this.getItem(a.id);a=a.getPosition();b=b?"onAfterDrop":"onDrag";c.lat=a.lat();
c.lng=a.lng();this.callEvent(b,[c.id,c])}},heatmap:{heatmapConfig_setter:function(a){return a=a||{}},drawData:function(){this._heatmap&&(this._heatmap.setMap(null),this._heatmap=null);var b=[];this.data.each(function(a){b.push(this._getConfig(a))},this);if(b.length){var d=webix.extend(this.config.heatmapConfig,{data:b,map:this._map},!0);this._heatmap=new a.maps.visualization.HeatmapLayer(d);this.callEvent("onHeatMapRender",[this._heatmap])}},getHeatmap:function(){return this._heatmap},_getConfig:function(b){var c=
{},e;for(e in b)c[e]=b[e];c.location=new a.maps.LatLng(b.lat,b.lng);return c}}}},webix.DataLoader,webix.EventSystem,webix.ui.view)})();
(function(){var a,b;webix.protoUI({name:"geochart",defaults:{chart:{displayMode:"auto",region:"world",resolution:"countries"}},$init:function(a){this.$view.innerHTML="<div class='webix_map_content' style='width:100%;height:100%'></div>";this._contentobj=this.$view.firstChild;this._waitMap=webix.promise.defer();a.chart=webix.extend(a.chart||{},this.defaults.chart);this.data.provideApi(this,!0);this.$ready.push(this.render);this.data.attachEvent("onClearAll",webix.bind(this._refreshColumns,this));this.data.attachEvent("onStoreUpdated",
webix.bind(this._drawData,this))},getMap:function(a){return a?this._waitMap:this._map},_getCallBack:function(b){return webix.bind(function(){"function"===typeof b&&b();a=a||window.google;this._initMap()},this)},render:function(){"undefined"==typeof window.google||"undefined"==typeof window.google.charts?(b||(b=document.createElement("script"),b.type="text/javascript",b.src="//www.gstatic.com/charts/loader.js",document.getElementsByTagName("head")[0].appendChild(b)),b.onload=this._getCallBack(b.onload)):
this._getCallBack()()},_initMap:function(){a.visualization&&a.visualization.GeoChart?(this._map=new a.visualization.GeoChart(this._contentobj),this._mapEvents(),this._waitMap.resolve(this._map)):(a.charts.load("current",{packages:["geochart"],mapsApiKey:this._settings.key}),a.charts.setOnLoadCallback(webix.bind(function(){this._initMap()},this)))},$onLoad:function(a,b){return this._map?!1:(this._waitMap.then(webix.bind(function(){this.parse(a,this._settings.datatype)},this)),!0)},_drawData:function(){if(this._map){var b=
this._columns&&this._columns.length?this._columns:this._defineColumns(),d=[];this.data.each(function(a,c){c=[];for(var e=0;e<b.length;e++){var f=a[b[e].label];"number"==b[e].type?f*=1:"tooltip"==b[e].role&&(f=this._settings.tooltip(a));c.push(f)}d.push(c)},this);if(b.length){for(var e=new a.visualization.DataTable,f=0;f<b.length;f++)e.addColumn(b[f]);e.addRows(d);e=new a.visualization.DataView(e);this._map.draw(e,this._settings.chart)}else this._map.draw(a.visualization.arrayToDataTable([["",""]]),
{})}else this._map||this._waitMap.then(webix.bind(this._drawData,this))},setDisplayMode:function(a){this._settings.chart.displayMode=a;this.refresh()},setRegion:function(a){this._settings.chart.region=a;this.refresh()},refresh:function(){this._map.clearChart();this._drawData()},tooltip_setter:function(a){this._settings.chart.tooltip=webix.extend(this._settings.chart.tooltip||{},{isHtml:!0});return webix.template(a)},$setSize:function(a,b){webix.ui.view.prototype.$setSize.apply(this,arguments)&&this._map&&
(webix.extend(this._settings,{width:a,height:b}),this.refresh())},_refreshColumns:function(){this._columns=null;this._drawData()},_getColumnType:function(a,b){if(!a||webix.isUndefined(a[b]))return"string";var c=typeof a[b];"string"!=c||isNaN(1*a[b])||(c="number");return c},_defineColumns:function(a){var b=this._settings.columns||[];a=this.data.pull[this.data.order[0]];if(!b.length&&a)for(var c in a)"id"!==c&&b.push(c);for(c=0;c<b.length;c++)"object"!==typeof b[c]&&(b[c]={type:this._getColumnType(a,
b[c]),label:b[c]});this._settings.tooltip&&b.push({type:"string",role:"tooltip",p:{html:!0}});return this._columns=b},_mapEvents:function(){a.visualization.events.addListener(this._map,"error",webix.bind(function(){this.callEvent("onMapError",arguments)},this));a.visualization.events.addListener(this._map,"ready",webix.bind(function(){this.callEvent("onMapReady",arguments)},this));a.visualization.events.addListener(this._map,"regionClick",webix.bind(function(){this.callEvent("onRegionClick",arguments)},
this));a.visualization.events.addListener(this._map,"select",webix.bind(function(){var a=this._map.getSelection()[0],b=a||this._selprev;if(b){var e=this.data.order[b.row];this._selprev=b;this.callEvent("onItemClick",[e,!!a])}},this))}},webix.DataLoader,webix.EventSystem,webix.ui.view)})();
webix.dp=function(a,b){"object"==typeof a&&a._settings&&(a=a._settings.id);if(webix.dp._pull[a]||b)return webix.dp._pull[a];if("string"==typeof a||"number"==typeof a)a={master:webix.$$(a)};a=new webix.DataProcessor(a);b=a._settings.master._settings.id;webix.dp._pull[b]=a;webix.$$(b).attachEvent("onDestruct",function(){webix.dp._pull[this._settings.id]=null;delete webix.dp._pull[this._settings.id]});return a};webix.dp._pull={};webix.dp.$$=function(a){return webix.dp._pull[a]};
webix.DataProcessor=webix.proto({defaults:{autoupdate:!0,updateFromResponse:!1,mode:"post",operationName:"webix_operation",trackMove:!1},$init:function(){this.reset();this._ignore=!1;this.name="DataProcessor";this.$ready.push(this._after_init_call)},reset:function(){this._updates=[]},url_setter:function(a){var b="";if("string"==typeof a){var c=a.split("->");1<c.length&&(a=c[1],b=c[0])}else a&&a.mode&&(b=a.mode,a=a.url);return b?webix.proxy(b,a):a},master_setter:function(a){var b=a;"DataStore"!=a.name&&
(b=a.data);this._settings.store=b;return a},_after_init_call:function(){webix.assert(this._settings.store,"store or master need to be defined for the dataprocessor");this._settings.store.attachEvent("onStoreUpdated",webix.bind(this._onStoreUpdated,this));this._settings.store.attachEvent("onDataMove",webix.bind(this._onDataMove,this))},ignore:function(a,b){var c=this._ignore;this._ignore=!0;a.call(b||this);this._ignore=c},off:function(){this._ignore=!0},on:function(){this._ignore=!1},_copy_data:function(a){var b=
{},c;for(c in a)0!==c.indexOf("$")&&(b[c]=a[c]);return b},save:function(a,b,c){b=b||"update";this._save_inner(a,c||this._settings.store.getItem(a),b)},_save_inner:function(a,b,c){"object"==typeof a&&(a=a.toString());if(!a||!0===this._ignore||!c||"paint"==c)return!0;var d=this._settings.store;d&&d._scheme_serialize&&(b=d._scheme_serialize(b));c={id:a,data:this._copy_data(b),operation:c};webix.isUndefined(b.$parent)||(c.data.parent=b.$parent);"delete"!=c.operation&&((b=this._settings.master)&&b.data&&
b.data.getMark&&b.data.getMark(a,"webix_invalid")&&(c._invalid=!0),this.validate(null,c.data)||(c._invalid=!0));this._check_unique(c)&&this._updates.push(c);this._settings.autoupdate&&this.send();return!0},_onDataMove:function(a,b,c,d){if(this._settings.trackMove){var e=webix.copy(this._settings.store.getItem(a));e.webix_move_index=b;e.webix_move_id=d;e.webix_move_parent=c;this._save_inner(a,e,"order")}},_onStoreUpdated:function(a,b,c){switch(c){case "save":c="update";break;case "update":c="update";
break;case "add":c="insert";break;case "delete":c="delete";break;default:return!0}return this._save_inner(a,b,c)},_check_unique:function(a){for(var b=0;b<this._updates.length;b++){var c=this._updates[b];if(c.id==a.id)return"delete"==a.operation&&("insert"==c.operation?this._updates.splice(b,1):c.operation="delete"),c.data=a.data,c._invalid=a._invalid,!1}return!0},send:function(){this._sendData()},_sendData:function(){if(this._settings.url){for(var a=this._updates,b=[],c=this._settings.url,d=0;d<a.length;d++){var e=
a[d];if(!e._in_progress&&!e._invalid){var f=e.id,g=e.operation,h="object"!=typeof c||c.$proxy?c:c[g],k=h&&(h.$proxy||"function"===typeof h);if(h&&(this._settings.store._scheme_save&&this._settings.store._scheme_save(e.data),this.callEvent("onBefore"+g,[f,e]))){e._in_progress=!0;if(!this.callEvent("onBeforeDataSend",[e]))return;e.data=this._updatesData(e.data);var l=this._send_callback({id:e.id,status:e.operation});h.$proxy?h.save?h.save(this.config.master,e,this,l):b.push(e):("insert"==g&&delete e.data.id,
k?h(e.id,e.operation,e.data).then(function(a){a&&"function"==typeof a.json&&(a=a.json());l.success("",a,-1)},function(a){l.error("",null,a)}):(e.data[this._settings.operationName]=g,this._send(h,e.data,this._settings.mode,g,l)));this.callEvent("onAfterDataSend",[e])}}}c.$proxy&&c.saveAll&&b.length&&c.saveAll(this.config.master,b,this,this._send_callback({}))}},_updatesData:function(a){var b={},c;for(c in a)0!==c.indexOf("$")&&(b[c]=a[c]);return b},_send:function(a,b,c,d,e){webix.assert(a,"url was not set for DataProcessor");
if("function"==typeof a)return a(b,d,e);webix.ajax()[c](a,b,e)},_send_callback:function(a){var b=this;return{success:function(c,d,e){return b._processResult(a,c,d,e)},error:function(c,d,e){return b._processError(a,c,d,e)}}},attachProgress:function(a,b,c){this.attachEvent("onBeforeDataSend",a);this.attachEvent("onAfterSync",b);this.attachEvent("onAfterSaveError",c);this.attachEvent("onLoadError",c)},_processError:function(a,b,c,d){a?this._innerProcessResult(!0,a.id,!1,a.status,!1,{text:b,data:c,loader:d}):
(this.callEvent("onLoadError",arguments),webix.callEvent("onLoadError",[b,c,d,this]))},_innerProcessResult:function(a,b,c,d,e,f){var g=this._settings.master,h=this.getItemState(b);h._in_progress=!1;if(a){if(this.callEvent("onBeforeSaveError",[b,d,e,f])){h._invalid=!0;this._settings.undoOnError&&g._settings.undo&&g.undo(b);this.callEvent("onAfterSaveError",[b,d,e,f]);return}}else this.setItemState(b,!1);c&&b!=c&&this._settings.store.changeId(b,c);e&&"delete"!=d&&this._settings.updateFromResponse&&
this.ignore(function(){this._settings.store.updateItem(c||b,e)});this._settings.undoOnError&&g._settings.undo&&g.removeUndo(c||b);this.callEvent("onAfterSave",[e,b,f]);this.callEvent("onAfter"+d,[e,b,f])},processResult:function(a,b,c){this._innerProcessResult(b&&("error"==b.status||"invalid"==b.status),a.id,b?b.newid||b.id:!1,a.status,b,c)},_processResult:function(a,b,c,d){this.callEvent("onBeforeSync",[a,b,c,d]);if(-1===d)this.processResult(a,c,{});else{var e=this._settings.url;if(e.$proxy&&e.result)e.result(a,
this._settings.master,this,b,c,d);else{if(b){var f=c.json();b&&"undefined"==typeof f&&(f={status:"error"})}this.processResult(a,f,{text:b,data:c,loader:d})}}this.callEvent("onAfterSync",[a,b,c,d])},escape:function(a){return this._settings.escape?this._settings.escape(a):encodeURIComponent(a)},getState:function(){if(!this._updates.length)return!1;for(var a=this._updates.length-1;0<=a;a--)if(this._updates[a]._in_progress)return"saving";return!0},getItemState:function(a){a=this._get_stack_index(a);return this._updates[a]||
null},setItemState:function(a,b){b?this.save(a,b):(a=this._get_stack_index(a),-1<a&&this._updates.splice(a,1))},_get_stack_index:function(a){for(var b=-1,c=0;c<this._updates.length;c++)if(this._updates[c].id==a){b=c;break}return b}},webix.Settings,webix.EventSystem,webix.ValidateData);
(function(){var a={};webix.jsonp=function(b,c,d,e){var f=webix.promise.defer(),g="webix_jsonp_"+webix.uid(),h=document.createElement("script");h.id=g;h.type="text/javascript";var k=document.getElementsByTagName("head")[0];"function"==typeof c&&(e=d,d=c,c={});c||(c={});c.jsonp="webix.jsonp."+g;webix.jsonp[g]=function(){d&&d.apply(e||window,arguments);f.resolve(arguments[0]);window.clearTimeout(a[g]);delete a[g];h.parentNode.removeChild(h);d=k=e=h=null;delete webix.jsonp[g]};a[g]=window.setTimeout(function(){f.reject();
delete webix.jsonp[g]},webix.jsonp.timer);var l=[],m;for(m in c)l.push(m+"="+encodeURIComponent(c[m]));b+=(-1==b.indexOf("?")?"?":"&")+l.join("&");h.src=b;k.appendChild(h);return f};webix.jsonp.timer=3E3})();
webix.markup={namespace:"x",attribute:"data-",dataTag:"li",_dash:/-([a-z])/g,_after_dash:function(a){return a[1].toUpperCase()},_parse_int:{width:!0,height:!0,gravity:!0,margin:!0,padding:!0,paddingX:!0,paddingY:!0,minWidth:!0,maxWidth:!0,minHeight:!0,maxHeight:!0,headerRowHeight:!0},_parse_bool:{disabled:!0,hidden:!0},_view_has_method:function(a,b){return webix.ui.hasMethod(a,b)},init:function(a,b,c){a=a||document.body;var d=[],e=this._get_core_els(a);a=e.html;for(var f=null,g=e.length-1;0<=g;g--)d[g]=
e[g];for(g=0;g<d.length;g++)e=this._sub_markup(d[g],a),e.$scope=c,f=this._initComponent(e,d[g],a,b);return f},parse:function(a,b){"string"==typeof a&&(a=webix.DataDriver[b||"xml"].toObject(a,a));a=this._get_core_els(a,b);return this._sub_markup(a[0],a.html)},_initComponent:function(a,b,c,d){d?a.container=d:(a.container=b.parentNode,webix.html.remove(b));this._view_has_method(a.view,"setPosition")&&delete a.container;return webix.ui(a)},_get_core_els:function(a){this._full_prefix=this.namespace?this.namespace+
":":"";this._full_prefix_top=this._full_prefix+"ui";var b=a.getElementsByTagName(this._full_prefix_top);!b.length&&a.documentElement&&a.documentElement.tagName==this._full_prefix_top&&(b=[a.documentElement]);!b.length&&this.namespace&&(b=a.getElementsByTagName("ui"),!b.length&&a.documentElement&&"ui"==a.documentElement.tagName&&(b=[a.documentElement]));b.length||(b=this._get_html_tops(a),b.html=!0);return b},_get_html_tops:function(a){if(a.getAttribute&&a.getAttribute(this.attribute+"view"))return[a];
a=a.querySelectorAll("["+this.attribute+"view]");for(var b=[],c=0;c<a.length;c++)a[c].parentNode.getAttribute(this.attribute+"view")||b.push(a[c]);return b},_sub_markup:function(a,b,c){var d=!1;if(!c){var e=this._get_name(a,b);if("ui"==e){c=a.childNodes;for(var f=0;f<c.length;f++)if(1==c[f].nodeType)return this._sub_markup(c[f],b)}c={view:e};b&&"table"==a.tagName.toLowerCase()&&(c.data=a,c.datatype="htmltable",d=!0)}f="cols"==c.view||"rows"==c.view||this._view_has_method(c.view,"addView");for(var g=
[],h=0,k=!(b||a.style),l=a.firstChild;l;){if(1==l.nodeType)if(e=this._get_name(l,b),"data"==e){h=1;e=l;l=l.nextSibling;c.data=this._handle_data(e,b);continue}else if("config"==e){this._get_config_html(l,c,b);e=l;l=l.nextSibling;webix.html.remove(e);continue}else"column"==e?(h=1,e=this._tag_to_json(l,b),e.header=e.header||e.value,e.width=1*e.width||"",c.columns=c.columns||[],c.columns.push(e)):e||f&&b?(e=this._sub_markup(l,b,{view:e}),"head"==e.view?c.head=e.rows?e.rows[0]:e.template:"body"==e.view?
this._view_has_method(c.view,"addView")?g.push({body:e.rows?e.rows[0]:e.value,header:e.header||""}):c.body=e.rows?1==e.rows.length?e.rows[0]:{rows:e.rows}:e.value:g.push(e)):k&&(h=1,e=l.tagName,b&&(e=e.toLowerCase().replace(this._dash,this._after_dash)),c[e]=webix.DataDriver.xml.tagToObject(l));l=l.nextSibling}this._attrs_to_json(a,c,b);if(g.length)c.stack?c[c.stack]=g:this._view_has_method(c.view,"setValues")?c.elements=g:"rows"==c.view?(c.view="layout",c.rows=g):"cols"==c.view?(c.view="layout",
c.cols=g):this._view_has_method(c.view,"setValue")?c.cells=g:this._view_has_method(c.view,"getBody")?c.body=1==g.length?g[0]:{rows:g}:c.rows=g;else if(!d&&!h)if(!b||c.template||c.view&&"template"!=c.view){if(a=this._content(a,b))b="template",this._view_has_method(c.view,"setValue")&&(b="value"),c[b]=c[b]||a}else c.view="template",c.content=a;return c},_empty:function(a){return 0<a.replace(/\s+/gm,"").length?!1:!0},_markup_names:{body:1,head:1,data:1,rows:1,cols:1,cells:1,elements:1,ui:1,column:1,
config:1},_get_config_html:function(a,b,c){var d=this._attrs_to_json(a,{});d.name?(b[d.name]=d,delete d.name):d.stack?b[d.stack]=[]:b=d;a=a.childNodes;for(var e=0;e<a.length;e++){var f=1==a[e].nodeType&&"config"==a[e].tagName.toLowerCase()&&a[e].attributes.length?this._get_config_html(a[e],d,c):a[e].innerHTML;d.stack&&f&&b[d.stack].push(f)}return b},_get_name:function(a,b){if(b)return a.getAttribute(this.attribute+"view")||("config"==a.tagName.toLowerCase()?"config":null);b=a.tagName.toLowerCase();
if(this.namespace){if(0===b.indexOf(this._full_prefix)||a.scopeName==this.namespace)return b.replace(this._full_prefix,"")}else if(webix.ui[b]||this._markup_names[b])return b;return 0},_handle_data:function(a,b){for(var c=[],d=a.getElementsByTagName(webix.markup.dataTag),e=0;e<d.length;e++){var f=d[e];if(f.parentNode.parentNode.tagName!=webix.markup.dataTag){var g=this._tag_to_json(f,b);f.className&&(g.$css=f.className);c.push(g)}}webix.html.remove(a);return c},_content:function(a,b){return a.style?
a.innerHTML:a.firstChild?a.firstChild.wholeText||a.firstChild.data||"":""},_tag_to_json:function(a,b){if(!b)return webix.DataDriver.xml.tagToObject(a);var c=this._attrs_to_json(a,{},b);!c.value&&a.childNodes.length&&(c.value=this._content(a,b));return c},_attrs_to_json:function(a,b,c){a=a.attributes;for(var d=0;d<a.length;d++){var e=a[d].name;if(c){if(0!==e.indexOf(this.attribute))continue;e=e.replace(this.attribute,"").replace(this._dash,this._after_dash)}var f=a[d].value;-1!=f.indexOf("json://")&&
(f=JSON.parse(f.replace("json://","")));this._parse_int[e]?f=parseInt(f,10):this._parse_bool[e]&&(f=f&&"false"!==f&&"0"!=f);b[e]=f}return b}};
(function(){function a(a,b){var d=a.callback;c(!1);a.box.parentNode.removeChild(a.box);l=a.box=null;d&&d(b,a.details)}function b(b){if(l){b=b||event;var c=b.which||event.keyCode;if(webix.message.keyboard)return 13!=c&&32!=c||a(l,!0),27==c&&a(l,!1),b.preventDefault&&b.preventDefault(),!(b.cancelBubble=!0)}}function c(a){c.cover&&c.cover.parentNode||(c.cover=document.createElement("DIV"),c.cover.onkeydown=b,c.cover.className="webix_modal_cover",document.body.appendChild(c.cover));c.cover.style.display=
a?"inline-block":"none"}function d(a,b,c){return"<div role='button' tabindex='0' aria-label='"+a+"' class='webix_popup_button"+(c?" "+c:"")+"' result='"+b+"' ><div>"+a+"</div></div>"}function e(a){m.area||(m.area=document.createElement("DIV"),m.area.className="webix_message_area",m.area.style[m.position]="5px",document.body.appendChild(m.area));m.area.setAttribute("role","alert");m.area.setAttribute("aria-atomic",!0);m.hide(a.id);var b=document.createElement("DIV");b.innerHTML="<div>"+a.text+"</div>";
b.className="webix_info webix_"+a.type;b.onclick=function(){m.hide(a.id);a=null};webix.$testmode&&(b.className+=" webix_no_transition");"bottom"==m.position&&m.area.firstChild?m.area.insertBefore(b,m.area.firstChild):m.area.appendChild(b);0<a.expire&&(m.timers[a.id]=window.setTimeout(function(){m.hide(a.id)},a.expire));b.style.height=b.offsetHeight-2+"px";m.pull[a.id]=b;b=null;return a.id}function f(b,c,e){var f=document.createElement("DIV");f.className=" webix_modal_box webix_"+b.type;f.setAttribute("webixbox",
1);f.setAttribute("role","alertdialog");f.setAttribute("aria-label",b.title||"");f.setAttribute("tabindex","0");var g="";b.width&&(f.style.width=b.width+(webix.rules.isNumber(b.width)?"px":""));b.height&&(f.style.height=b.height+(webix.rules.isNumber(b.height)?"px":""));b.title&&(g+='<div class="webix_popup_title">'+b.title+"</div>");g+='<div class="webix_popup_text"><span>'+(b.content?"":b.text)+'</span></div><div  class="webix_popup_controls">';if(c||b.ok)g+=d(b.ok||"OK",!0,"confirm");if(e||b.cancel)g+=
d(b.cancel||"Cancel",!1);if(b.buttons)for(var h=0;h<b.buttons.length;h++)g+=d(b.buttons[h],h);f.innerHTML=g+"</div>";b.content&&(g=b.content,"string"==typeof g&&(g=document.getElementById(g)),"none"==g.style.display&&(g.style.display=""),f.childNodes[b.title?1:0].appendChild(g));f.onclick=function(c){c=c||event;var d=c.target||c.srcElement;d.className||(d=d.parentNode);-1!=d.className.indexOf("webix_popup_button")&&(d=d.getAttribute("result"),a(b,"true"==d||("false"==d?!1:d)));c.cancelBubble=!0};
b.box=f;if(c||e||b.buttons)l=b;return f}function g(a,d,e){d=a.tagName?a:f(a,d,e);a.hidden||c(!0);webix.toNode(a.container||document.body).appendChild(d);e=a.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-d.offsetWidth)/2));var g=a.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-d.offsetHeight)/2));d.style.top="top"==a.position?"-3px":g+"px";d.style.left=e+"px";d.onkeydown=b;d.focus();a.hidden&&webix.modalbox.hide(d);return d}
function h(a,b,c){"object"!=typeof a&&("function"==typeof b&&(c=b,b=""),a={text:a,type:b,callback:c});return a}function k(a,b,c,d){"object"!=typeof a&&(a={text:a,type:b,expire:c,id:d});a.id=a.id||m.uid();a.expire=a.expire||m.expire;return a}var l=null;webix.event(document,"keydown",b,{capture:!0});webix.alert=function(){var a=h.apply(this,arguments);a.type=a.type||"confirm";return g(a,!0,!1)};webix.confirm=function(){var a=h.apply(this,arguments);a.type=a.type||"alert";return g(a,!0,!0)};webix.modalbox=
function(){var a=h.apply(this,arguments);a.type=a.type||"alert";return g(a)};webix.modalbox.hide=function(a){if(a){for(;a&&a.getAttribute&&!a.getAttribute("webixbox");)a=a.parentNode;a&&a.parentNode.removeChild(a)}c(!1);l=null};var m=webix.message=function(a,b,c,d){a=k.apply(this,arguments);a.type=a.type||"info";switch(a.type.split("-")[0]){case "alert":return g(a,!0,!1);case "confirm":return g(a,!0,!0);case "modalbox":return g(a);default:return e(a)}};m.seed=(new Date).valueOf();m.uid=function(){return m.seed++};
m.expire=4E3;m.keyboard=!0;m.position="top";m.pull={};m.timers={};m.hideAll=function(){for(var a in m.pull)m.hide(a)};m.hide=function(a){var b=m.pull[a];b&&b.parentNode&&(window.setTimeout(function(){b.parentNode.removeChild(b);b=null},2E3),b.style.height=0,b.className+=" hidden",m.area.removeAttribute("role"),m.timers[a]&&window.clearTimeout(m.timers[a]),delete m.pull[a])}})();
webix.debug_ready(function(){function a(a){var b={},c=[];a=webix.$$(a);for(var d in a.config)f[d]||"object"==typeof a.config[d]||"undefined"==typeof a.config[d]||"function"==typeof a.config[d]||("view"==d||"id"==d?c.push({label:d,id:d}):c.push({label:d,type:"text",id:d}),a.defaults[d]==a.config[d]&&(c[c.length-1].css={color:"#888"}),b[d]=a.config[d]);c.sort(function(a,b){return!a.css&&b.css?-1:a.css&&!b.css?1:a.id>b.id?1:a.id==b.id?0:-1});return{elements:c,data:b,head:" ["+a.name+"] <strong>"+a._settings.id+
"</strong>"}}function b(){webix.$$("webix_debug_inspector_win")||webix.ui({id:"webix_debug_inspector_win",view:"window",top:2,left:0,width:350,height:350,head:!1,autofit:!1,body:{cols:[{width:10},{type:"clean",rows:[{view:"toolbar",elements:[{view:"label",value:"",id:"webix_debug_inspector_head"},{view:"button",width:100,value:"Hide",type:"custom",click:function(){webix.debug_inspect()}}]},{id:"webix_debug_inspector",nameWidth:150,view:"property",scroll:"y",elements:[],on:{onaftereditstop:function(a,
b){if(a.old!=a.value){a=a.value;if("true"===a||"false"===a)a="true"===a;else{var c=parseInt(a,10);c==a&&(a=c)}c=webix.$$(this.config.view);c.define(b.id,a);c.refreshColumns?c.refreshColumns():c.refresh&&c.refresh();c.resize()}}}}]}]}})}function c(c,d){b();var e=webix.$$("webix_debug_inspector_win");if(c){var f=a(c),g=document.body.offsetWidth,h=document.body.offsetHeight;d=d?webix.html.pos(d):{x:0,y:0};e.define("height",Math.max(350,h-4));e.resize();h=webix.$$("webix_debug_inspector");h.define("elements",
f.elements);h.define("view",c);e.show({x:d.x>g/2?0:g-370,y:0});webix.$$("webix_debug_inspector").setValues(f.data);webix.$$("webix_debug_inspector_head").setValue(f.head)}else e.hide()}function d(a){return 1E5<=a?"Any":a}function e(a,b,c){window.console.log((a==c?">>":"  ")+b+a.name+" / "+a.config.id);b+="  ";if(a._cells)for(var d=0;d<a._cells.length;d++)e(a._cells[d],b,c);a._head_cell&&e(a._head_cell,b,c);a._body_cell&&e(a._body_cell,b,c)}var f={_inner:!0,awidth:!0,cheight:!0,bheight:!0,aheight:!0};
webix.debug_inspect=c;webix.ui({view:"contextmenu",id:"webix:debugmenu",on:{onBeforeShow:function(a){if(!a.ctrlKey)return!1;a=webix.html.locate(a,"view_id");if(!a)return!1;this.config.lastTarget=a;webix.blockEvent();webix.delay(function(){webix.unblockEvent()})},onShow:function(){var a=webix.$$(this.config.lastTarget);a="<span style='color:#888'>"+a._settings.id+"<sup style='float:right'>["+a.name+"]</sup></span>";document.getElementById("webix_debug_cmx").innerHTML=a}},data:["<div id='webix_debug_cmx'></div>",
{id:"inspect",value:"Inspect"},{id:"docs",value:"Documentation"},{value:"Log to Console",submenu:[{id:"size",value:"Sizes"},{id:"tree",value:"Tree"},{id:"dump",value:"Dump"}]}],click:function(a,b){var f=webix.$$(this.config.lastTarget);"dump"==a&&(window.console.info("\n"+f.name+" / "+f.config.id),window.console.log("\nView: ",f,", Config: ",f.config,", Data: ",f.data),window.console.log(f.$view));if("tree"==a){for(var g=f;f.getParentView();)f=f.getParentView();window.console.log("");e(f,"",g)}"size"==
a&&(window.console.info(""),window.console.info("\n"+f.name+" / "+f.config.id),window.console.info("\n[min]   ",f.config.width," x ",f.config.height),g=f.$getSize(0,0),window.console.info("[max]    ",d(g[1])," x ",d(g[3])+(f.config.autoheight?", auto height":"")),window.console.info("[gravity]   ",f.config.gravity),window.console.info("\n[content]    ",f._content_width," x ",f._content_height),window.console.info("[last set]   ",f._last_size[0]," x ",f._last_size[1]),f._settings._inner?window.console.info("\n[borders]   ",
"left:",!f._settings._inner.left,"\ttop:",!f._settings._inner.top,"\tright:",!f._settings._inner.right,"\tbottom:",!f._settings._inner.bottom):window.console.info("\n[borders]   none"));"docs"==a&&window.open("http://docs.webix.com/api__refs__ui."+f.name+".html","__blank");"inspect"==a&&c(this.config.lastTarget,b)},master:document.body})});
webix.protoUI({name:"carousel",defaults:{scrollSpeed:"300ms",type:"clean",navigation:{},animate:!0},$init:function(a){this._viewobj.className+=" webix_carousel";this._dataobj=this._layout=null;this._active_cell=0;this.$ready.unshift(this._initLayout);this.$ready.push(this._after_init_call)},addView:function(a,b){a=this._layout.addView(a,b);this._fix_after_view_add();return a},removeView:function(a){this._layout.removeView(a);this._fix_after_view_add()},_replace:function(a,b){this._layout._replace(a,
b);this._fix_after_view_add()},_fix_after_view_add:function(){this._cells=this._layout._cells;this._renderPanel();this.setActiveIndex(Math.min(this._active_cell,this._cells.length-1))},_initLayout:function(){this._layout&&this._layout.destructor&&this._layout.destructor();var a="";this.config.cols?(a="cols",this._vertical_orientation=0):(a="rows",this._vertical_orientation=1);var b={borderless:!0,type:"clean"};b[a]=webix.copy(this._settings[a]);a="type margin marginX marginY padding paddingX paddingY".split(" ");
for(var c={},d=0;d<a.length;d++)this._settings[a[d]]&&(c[a[d]]=this._settings[a[d]]);webix.extend(b,c,!0);this._layout=webix.ui._view(b);this._layout._parent_cell=this;this._viewobj.appendChild(this._layout._viewobj);this._cells=this._layout._cells;this._layout._show=webix.bind(webix.ui.carousel.prototype._show,this);this._layout.adjustScroll=webix.bind(webix.ui.carousel.prototype.adjustScroll,this);webix.attachEvent("onReconstruct",webix.bind(function(a){a==this._layout&&this._setScroll()},this));
this._contentobj=this._viewobj.firstChild},_onKeyPress:function(a,b){this._settings.navigation.items&&"tab"===b.target.getAttribute("role")&&this._moveActive(a,b);webix.ui.baseview.prototype._onKeyPress.call(this,a,b)},getChildViews:function(){return[this._layout]},getLayout:function(){return this._layout},_after_init_call:function(){this._contentobj.setAttribute("touch_scroll",this._vertical_orientation?"y":"x");this._layout.attachEvent("onAfterScroll",webix.bind(function(a){this.callEvent("onShow",
[this.getActiveId()])},this));webix.ui.each(this._layout,function(a){a._viewobj.setAttribute("role","tabpanel")})},adjustScroll:function(a){var b=this._vertical_orientation?this._content_height:this._content_width;if(this._vertical_orientation){var c=Math.round(a.f/b);a.f=c*b}else c=Math.round(a.e/b),a.e=c*b;this._active_cell=-c;this._settings.navigation&&this._renderNavItems();return!0},_show:function(a){var b;var c=-1;var d=this._layout;for(b=0;b<d._cells.length;b++)if(d._cells[b]==a){c=b;break}0>
c||c==this._active_cell||(this._active_cell=c,a=d._vertical_orientation?this._content_height:this._content_width,b=-(d._vertical_orientation?0:c*a),this.scrollTo(b,-(d._vertical_orientation?c*a:0)),this.callEvent("onShow",[d._cells[this._active_cell]._settings.id]),this._settings.navigation&&this._renderPanel())},scrollTo:function(a,b){webix.Touch&&webix.animate.isSupported()&&this._settings.animate?webix.Touch._set_matrix(this._contentobj,a,b,this._settings.scrollSpeed||"100ms"):(this._contentobj.style.marginLeft=
a+"px",this._contentobj.style.marginTop=b+"px")},navigation_setter:function(a){this._mergeSettings(a,{type:"corner",buttons:!0,items:!0});return a},showNext:function(){this._active_cell<this._layout._cells.length-1&&this.setActiveIndex(this._active_cell+1)},showPrev:function(){0<this._active_cell&&this.setActiveIndex(this._active_cell-1)},setActiveIndex:function(a){webix.assert(a<this._layout._cells.length,"Not existing index in collection");webix.$$(this._layout._cells[a]._settings.id).show()},getActiveIndex:function(){return this._active_cell},
$getSize:function(a,b){var c=this._layout.$getSize(0,0);a=webix.ui.view.prototype.$getSize.call(this,a,b);this._layout._vertical_orientation?(a[0]=Math.max(a[0],c[0]),a[1]=Math.min(a[1],c[1])):(a[2]=Math.max(a[2],c[2]),a[3]=Math.min(a[3],c[3]));return a},$setSize:function(a,b){var c=this._layout,d=c._cells.length;a=webix.ui.view.prototype.$setSize.call(this,a,b);b=this._content_height*(c._vertical_orientation?d:1);d=this._content_width*(c._vertical_orientation?1:d);a?(this._contentobj.style.height=
b+"px",this._contentobj.style.width=d+"px",c.$setSize(d,b),this._setScroll()):c.$setSize(d,b)},_setScroll:function(){var a=this._layout,b=this._active_cell||0,c=a._vertical_orientation?this._content_height:this._content_width;this.scrollTo(-(a._vertical_orientation?0:b*c),-(a._vertical_orientation?b*c:0));this._settings.navigation&&this._renderPanel()},getActiveId:function(){var a=this._layout._cells[this._active_cell];return a?a._settings.id:null},setActive:function(a){webix.$$(a).show()}},webix.EventSystem,
webix.NavigationButtons,webix.ui.view);
webix.type(webix.ui.list,{name:"uploader",template:"#name#  {common.removeIcon()}{common.percent()}<div style='float:right'>#sizetext#</div>",percent:function(a){return"transfer"==a.status?"<div style='width:60px; text-align:center; float:right'>"+a.percent+"%</div>":"<div class='webix_upload_"+a.status+"'><span class='"+("error"==a.status?"error_icon":"fa-check webix_icon")+"'></span></div>"},removeIcon:function(a){return"<div class='webix_remove_upload'><span class='cancel_icon'></span></div>"},on_click:{webix_remove_upload:function(a,
b){webix.$$(this.config.uploader).files.remove(b)}}});
webix.UploadDriver={flash:{$render:function(a){window.swfobject||webix.require("legacy/swfobject.js",!0);a=this._settings;a.swfId=a.swfId||"webix_swf_"+webix.uid();this._getBox().innerHTML+="<div class='webix_upload_flash'><div id='"+a.swfId+"'></div></div>";this._upload_area=this._getBox().lastChild;swfobject.embedSWF(webix.codebase+"/legacy/uploader.swf",a.swfId,"100%","100%","9",null,{uploaderId:a.id,ID:a.swfId,enableLogs:a.enableLogs?"1":"",paramName:a.inputName,multiple:a.multiple?"Y":""},{wmode:"transparent"});
swfobject.getFlashPlayerVersion();webix._event(this._viewobj,"click",webix.bind(function(){250<new Date-(this._upload_timer_click||0)&&this.fileDialog()},this));this.files.attachEvent("onBeforeDelete",webix.bind(this._stop_file,this))},$applyFlash:function(a,b){return this[a].apply(this,b)},getSwfObject:function(){return swfobject.getObjectById(this._settings.swfId)},fileDialog:function(){this.getSwfObject()&&this.getSwfObject().showDialog()},send:function(a){"function"==typeof a&&(this._last_assigned_upload_callback=
a,a=0);if(a){var b=this.files.getItem(a);if("client"!==b.status)return!1;b.status="transfer";if(this.getSwfObject()){var c=this._get_active_url(b),d=this._settings.formData||{};"function"===typeof d&&(d=d.call(this));b=webix.extend(b.formData||{},d);this.getSwfObject().upload(a,c,b)}return!0}a=this.files.data.order;c=!0;if(a.length)for(b=0;b<a.length;b++)c=this.send(a[b])&&c;c&&this._upload_complete()},$beforeAddFileToQueue:function(a,b,c){var d=b.split(".").pop(),e=this._format_size(c);return this.callEvent("onBeforeFileAdd",
[{id:a,name:b,size:c,sizetext:e,type:d}])},$addFileToQueue:function(a,b,c){if(this.files.exists(a))return!1;this._settings.multiple||this.files.clearAll();var d=b.split(".").pop(),e=this._format_size(c);b={name:b,id:a,size:c,sizetext:e,type:d,status:"client"};this.files.add(b);this.callEvent("onAfterFileAdd",[b]);a&&this._settings.autosend&&this.send(a)},stopUpload:function(a){this._stop_file(a)},_stop_file:function(a){var b=this.files.getItem(a);"transfer"==b.status&&(this.getSwfObject().uploadStop(a),
b.status="client")},_drop:function(){},$onUploadComplete:function(){this._settings.autosend&&this._upload_complete()},$onUploadSuccess:function(a,b,c){if(b=this.files.getItem(a))b.status="server",b.progress=100,c.text&&"string"==typeof c.text&&(webix.DataDriver.json.toObject(c.text),webix.extend(b,c,!0)),this.callEvent("onFileUpload",[b,c]),this.callEvent("onChange",[]),this.files.updateItem(a)},$onUploadFail:function(a){var b=this.files.getItem(a);b.status="error";delete b.percent;this.files.updateItem(a);
this.callEvent("onFileUploadError",[b,""])}},html5:{$render:function(a){if(this._upload_area)this._contentobj.firstChild.appendChild(this._upload_area);else{this.files.attachEvent("onBeforeDelete",this._stop_file);a={type:"file","class":"webix_hidden_upload",tabindex:-1};this._settings.accept&&(a.accept=this._settings.accept);this._settings.multiple&&(a.multiple="true");this._settings.directory&&(a.webkitdirectory="true",a.mozdirectory="true",a.directory="true");var b=webix.html.create("input",a);
this._upload_area=this._contentobj.firstChild.appendChild(b);webix._event(this._viewobj,"drop",webix.bind(function(a){this._drop(a);webix.html.preventEvent(a)},this));webix._event(b,"change",webix.bind(function(){this._add_files(b.files);if(webix.env.isIE){var a=document.createElement("form");a.appendChild(this._upload_area);a.reset();this._contentobj.firstChild.appendChild(b)}else b.value=""},this));webix._event(this._viewobj,"click",webix.bind(function(){250<new Date-(this._upload_timer_click||
0)&&this.fileDialog()},this));webix._event(this._viewobj,"dragenter",webix.html.preventEvent);webix._event(this._viewobj,"dragexit",webix.html.preventEvent);webix._event(this._viewobj,"dragover",webix.html.preventEvent)}},_directoryEntry:function(a){return a.isDirectory},_directoryDrop:function(a,b,c){a.isFile?a.file(function(a){b.addFile(a,null,null,{name:c+"/"+a.name})}):a.isDirectory&&a.createReader().readEntries(function(d){for(var e=0;e<d.length;e++)b._directoryDrop(d[e],b,(c?c+"/":"")+a.name)})},
_drop:function(a){var b=a.dataTransfer.files,c=a.dataTransfer.items;if(this.callEvent("onBeforeFileDrop",[b,a])){c=c||b;for(var d=0;d<c.length;d++){var e=c[d];if(this._settings.directory&&e.webkitGetAsEntry&&(e=e.webkitGetAsEntry(),e.isDirectory)){this._directoryDrop(e,this,"");continue}this.addFile(b[d])}}this.callEvent("onAfterFileDrop",[b,a])},fileDialog:function(a){this._upload_timer_click=new Date;this._last_file_context=a;a=this._viewobj.getElementsByTagName("INPUT");a[a.length-1].click()},
send:function(a){"function"==typeof a&&(this._last_assigned_upload_callback=a,a=0);if(a){var b=this.files.getItem(a);if("client"!==b.status)return!1;webix.assert(this._settings.upload,"You need to define upload url for uploader component");b.status="transfer";var c=new FormData;if(b.folder)for(h=0;h<b.folder.length;h++)c.append(this.config.inputName+h,b.folder[h],b.folder[h].webkitRelativePath);else c.append(this.config.inputName,b.file,b.name),this._settings.directory&&c.append(this.config.inputName+
"_fullpath",b.name);h={};var d=this._settings.formData||{};"function"===typeof d&&(d=d.call(this));d=webix.extend(b.formData||{},d);var e=new XMLHttpRequest,f=this._get_active_url(b);if(webix.callEvent("onBeforeAjax",["POST",f,d,e,h,c])){for(var g in d)c.append(g,d[g]);b.xhr=e;e.upload.addEventListener("progress",webix.bind(function(b){this.$updateProgress(a,b.loaded/b.total*100)},this),!1);e.onload=webix.bind(function(b){e.aborted||this._file_complete(a)},this);e.open("POST",f,!0);for(g in h)e.setRequestHeader(g,
h[g]);e.send(c)}this.$updateProgress(a,0);return!0}b=this.files.data.order;c=!0;if(b.length)for(var h=0;h<b.length;h++)c=!this.send(b[h])&&c;c&&this._upload_complete()},_file_complete:function(a){var b=this.files.getItem(a);if(b){var c=null;400>b.xhr.status&&(c=webix.DataDriver[this._settings.datatype||"json"].toObject(b.xhr.responseText));c&&"error"!=c.status?(webix.assert(!c.status||"server"==c.status,"Not supported status value, use 'error' or 'server'"),this._complete(a,c)):(b.status="error",
delete b.percent,this.files.updateItem(a),this.callEvent("onFileUploadError",[b,c]));delete b.xhr}},stopUpload:function(a){webix.bind(this._stop_file,this.files)(a)},_stop_file:function(a){a=this.getItem(a);"undefined"!==typeof a.xhr&&(a.xhr.aborted=!0,a.xhr.abort(),delete a.xhr,a.status="client")}}};
webix.protoUI({name:"uploader",defaults:{autosend:!0,multiple:!0,inputName:"upload"},$cssName:"button",_allowsClear:!0,on_click:{webix_hidden_upload:function(){return!1}},send:function(){},fileDialog:function(){},stopUpload:function(){},$init:function(a){a=webix.UploadDriver.html5;this.files=new webix.DataCollection;this._destroy_with_me=[this.files];if(webix.isUndefined(XMLHttpRequest)||webix.isUndefined((new XMLHttpRequest).upload))a=webix.UploadDriver.flash;webix.assert(a,"incorrect driver");webix.extend(this,
a,!0)},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&this.render()},apiOnly_setter:function(a){webix.delay(this.render,this);return this.$apiOnly=a},_add_files:function(a){for(var b=0;b<a.length;b++)this.addFile(a[b])},link_setter:function(a){a&&webix.delay(function(){var a=webix.$$(this._settings.link);if(!a){var c=this.getTopParentView();c.$$&&(a=c.$$(this._settings.link))}a.sync&&a.filter?a.sync(this.files):a.setValues&&this.files.data.attachEvent("onStoreUpdated",function(){a.setValues(this)});
a._settings.uploader=this._settings.id},this);return a},addFile:function(a,b,c,d){var e=null;"object"==typeof a&&(e=a,a=e.name,b=e.size);var f=this._format_size(b);c=c||a.split(".").pop();a={file:e,name:a,id:webix.uid(),size:b,sizetext:f,type:c,context:this._last_file_context,status:"client"};this._settings.directory&&e.webkitRelativePath&&(a.name=e.webkitRelativePath);d&&webix.extend(a,d,!0);this.callEvent("onBeforeFileAdd",[a])&&(this._settings.multiple||this.files.clearAll(),d=this.files.add(a),
this.callEvent("onAfterFileAdd",[a]),d&&this._settings.autosend&&this.send(d));return a},_get_active_url:function(a){var b=this._settings.upload;a=webix.extend(a.urlData||{},this._settings.urlData||{});if(b&&a){var c=[],d;for(d in a)c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));c.length&&(b+=(-1==b.indexOf("?")?"?":"&")+c.join("&"))}return b},addDropZone:function(a,b){var c=webix.toNode(a);a="";b&&(a=" "+webix.html.createCss({content:'"'+b+'"'},":before"));var d="webix_drop_file"+a,e=
null;webix._event(c,"dragover",webix.html.preventEvent);webix._event(c,"dragover",function(a){webix.html.addCss(c,d,!0);e&&(clearTimeout(e),e=null)});webix._event(c,"dragleave",function(a){e=setTimeout(function(){webix.html.removeCss(c,d)},150)});webix._event(c,"drop",webix.bind(function(a){webix.html.removeCss(c,d);this._drop(a);return webix.html.preventEvent(a)},this))},_format_size:function(a){for(var b=0;1024<a;)b++,a/=1024;return Math.round(100*a)/100+" "+webix.i18n.fileSize[b]},_complete:function(a,
b){var c=this.files.getItem(a);webix.extend(c,b,!0);c.status="server";c.progress=100;this.callEvent("onFileUpload",[c,b]);this.callEvent("onChange",[]);this.files.updateItem(a);this.isUploaded()&&this._upload_complete(b)},_upload_complete:function(a){this.callEvent("onUploadComplete",[a]);this._last_assigned_upload_callback&&(this._last_assigned_upload_callback.call(this,a),this._last_assigned_upload_callback=0)},isUploaded:function(){for(var a=this.files.data.order,b=0;b<a.length;b++)if("server"!=
this.files.getItem(a[b]).status)return!1;return!0},$onUploadComplete:function(){},$updateProgress:function(a,b){this.files.getItem(a).percent=Math.round(b);this.files.updateItem(a)},setValue:function(a){"string"==typeof a&&a&&(a={value:a,status:"server"});this.files.clearAll();a&&this.files.parse(a);this.callEvent("onChange",[])},getValue:function(){var a=[];this.files.data.each(function(b){"server"==b.status&&a.push(b.value||b.name)});return a.join(",")}},webix.ui.button);
webix.html.addMeta=function(a,b){document.getElementsByTagName("head").item(0).appendChild(webix.html.create("meta",{name:a,content:b}))};
(function(){var a=function(){var a=!!(window.orientation%180);webix.ui.orientation!==a&&(webix.ui.orientation=a,webix.callEvent("onRotate",[a]))};webix.env.touch&&(webix.ui.orientation=!!((webix.isUndefined(window.orientation)?90:window.orientation)%180),webix.event(window,"onorientationchange"in window?"orientationchange":"resize",a));webix.env.isFF&&window.matchMedia&&(window.matchMedia("(orientation: portrait)").addListener(function(){webix.ui.orientation=!1}),window.matchMedia("(orientation: landscape)").addListener(function(){webix.ui.orientation=
!0}));webix.ui.fullScreen=function(){if(webix.env.touch){webix.html.addMeta("apple-mobile-web-app-capable","yes");webix.html.addMeta("viewport","initial-scale=1, maximum-scale=1, user-scalable=no");var b=document.body.offsetHeight||document.body.scrollHeight,c=-1!=navigator.userAgent.indexOf("iPhone");navigator.userAgent.indexOf("iPad");var d=navigator.userAgent.match(/iPhone OS (\d+)/),e=d&&7<=d[1],f=c&&(356==b||208==b||306==b||158==b||444==b),g=568==window.screen.height,h=function(){var a=0,b=0;
c&&!e?webix.ui.orientation?(a=g?568:480,b=f?268:300):(a=320,b=g?f?504:548:f?416:460):webix.env.isAndroid?webix.env.isFF||(document.body.style.width=document.body.style.height="1px",document.body.style.overflow="hidden",b=window.outerWidth/window.innerWidth,a=window.outerWidth/b,b=window.outerHeight/b):webix.env.isIEMobile||(a=window.innerWidth,b=window.innerHeight);b&&(document.body.style.height=b+"px",document.body.style.width=a+"px");webix.ui._freeze_resize=!1;webix.ui.resize()};b=function(){webix.ui._freeze_resize=
!0;webix.env.isSafari?h():webix.delay(h,null,[],500)};webix.attachEvent("onRotate",b);a();webix.delay(b)}}})();
webix.history={track:function(a,b){this._init_state(a,b);this._aHandler&&webix.$$(this._aViewId).detachEvent(this._aHandler);if(a){this._aViewId=a;var c=webix.$$(a);b=function(){webix.history._ignored||c.getValue&&webix.history.push(a,c.getValue())};this._aHandler=c.getActiveId?c.attachEvent("onViewChange",b):c.attachEvent("onChange",b)}},_set_state:function(a,b){webix.history._ignored=1;a=webix.$$(a);a.callEvent("onBeforeHistoryNav",[b])&&a.setValue&&a.setValue(b);webix.history._ignored=0},push:function(a,
b,c){a=webix.$$(a);var d="";b&&(d="#!/"+b);webix.isUndefined(c)&&(c=a.getValue?a.getValue():b);window.history.pushState({webix:!0,id:a._settings.id,value:c},"",d)},_init_state:function(a,b){webix.event(window,"popstate",function(a){a.state&&a.state.webix&&webix.history._set_state(a.state.id,a.state.value)});var c=window.location.hash;webix.noanimate=!0;c&&0===c.indexOf("#!/")?webix.history._set_state(a,c.replace("#!/","")):b&&(webix.history.push(a,b),webix.history._set_state(a,b));webix.noanimate=
!1;this._init_state=function(){}}};
webix.protoUI({name:"slider",$touchCapture:!0,defaults:{min:0,max:100,value:50,step:1,title:!1,moveTitle:!0,template:function(a,b){var c=b._handle_id="x"+webix.uid(),d="<div class='webix_slider_title"+(a.moveTitle?" webix_slider_move":"")+"'"+(!a.moveTitle&&a.vertical?" style='line-height:"+(a.aheight-2*a.inputPadding)+"px;'":"")+"></div>",e="<div class='webix_slider_handle' role='slider' aria-label='"+a.label+(a.title?" "+a.title(a):"")+"' aria-valuemax='"+a.max+"' aria-valuemin='"+a.min+"' aria-valuenow='"+
a.value+"' tabindex='0' id='"+c+"'>&nbsp;</div>";return b.$renderInput(a,a.vertical?"<div class='webix_slider_box'><div class='webix_slider_right'></div><div class='webix_slider_left'>&nbsp;</div>"+e+"</div>"+d:d+"<div class='webix_slider_box'><div class='webix_slider_left'>&nbsp;</div><div class='webix_slider_right'></div>"+e+"</div>",c)}},type_setter:function(a){this._viewobj.className+=" webix_slider_"+a},title_setter:function(a){return"string"==typeof a?webix.template(a):a},_get_slider_handle:function(){return this.$view.querySelector(".webix_slider_handle")},
_set_inner_size:function(){var a=this._get_slider_handle(),b=this._settings;if(a){var c=b.vertical?this._content_height:this._get_input_width(b),d=b.value%b.step?Math.round(b.value/b.step)*b.step:b.value,e=b.max-b.min;d=Math.max(Math.min(d,b.max),b.min);d=b.vertical?e-(d-b.min):d-b.min;d=Math.ceil((c-2*this._sliderPadding)*d/e);e=c-2*this._sliderPadding-d;var f=b.vertical?"top":"left";b=b.vertical?"height":"width";a.style[f]=this._sliderPadding+d-this._sliderHandleWidth/2+"px";a.parentNode.style[b]=
c+"px";e=Math.min(Math.max(e,2*this._sliderBorder),c-2*this._sliderPadding-2*this._sliderBorder);d=Math.min(Math.max(d,2*this._sliderBorder),c-2*this._sliderPadding-2*this._sliderBorder);c=a.previousSibling;c.style[b]=e+"px";c.previousSibling.style[b]=d+"px";this._set_title(a,d,e,f)}},_set_title:function(a,b,c,d){var e=this._settings;this._settings.title&&(a=a.parentNode[e.vertical?"nextSibling":"previousSibling"],a.innerHTML=this._settings.title(this._settings,this),this._settings.moveTitle&&(e.vertical?
b=b+2*this._sliderBorder-this._sliderHandleWidth/2:(e=a.clientWidth/2,b=this._sliderPadding+b-e+(e>b?e-b-2*this._sliderBorder:0)-(e>c?e-c-2*this._sliderBorder-this._sliderHandleWidth/2:0)),a.style[d]=b+"px"))},_set_value_now:function(){this._get_slider_handle().setAttribute("aria-valuenow",this._settings.value)},refresh:function(){var a=this._get_slider_handle();a&&(this._set_value_now(),this._settings.title&&a.setAttribute("aria-label",this._settings.label+" "+this._settings.title(this._settings,
this)),this._set_inner_size())},$setValue:function(){this.refresh()},$getValue:function(){return this._settings.value},$init:function(a){webix.env.touch?this.attachEvent("onTouchStart",webix.bind(this._on_mouse_down_start,this)):webix._event(this._viewobj,"mousedown",webix.bind(this._on_mouse_down_start,this));webix._event(this.$view,"keydown",webix.bind(this._handle_move_keyboard,this));a.vertical&&(a.height=a.height||webix.skin.$active.vSliderHeight,this._viewobj.className+=" webix_slider_vertical",
this._sliderPadding=webix.skin.$active.vSliderPadding)},$skin:function(){this._sliderHandleWidth=webix.skin.$active.sliderHandleWidth;this._sliderPadding=webix.skin.$active.sliderPadding;this._sliderBorder=webix.skin.$active.sliderBorder},_handle_move_keyboard:function(a){var b=a.keyCode,c=this._settings,d=c.value;if(32<b&&41>b){webix.html.preventEvent(a);this._activeIndex=(a=/webix_slider_handle_(\d)/.exec((a.target||a.srcElement).className))?parseInt(a[1],10):-1;a&&(d=c.value[this._activeIndex]);
d=d<c.min?c.min:d>c.max?c.max:d;if(35===b)d=c.min;else if(36===b)d=c.max;else{var e=37===b||40===b||34===b?-1:1;if(33===b||34===b||1<c.step)e*=c.step;d=1*d+e}if(d>=c.min&&d<=c.max){if(a){b=[];for(a=0;a<c.value.length;a++)b[a]=a===this._activeIndex?d:c.value[a];d=b}this.setValue(d);this._activeIndex=-1}}},_on_mouse_down_start:function(a){var b=a.target||a.srcElement;this._mouse_down_process&&this._mouse_down_process(a);var c=this._settings.value;webix.isArray(c)&&(c=webix.copy(c));if(-1!=b.className.indexOf("webix_slider_handle"))return this._start_value=
c,this._start_handle_dnd.apply(this,arguments);-1!=b.className.indexOf("webix_slider")&&(this._start_value=c,this._settings.value=this._get_value_from_event.apply(this,arguments),this._start_handle_dnd(a))},_start_handle_dnd:function(a){this._handle_drag_events=webix.env.touch?[this.attachEvent("onTouchMove",webix.bind(this._handle_move_process,this)),this.attachEvent("onTouchEnd",webix.bind(this._handle_move_stop,this))]:[webix.event(document.body,"mousemove",webix.bind(this._handle_move_process,
this)),webix.event(window,"mouseup",webix.bind(this._handle_move_stop,this))];webix.html.addCss(document.body,"webix_noselect")},_handle_move_stop:function(a){this._handle_drag_events&&(webix.env.touch?(webix.detachEvent(this._handle_drag_events[0]),webix.detachEvent(this._handle_drag_events[1])):(webix.eventRemove(this._handle_drag_events[0]),webix.eventRemove(this._handle_drag_events[1])),this._handle_drag_events=[]);webix.html.removeCss(document.body,"webix_noselect");a=this._settings.value;webix.isArray(a)&&
(a=webix.copy(a));this._settings.value=this._start_value;this.setValue(a);this._get_slider_handle(this._activeIndex).focus();this._activeIndex=-1},_handle_move_process:function(a){this._settings.value=this._get_value_from_event.apply(this,arguments);this.refresh();this.callEvent("onSliderDrag",[])},_get_value_from_event:function(a,b){var c=this._settings.vertical?"y":"x";a=webix.env.touch?b?b[c]:a[c]:webix.html.pos(a)[c];return this._get_value_from_pos(a)},_get_value_from_pos:function(a){var b=this._settings,
c=b.max-b.min,d=b.vertical?"y":"x";d=webix.html.offset(this._get_slider_handle().parentNode)[d]+this._sliderPadding;var e=(b.vertical?this._content_height:this._get_input_width(b))-2*this._sliderPadding;a=e?(a-d)*c/e:0;b.vertical&&(a=c-a);a=Math.round((a+b.min)/b.step)*b.step;return Math.max(Math.min(a,b.max),b.min)},_init_onchange:function(){}},webix.ui.text);
webix.protoUI({name:"rangeslider",$cssName:"slider webix_rangeslider",defaults:{separator:",",value:"20,80",template:function(a,b){var c="x"+webix.uid();b._handle_id=[c+"_0",c+"_1"];var d="role='slider' aria-label='"+a.label+(a.title?" "+a.title(a):"")+"' aria-valuemax='"+a.max+"' aria-valuemin='"+a.min+"' tabindex='0'",e="<div class='webix_slider_handle webix_slider_handle_0' id='"+b._handle_id[0]+"' "+d+" aria-valuenow='"+a.value[0]+"'>&nbsp;</div>";e+="<div class='webix_slider_handle webix_slider_handle_1' id='"+
b._handle_id[1]+"' "+d+" aria-valuenow='"+a.value[1]+"'>&nbsp;</div>";return b.$renderInput(a,"<div class='webix_slider_title'></div><div class='webix_slider_box'><div class='webix_slider_right'>&nbsp;</div><div class='webix_slider_left'></div>"+e+"</div>",c)}},value_setter:function(a){webix.isArray(a)||(a=a.toString().split(this._settings.separator));2>a.length&&(a[1]=a[0]);a[0]=parseFloat(a[0]);a[1]=parseFloat(a[1]);return a},_get_slider_handle:function(a){return this.$view.querySelector(".webix_slider_handle_"+
((a&&0<=a?a:0)||0))},_get_left_pos:function(a,b){var c=this._settings;var d=c.max-c.min;b=c.value[b]%c.step?Math.round(c.value[b]/c.step)*c.step:c.value[b];b=Math.max(Math.min(b,c.max),c.min);return Math.ceil((a-20)*(b-c.min)/d)},_set_inner_size:function(){var a=this._get_slider_handle(0);var b=this._get_slider_handle(1);var c=this._settings;webix.isArray(c.value)||this.define("value",c.value);if(a){var d=this._get_input_width(c);var e=a.parentNode;e.style.width=d+"px";c=this._get_left_pos(d,0);var f=
this._get_left_pos(d,1);a.style.left=10+c-8+"px";b.style.left=10+f-8+"px";e.firstChild.style.width=d-22+"px";e.childNodes[1].style.width=f-c+"px";e.childNodes[1].style.left=c+12+"px";this._settings.title&&(a.parentNode.previousSibling.innerHTML=this._settings.title(this._settings,this))}},_set_value_now:function(){for(var a=0;2>a;a++)this._get_slider_handle(a).setAttribute("aria-valuenow",this._settings.value[a])},_mouse_down_process:function(a){this._activeIndex=(a=/webix_slider_handle_(\d)/.exec((a.target||
a.srcElement).className))?parseInt(a[1],10):-1;a&&this._set_handle_active(this._activeIndex)},setValue:function(a){var b=this._settings.value,c="object"==typeof a?a.join(this._settings.separator):a;if(b.join(this._settings.separator)==c)return!1;this._settings.value=a;this._rendered_input&&this.$setValue(a);this.callEvent("onChange",[a,b])},$getValue:function(){var a=this._settings.value;return this._settings.stringResult?a.join(this._settings.separator):a},_set_handle_active:function(a){var b=this._get_slider_handle(a);
a=this._get_slider_handle(1-a);-1==b.className.indexOf("webix_slider_active")&&(b.className+=" webix_slider_active");a.className=a.className.replace(" webix_slider_active","")},_get_value_from_pos:function(a){var b=this._settings,c=b.value,d=b.max-b.min,e=webix.html.offset(this._get_slider_handle().parentNode).x;d=Math.ceil((a-e)*d/this._get_input_width(b));d=Math.round((d+b.min)/b.step)*b.step;e=webix.html.offset(this._get_slider_handle(0)).x;var f=webix.html.offset(this._get_slider_handle(1)).x;
e!=f||b.value[0]!=b.min&&b.value[0]!=b.max?0<=this._activeIndex?a=this._activeIndex:e==f?a=a<e?0:1:this._activeIndex=a=Math.abs(e-a)<Math.abs(f-a)?0:1:(a=b.value[0]==b.min?1:0,this._set_handle_active(a));c[a]=a?Math.max(Math.min(d,b.max),c[0]):Math.max(Math.min(d,c[1]),b.min);return c}},webix.ui.slider);
webix.proxy.offline={$proxy:!0,storage:webix.storage.local,cache:!1,data:"",_is_offline:function(){this.cache||webix.env.offline||(webix.callEvent("onOfflineMode",[]),webix.env.offline=!0)},_is_online:function(){!this.cache&&webix.env.offline&&(webix.env.offline=!1,webix.callEvent("onOnlineMode",[]))},load:function(a,b){var c={error:function(){var c=this.getCache()||this.data,e={responseText:c},f=webix.ajax.prototype._data(e);this._is_offline();webix.ajax.$callback(a,b,c,f,e)},success:function(c,
e,f){this._is_online();webix.ajax.$callback(a,b,c,e,f);this.setCache(c)}};this.cache&&this.getCache()?c.error.call(this):this.source.$proxy?this.source.load(this,c):webix.ajax(this.source,c,this)},getCache:function(){return this.storage.get(this._data_name())},clearCache:function(){this.storage.remove(this._data_name())},setCache:function(a){this.storage.put(this._data_name(),a)},_data_name:function(){return this.source.$proxy?this.source.source+"_$proxy$_data":this.source+"_$proxy$_data"},saveAll:function(a,
b,c,d){this.setCache(a.serialize());webix.ajax.$callback(a,d,"",b)},result:function(a,b,c,d,e){for(a=0;a<e.length;a++)c.processResult({id:e[a].id,status:e[a].operation},{},{})}};webix.proxy.cache={init:function(){webix.extend(this,webix.proxy.offline)},cache:!0};webix.proxy.local={init:function(){webix.extend(this,webix.proxy.offline)},cache:!0,data:[]};
webix.ActiveContent={$init:function(a){if(a.activeContent){this.$ready.push(this._init_active_content_list);this._active_holders={};this._active_holders_item={};this._active_holders_values={};this._active_references={};for(var b in a.activeContent)if(this[b]=this._bind_active_content(b),a.activeContent[b].earlyInit){var c=webix._parent_cell;webix._parent_cell=null;this[b].call(this,{},this,a.activeContent);webix._parent_cell=c}}},_destructActiveContent:function(){for(var a in this._active_references){var b=
this._active_references[a];b.destructor&&b.destructor()}},_init_active_content_list:function(){this.attachEvent("onDestruct",webix.bind(this._destructActiveContent,this));webix._event(this.$view,"blur",function(a){if("BUTTON"!=(a.target||a.srcElement).tagName){var b=webix.$$(a);b&&b!==this&&b.getValue&&b.setValue&&(b.getNode(a),a=b.getValue(),a!=b._settings.value&&b.setValue(a))}},{bind:this,capture:!0});if(this.filter){for(var a in this._settings.activeContent)this.type[a]=this[a],this[a]=this._locate_active_content_by_id(a);
this.attachEvent("onBeforeRender",function(){this.type.masterUI=this});this.type.masterUI=this}},_locate_active_content_by_id:function(a){return function(b){var c=this._active_references[a],d=c._settings.id;b=this.getItemNode(b).getElementsByTagName("DIV");for(var e=0;e<b.length;e++)if(b[e].getAttribute("view_id")==d){c._viewobj=c._dataobj=b[e];break}return c}},_get_active_node:function(a,b,c){return function(d){if(d)for(d=d.target||d.srcElement;d;){if(d.getAttribute&&d.getAttribute("view_id")){c._setActiveContentView(a,
d);if(c.locate){var e=c.locate(d.parentNode);a._settings.value=c._active_holders_values[b][e];a._settings.$masterId=e}return d}d=d.parentNode}return a._viewobj}},_set_new_active_value:function(a,b){return function(c){var d=b.data;if(b.filter){var e=b.locate(this._viewobj.parentNode);d=b.getItem(e);this.refresh();b._active_holders_item[a][e]=this._viewobj.outerHTML||(new XMLSerializer).serializeToString(this._viewobj);b._active_holders_values[a][e]=c}d&&(d[a]=c)}},_bind_active_content:function(a){return function(b,
c,d){c=c._active_holders?c:c.masterUI;if(!c._active_holders[a]){var e=document.createElement("DIV");d=d||c._settings.activeContent;d=webix.ui(d[a],e);e.firstChild.setAttribute("onclick","event.processed = true; if (webix.env.isIE8) event.srcElement.w_view = '"+d._settings.id+"';");d.getNode=c._get_active_node(d,a,c);d.attachEvent("onChange",c._set_new_active_value(a,c));c._active_references[a]=d;c._active_holders[a]=e.innerHTML;c._active_holders_item[a]={};c._active_holders_values[a]={};d.$activeEl=
d.$view}c.filter&&b[a]!=c._active_holders_values[a]&&!webix.isUndefined(b[a])&&(d=c._active_references[a],d.blockEvent(),c._setActiveContentView(d,d.$activeEl),d.$view.firstChild||d.refresh(),d.setValue(b[a]),d.refresh(),d.unblockEvent(),c._active_holders_values[a][b.id]=b[a],c._active_holders_item[a][b.id]=d._viewobj.outerHTML||(new XMLSerializer).serializeToString(d._viewobj));return c._active_holders_item[a][b.id]||c._active_holders[a]}},_setActiveContentView:function(a,b){a._dataobj=a._viewobj=
a.$view=b}};
webix.ProgressBar={$init:function(){webix.isUndefined(this._progress)&&this.attachEvent&&(this.attachEvent("onBeforeLoad",this.showProgress),this.attachEvent("onAfterLoad",this.hideProgress),this._progress=null)},showProgress:function(a){if(!this._progress){a=webix.extend({position:0,delay:2E3,type:"icon",icon:"refresh",hide:!1},a||{},!0);this._progress=webix.html.create("DIV",{"class":"webix_progress_"+a.type,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100",tabindex:"0"},"<div class='webix_progress_state "+
("icon"==a.type?"fa-"+a.icon+" fa-spin":"")+"'></div>");this.setPosition||(this._viewobj.style.position="relative");webix.html.insertBefore(this._progress,this._viewobj.firstChild,this._viewobj);this._viewobj.setAttribute("aria-busy","true");if(!webix.Touch.$active&&this.getScrollState){var b=this.getScrollState();this._viewobj.scrollWidth!=this.$width&&(this._progress.style.left=b.x+"px");this._viewobj.scrollHeight!=this.$height&&(this._progress.style.top="bottom"!=a.type?b.y+"px":b.y+this.$height-
this._progress.offsetHeight+"px")}this._progress_delay=1}a&&"icon"!=a.type?webix.delay(function(){if(this._progress){var b=a.position||1;if(this._progress.style[webix.env.transitionDuration]===webix.undefined&&a.delay){var d=0,e=0,f=b/a.delay*30,g=this;this._progressTimer&&(window.clearInterval(this._progressTimer),e=this._progress.firstChild.offsetWidth/this._progress.offsetWidth*100);this._progressTimer=window.setInterval(function(){30*d==a.delay?window.clearInterval(g._progressTimer):(g._progress&&
g._progress.firstChild&&(g._progress.firstChild.style.width=e+d*f*b*100+"%"),d++)},30)}else this._progress.firstChild.style.width=100*b+"%",a.delay&&(this._progress.firstChild.style[webix.env.transitionDuration]=a.delay+"ms");a.hide&&webix.delay(this.hideProgress,this,[1],a.delay)}this._progress_delay=0},this):a&&"icon"==a.type&&a.hide&&webix.delay(this.hideProgress,this,[1],a.delay)},hideProgress:function(a){this._progress_delay&&(a=!0);this._progress&&(a?(this._progressTimer&&window.clearInterval(this._progressTimer),
webix.html.remove(this._progress),this._progress=null,this._viewobj.removeAttribute("aria-busy")):this.showProgress({position:1.1,delay:300,hide:!0}))}};
webix.protoUI({name:"multitext",$cssName:"text",defaults:{icon:"plus-circle",iconWidth:25,separator:", "},getValueHere:function(){return webix.ui.text.prototype.getValue.call(this)},setValueHere:function(a){return webix.ui.text.prototype.$setValue.call(this,a)},getValue:function(){if("extra"==this.config.mode)return this.getValueHere();if(this._full_value)return this._full_value;for(var a=[this.getValueHere(this)],b=0;b<this._subs.length;b++){var c=webix.$$(this._subs[b]).getValueHere();c&&a.push(c)}return a.join(this.config.separator)},
$setValue:function(a){a=a||"";if("extra"==this.config.mode)return this.setValueHere(a);this._full_value=a;a=a.split(this.config.separator);if(a.length==this._subs.length+1){this.setValueHere(a[0]);for(var b=0;b<this._subs.length;b++)webix.$$(this._subs[b]).setValueHere(a[b+1])}else{this.removeSection();this.setValueHere.call(this,a[0]);for(b=1;b<a.length;b++)this.addSection(a[b]);this._full_value=""}},_subOnChange:function(a){a=this.config.master?webix.$$(this.config.master):this;var b=a.getValue(),
c=a._settings.value;b!==c&&(a._settings.value=b,a.callEvent("onChange",[b,c]))},addSection:function(a){var b=this.config;a={labelWidth:b.labelWidth,inputWidth:b.inputWidth,width:b.width,label:b.label?"&nbsp;":"",view:this.name,mode:"extra",value:a||"",icon:"minus-circle",suggest:b.suggest||null,master:b.id};webix.extend(a,b.subConfig||{},!0);b=this.getParentView().addView(a);webix.$$(b).attachEvent("onChange",this._subOnChange);this._subs.push(b);this.callEvent("onSectionAdd",[b,this._subs.length]);
return b},removeSection:function(a){for(var b=this.config.master?webix.$$(this.config.master):this,c=b._subs.length-1;0<=c;c--){var d=b._subs[c];a&&d!=a||(b._subs.removeAt(c),this.getParentView().removeView(d),b.callEvent("onSectionRemove",[d,c+1]))}},on_click:{webix_input_icon:function(a,b,c){"extra"==this.config.mode?(this.removeSection(this.config.id),a=this.getParentView().getChildViews(),a[a.length-1].focus(),this._subOnChange()):webix.$$(this.addSection()).focus();return!1}},$init:function(){this._subs=
webix.toArray([]);this.attachEvent("onKeyPress",this._onKeyPress)},$render:function(a){this.$setValue(a.value)}},webix.ui.text);
webix.protoUI({name:"organogram",defaults:{scroll:"auto",ariaLabel:"lines"},$init:function(){this._viewobj.className+=" webix_organogram";this._html=document.createElement("DIV");this.$ready.push(this._afterInit);webix.extend(this.data,webix.TreeStore,!0);this.data.provideApi(this,!0)},_id:"webix_dg_id",on_click:{webix_organogram_item:function(a,b){this._settings.select&&("multiselect"==this._settings.select||this._settings.multiselect?this.select(b,!1,a.ctrlKey||a.metaKey||"touch"==this._settings.multiselect,
a.shiftKey):this.select(b),this._no_animation=!1)}},on_context:{},on_dblclick:{},_afterInit:function(){this._dataobj.style.position="relative";this.data.attachEvent("onStoreUpdated",webix.bind(this.render,this))},_toHTMLItem:function(a){var b=this.data._marks[a.id];this.callEvent("onItemRender",[a]);return this.type.templateStart.call(this,a,this.type,b)+(a.$template?this.type["template"+a.$template].call(this,a,this.type,b):this.type.template.call(this,a,this.type,b))+this.type.templateEnd.call(this)},
_toHTML:function(a){var b=this._toHTMLItem(a);this.data.branch[a.id]&&(b+=this._renderBranch(a.id));return b},_isListBlocks:function(){return this.type.listMarginX||this.type.listMarginY},_renderBranch:function(a,b){var c,d="",e=this.data.branch[a],f=this.data._marks[a],g=this.getItem(a),h=g?g.$type:!1;b=b||0;"list"===h&&(b+=this.type.listMarginX);if(!a){this._colHeight=[];this.$xy={};var k=this.$width-2*this.type.padding;this.$xy[0]={totalWidth:k,start:this.type.padding,width:0,height:0,left:k/2,
top:this.type.padding||0}}if(e){var l=this.$xy[a];"list"!=h||this._isListBlocks()||(d+=this.type.templateListStart.call(this,g,this.type,f));var m=0,n=0;for(c=0;c<e.length;c++){var p=e[c];k=this._tw[p];var q=this.getItem(p);q.open==webix.undefined&&(q.open=!0);"list"==h&&this.data.addMark(p,"list_item","",1,!0);var r=this._getItemHeight(p);if("list"==h){var v=0;this._isListBlocks()?v=this.type.listMarginY:c||(v=this.type.marginY);this.$xy[p]={totalWidth:k,start:l.start,width:this.type.width,height:r,
left:l.start+k/2-this.type.width/2+b,top:c?this.$xy[e[c-1]].top+this.$xy[e[c-1]].height+v+n:l.top+l.height+v};n=this.data.branch[p]?this._getBranchHeight(p):0}else this.$xy[p]={totalWidth:k,start:l.start+m,width:this.type.width,height:r,left:l.start+m+k/2-this.type.width/2,top:l.top+l.height+(a?this.type.marginY:0)};d+=this._toHTMLItem(q);m+=k}for(c=0;c<e.length;c++)p=e[c],this.data.branch[p]&&this.getItem(p).open?d+=this._renderBranch(p,b):g&&("list"!=g.$type?this._colHeight.push(this.$xy[p].top+
this.$xy[p].height):c==e.length-1&&this._colHeight.push(this.$xy[p].top+this.$xy[p].height));a=0;for(var t in this.$xy)q=this.$xy[t],a=Math.max(q.left+q.width,a);this._dataobj.style.width=a+this.type.padding+this.type.marginX/2+"px";"list"!=h||this._isListBlocks()||(d+=this.type.templateListEnd(g,this.type,f))}return d},_getBranchHeight:function(a){a=this.data.branch[a];for(var b=0,c=0;c<a.length;c++)b+=this._getItemHeight(a[c])+this.type.listMarginY,this.data.branch[a[c]]&&(b+=this._getBranchHeight(a[c]));
return b+this.type.marginY},_getItemHeight:function(a){var b=this.getItem(a),c=this.type.height;"function"==typeof c&&(c=c.call(b,this.type,this.data._marks[a]));this._hDiv||(this._hDiv=webix.html.create("div"),this._dataobj.appendChild(this._hDiv));this._hDiv.className=this.type.classname(b,this.type,this.data._marks[a]);this._hDiv.style.cssText="width:"+this.type.width+"px;height:"+c+("auto"==c?"":"px")+";";this._hDiv.innerHTML=this.type.template.call(this,b,this.type,this.data._marks[a]);return this._hDiv.scrollHeight},
_calcTotalWidth:function(){var a={},b=this.type.width,c=this.type.marginX;this.data.each(function(d){a[d.id]=b+c;if((d=this.getParentId(d.id))&&"list"!=this.getItem(d).$type)for(;d;){for(var e=this.branch[d],f=a[d]=0;f<e.length;f++)a[d]+=a[e[f]]||0;d=this.getParentId(d)}});return this._tw=a},getItemNode:function(a){if(this._htmlmap)return this._htmlmap[a];this._htmlmap={};for(var b=this._dataobj.childNodes,c=0;c<b.length;c++){var d=b[c].getAttribute(this._id);d&&(this._htmlmap[d]=b[c]);if(-1!=b[c].className.indexOf("webix_organogram_list")&&
!this._isListBlocks())for(var e=b[c].childNodes,f=0;f<e.length;f++)(d=e[f].getAttribute(this._id))&&(this._htmlmap[d]=e[f])}return this.getItemNode(a)},_toHTMLObject:function(a){this._html.innerHTML=this._toHTMLItem(a);return this._html.firstChild},render:function(a,b,c){if(this.isVisible(this._settings.id)&&!this.$blockRender)return webix.debug_render&&webix.log("Render: "+this.name+"@"+this._settings.id),"update"==c?(c=this.getItemNode(a),a=this._htmlmap[a]=this._toHTMLObject(b),webix.html.insertBefore(a,
c),webix.html.remove(c)):this.callEvent("onBeforeRender",[this.data])&&(this._calcTotalWidth(),this._htmlmap=null,this._dataobj.innerHTML=this._renderBranch(0),this._hDiv=null,this._dataobj.style.height=Math.max.apply(Math,this._colHeight)+this.type.padding+"px",this._renderCanvas(),this.resize(),this.callEvent("onAfterRender",[])),!0},_renderCanvas:function(){this.canvas&&this.canvas.clearCanvas(!0);this.canvas=new webix.Canvas({container:this._dataobj,name:this.name,title:this._settings.ariaLabel,
width:this._dataobj.offsetWidth,height:this._dataobj.offsetHeight});this._drawLines(0)},_drawLine:function(a,b,c,d,e,f,g){a.strokeStyle=f;a.lineCap="square";a.lineWidth=g;a.beginPath();a.moveTo(b,c);a.lineTo(d,e);a.stroke();a.lineWidth=1},_drawLines:function(a,b){var c,d,e;b||(b=this.canvas.getCanvas());if(this.$xy){a=a||0;var f=this.data.branch[a];var g=this.getItem(a);if(f&&f.length){var h=this.$xy[a];if(a){var k=parseInt(h.left+h.width/2,10)+.5;var l=parseInt(h.top+h.height,10);var m=parseInt(h.top+
h.height+this.type.marginY/2,10);if("list"==g.$type){if(!this._isListBlocks()){m=parseInt(h.top+h.height+this.type.marginY,10);this._drawLine(b,k,l,k,m,this.type.lineColor);return}}else this._drawLine(b,k,l,k,m,this.type.lineColor)}l=parseInt(h.top+h.height+this.type.marginY/2,10)+.5;for(c=0;c<f.length;c++)a&&(m=this.$xy[f[c]],"list"==g.$type&&this._isListBlocks()?(k=parseInt(h.left+this.type.listMarginX/2,10)+.5,c?c==f.length-1&&(e=k):d=k,m=parseInt(m.top+m.height/2,10),this._drawLine(b,k,l-this.type.marginY/
2,k,m,this.type.lineColor),this._drawLine(b,k,m,k+this.type.listMarginX/2,m,this.type.lineColor)):(k=parseInt(m.left+m.width/2,10)+.5,c?c==f.length-1&&(e=k):d=k,m=parseInt(m.top,10),this._drawLine(b,k,l,k,m,this.type.lineColor))),this.getItem(f[c]).open&&this._drawLines(f[c],b);a&&this._drawLine(b,d,l,e,l,this.type.lineColor)}}},$getSize:function(a,b){var c=this._settings.autowidth,d=this._settings.autoheight;c&&(a=this._dataobj.offsetWidth+(this._dataobj.offsetHeight>b&&!d?webix.ui.scrollSize:0));
d&&(b=this._dataobj.offsetHeight+(this._dataobj.offsetWidth>a&&!c?webix.ui.scrollSize:0));return webix.ui.view.prototype.$getSize.call(this,a,b)},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&(this._dataobj.style.width=this.$width+"px",this._dataobj.style.height=this.$height+"px",this.render())},type:{width:120,height:"auto",padding:20,marginX:20,marginY:20,listMarginX:0,listMarginY:0,lineColor:"#90caf9",classname:function(a,b,c){b="webix_organogram_item ";a.$css&&("object"==
typeof a.$css&&(a.$css=webix.html.createCss(a.$css)),b+=" "+a.$css);c&&c.list_item&&(b+=" webix_organogram_list_item ");c&&c.$css&&(b+=c.$css);return b+=" webix_organogram_level_"+a.$level},listClassName:function(a){var b="webix_organogram_list webix_organogram_list_"+a.$level;a.$listCss&&("object"==typeof a.$listCss&&(a.$listCss=webix.html.createCss(a.$listCss)),b+=" "+a.$listCss);return b},template:webix.template("#value#"),templateStart:function(a,b,c){var d="";if((!c||!c.list_item||b.listMarginX||
b.listMarginY)&&this.$xy){var e=this.$xy[a.id];d+="width: "+e.width+"px; height: "+e.height+"px;";d+="top: "+e.top+"px; left: "+e.left+"px;"}return'<div webix_dg_id="'+a.id+'" class="'+b.classname.call(this,a,b,c)+'"'+(d?'style="'+d+'"':"")+'">'},templateEnd:webix.template("</div>"),templateListStart:function(a,b,c){var d="";if(this.$xy){var e=this.$xy[a.id];d+="width: "+e.width+"px;";d+="top: "+(e.top+e.height+b.marginY)+"px; left: "+e.left+"px;"}return'<div class="'+b.listClassName.call(this,a,
b,c)+'"'+(d?'style="'+d+'"':"")+'">'},templateListEnd:webix.template("</div>")}},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.DataMarks,webix.SelectionModel,webix.MouseEvents,webix.Scrollable,webix.RenderStack,webix.TreeDataLoader,webix.DataLoader,webix.ui.view,webix.EventSystem);
webix.protoUI({name:"barcode",defaults:{type:"ean13",height:160,width:220,paddingY:10,paddingX:20,textHeight:20,color:"#000",ariaLabel:"bars"},$init:function(){this.$view.className+=" webix_barcode";this.types||(this.types={"default":this.type},this.type.name="default")},type:{},render:function(){this.isVisible(this._settings.id)&&(this.canvas&&this.canvas.clearCanvas(!0),this.$view.innerHTML="",this._renderCanvas())},_renderCanvas:function(){this.canvas=new webix.Canvas({container:this.$view,name:this.name,
title:this._settings.ariaLabel,width:this.$width,height:this.$height});this._drawBars()},_drawBars:function(){var a,b=this._settings.value;var c=this._settings.type;if(!c||!this.types[c]||!b)return!1;c=this.type.encode(b);var d=c.length;var e=this.canvas.getCanvas();if(d){var f=(this.$width-2*this.config.paddingX)/d,g=0;for(a=0;a<d;a++)parseInt(c.charAt(a),10)?(g++,a==d-1&&this._drawBar(e,a+1,f,g,d)):g&&(this._drawBar(e,a,f,g,d),g=0);this._addText(b,f)}},_drawBar:function(a,b,c,d,e){var f=parseInt(b*
c+this.config.paddingX,10);c=parseInt(f-d*c,10);d=this.config.paddingY;var g=this.$height-this.config.paddingY-this.config.textHeight;this._isEAN()&&(4>b||b>e-4||b<e/2+2&&b>e/2-2)&&(g+=this.config.textHeight/2);a.fillStyle=this.config.color;a.beginPath();a.moveTo(c,d);a.lineTo(f,d);a.lineTo(f,g);a.lineTo(c,g);a.lineTo(c,d);a.fill()},_addText:function(a,b){var c;this.type.template&&(a=this.type.template(a));if(this._isEAN()){this.type.firstDigit&&(this.canvas.renderTextAt(!0,"left",this.config.paddingX,
this.$height-this.config.paddingY,a.charAt(0)),a=a.slice(1));var d=a.length;this.type.lastDigit&&d--;if(d){var e=(this.$width-2*this.config.paddingX-11*b)/d;for(c=0;c<d;c++){var f=this.config.paddingX+c*e+(c<d/2?3:8)*b+e/2;this.canvas.renderTextAt(!0,!0,f,this.$height-this.config.paddingY,a.charAt(c))}this.type.lastDigit&&(f=this.config.paddingX+d*e+11*b,this.canvas.renderTextAt(!0,!1,f,this.$height-this.config.paddingY,a.charAt(d)))}}else this.canvas.renderTextAt(!0,!0,this.$width/2,this.$height-
this.config.paddingY,a)},setValue:function(a){this._settings.value=a;this.render();return a},getValue:function(){var a=this._settings.value;return this.type.template?this.type.template(a):a},type_setter:function(a){this.types[a]?(this.type=webix.clone(this.types[a]),this.type.css&&(this._contentobj.className+=" "+this.type.css)):this.customize(a);return a},_isEAN:function(){var a=this.config.type;return 0===a.indexOf("ean")||-1!=a.indexOf("upcA")},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,
a,b)&&this.render()}},webix.ui.view);
webix.type(webix.ui.barcode,{name:"ean8",encodings:[["0001101","1110010"],["0011001","1100110"],["0010011","1101100"],["0111101","1000010"],["0100011","1011100"],["0110001","1001110"],["0101111","1010000"],["0111011","1000100"],["0110111","1001000"],["0001011","1110100"]],encode:function(a){var b;a=a.replace(/[^0-9]/g,"").substring(0,7);if(7!=a.length)return"";a+=this.checksum(a);var c="101";for(b=0;4>b;b++)c+=this.encodings[parseInt(a.charAt(b),10)][0];c+="01010";for(b=4;8>b;b++)c+=this.encodings[parseInt(a.charAt(b),
10)][1];return c+"101"},template:function(a){return a.replace(/[^0-9]/g,"").substring(0,7)+this.checksum(a)},checksum:function(a){a=a.substring(0,7);var b,c=!0,d=0;for(b=0;7>b;b++)d+=(c?3:1)*parseInt(a.charAt(b),10),c=!c;return((10-d%10)%10).toString()}});
webix.type(webix.ui.barcode,{name:"ean13",firstDigit:!0,encodings:[["0001101","0100111","1110010","000000"],["0011001","0110011","1100110","001011"],["0010011","0011011","1101100","001101"],["0111101","0100001","1000010","001110"],["0100011","0011101","1011100","010011"],["0110001","0111001","1001110","011001"],["0101111","0000101","1010000","011100"],["0111011","0010001","1000100","010101"],["0110111","0001001","1001000","010110"],["0001011","0010111","1110100","011010"]],encode:function(a){var b;
a=a.replace(/[^0-9]/g,"").substring(0,12);if(12!=a.length)return"";a+=this.checksum(a);var c="101";var d=this.encodings[parseInt(a.charAt(0),10)][3];for(b=1;7>b;b++)c+=this.encodings[parseInt(a.charAt(b),10)][parseInt(d.charAt(b-1),10)];c+="01010";for(b=7;13>b;b++)c+=this.encodings[parseInt(a.charAt(b),10)][2];return c+"101"},template:function(a){return a.replace(/[^0-9]/g,"").substring(0,12)+this.checksum(a)},checksum:function(a){var b,c=!1,d=0;a=a.substring(0,12);for(b=0;12>b;b++)d+=(c?3:1)*parseInt(a.charAt(b),
10),c=!c;return((10-d%10)%10).toString()}});webix.type(webix.ui.barcode,{name:"upcA",firstDigit:!0,lastDigit:!0,encode:function(a){12>a.length&&(a="0"+a);return webix.ui.barcode.prototype.types.ean13.encode(a)},template:function(a){return a.replace(/[^0-9]/g,"").substring(0,11)+this.checksum(a)},checksum:function(a){12>a.length&&(a="0"+a);return webix.ui.barcode.prototype.types.ean13.checksum(a)}});
webix.protoUI({name:"abslayout",$init:function(){this.$view.className+=" webix_abslayout";delete this.rows_setter;delete this.cols_setter;this._collection=[]},cells_setter:function(a){this._collection=a},_parse_cells:function(){webix.ui.baselayout.prototype._parse_cells.call(this,this._collection)},$getSize:function(a,b){a=webix.ui.baseview.prototype.$getSize.call(this,0,0);b=null;for(var c=0;c<this._cells.length;c++)this._cells[c]._settings.relative&&(b=this._cells[c].$getSize(0,0));b&&(1E5<=a[1]&&
(a[1]=0),1E5<=a[3]&&(a[3]=0),a[0]=Math.max(a[0],b[0]),a[1]=Math.max(a[1],b[1]),a[2]=Math.max(a[2],b[2]),a[3]=Math.max(a[3],b[3]));return a},$setSize:function(a,b){this._layout_sizes=[a,b];webix.debug_size_box_start(this);webix.ui.baseview.prototype.$setSize.call(this,a,b);this._set_child_size(a,b);webix.debug_size_box_end(this,[a,b])},_set_child_size:function(a,b){for(var c=0;c<this._cells.length;c++){var d=this._cells[c],e=d._settings;e.relative&&(e.left=e.top=0,e.width=a,e.height=b);var f=d.$getSize(0,
0);d.$setSize(f[0],f[2]);d=d.$view;f=["left","right","top","bottom"];for(var g=0;g<f.length;g++){var h=f[g];h in e&&(d.style[h]=e[h]+"px")}}}},webix.ui.baselayout);
webix.protoUI({name:"datalayout",$init:function(){this.data.provideApi(this,!0);this.data.attachEvent("onStoreUpdated",webix.bind(this.render,this))},_parse_cells:function(a){this._origin_cells||(this._origin_cells=this._collection,this._collection=[{}]);return webix.ui.layout.prototype._parse_cells.call(this,this._collection)},setValue:function(a){this.parse(a)},getValue:function(a){a=this._origin_cells.length;for(var b=0;b<this._cells.length;b++){var c=this.data.getItem(this.data.order[Math.floor(b/
a)]);this._save_data(this._cells[b],c)}return this.data.serialize()},_save_data:function(a,b){var c=a._settings.name;if(c){var d=null;a.getValues?d=a.getValues():a.getValue?d=a.getValue():a.serialize&&(d=a.serialize());"$value"==c?webix.extend(b,d,!0):b[c]=d}else if(a=a._cells)for(c=0;c<a.length;c++)this._save_data(a[c],b)},_fill_data:function(a,b){var c=a._settings.name;if(c)b="$value"==c?b:b[c],a.setValues?a.setValues(b):a.setValue?a.setValue(b):a.parse&&(a.openAll&&(b=webix.copy(b)),a.parse(b));
else if(a=a._cells)for(c=0;c<a.length;c++)this._fill_data(a[c],b)},render:function(a,b,c){var d=this._origin_cells.length;if(a&&"update"===c)for(b=this.getItem(a),c=this.getIndexById(a),a=0;a<d;a++)this._fill_data(this._cells[c*d+a],b);else{var e=this._collection=[];b=this.data.order;for(a=0;a<b.length;a++)if(d)for(c=0;c<d;c++)e.push(webix.copy(this._origin_cells[c]));else e.push(this.getItem(b[a]));e.length||e.push({});this.reconstruct();if(d)for(a=0;a<b.length;a++)for(e=this.getItem(b[a]),c=0;c<
d;c++)this._fill_data(this._cells[a*d+c],e)}}},webix.DataLoader,webix.ui.layout);webix.protoUI({$init:function(){webix.extend(this,webix.FlexLayout,!0)},name:"flexdatalayout"},webix.ui.datalayout);
webix.protoUI({name:"gridlayout",defaults:{gridColumns:2,gridRows:2,margin:10,padding:10},gridRows_setter:function(a){return this._actual_rows=a},_parse_cells:function(){for(var a=0;a<this._collection.length;a++)this._collection[a]._inner={};webix.ui.baselayout.prototype._parse_cells.call(this,this._collection)},removeView:function(a){webix.ui.abslayout.prototype.removeView.call(this,a);this._do_compact();this.callEvent("onChange",[])},_check_default_pos:function(a){a.dx=a.dx||1;a.dy=a.dy||1;if(webix.isUndefined(a.y)||
webix.isUndefined(a.x)){for(var b=this._buildMatrix(),c=0;c<this._actual_rows;c++)for(var d=0;d<this._settings.gridColumns;d++)if(!b[d][c]&&this._isFree(b,d,c,d+a.dx,c+a.dy)){a.x=d;a.y=c;return}a.x=0;a.y=this._actual_rows}b=a.x+a.dx-this._settings.gridColumns;0<b&&(a.dx-=b)},_replace:function(a,b){this._check_default_pos(a.config);this._cells.push(a);a._parent_cell=this;this.$view.appendChild(a._viewobj);this._reserveSpace(a.config,a.config.id);this._silent||this.callEvent("onChange",[])},_isFree:function(a,
b,c,d,e){for(;b<d;b++)for(var f=c;f<e;f++)if(!a[b]||a[b][f])return!1;return!0},_markMatrix:function(a,b,c){for(var d=0;d<b.dx;d++)for(var e=0;e<b.dy;e++)a[d+b.x][e+b.y]=c},_canMoveRight:function(a,b,c){var d=this._settings.gridColumns;for(b=b.x+b.dx;b+c.dx<=d;b++)if(this._isFree(a,b,c.y,b+c.dx,c.y+c.dy))return b-c.x;return 0},_canMoveLeft:function(a,b,c){for(b=b.x-c.dx;0<=b;b--)if(this._isFree(a,b,c.y,b+c.dx,c.y+c.dy))return c.x-b;return 0},_canMoveTop:function(a,b,c){for(b=b.y-c.dy;0<=b;b--)if(this._isFree(a,
c.x,b,c.x+c.dx,b+c.dy))return c.y-b;return 0},_buildMatrix:function(a){for(var b=[],c=0;c<this._settings.gridColumns;c++)b[c]=[];for(c=0;c<this._cells.length;c++){var d=this._cells[c].config;d.id!==a&&this._markMatrix(b,d,d.id)}return b},_do_compact:function(){this._compact()&&this._apply_new_grid()},_compact:function(){var a=this._settings.gridColumns,b=this._actual_rows,c=this._buildMatrix(),d=!1;--b;a:for(;0<=b;b--){for(var e=a-1;0<=e;e--)if(c[e][b])continue a;d=!0;for(e=0;e<this._cells.length;e++){var f=
this._cells[e].config;f.y>=b&&--f.y}}return d},_reserveSpace:function(a,b,c){a.x-=Math.max(0,a.x+a.dx-this._settings.gridColumns);for(var d=[],e=this._buildMatrix(b),f=0;f<this._cells.length;f++){var g=this._cells[f].config;g.id!==b&&g.y<a.y+a.dy&&g.y+g.dy>a.y&&g.x<a.x+a.dx&&g.x+g.dx>a.x&&d.push(g)}b=[];for(f=0;f<d.length;f++){g=d[f];this._markMatrix(e,g,0);var h=this._canMoveRight(e,a,g);h?g.x+=h:(h=this._canMoveLeft(e,a,g))?g.x-=h:(h=this._canMoveTop(e,a,g))?g.y-=h:(g.y=a.y+a.dy,b.push(g));this._markMatrix(e,
g,g.id)}for(f=0;f<b.length;f++)this._reserveSpace(b[f],b[f].id,!0);c||(this._compact(),this._apply_new_grid())},_apply_new_grid:function(){for(var a=this._settings.gridRows,b=0;b<this._cells.length;b++){var c=this._cells[b].config;a=Math.max(a,c.y+c.dy)}this._actual_rows!=a&&(this._actual_rows=a,this.resize());this._set_child_size()},moveView:function(a,b){b=webix.extend(webix.$$(a).config,b,!0);this._reserveSpace(b,a);this.callEvent("onChange",[])},serialize:function(a){for(var b=[],c=0;c<this._cells.length;c++)if(a)b.push(a.call(this,
this._cells[c]));else{var d=this._cells[c].config;b.push({id:d.id,name:d.name,x:d.x,y:d.y,dx:d.dx,dy:d.dy})}return b},clearAll:function(){for(var a=0;a<this._cells.length;a++)this._cells[a].destructor();this._cells=[]},restore:function(a,b){b=b||this._settings.factory;a=webix.copy(a);this._silent=!0;for(var c={},d=0;d<a.length;d++){var e=a[d],f=webix.$$(e.id);f?(webix.extend(f.config,e,!0),e=f.config.id):(f=b.call(this,e),e=this.addView(f));c[e]=1}for(d=this._cells.length-1;0<=d;d--)c[this._cells[d].config.id]||
(this._cells[d].destructor(),this._cells.splice(d,1));this._apply_new_grid();this._silent=!1},$getSize:function(a,b){a=webix.ui.baseview.prototype.$getSize.call(this,0,0);for(b=0;b<this._cells.length;b++)this._cells[b].$getSize(0,0);b=this._settings.cellWidth;var c=this._settings.cellHeight,d=this._getActualSize(0,0,this._settings.gridColumns,this._actual_rows);b&&(a[0]=d.dx+2*d.x);c&&(a[2]=d.dy+2*d.y);return a},_getActualSize:function(a,b,c,d){var e=this._settings.margin,f=this._settings.paddingX||
this._settings.padding,g=this._settings.paddingY||this._settings.padding,h=this._settings.cellWidth;h||(h=(this.$width-2*f+e)/this._settings.gridColumns-e);var k=this._settings.cellHeight;k||(k=(this.$height-2*g+e)/this._actual_rows-e);return{x:f+(h+e)*a,y:g+(k+e)*b,dx:Math.ceil(h+(h+e)*(c-1)),dy:Math.ceil(k+(k+e)*(d-1))}},_set_child_size:function(a,b){for(a=0;a<this._cells.length;a++){b=this._cells[a];var c=b._settings;c=this._getActualSize(c.x,c.y,c.dx,c.dy);b.$getSize(0,0);b.$setSize(c.dx,c.dy);
b=b.$view;b.style.left=c.x+"px";b.style.top=c.y+"px"}}},webix.ui.abslayout);
webix.protoUI({name:"dashboard",$init:function(){webix.DragControl.addDrag(this.$view,this);webix.DragControl.addDrop(this.$view,this,!0)},_isDragNode:function(a){return!a.getAttribute||a.getAttribute("webix_disable_drag")?!1:-1!=(a.className||"").indexOf("panel_drag")?a:a.parentNode&&a!=this.$view?this._isDragNode(a.parentNode):!1},$dragCreate:function(a,b){if(b.target){if(!this._isDragNode(b.target))return!1;a=webix.$$(b);a.$resizeMove||(a=a.queryView(function(a){return!!a.config.dx},"parent"));
var c=webix.html.offset(this.$view);b=webix.html.pos(b);webix.DragControl._drag_context={source:a,from:this,dashboard:{sx:b.x-c.x-parseInt(a.$view.style.left)+this._settings.margin/2,sy:b.y-c.y-parseInt(a.$view.style.top)+this._settings.margin/2}};this._addDragMarker(a._settings.dx,a._settings.dy);return a.$view}},_addDragMarker:function(a,b){var c=this._dragMarker=webix.html.create("div",{"class":"panel_target"});a=this._getActualSize(0,0,a,b);c.style.width=a.dx+"px";c.style.height=a.dy+"px";this.$view.appendChild(this._dragMarker)},
$drop:function(a,b){a=webix.DragControl._drag_context;b={x:a.dashboard.x,y:a.dashboard.y};a.from===this?this.moveView(a.source.config.id,b):(b.name=a.source[0],b.dx=a.dashboard.dx,b.dy=a.dashboard.dy,b.id=b.name+":"+webix.uid(),b=this._settings.factory.call(this,b),this.addView(b))},$dragDestroy:function(a,b,c){b.style.zIndex=1;webix.html.remove(this._dragMarker);this._dragMarker=null;this._apply_new_grid()},_getPosFromCoords:function(a,b){var c=this._settings.margin,d=this._settings.paddingX||this._settings.padding,
e=this._settings.paddingY||this._settings.padding,f=this._settings.cellWidth;f||(f=(this.$width-2*d+c)/this._settings.gridColumns-c);var g=this._settings.cellHeight;g||(g=(this.$height-2*e+c)/this._actual_rows-c);a=Math.round(-.2+(a-d)/(f+c/2));b=Math.round(-.2+(b-d)/(g+c/2));a=Math.max(0,Math.min(a,this._settings.gridColumns));b=Math.max(0,Math.min(b,this._actual_rows));return{x:a,y:b,width:f,height:g,margin:c,rx:a*f+c*a+d,ry:b*g+c*b+e}},$dragOut:function(){var a=webix.DragControl._drag_context;
this._dragMarker&&a.external&&(webix.html.remove(this._dragMarker),this._dragMarker=null)},$dragIn:function(a,b,c){a=webix.DragControl._drag_context;this._dragMarker||(a.external=!0,b=a.from.getItem(a.source),a.dashboard={dx:b.dx,dy:b.dy},this._addDragMarker(b.dx,b.dy));if(a.external){b=this._dragMarker;c=webix.env.mouse.context(c);var d=webix.html.offset(this.$view);c=this._getPosFromCoords(c.x-d.x,c.y-d.y);webix.extend(a.dashboard,c,!0);b.style.left=c.rx+"px";b.style.top=c.ry+"px"}return!0},$dragPos:function(a,
b,c){var d=webix.DragControl._drag_context;c.style.left="-10000px";b=webix.env.mouse.context(b);c=webix.html.offset(this.$view);d=d.dashboard;var e=this._getPosFromCoords(b.x-c.x-d.sx,b.y-c.y-d.sy);a.x=b.x-d.sx-c.x;a.y=b.y-d.sy-c.y;a=this._dragMarker;a.style.left=e.rx+"px";a.style.top=e.ry+"px";webix.extend(d,e,!0)}},webix.ui.gridlayout);
webix.protoUI({name:"panel",$init:function(a){if(a.header&&a.body){var b=a.header;"object"!==typeof b&&(b={template:a.header,type:"header",css:"webix_header"});a.body=[b,a.body]}webix.html.addCss(this.$view,"panel_drag_view");this.$ready.push(this._init_drag_area)},_init_drag_area:function(){var a=this.getChildViews();a=1===a.length?this:a[1];if(this._settings.icon){var b=webix.html.create("div",{"class":"panel_icon"},"<span class='webix_icon fa-"+this._settings.icon+" panel_icon_span'></span>");
a.$view.appendChild(b)}},body_setter:function(a){return this.rows_setter(webix.isArray(a)?a:[a])},$resizeEnd:function(a){var b=this.getParentView();b&&b._getPosFromCoords&&(a=b._getPosFromCoords(a.x,a.y),b.moveView(this._settings.id,{dx:Math.max(a.x,1),dy:Math.max(a.y,1)}))},$resizeMove:function(a){var b=this.getParentView();b&&b._getPosFromCoords&&(b=b._getPosFromCoords(a.x,a.y),a.x=b.width*b.x+b.margin*(b.x-1),a.y=b.height*b.y+b.margin*(b.y-1))}},webix.ui.layout,webix.ResizeArea);
webix.protoUI({name:"video",$init:function(a){a.id||(a.id=webix.uid());this.$ready.push(this._init_video)},_init_video:function(){var a=this._settings;this._contentobj=webix.html.create("video",{"class":"webix_view_video",style:"width:100%;height:100%;",autobuffer:"autobuffer"},"");a.poster&&(this._contentobj.poster=a.poster);if(a.src){"object"!=typeof a.src&&(a.src=[a.src]);for(var b=0;b<a.src.length;b++)this._contentobj.innerHTML+=' <source src="'+a.src[b]+'">'}a.controls&&(this._contentobj.controls=
!0);a.autoplay&&(this._contentobj.autoplay=!0);this._viewobj.appendChild(this._contentobj)},getVideo:function(){return this._contentobj},defaults:{src:"",controls:!0}},webix.ui.view);
webix.protoUI({name:"sidemenu",defaults:{animate:!0,position:"left",width:200,borderless:!0},$init:function(){this.$view.className+=" webix_sidemenu"},$skin:function(){this.defaults.padding=0},position_setter:function(a){var b=this._settings.position;b&&webix.html.removeCss(this.$view," webix_sidemenu_"+b);webix.html.addCss(this.$view," webix_sidemenu_"+a);return a},$getSize:function(){var a=webix.ui.window.prototype.$getSize.apply(this,arguments);return this._desired_sizes=a},$setSize:function(a,
b){webix.ui.view.prototype.$setSize.call(this,a,b);a=this._content_width-2*this._settings.padding;b=this._content_height-2*this._settings.padding;this._contentobj.style.padding=this._settings.padding+"px";this._headobj.style.display="none";this._bodyobj.style.height=b+"px";this._body_cell.$setSize(a,b)},show:function(){if(!this.callEvent("onBeforeShow",arguments))return!1;this._settings.hidden=!1;this._viewobj.style.zIndex=this._settings.zIndex||webix.ui.zIndex();if(this._settings.modal||this._modal)this._modal_set(!0),
this._modal=null;this._viewobj.style.display="block";this._render_hidden_views();this._settings.position&&this._setPosition();this._hide_timer=1;webix.delay(function(){this._hide_timer=0},this,[],webix.env.touch?400:100);this.config.autofocus&&(this._prev_focus=webix.UIManager.getFocus(),webix.UIManager.setFocus(this));-1==webix.ui._popups.find(this)&&webix.ui._popups.push(this);this.callEvent("onShow",[])},_setPosition:function(a){var b=0,c=0,d={};this.$view.style.position="fixed";var e=window.innerWidth||
document.documentElement.offsetWidth;var f=window.innerHeight||document.documentElement.offsetHeight;var g=this._desired_sizes[0]||e;var h=this._desired_sizes[2]||f;webix.assert(g&&h,"Attempt to show not rendered window");var k=this._settings.position;"top"==k?g=e:"right"==k?(h=f,b=e-g):"bottom"==k?(g=e,c=f-h):h=f;d={left:b,top:c,width:g,height:h,maxWidth:e,maxHeight:f};"function"==typeof this._settings.state&&this._settings.state.call(this,d);this._state=d;this.$setSize(d.width,d.height);"undefined"==
typeof a&&this._isAnimationSupported()?(webix.html.removeCss(this.$view,"webix_animate",!0),this._animate[this._settings.position].beforeShow.call(this,d),webix.delay(function(){webix.html.addCss(this.$view,"webix_animate",!0)},this,null,1),webix.delay(function(){this._animate[this._settings.position].show.call(this,d)},this,null,10)):this.setPosition(d.left,d.top)},_isAnimationSupported:function(){return webix.animate.isSupported()&&this._settings.animate&&!(webix.env.isIE&&-1!=navigator.appVersion.indexOf("MSIE 9"))},
hidden_setter:function(a){a?this.hide(!0):this.show();return!!a},_animate:{left:{beforeShow:function(a){this.$view.style.left=-a.width+"px";this.$view.style.top=a.top+"px"},show:function(){this.$view.style.left="0px"},hide:function(a){this.$view.style.left=-a.width+"px"}},right:{beforeShow:function(a){this.$view.style.left="auto";this.$view.style.right=-a.width+"px";this.$view.style.top=a.top+"px"},show:function(){this.$view.style.right="0px"},hide:function(a){this.$view.style.right=-a.width+"px"}},
top:{beforeShow:function(a){this.setPosition(a.left,a.top);this.$view.style.height="0px";this._bodyobj.style.height="0px"},show:function(a){this.$view.style.height=a.height+"px";this._bodyobj.style.height=a.height+"px"},hide:function(){this.$view.style.height="0px";this._bodyobj.style.height="0px"}},bottom:{beforeShow:function(a){this.$view.style.left=a.left+"px";this.$view.style.top="auto";this.$view.style.bottom=(a.bottom!=webix.undefined?a.bottom:a.maxHeight-a.top-a.height)+"px";this.$view.style.height=
"0px"},show:function(a){this.$view.style.height=a.height+"px"},hide:function(){this.$view.style.height="0px"}}},hide:function(a){if(!this.$destructed){this._settings.modal&&this._modal_set(!1);var b=window.innerWidth||document.documentElement.offsetWidth,c=window.innerHeight||document.documentElement.offsetHeight;if(!a&&this._isAnimationSupported()&&b==this._state.maxWidth&&c==this._state.maxHeight){this._animate[this._settings.position].hide.call(this,this._state);var d=webix.event(this.$view,webix.env.transitionEnd,
webix.bind(function(a){this._hide_callback();webix.eventRemove(d)},this))}else this._hide_callback();this._settings.autofocus&&(a=document.activeElement)&&this._viewobj&&this._viewobj.contains(a)&&(webix.UIManager.setFocus(this._prev_focus),this._prev_focus=null);this._hide_sub_popups()}}},webix.ui.popup);
(function(){var a=webix.CustomScroll={scrollStep:40,init:function(){this._init_once();webix.env.$customScroll=!0;webix.ui.scrollSize=0;webix.destructors.push({obj:{destructor:function(){this._last_active_node=null}}});webix.attachEvent("onReconstruct",a._on_reconstruct);webix.attachEvent("onResize",a._on_reconstruct);webix.attachEvent("onClick",a._on_reconstruct)},resize:function(){this._on_reconstruct()},_enable_datatable:function(b){b._body._custom_scroll_view=b._settings.id;b.attachEvent("onAfterRender",
function(){var b=a._get_datatable_sizes(this),d=Math.max(b.dy-b.py,0);b=Math.max(b.dx-b.px,0);this._y_scroll&&this._scrollTop>d?this._y_scroll.scrollTo(d):this._x_scroll&&this._scrollLeft>b&&this._x_scroll.scrollTo(b);a._last_active_node==this._body&&a._on_reconstruct()});webix._event(b._body,"mouseover",a._mouse_in);webix._event(b._body,"mouseout",a._mouse_out)},enable:function(b,c){a._init_once();if(b.mapCells)return this._enable_datatable(b);var d=b;b._dataobj&&(d=b._dataobj.parentNode);d._custom_scroll_mode=
c||"xy";webix._event(d,"mouseover",a._mouse_in);webix._event(d,"mouseout",a._mouse_out);webix._event(d,"mousewheel",a._mouse_wheel);webix._event(d,"DOMMouseScroll",a._mouse_wheel);this._setDataHandler(b)},_on_reconstruct:function(){var b=a._last_active_node;b&&b._custom_scroll_size&&(a._mouse_out_timed.call(b),a._mouse_in.call(b))},_init_once:function(b){webix.event(document.body,"mousemove",function(b){a._active_drag_area&&a._adjust_scroll(a._active_drag_area,a._active_drag_area._scroll_drag_pos,
webix.html.pos(b))});a._init_once=function(){}},_mouse_in:function(b){a._last_active_node=this;clearTimeout(this._mouse_out_timer);if(!this._custom_scroll_size&&!a._active_drag_area){if(this._custom_scroll_view){b=webix.$$(this._custom_scroll_view);if(!b)return;b=a._get_datatable_sizes(b)}else b={dx:this.scrollWidth,dy:this.scrollHeight,px:this.clientWidth,py:this.clientHeight},b._scroll_x=b.dx>b.px&&-1!=this._custom_scroll_mode.indexOf("x"),b._scroll_y=b.dy>b.py&&-1!=this._custom_scroll_mode.indexOf("y");
this._custom_scroll_size=b;b._scroll_x&&(b._scroll_x_node=a._create_scroll(this,"x",b.dx,b.px,"width","height"),b._sx=b.px-b._scroll_x_node.offsetWidth-4,b._vx=b.dx-b.px,a.trackBar&&(b._bar_x=a._create_bar(this,"x")));b._scroll_y&&(b._scroll_y_node=a._create_scroll(this,"y",b.dy,b.py,"height","width"),b._sy=b.py-b._scroll_y_node.offsetHeight-4,b._vy=b.dy-b.py,a.trackBar&&(b._bar_y=a._create_bar(this,"y")));a._update_scroll(this)}},_create_bar:function(a,c){c=webix.html.create("DIV",{webixignore:"1",
"class":"webix_c_scroll_bar_"+c},"");a.appendChild(c);return c},_adjust_scroll:function(b,c,d){var e=b._custom_scroll_size,f=b._custom_scroll_view;f&&(f=webix.$$(f));if(e._scroll_x_node==b._scroll_drag_enabled){var g=(d.x-c.x)*e._vx/e._sx;f?f._x_scroll.scrollTo(f._scrollLeft+g):a._set_scroll_value(b,"scrollLeft",g)}e._scroll_y_node==b._scroll_drag_enabled&&(g=(d.y-c.y)*e._vy/e._sy,f?f._y_scroll.scrollTo(f._scrollTop+g):a._set_scroll_value(b,"scrollTop",g));b._scroll_drag_pos=d;a._update_scroll(b)},
_get_datatable_sizes:function(a){var b={};a._x_scroll&&a._settings.scrollX&&(b.dx=a._x_scroll._settings.scrollWidth,b.px=a._x_scroll._last_set_size||1,b._scroll_x=1<b.dx-b.px);a._y_scroll&&a._settings.scrollY&&(b.dy=a._y_scroll._settings.scrollHeight,b.py=a._y_scroll._last_set_size||1,b._scroll_y=1<b.dy-b.py);return b},_mouse_out:function(){clearTimeout(this._mouse_out_timer);this._mouse_out_timer=webix.delay(a._mouse_out_timed,this,[],200)},_removeScroll:function(a){a&&(webix.html.remove(a),a._webix_event_sc1&&
(webix.eventRemove(a._webix_event_sc1),webix.eventRemove(a._webix_event_sc2)))},_mouse_out_timed:function(){if(this._custom_scroll_size)if(this._scroll_drag_enabled)this._scroll_drag_released=!0;else{var b=this._custom_scroll_size;a._removeScroll(b._scroll_x_node);a._removeScroll(b._scroll_y_node);webix.html.removeCss(document.body,"webix_noselect");b._bar_x&&webix.html.remove(b._bar_x);b._bar_y&&webix.html.remove(b._bar_y);this._custom_scroll_size=null}},_mouse_wheel:function(b){var c=this._custom_scroll_size,
d=b.wheelDelta/-40,e=!0;!d&&b.detail&&webix.isUndefined(b.wheelDelta)&&(d=b.detail);c&&(c._scroll_x_node&&(b.wheelDeltaX||d&&!c._scroll_y_node)?e=a._set_scroll_value(this,"scrollLeft",(b.wheelDeltaX/-40||d)*a.scrollStep):d&&c._scroll_y_node&&(e=a._set_scroll_value(this,"scrollTop",d*a.scrollStep)));a._update_scroll(this);if(!1!==e)return webix.html.preventEvent(b)},_set_scroll_value:function(b,c,d){var e=b._custom_scroll_size;e="scrollLeft"==c?e.dx-e.px:e.dy-e.py;var f=b[c];f+d>e&&(d=e-f);if(!d||
0>f+d&&0===f)return!1;webix.env.isIE&&a._update_scroll(b,c,d+f);b[c]+=d;return!0},_create_scroll:function(b,c,d,e,f,g){c=webix.html.create("DIV",{webixignore:"1","class":"webix_c_scroll_"+c},"<div></div>");c.style[f]=Math.max(e*e/d-7,40)+"px";b.style.position="relative";b.appendChild(c);b._webix_event_sc1=webix.event(c,"mousedown",a._scroll_drag(b));b._webix_event_sc2=webix.event(document.body,"mouseup",webix.bind(a._scroll_drop,b));return c},_scroll_drag:function(b){return function(c){webix.html.addCss(document.body,
"webix_noselect",1);this.className+=" webix_scroll_active";a._active_drag_area=b;b._scroll_drag_enabled=this;b._scroll_drag_pos=webix.html.pos(c)}},_scroll_drop:function(b){this._scroll_drag_enabled&&(webix.html.removeCss(document.body,"webix_noselect"),this._scroll_drag_enabled.className=this._scroll_drag_enabled.className.toString().replace(" webix_scroll_active",""),this._scroll_drag_enabled=!1,a._active_drag_area=0,this._scroll_drag_released&&(a._mouse_out_timed.call(this),this._scroll_drag_released=
!1))},_update_scroll:function(a,c,d){var b=a._custom_scroll_size;if(b&&(b._scroll_x_node||b._scroll_y_node)){var f=a._custom_scroll_view,g="scrollLeft"==c?d:a.scrollLeft;g=f?webix.$$(f)._scrollLeft:g;var h=f?0:g;a="scrollTop"==c?d:a.scrollTop;a=f?webix.$$(f)._scrollTop:a;f=f?0:a;b._scroll_x_node&&(b._scroll_x_node.style.bottom=1-f+"px",b._scroll_x_node.style.left=Math.round(b._sx*g/(b.dx-b.px))+h+1+"px",b._bar_x&&(b._bar_x.style.bottom=1-f+"px",b._bar_x.style.left=h+"px"));b._scroll_y_node&&(b._scroll_y_node.style.right=
0-h+"px",b._scroll_y_node.style.top=Math.round(b._sy*a/(b.dy-b.py))+f+1+"px",b._bar_y&&(b._bar_y.style.right=0-h+"px",b._bar_y.style.top=f+"px"))}},_setDataHandler:function(b){b.data&&b.data.attachEvent&&b.data.attachEvent("onStoreUpdated",function(){var c=a._last_active_node;c&&b.$view.contains(c)&&a.resize()})}}})();
webix.protoUI({name:"portlet",defaults:{layoutType:"wide",icon:"bars"},$init:function(a){this._viewobj.style.position="relative";a.header&&a.body&&(a.body=[{template:a.header,type:"header"},a.body]);this.$ready.push(this._init_drag_area);webix.attachEvent("onAfterPortletMove",this._refreshChildScrolls)},_refreshChildScrolls:function(a){webix.ui.each(a,function(a){a._restore_scroll_state&&a._restore_scroll_state()})},_init_drag_area:function(){var a=this.getChildViews();1<a.length?webix.DragControl.addDrag(a[0].$view,
this):this._settings.icon?(a=webix.html.create("div",{"class":"portlet_drag"},"<span class='webix_icon fa-"+this._settings.icon+"'></span>"),this._viewobj.appendChild(a),webix.DragControl.addDrag(a,this)):webix.DragControl.addDrag(this.$view,this)},body_setter:function(a){return this.rows_setter(webix.isArray(a)?a:[a])},markDropArea:function(a,b){if(!a)return webix.html.remove(this._markerbox);a=webix.$$(a);this._markerbox||(this._markerbox=webix.html.create("div",null,"&nbsp;"));a.$view.appendChild(this._markerbox);
this._markerbox.className="portlet_marker"+b},movePortlet:function(a,b){var c=a.getParentView(),d=this.getParentView(),e=c.index(a),f=d.index(this);if(webix.callEvent("onBeforePortletMove",[d,c,this,a,b])){webix.ui._freeze_resize=!0;var g=d!=c?1:0,h=c._vertical_orientation;if("top"==b||"bottom"==b)1!==h&&(c=webix.ui({type:a._settings.layoutType,rows:[]},c,e+g),webix.ui(a,c,0),e=0,g=1),"bottom"==b&&(g+=1);else if("left"==b||"right"==b)0!==h&&(c=webix.ui({type:a._settings.layoutType,cols:[]},c,e+g),
webix.ui(a,c,0),e=0,g=1),"right"==b&&(g+=1);f<e&&--g;webix.ui(this,c,e+g);"replace"==b&&webix.ui(a,d,f);this._removeEmptySource(d);webix.ui._freeze_resize=!1;d.getTopParentView();a.resize();d.resize();webix.callEvent("onAfterPortletMove",[d,c,this,a,b])}},_removeEmptySource:function(a){for(var b,c=0;a.getChildViews().length<=c;)b=a,a=a.getParentView(),c=1;c&&a.removeView(b)},$drag:function(a,b){webix.html.addCss(this._viewobj,"portlet_in_drag");webix.DragControl._drag_context={source:a,from:a};return this._viewobj.innerHTML},
$dragDestroy:function(a,b,c){webix.html.removeCss(this._viewobj,"portlet_in_drag");webix.html.remove(b);this._portlet_drop_target&&(this.movePortlet(this._portlet_drop_target,this._portlet_drop_mode),this.markDropArea(),this._portlet_drop_target=null)},_getDragItemPos:function(){return webix.html.offset(this.$view)},$dragPos:function(a,b,c){c.style.left="-10000px";c=webix.env.mouse.context(b);c=document.elementFromPoint(c.x-(document.body.scrollLeft||document.documentElement.scrollLeft||0),c.y-(document.body.scrollTop||
document.documentElement.scrollTop||0));var d=null;c&&(d=webix.$$(c));this._portlet_drop_target=this._getPortletTarget(d);this._portlet_drop_mode=this._markPortletDrag(this._portlet_drop_target,b);a.x=a.x-this._content_width+10;a.y-=20;webix.DragControl._skip=!0},_markPortletDrag:function(a,b){var c="",d="";if(b&&a){var e=webix.html.offset(a.$view);d=webix.html.pos(b);b=d.x-e.x-e.width/2;var f=d.y-e.y-e.height/2;(d=a._settings.mode)||(d=e.height/e.width*Math.abs(b)>Math.abs(f)?"cols":"rows");"cols"==
d?c=0<=b?"right":"left":"rows"==d&&(c=0<=f?"bottom":"top");this.markDropArea(a,c)}this.markDropArea(a,c);return c||d},_getPortletTarget:function(a){for(;a;){if(a.movePortlet)return a;a=a.getParentView()}}},webix.ui.layout);
webix.UIManager.getState=function(a,b){b=b||!1;a=webix.$$(a);var c={id:a.config.id,width:a.config.width,height:a.config.height,gravity:a.config.gravity};webix.isUndefined(a.config.collapsed)||(c.collapsed=a.config.collapsed);if("tabs"===a.name||"tabbar"===a.name)c.activeCell=a.getValue();if(b&&(c=[c],a._cells))for(var d=0;d<a._cells.length;d++)c=c.concat(this.getState(a._cells[d],b));return c};
webix.UIManager.setState=function(a){webix.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b],d=webix.$$(c.id);d&&(webix.isUndefined(c.collapsed)||d.define("collapsed",c.collapsed),webix.isUndefined(c.activeCell)||d.setValue(c.activeCell),d.define("width",c.width),d.define("height",c.height),d.define("gravity",c.gravity))}(a=webix.$$(a[0].id))&&a.resize()};
(function(){function a(a,b,c){return!c&&b.format?function(c){return b.format(c[a])}:function(b){return b[a]}}function b(b,c){var d=[],e=0,f=0,g=b.getColumnConfig,h=c.columns,k=!!c.rawValues;d.heights={};if(!h)if(g)h=[].concat(b._columns);else{h=[];var l=b.data.pull[b.data.order[0]],u;for(u in l)"id"!==u&&"$"!=u[0]&&h.push({id:u})}else if(!h.length){l=[];for(u in h)l.push(webix.extend({id:u},webix.extend({},h[u])));h=l}if(c.ignore)for(u=h.length-1;0<=u;u--)c.ignore[h[u].id]&&h.splice(u,1);c.id&&d.push({id:"id",
width:50,header:" ",template:function(a){return a.id}});if(c.flatTree){var y=c.flatTree.id;l=[].concat(c.flatTree.columns);var w=[],z=!!c.flatTree.fill;for(u=1;u<=l.length;u++)l[u-1].template=function(a,b){return function(b){return b.$level==a?w[a]=b[y]:z&&a<b.$level?w[a]:""}}(u);var x=0;for(u=h.length-1;0<=u;u--)h[u].id===y&&(x=u);h=[].concat(h.slice(0,x)).concat(l).concat(h.slice(x+1))}for(l=0;l<h.length;l++)if(x=h[l],u=x.id,!x.noExport){g&&b._columns_pull[u]&&(x=webix.extend(webix.extend({},x),
b._columns_pull[u]));var B={id:x.id,template:k||!x.template?a(u,x,k):x.template,width:(x.width||200)*("excel"===c.export_mode?8.43/70:1),header:!1!==x.header?x.header||u:""};B.header="string"===typeof B.header?[{text:B.header}]:webix.copy(B.header);for(u=0;u<B.header.length;u++)B.header[u]=B.header[u]?B.header[u].contentId?"":B.header[u].text:"";e=Math.max(e,B.header.length);if(b._settings.footer){x=x.footer||"";x="string"==typeof x?[{text:x}]:webix.copy(x);for(u=0;u<x.length;u++)x[u]=x[u]?x[u].contentId?
b.getHeaderContent(x[u].contentId).getValue():x[u].text:"";B.footer=x;f=Math.max(f,B.footer.length)}d.push(B)}for(u=0;u<d.length;u++){c=e-d[u].header.length;for(g=0;g<c;g++)d[u].header.push("");if(b._settings.footer)for(c=f-d[u].footer.length,g=0;g<c;g++)d[u].footer.push("")}return d}function c(a,b,c){var d=!!b.filterHTML,e=/<[^>]*>/gi,f=[];"excel"===b.export_mode&&b.docHeader&&(f=[[(b.docHeader.text||b.docHeader).toString()],[""]],b.docHeader.height&&(c.heights[0]=b.docHeader.height));if(!1!==b.header&&
c.length)for(var g=0;g<c[0].header.length;g++){var h=[];for(var k=0;k<c.length;k++){var l="";c[k].header[g]&&(l=c[k].header[g],d&&(l=c[k].header[g]=l.replace(e,"")));h.push(l)}"excel"!=b.export_mode||!a._columns||!1===b.heights||a._headers[g]===webix.skin.$active.barHeight&&"all"!=b.heights||(c.heights[f.length]=a._headers[g]);"pdf"!==b.export_mode&&(f[f.length]=h)}b.yCorrection=(b.yCorrection||0)-f.length;var m="TreeStore"==a.data.name,w=b.flatTree||b.plainOutput?"":" - ";a.data.each(function(g){for(var h=
[],k=0;k<c.length;k++){var l=c[k],n=null;b.math&&g["$"+l.id]&&"="==g["$"+l.id].charAt(0)&&!g["$"+l.id].match(/^=(image|link|sparkline)\(/i)&&(n=g["$"+l.id]);if(this._spans_pull){var p=this.getSpan(g.id,l.id);p&&p[4]&&p[0]==g.id&&p[1]==l.id&&(n=p[4],d&&"string"===typeof n&&(n=n.replace(e,"")))}n||((n=l.template(g,a.type,g[l.id],l,k))||0===n||(n=""),d&&"string"===typeof n&&(m&&(n=n.replace(/<div class=.webix_tree_none.><\/div>/,w)),n=n.replace(e,"")),"string"===typeof n&&"csv"===b.export_mode&&(n=n.trim()),
"string"!==typeof n||"excel"!==b.export_mode&&"csv"!==b.export_mode||(n=n.replace(/<br\s*\/?>/mg,"\n")));h.push(n)}"excel"==b.export_mode&&a._columns&&!1!==b.heights&&(g.$height&&g.$height!==webix.skin.$active.rowHeight||"all"==b.heights)&&(c.heights[f.length]=g.$height||this.config.rowHeight);f.push(h)},a);if(!1!==b.footer)for(l=c[0].footer?c[0].footer.length:0,h=0;h<l;h++){g=[];for(k=0;k<c.length;k++){var z=c[k].footer[h];d&&(z=c[k].footer[h]=z.toString().replace(e,""));g.push(z)}"excel"!=b.export_mode||
!a._columns||!1===b.heights||a._footers[h]===webix.skin.$active.barHeight&&"all"!=b.heights||(c.heights[f.length]=a._footers[h]);"pdf"!==b.export_mode&&f.push(g)}"excel"===b.export_mode&&b.docFooter&&(f=f.concat([[],[(b.docFooter.text||b.docFooter).toString()]]),b.docFooter.height&&(c.heights[f.length-1]=b.docFooter.height));return f}function d(a,b){var c=a._spans_pull,d=[];if(a.getColumnConfig){!1!==b.header&&(d=e(a,b,"header",d));if(c){var f=b.xCorrection||0,g=b.yCorrection||0,h;for(h in c){var k=
c[h],l;for(l in k){var u=a.getColumnIndex(l)-f,y=a.getIndexById(h)-g;d.push({s:{c:u,r:y},e:{c:u+k[l][0]-1,r:y+(k[l][1]-1)}})}}}!1!==b.footer&&(d=e(a,b,"footer",d))}return d}function e(a,b,c,d){var e=a.config.columns;a=(b.docHeader?2:0)+("header"==c?0:(!1!==b.header?a._headers.length:0)+a.count());for(b=0;b<e.length;b++)for(var f=e[b][c],g=0;g<f.length;g++)f[g]&&(f[g].colspan||f[g].rowspan)&&d.push({s:{c:b,r:g+a},e:{c:b+(f[g].colspan||1)-1,r:g+(f[g].rowspan||1)-1+a}});return d}function f(a,b,c,d){c.header=
webix.isUndefined(c.header)||!0===c.header?{}:c.header;c.footer=webix.isUndefined(c.footer)||!0===c.footer?{}:c.footer;c.table=c.table||{};var e=c.width||595.296,f=c.height||841.896;c.orientation&&"landscape"===c.orientation&&(f=[e,e=f][0]);if(c.autowidth){e=80;for(var g=0;g<a.length;g++)e+=a[g].width}var h=new pdfjs.Document({padding:40,font:c._export_font,threshold:256,width:e,height:f}),k=!1===c.header?0:a[0].header.length;e=!1!==c.footer&&a[0].footer?a[0].footer.length:0;f=[];for(g=0;g<a.length;g++)f[g]=
a[g].width;g=webix.extend(c.table,{borderWidth:1,height:20,lineHeight:1.1,borderColor:15658734,backgroundColor:16777215,color:6710886,textAlign:"left",paddingRight:10,paddingLeft:10,headerRows:k,widths:f.length?f:["100%"]});f=h.table(g);if(k){var l=webix.extend(c.header,{borderRightColor:11587299,borderBottomColor:11587299,color:4868682,backgroundColor:13820911,height:27,lineHeight:1.2});for(g=0;g<k;g++)for(var m=f.tr(l),n=0;n<a.length;n++)m.td(a[n].header[g].toString())}for(g=0;g<b.length;g++)for(k=
f.tr({}),n=0;n<b[g].length;n++)k.td(b[g][n]);if(e)for(b=webix.extend(c.footer,{borderRightColor:15658734,borderBottomColor:15658734,backgroundColor:16448250,color:6710886,height:27,lineHeight:1.2}),g=0;g<e;g++)for(k=f.tr(b),n=0;n<a.length;n++)k.td(a[n].footer[g].toString());!1!==c.docFooter&&h.footer().text({color:6710886,textAlign:"center"}).append(webix.i18n.dataExport.page||"Page").pageNumber().append("  "+(webix.i18n.dataExport.of||"of")+"  ").pageCount();var z=0,x=1;c.docHeader&&("string"==typeof c.docHeader&&
(c.docHeader={text:c.docHeader}),webix.extend(c.docHeader,{color:6710886,textAlign:"right",order:0}),z=c.docHeader.order);c.docHeaderImage&&("string"==typeof c.docHeaderImage&&(c.docHeaderImage={url:c.docHeaderImage}),webix.extend(c.docHeaderImage,{align:"right",order:1}),x=c.docHeaderImage.order);c.docHeader&&x>z&&h.header({paddingBottom:10}).text(c.docHeader.text,c.docHeader);c.docHeaderImage?pdfjs.load(c.docHeaderImage.url,function(a,b){a||(a=new pdfjs.Image(b),h.header({paddingBottom:10}).image(a,
c.docHeaderImage),c.docHeader&&x<z&&h.header({paddingBottom:10}).text(c.docHeader.text,c.docHeader));a=h.render();d(a,c)}):(a=h.render(),d(a,c))}webix.toPNG=function(a,b){var c=webix.promise.defer();webix.require(webix.cdn+"/extras/html2canvas.min.js",function(){"string"===typeof b&&(b={filename:b});b=b||{};var d=webix.$$(a);d&&d.$exportView&&(d=d.$exportView(b));webix.assert(d,"non-existing view for export");if(!d)return c.reject("non-existing view for export");d=d?d.$view:webix.toNode(a);var e=
(b.filename||"Data")+".png";window.html2canvas(d).then(function(a){var d=function(d){!1!==b.download&&webix.html.download(d,e);a.remove();c.resolve(d)};a.msToBlob?d(a.msToBlob()):a.toBlob(d,"image/png")})});return c};webix.toExcel=function(a,e){e=e||{};e.export_mode="excel";a=webix.isArray(a)?a:[a];for(var f=[],g=0;g<a.length;g++){var k=webix.$$(a[g]);k&&k.$exportView&&(k=k.$exportView(e));k&&(f=f.concat(k));webix.assert(k,"non-existing view for export");if(e.dataOnly){var l=b(k,e);f[g]={scheme:l,
exportData:c(k,e,l),spans:e.spans?d(k,e):[]}}}if(e.dataOnly)return f;var r=webix.promise.defer();webix.require(webix.cdn+"/extras/xlsx.core.styles.min.js",function(){if(!f.length)return r.reject("non-existing view for export");for(var a={SheetNames:[],Sheets:{},Workbook:{WBProps:{},Names:[]}},g=webix.isArray(e.sheets)?e.sheets:[e.name||"Data"],k=0;k<f.length;k++){var l=f[k].scheme||b(f[k],e),m=f[k].exportData||c(f[k],e,l),n=f[k].spans?f[k].spans:e.spans?d(f[k],e):[],p=f[k].ranges||[],q=m;m=l;var A=
f[k].styles||[];l={};for(var F={s:{c:1E7,r:1E7},e:{c:0,r:0}},D=0;D!=q.length;++D)for(var E=0;E!=q[D].length;++E){F.s.r>D&&(F.s.r=D);F.s.c>E&&(F.s.c=E);F.e.r<D&&(F.e.r=D);F.e.c<E&&(F.e.c=E);var C={v:q[D][E]};if(null!==C.v){var G=XLSX.utils.encode_cell({c:E,r:D});C.v instanceof Date?(C.t="n",C.z=XLSX.SSF[h][14],C.v=Math.round(25569+C.v/864E5)):"boolean"===typeof C.v?C.t="b":"number"===typeof C.v||C.v&&!isNaN(1*C.v)?(C.v*=1,C.t="n"):"="==C.v.charAt(0)?(C.t="n",C.f=C.v,delete C.v):C.t="s";A&&(C.s=A[D]&&
A[D][E]?A[D][E]:"");l[G]=C}}1E7>F.s.c&&(l["!ref"]=XLSX.utils.encode_range(F));q=void 0;A=m.heights;for(q in A)A[q]={hpx:A[q],hpt:.75*A[q]};l["!rows"]=A;q=[];for(A=0;A<m.length;A++)q.push({wch:m[A].width});l["!cols"]=q;n.length&&(l["!merges"]=n);n=l;l=(g[k]||"Data"+k).replace(/[\*\?:\[\]\\\/]/g,"").replace(/&/g,"&amp;").substring(0,31);a.SheetNames.push(l);a.Sheets[l]=n;a.Workbook.Names=a.Workbook.Names.concat(p)}a=XLSX.write(a,{bookType:"xlsx",bookSST:!1,type:"binary"});g=(e.filename||g.join(","))+
".xlsx";k=Blob;p=new ArrayBuffer(a.length);n=new Uint8Array(p);for(l=0;l!=a.length;++l)n[l]=a.charCodeAt(l)&255;a=new k([p],{type:"application/xlsx"});!1!==e.download&&webix.html.download(a,g);r.resolve(a)});return r};webix.toCSV=function(a,d){d=d||{};(a=webix.$$(a))&&a.$exportView&&(a=a.$exportView(d));webix.assert(a,"non-existing view for export");if(!a)return webix.promise.reject("non-existing view for export");d.export_mode="csv";d.filterHTML=!0;var e=b(a,d);a=c(a,d,e);e=webix.csv.stringify(a);
a=(d.filename||"Data")+".csv";e=new Blob(["\ufeff"+e],{type:"text/csv"});!1!==d.download&&webix.html.download(e,a);return webix.promise.resolve(e)};var g;webix.toPDF=function(a,d){var e=webix.promise.defer();webix.require(webix.cdn+"/extras/pdfjs.js",function(){d=d||{};var h=webix.$$(a);h&&h.$exportView&&(h=h.$exportView(d));webix.assert(h,"non-existing view for export");if(!h)return e.reject();d.export_mode="pdf";d._export_font=g;d.fontName=d.fontName||"pt-sans.regular";var k=b(h,d),l=c(h,d,k),m=
function(a,b){var c=(b.filename||"Data")+".pdf";a=new Blob([a.toString()],{type:"application/pdf"});!1!==b.download&&webix.html.download(a,c);e.resolve(a)};d._export_font?f(k,l,d,m):pdfjs.load(webix.cdn+"/extras/"+d.fontName+".ttf",function(a,b){if(a)throw a;g=d._export_font=new pdfjs.TTFFont(b);f(k,l,d,m)})});return e};var h="_table"})();
webix.protoUI({name:"pdfviewer",defaults:{scale:"auto"},$init:function(a){this.$view.className+=" webix_pdf";var b=document.createElement("DIV");b.className="canvas_wrapper";var c=document.createElement("canvas");this._currentPage=this.$view;this._container=this.$view.appendChild(b);this._canvas=this._container.appendChild(c);this.$pdfDoc=null;this.$numPages=this.$pageNum=0;this._pageRendering=!1;this._pageNumPending=null;this._ctx=this._canvas.getContext("2d");this._init_scale_value=.1;this._default_scale_delta=
a.scaleDelta||1.1;this._min_scale=a.minScale||.25;this._max_scale=a.maxScale||10;this._max_auto_scale=1.25;this._hPadding=40;this._vPadding=10;this.$ready.push(this._attachHandlers)},toolbar_setter:function(a){if("string"==typeof a){var b=webix.$$(a);b&&(b.$master=this,b.refresh());this.attachEvent("onDocumentReady",function(){b?(b.setPage(this.$pageNum),b.setValues(this.$numPages,this._settings.scale)):this.toolbar_setter(a)});return a}},_attachHandlers:function(){delete this._settings.datatype;
this.attachEvent("onScaleChange",function(a,b){b&&this._settings.toolbar&&webix.$$(this._settings.toolbar).setScale&&webix.$$(this._settings.toolbar).setScale(a)});webix.env.touch?(this._touchDelta=!1,webix._event(this._viewobj,"touchstart",webix.bind(function(a){var b=a.targetTouches;2===b.length&&(webix.html.preventEvent(a),this._touchDelta=Math.abs(b[0].pageY-b[1].pageY))},this)),webix._event(this.$view,"touchmove",webix.bind(function(a){var b=a.targetTouches;2===b.length&&!1!==this._touchDelta&&
(webix.html.preventEvent(a),Math.abs(b[0].pageY-b[1].pageY)>this._touchDelta?this.zoomIn():this.zoomOut(),this._touchDelta=!1)},this)),this.attachEvent("onSwipeX",function(a,b){this.$view.scrollLeft-=b.x-a.x}),this.attachEvent("onSwipeY",function(a,b){var c=this.$view.scrollHeight,d=this.$view.offsetHeight,e=this.$view.scrollTop;a=b.y-a.y;this.$view.clientHeight===c||0>a&&e>c-d||0<a&&0===e?(d=this.$pageNum+(0<a?-1:1),0<d&&d<=this.$numPages&&(this.$pageNum=d,this._queueRenderPage(this.$pageNum),this.$view.scrollTop=
0<a?c:0)):this.$view.scrollTop=e-a})):webix.event(window,webix.env.isFF?"DOMMouseScroll":"mousewheel",webix.bind(function(a){var b=0>("DOMMouseScroll"===a.type?-a.detail:a.wheelDelta)?"out":"in";a.ctrlKey&&(webix.html.preventEvent(a),"in"==b?this.zoomIn():this.zoomOut())},this))},_getDocument:function(a){if(a.name){var b=new FileReader;b.onload=webix.bind(function(a){this._getDocument({data:a.target.result})},this);b.readAsArrayBuffer(a)}else PDFJS.getDocument({data:a.data}).then(webix.bind(function(a){this.clear();
this.$pdfDoc=a;this.$numPages=this.$pdfDoc.numPages;this.$pageNum=1;this._renderPage(this.$pageNum).then(webix.bind(function(){this.callEvent("onDocumentReady")},this))},this))},$onLoad:function(a){window.PDFJS?this._getDocument(a):webix.require([webix.cdn+"/extras/pdfjs/compatibility.min.js",webix.cdn+"/extras/pdfjs/pdf.min.js"],function(){PDFJS.workerSrc=webix.cdn+"/extras/pdfjs/pdf.worker.min.js";this._getDocument(a)},this);return!0},_getViewPort:function(a,b){a=a.getViewport(b);this._canvas.height=
a.height;this._canvas.width=a.width;this._container.style.width=a.width+"px";this._container.style.height=a.height+"px";return a},_renderPage:function(a){var b=this;b._pageRendering=!0;return this.$pdfDoc.getPage(a).then(function(a){var c=isNaN(parseFloat(b._settings.scale))?b._init_scale_value:b._settings.scale,e=b._getViewPort(a,c);c!==b._settings.scale&&(c=b._getScale(b._settings.scale),e=b._getViewPort(a,c),b._settings.scale=c);c={canvasContext:b._ctx,viewport:e};a.cleanupAfterRender=!0;return a.render(c).promise.then(function(){b.callEvent("onPageRender",
[b.$pageNum]);b._pageRendering=!1;null!==b._pageNumPending&&(b._renderPage(b._pageNumPending),b._pageNumPending=null)})})},_queueRenderPage:function(a){this._pageRendering?this._pageNumPending=a:this._renderPage(a)},renderPage:function(a){!this.$pdfDoc||0>a||a>this.$numPages||(this.$pageNum=a,this._queueRenderPage(this.$pageNum))},prevPage:function(){1>=this.$pageNum||(this.$pageNum--,this._queueRenderPage(this.$pageNum))},nextPage:function(){this.$pageNum>=this.$numPages||(this.$pageNum++,this._queueRenderPage(this.$pageNum))},
zoomIn:function(){var a=this._settings.scale;a=(a*this._default_scale_delta).toFixed(2);a=Math.ceil(10*a)/10;a=Math.min(this._max_scale,a);this.setScale(a,!0)},zoomOut:function(){var a=this._settings.scale;a=(a/this._default_scale_delta).toFixed(2);a=Math.floor(10*a)/10;a=Math.max(this._min_scale,a);this.setScale(a,!0)},_getScale:function(a){if(!isNaN(parseFloat(a)))return a;isNaN(parseFloat(this._settings.scale))&&(this._settings.scale=this._init_scale_value);var b=1,c=((this._currentPage.clientWidth-
this._hPadding)*this._settings.scale/this._canvas.clientWidth).toFixed(2),d=((this._currentPage.clientHeight-this._vPadding)*this._settings.scale/this._canvas.clientHeight).toFixed(2);switch(a){case "page-actual":b=1;break;case "page-width":b=c;break;case "page-height":b=d;break;case "page-fit":b=Math.min(c,d);break;case "auto":b=Math.min(this._max_auto_scale,this._currentPage.clientWidth>this._currentPage.clientHeight?Math.min(d,c):c)}return b},setScale:function(a,b){isNaN(parseFloat(a))?(a=this._getScale(a),
this._setScale(a,b)):this._setScale(a,b)},_setScale:function(a,b){this._settings.scale=a;this.renderPage(this.$pageNum);this.callEvent("onScaleChange",[a,b])},download:function(){if(this.$pdfDoc){var a=(this._settings.downloadName||"document")+".pdf";this.$pdfDoc.getData().then(function(b){b=PDFJS.createBlob(b,"application/pdf");webix.html.download(b,a)})}},clear:function(){this.$pdfDoc&&(this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._container.style.height=this._container.style.width=
this._canvas.width=this._canvas.height=0,this._settings.scale="auto",this.$pageNum=this.$numPages=0,this.$pdfDoc.transport.startCleanup(),this.$pdfDoc.destroy(),this.$pdfDoc=null,this._settings.toolbar&&webix.$$(this._settings.toolbar)&&webix.$$(this._settings.toolbar).reset())}},webix.EventSystem,webix.AtomDataLoader,webix.ui.view);
webix.protoUI({name:"pdfbar",reset:function(){this.setPage(0);this.setValues(0,"auto")},$init:function(a){this.$view.className+=" pdf_bar";a.cols=[{view:"button",type:"icon",icon:"arrow-left",width:35,click:function(){this.getParentView()._navigate("prev")}},{view:"text",width:70,value:"0",on:{onBlur:function(){this.getParentView()._navigate(this.getValue())},onKeyPress:function(a){13===a&&this.getParentView()._navigate(this.getValue())}}},{template:webix.i18n.PDFviewer.of+" #limit#",width:70,data:{limit:0},
borderless:!0},{view:"button",type:"icon",icon:"arrow-right",width:35,click:function(){this.getParentView()._navigate("next")}},{},{view:"button",type:"icon",icon:"minus",width:35,click:function(){this.getParentView().zoom("out")}},{view:"richselect",options:[],maxWidth:195,suggest:{padding:0,css:"pdf_opt_list",borderless:!0,body:{type:{height:25},scroll:!1,yCount:13}},on:{onChange:function(){this.getParentView().setMasterScale(this.getValue())}}},{view:"button",type:"icon",icon:"plus",width:35,click:function(){this.getParentView().zoom("in")}},
{view:"button",type:"icon",icon:"download",width:35,click:function(){this.getParentView().download()}}];this.$ready.push(this._setScaleOptions)},_setScaleOptions:function(){var a=this.getChildViews()[6].getPopup().getBody();a.clearAll();a.parse([{id:"auto",value:webix.i18n.PDFviewer.automaticZoom},{id:"page-actual",value:webix.i18n.PDFviewer.actualSize},{id:"page-fit",value:webix.i18n.PDFviewer.pageFit},{id:"page-width",value:webix.i18n.PDFviewer.pageWidth},{id:"page-height",value:webix.i18n.PDFviewer.pageHeight},
{id:"0.5",value:"50%"},{id:"0.75",value:"75%"},{id:"1",value:"100%"},{id:"1.25",value:"125%"},{id:"1.5",value:"150%"},{id:"2",value:"200%"},{id:"3",value:"300%"},{id:"4",value:"400%"}]);var b=0;a.data.each(function(a){b=Math.max(webix.html.getTextSize(a.value,"webixbutton").width,b)});this.getChildViews()[6].define("width",b+20);this.getChildViews()[6].resize()},_navigate:function(a){this.setMasterPage(a);this.setPage(this.$master.$pageNum)},setScale:function(a){var b=this.getChildViews()[6];b.blockEvent();
b.getPopup().getList().exists(a)?b.setValue(a):(b.setValue(""),b.getInputNode().innerHTML=(100*a).toFixed(0)+"%");b.unblockEvent()},setMasterScale:function(a){this.$master&&this.$master.setScale(a)},setMasterPage:function(a){this.$master&&("prev"===a?this.$master.prevPage():"next"===a?this.$master.nextPage():isNaN(parseInt(a))||this.$master.renderPage(parseInt(a)))},zoom:function(a){this.$master&&("out"===a?this.$master.zoomOut():"in"===a&&this.$master.zoomIn())},setPage:function(a){this.getChildViews()[1].setValue(a)},
setValues:function(a,b){this.getChildViews()[2].data.limit=a;this.getChildViews()[2].refresh();this.setScale(b)},download:function(){this.$master&&this.$master.download()}},webix.ui.toolbar);
webix.protoUI({name:"excelbar",defaults:{padding:0,type:"line"},$init:function(a){a.cols=[{view:"tabbar",options:[""],optionWidth:200,on:{onaftertabclick:function(){this.getParentView().callEvent("onExcelSheetSelect",[this.getValue()])}}}]},getValue:function(){return this.getInput().getValue()},setValue:function(a){return this.getInput().setValue(a)},getInput:function(){return this.getChildViews()[0]},setSheets:function(a){var b=this.getInput();b.config.options=a;b.refresh()}},webix.ui.toolbar);
webix.protoUI({name:"excelviewer",$init:function(){this.$ready.push(function(){this._settings.toolbar&&webix.$$(this._settings.toolbar).attachEvent("onExcelSheetSelect",webix.bind(this.showSheet,this))})},defaults:{datatype:"excel"},$onLoad:function(a){return a.sheets?(this._excel_data=a,this._settings.toolbar&&webix.$$(this._settings.toolbar).setSheets(a.names),a=a.names[0],this.showSheet(a.id||a),!0):!1},$exportView:function(a){if("excel"!==a.export_mode||a.dataOnly)return this;!0===a.sheets?a.sheets=
this.getSheets():a.sheets&&a.sheets.length?"string"==typeof a.sheets&&(a.sheets=[a.sheets]):a.sheets=[this._activeSheet];a.dataOnly=!0;a.heights=webix.isUndefined(a.heights)&&a.styles?"all":a.heights;for(var b=[],c=this._activeSheet,d=0;d<a.sheets.length;d++)this.showSheet(a.sheets[d]),b=b.concat(webix.toExcel(this,a)),a.styles&&(b[d].styles=this._getExportStyles(a));this.showSheet(c);delete a.dataOnly;return b},showSheet:function(a){this.clearAll();var b=this.data.driver.sheetToArray(this._excel_data.sheets[a],
{spans:this._settings.spans}),c=this._settings.excelHeader,d={},e={};if(b.sizes)for(var f=0;f<b.sizes.length;f++)"column"==b.sizes[f][0]?d[b.sizes[f][1]]=Math.round(b.sizes[f][2]):"row"==b.sizes[f][0]&&(e[b.sizes[f][1]]=Math.round(b.sizes[f][2]));if(c)if(!0===c)for(c=b.data.splice(0,1)[0],f=0;f<c.length;f++)c[f]={header:c[f],id:"data"+f,width:d[f],adjust:!d[f],editor:"text",sort:"string"};else c=webix.copy(c);else for(c=webix.copy(b.data[0]),f=0;f<c.length;f++)c[f]={header:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[f],
id:"data"+f,width:d[f],adjust:!d[f],editor:"text",sort:"string"};this.config.columns=c;this.refreshColumns();this.parse(b,this._settings.datatype);this._activeSheet=a;a=this._paintSpans(b.spans);e=this._paintRowHeight(e);b=this._paintStyles(b.styles,a);(a||e||b)&&this.refresh()},getSheets:function(){return this._excel_data.names},_getSpanCss:function(a,b,c,d){for(var e=!1,f=0;f<a.length;f++)if(a[f][0]===b&&a[f][1]===c){a[f][5]=webix.html.createCss(this._toCellStyle(d));this.addSpan(a[f][0],a[f][1],
a[f][2],a[f][3],a[f][4],a[f][5]);e=!0;break}return e},_paintStyles:function(a,b){var c=0;if(a&&a.length){for(var d=0;d<a.length;d++){var e=a[d][0]-(this.config.excelHeader?1:0);if(0<=e&&(e=this.getIdByIndex(e),this.exists(e))){var f=this.getItem(e),g=this.columnId(a[d][1]);g&&(b.length&&this._getSpanCss(b,e,g,a[d][2])||(f.$cellCss=f.$cellCss||{},f.$cellCss[g]=this._toCellStyle(a[d][2])),c++)}}return c}return!1},_safeColor:function(a){a=a||"000000";8===a.length&&(a=a.substring(2));return"#"+a},_toCellStyle:function(a){var b=
{};a.fill&&a.fill.fgColor&&(b["background-color"]=this._safeColor(a.fill.fgColor.rgb));if(a.font){var c=a.font;c.name&&(b["font-family"]=c.name);c.sz&&(b["font-size"]=c.sz/.75+"px");c.color&&c.color.rgb&&(b.color=this._safeColor(c.color.rgb));c.bold&&(b["font-weight"]="bold");c.underline&&(b["text-decoration"]="underline");c.italic&&(b["font-style"]="italic");c.strike&&(b["text-decoration"]="line-through")}a.alignment&&(c=a.alignment,c.vertical&&"center"==c.vertical&&(b.display="flex",b["justify-content"]=
"flex-start",b["align-items"]="center"),c.vertical&&"bottom"==c.vertical&&(b.display="flex",b["justify-content"]="flex-end",b["align-items"]="flex-end"),c.horizontal&&(!c.vertical||"center"!=c.vertical&&"bottom"!=c.vertical?b["text-align"]=c.horizontal:b["justify-content"]="center"),c.wrapText&&(b["white-space"]="normal"));a.border&&(a=a.border,a.top&&(b["border-top"]="1px solid "+this._safeColor(a.top.color.rgb)),a.bottom&&(b["border-bottom"]="1px solid "+this._safeColor(a.bottom.color.rgb)+" !important"),
a.left&&(b["border-left"]="1px solid "+this._safeColor(a.left.color.rgb)),a.right&&(b["border-right"]="1px solid "+this._safeColor(a.right.color.rgb)+" !important"));return b},_paintRowHeight:function(a){var b=0,c;for(c in a){var d=this.config.excelHeader?c-1:c;0<=d&&(d=this.getIdByIndex(d),this.exists(d)&&(this.getItem(d).$height=a[c],b++))}this.config.fixedRowHeight=!b;return b},_paintSpans:function(a){var b=[];if(this._settings.spans&&a&&a.length){this._spans_pull={};for(var c=0;c<a.length;c++)this.config.excelHeader&&
a[c][0]--,0<=a[c][0]&&(a[c][0]=this.getIdByIndex(a[c][0]),a[c][1]="data"+a[c][1],b.push(a[c]));this.addSpan(b);return b}return!1}},webix.ui.datatable);
webix.DataDriver.excel=webix.extend({toObject:function(a){if(!a.excel){var b=a.options||{};b.dataurl&&webix.extend(b,this._urlToOptions(b.dataurl));a=a.data||a;var c=webix.promise.defer();if(a.name){b.ext=a.name.split(".").pop();var d=new FileReader;d.onload=webix.bind(function(a){c.resolve(this.parseData(a.target.result,b))},this);d.readAsArrayBuffer(a)}else c.resolve(this.parseData(a,b));return c}return a},parseData:function(a,b){a=new Uint8Array(a);for(var c=[],d=0;d!=a.length;++d)c[d]=String.fromCharCode(a[d]);
var e=(b.ext||b).toLowerCase();"xls"!=e&&(e="xlsx");return webix.require(webix.cdn+"/extras/xlsx.core.styles.min.js").then(webix.bind(function(){var a="xls"==e?XLS.read(c.join(""),{type:"binary",cellStyles:!0,cellDates:!0}):XLSX.read(c.join(""),{type:"binary",cellStyles:!0,cellDates:!0});a={sheets:a.Sheets,names:a.SheetNames,options:b,ranges:a.Workbook?a.Workbook.Names||[]:[]};return webix.extend(this.getSheet(a,b),a)},this))},getSheet:function(a,b){a=this.sheetToArray(a.sheets[b.name||a.names[0]],
b);b.rows&&b.rows.length&&(a.data=a.data.splice(b.rows[0],Math.min(b.rows[1],a.data.length)-b.rows[0]));return a},sheetToArray:function(a,b){var c=[],d=[],e=[],f=[];if(a&&a["!ref"]){var g=XLS.utils.decode_range(a["!ref"]),h,k,l=g.s.c,m=g.s.r+(b.rows?b.rows[0]:0);for(h=g.s.r;h<=g.e.r;h++){var n=[];for(k=g.s.c;k<=g.e.c;k++){var p=XLS.utils.encode_cell({r:h,c:k});if(p=a[p]){var q=b.math&&p.f?"="==p.f.charAt(0)?p.f:"="+p.f:"d"==p.t&&webix.isDate(p.v)?webix.i18n.dateFormatStr(p.v):p.v;n.push(q);p.s&&e.push([h-
m,k-l,p.s])}else n.push("")}c.push(n)}if(a["!merges"])for(h=a["!merges"],g=0;g<h.length;g++)k=h[g].s,n=h[g].e,(!b.rows||0<=k.r-m&&n.r-m<=b.rows[1])&&d.push([k.r-m,k.c-l,n.c-k.c+1,n.r-k.r+1]);if(a["!cols"])for(b=a["!cols"],g=0;g<b.length;g++)b[g]&&f.push(["column",g-l,Math.round(b[g].wch/(8.43/70))]);if(a["!rows"])for(a=a["!rows"],g=0;g<a.length;g++)a[g]&&f.push(["row",g-m,a[g].hpx])}return{data:c,spans:d,styles:e,sizes:f,excel:!0}},_urlToOptions:function(a){var b=a.split("[");a={};a.name=b[0];b[1]&&
(b=b[1].split(/[^0-9]+/g),b[0]=1*b[0]||0,b[1]=1*b[1]||9999999,a.rows=b);return a}},webix.DataDriver.jsarray);
webix.protoUI({name:"treemap",defaults:{activeItem:!1,subRender:!0,header:!0,headerHeight:35,value:webix.template("#value#"),headerTemplate:"",navigation:!0},value_setter:webix.template,headerTemplate_setter:webix.template,header_setter:function(a){a&&!0!==a&&(this.type.header=a);return a},$init:function(a){this.$view.className+=" webix_treemap";this._viewobj.setAttribute("role","tree");this._htmlElement=document.createElement("DIV");webix.extend(this.data,webix.TreeStore,!0);this.data.provideApi(this,
!0);this.data.attachEvent("onClearAll",webix.bind(function(){this._html="";this.$values={};this.$xy={}},this));this.attachEvent("onKeyPress",this._onKeyPress)},_toHTMLItem:function(a){var b=this.data._marks[a.id];this.callEvent("onItemRender",[a]);var c=a.$template?this.type["template"+a.$template].call(this,a,this.type,b):this.type.template.call(this,a,this.type,b);return this.type.templateStart.call(this,a,this.type,b)+c+this.type.templateEnd.call(this)},_renderHeader:function(a){a=this.getItem(a);
var b=this._settings.headerHeight;a="<div class='webix_treemap_header' style='height:"+b+"px;line-height:"+b+"px;'>"+this.type.header.call(this,a,this.type);return a+"</div>"},_renderBranch:function(a){var b,c=[];if(!this.$width||!this.count())return this._html="",!1;if(!a){a=this.config.branch||0;this._html="";this.$values={};this.$xy={};this.$xy[a]={width:this.$width,height:this.$height,top:0,left:0};a&&this._settings.header&&(this.$xy[a].height-=this._settings.headerHeight,this.$xy[a].top=this._settings.headerHeight,
this._html+=this._renderHeader(a));var d=0;this.data.each(function(a){var c=this.getParentId(a.id);if(!this.data.branch[a.id]&&(b=1*this.config.value.call(this,a),!isNaN(b)&&b))for(this.$values[a.id]=b,d+=b;c;)this.$values[c]||(this.$values[c]=0),this.$values[c]+=b,c=this.getParentId(c)},this,!1,a)}this.data.eachChild(a,function(a){this.$values[a.id]&&c.push(webix.copy(a))},this);d=d||this.$values[a];if(c.length&&d){var e=this.$xy[a];e={top:e.top,left:e.left,dx:e.width,dy:e.height,set:[],sum:0};e.dim=
Math.min(e.dx,e.dy);var f=e.dx*e.dy/d;for(a=0;a<c.length;a++)c[a].$value=this.$values[c[a].id]*f;c.sort(function(a,b){return a.$value>b.$value?-1:1});f=Infinity;for(a=0;c[a];){var g=this._worst(e,c[a]);g<f?(e.sum+=c[a].$value,e.set.push(c[a]),f=g,a++):(this._renderRow(e),g={top:e.top,left:e.left,dx:e.dx,dy:e.dy,set:[],sum:0},f=e.sum/e.dim,e.dx>e.dy?(g.left+=f,g.dx-=f):(g.top+=f,g.dy-=f),e=g,e.dim=Math.min(e.dx,e.dy),f=Infinity)}}e&&this._renderRow(e)},_renderRow:function(a){var b,c=a.top,d=a.left;
a.mode=a.dy<a.dx;a.contra=a.sum/a.dim;for(b=0;b<a.set.length;b++){var e=a.set[b].id;if(a.mode){var f=a.contra;var g=a.set[b].$value/a.contra}else f=a.set[b].$value/a.contra,g=a.contra;this.$xy[e]={};this.$xy[e].top=c;this.$xy[e].left=d;a.mode?c+=g:d+=f;this.$xy[e].width=f;this.$xy[e].height=g;this._html+=this._toHTMLItem(this.getItem(e));this._settings.subRender&&this.data.branch[e]&&this._renderBranch(e)}},_worst:function(a,b){var c=a.sum+b.$value;b=c*c/(a.dim*a.dim*b.$value);a.set.length&&(b=Math.max(a.dim*
a.dim*a.set[0].$value/(c*c),b));return 1<b?b:1/b},_toHTMLObject:function(a){this._htmlElement.innerHTML=this._toHTMLItem(a);return this._htmlElement.firstChild},showBranch:function(a){this._settings.branch=a;this.refresh()},render:function(a,b,c){if(this.isVisible(this._settings.id)&&!this.$blockRender){if("update"==c){if(c=this.getItemNode(a))a=this._htmlmap[a]=this._toHTMLObject(b),webix.html.insertBefore(a,c),webix.html.remove(c)}else!this.data.branch||this._settings.branch&&!this.data.branch[this._settings.branch]||
(this._htmlmap=null,this.callEvent("onBeforeRender",[]),this._renderBranch(),this._dataobj.innerHTML=this._html,this.callEvent("onAfterRender",[]));return!0}},_id:"webix_dm_id",on_click:{webix_treemap_item:function(a,b){this._settings.select&&("multiselect"==this._settings.select||this._settings.multiselect?this.select(b,!1,a.ctrlKey||a.metaKey||"touch"==this._settings.multiselect,a.shiftKey):this.select(b));this._settings.activeItem&&this.isBranch(b)&&this.showBranch(b)},webix_treemap_header_item:function(a){a=
webix.html.locate(a,"webix_dm_header_id");this.define("branch",a);this.refresh()},webix_treemap_reset:function(a){this.define("branch",0);this.refresh()}},on_dblclick:{},on_mouse_move:{},_getCssText:function(a){var b="",c;for(c in a)b+=c+":"+a[c]+";";return b},type:{template:webix.template("#value#"),header:function(a,b){for(var c=a.id,d="<div role='button' tabindex='0' aria-label='"+webix.i18n.aria.resetTreeMap+"' class='webix_treemap_reset'></div>",e=[];c;)a=this.getItem(c),e.push(b.headerItem.call(this,
a,b)),c=this.getParentId(c);e.reverse();return d+e.join("<span class='webix_icon fa-angle-right webix_treemap_path_icon'></span>")},headerItem:function(a){var b=this.config.headerTemplate(a);a='<a role="button" tabindex="0" aria-label="'+b+'" webix_dm_header_id="'+a.id+'" class="webix_treemap_header_item">';return a+b+"</a>"},classname:function(a,b,c){var d="webix_treemap_item";b.css&&(d+=b.css+" ");a.$css&&("object"==typeof a.$css&&(a.$css=webix.html.createCss(a.$css)),d+=" "+a.$css);var e=this.$xy[a.id];
c&&c.$css&&(d+=" "+c.$css);d+=" webix_treemap_level_"+this.getItem(a.id).$level;var f=this.getParentId(a.id);f&&f!=this._settings.branch||(d+=" webix_treemap_level_top");1>this.$height-e.top-e.height&&(d+=" webix_treemap_item_bottom");1>this.$width-e.left-e.width&&(d+=" webix_treemap_item_right");b.cssClass&&(a=b.cssClass.call(this,a,b,c))&&(d="object"==typeof a?d+(" "+webix.html.createCss(a)):d+(" "+a));return d},templateStart:function(a,b,c){var d="";if(this.$xy){var e=this.$xy[a.id];d+="width: "+
e.width+"px; height: "+e.height+"px;";d+="top: "+e.top+"px; left: "+e.left+"px;"}return'<div role="treeitem" aria-level="'+a.$level+'" '+(c&&c.webix_selected?'aria-selected="true" tabindex="0"':"")+' webix_dm_id="'+a.id+'" class="'+b.classname.call(this,a,b,c)+'" style="'+d+'">'},templateEnd:webix.template("</div>")}},webix.AutoTooltip,webix.Group,webix.TreeAPI,webix.SelectionModel,webix.KeysNavigation,webix.MouseEvents,webix.Scrollable,webix.TreeDataLoader,webix.ui.proto,webix.TreeRenderStack,webix.CopyPaste,
webix.EventSystem);
webix.extend(webix.ui.datatable,{_init_areaselect:function(){this._arSelCheckKeys=!0;this._areaSelStorage={};this.define("select","area");this.attachEvent("onAfterScroll",function(){this.refreshSelectArea()});this.attachEvent("onAfterRender",function(){this.refreshSelectArea()});this.attachEvent("onBeforeColumnHide",function(a){this._areaSelHiddenIndex=this.getColumnIndex(a)});this.attachEvent("onAfterColumnHide",function(){this._excludeColumnFromAreas(this._areaSelHiddenIndex)});this.attachEvent("onAfterRender",
function(){this._setTabindex()});this._bs_do_select=function(a,b,c,d){if(a.row&&b.row){if(c)return this.addSelectArea(a,b,!0),this._arSelCheckKeys=!0,!1;if(this.callEvent("onAreaDrag",[a,b,d]))this._activeAreaSName?this._removeAreaNodes(this._activeAreaSName):!this._arSelCheckKeys||this._settings.multiselect&&d&&d.ctrlKey||(this.removeSelectArea(),this._arSelCheckKeys=!1);else return!1}};this.attachEvent("onBeforeAreaAdd",this._span_correct_range);webix._event(this._body,"mousedown",this._ars_down,
{bind:this})},_block_sel_flag:!0,_excludeColumnFromAreas:function(a){var b=this._areaSelStorage,c;for(c in b){var d=b[c];if(0>this.getColumnIndex(d.start.column))if(d.start.column==d.end.column)this.removeSelectArea(d.name);else{var e=this.columnId(a+1);e&&this._updateSelectArea(d.name,{row:d.start.row,column:e},null)}else 0>this.getColumnIndex(d.end.column)&&(e=this.columnId(a-1))&&this._updateSelectArea(d.name,null,{row:d.end.row,column:e})}},_extendAreaRange:function(a,b,c,d){if(b){var e=this.getColumnIndex(b.start.column);
var f=this.getColumnIndex(b.end.column);var g=this.getIndexById(b.start.row);var h=this.getIndexById(b.end.row);var k=this.getColumnIndex(a.column);a=this.getIndexById(a.row);var l=this.getIndexById(b.init.row);var m=this.getColumnIndex(b.init.column);if(e>k||"left"==c)"left"===c&&d.ctrl?(e=this._extendAreaToData(l,e,c),f=m):"left"===c&&f>m?f--:e=k;else if(f<=k||"right"==c)"right"==c&&d.ctrl?(f=this._extendAreaToData(l,f,c),e=m):"right"==c&&e<m?e++:f=k;if(g>a||"up"==c)"up"==c&&d.ctrl?(g=this._extendAreaToData(g,
m,c),h=l):"up"==c&&h>l?h--:g=a;else if(h<a||"down"==c)"down"==c&&d.ctrl?(h=this._extendAreaToData(h,m,c),g=l):"down"==c&&g<l?g++:h=a;c={row:this.getIdByIndex(g),column:this.columnId(e)};f={row:this.getIdByIndex(h),column:this.columnId(f)};this.callEvent("onBeforeBlockSelect",[c,f,!0])&&(this._updateSelectArea(b.name,c,f),this.callEvent("onSelectChange",[]),this.callEvent("onAfterBlockSelect",[c,f]))}},_extendAreaToData:function(a,b,c){var d=this.config.columns,e=this.data.order,f=this.data.pull[e[a]],
g=d[b].id,h=0;if("right"==c)for(a=b+1;a<d.length;a++)if(f[d[a].id]){h=a;break}else h=a;else if("left"==c)for(a=b-1;0<=a;a--){if(f[d[a].id]){h=a;break}}else if("down"==c)for(a+=1;a<e.length;a++)if(this.getItem(e[a])[g]){h=a;break}else h=a;else if("up"==c)for(--a;0<=a;a--)if(this.getItem(e[a])[g]){h=a;break}return h},_updateSelectArea:function(a,b,c,d){a=this._areaSelStorage[a];if(!a)return!1;var e=webix.copy(a);b={start:b||a.start,end:c||a.end};this._span_correct_range(b);webix.extend(a,b,!0);this.refreshSelectArea();
this._setTabindex(e);d&&this.callEvent("onSelectChange",[])},areaselect_setter:function(a){a&&(this._init_areaselect(),this._init_areaselect=function(){});this.define("blockselect",a);return a},addSelectArea:function(a,b,c,d,e,f){var g=this.getIndexById(a.row);var h=this.getIndexById(b.row);a=this.getColumnIndex(a.column);b=this.getColumnIndex(b.column);if(g>h){var k=g;g=h;h=k}a>b&&(k=a,a=b,b=k);d=d||this._activeAreaSName||webix.uid();this._activeAreaSName=null;g={start:{row:this.getIdByIndex(g),
column:this.columnId(a)},end:{row:this.getIdByIndex(h),column:this.columnId(b)}};e&&(g.css=e);if(f||!1===f)g.handle=f;if(this._areaSelStorage[d])return this._updateSelectArea(d,g.start,g.end,!0);g.handle=!0;g.name=d;g.init=g.start;this.callEvent("onBeforeAreaAdd",[g])&&(this._lastDefArea=d,c||this.removeSelectArea(),this._areaSelStorage[g.name]=g,this._selected_areas.push(g),this.refreshSelectArea(),this._setTabindex(),this.callEvent("onAfterAreaAdd",[g]),this.callEvent("onSelectChange",[]))},_renderSelectAreaBox:function(){var a=
webix.html.create("DIV");a.className="webix_area_selection_layer";a.style.top=this._render_scroll_shift+"px";return a},refreshSelectArea:function(){var a,b=null,c=null,d=null;var e=this._settings.prerender;if(this._render_full_rows){var f=this._get_x_range(e);e=this._get_y_range(!0===e);this._rselect_box||(this._rselect_box=this._renderSelectAreaBox(),this._body.childNodes[1].appendChild(this._rselect_box),this._rselect_box_left=this._renderSelectAreaBox(),this._body.childNodes[0].appendChild(this._rselect_box_left),
this._rselect_box_right=this._renderSelectAreaBox(),this._body.childNodes[2].appendChild(this._rselect_box_right));this._rselect_box.innerHTML="";this._rselect_box_left.innerHTML="";this._rselect_box_right.innerHTML="";var g=this._settings.leftSplit,h=this._settings.rightSplit;for(a in this._areaSelStorage){var k=this._areaSelStorage[a];var l=this._calcAreaSelectIndexes(k,f,e);if(null===l)this.removeSelectArea(a);else{var m=this.getColumnIndex(k.start.column),n=this.getColumnIndex(k.end.column);if(l.r0<=
l.r1){if(this._settings.topSplit&&void 0>=this._settings.topSplit&&void 0<this._render_scroll_top)return!1;m<g&&(c=this._getSelectAreaCellPositions(l.r0,m,l.r1,Math.min(n,g-1)));l.c0<=l.c1&&(b=this._getSelectAreaCellPositions(l.r0,l.c0,l.r1,l.c1));h&&n>=this._rightSplit&&(d=this._getSelectAreaCellPositions(l.r0,Math.max(m,this._rightSplit),l.r1,n));(c||b||d)&&this._setSelectAreaBorders(c,b,d,a,k.css,k.handle)}}}}},_calcAreaSelectIndexes:function(a,b,c){var d=this.getIndexById(a.start.row),e=this.getIndexById(a.end.row),
f=this.getColumnIndex(a.start.column),g=this.getColumnIndex(a.end.column);if(-1===f||-1===g||-1===d||-1===e)return null;var h=Math.min(c[1],e);if(this._settings.topSplit){var k=d;k>=this._settings.topSplit&&(k=Math.max(c[0]-this._settings.topSplit,d));h>=this._settings.topSplit&&(c=this._cellPosition(this.getIdByIndex(e),a.end.column),a=this._cellPosition(this.getIdByIndex(this._settings.topSplit-1),a.end.column),a.top+a.height>c.top+c.height&&(h=this._settings.topSplit-1))}else k=Math.max(c[0],this.getIndexById(a.start.row));
return{r0:k,r1:h,c0:Math.max(b[0],f),c1:Math.min(this._rightSplit?b[1]-1:b[1],g)}},_getSelectAreaCellPositions:function(a,b,c,d){a=this._cellPosition(this.getIdByIndex(a),this.columnId(b));c=this._cellPosition(this.getIdByIndex(c),this.columnId(d));return[a,c]},_setSelectAreaBorders:function(a,b,c,d,e,f){var g=this._areaSelStorage[d],h=0;this._settings.topSplit&&(h=this._getTopSplitOffset(g.start,!0));g=function(a,b,c,f,g){var k;var l={top:1,right:1,bottom:1,left:1};f&&delete l.left;g&&delete l.right;
f=c.top-b.top+c.height-1;g=c.left-b.left+c.width;for(k in l){l=b.top+h;"bottom"==k&&(l=c.top+c.height);var m=b.left;"right"==k&&(m=c.left+c.width);var n="top"==k||"bottom"==k;a.appendChild(webix.html.create("DIV",{"class":"webix_area_selection webix_area_selection_"+k+(e?" "+e:""),style:"left:"+m+"px;top:"+l+"px;"+(n?"width:"+g+"px;":"height:"+(f-h)+"px;"),webix_area_name:d},""));n=a.lastChild;"right"==k&&(n.style.left=m-n.offsetWidth+"px");"bottom"==k&&(n.style.top=l-n.offsetHeight+"px")}};c&&g(this._rselect_box_right,
c[0],c[1],!!b,!1);b&&g(this._rselect_box,b[0],b[1],!!a,!!c);a&&g(this._rselect_box_left,a[0],a[1],!1,!!b);f&&(a=c?c[1]:b?b[1]:a[1],b=c?this._rselect_box_right:b?this._rselect_box:this._rselect_box_left,b.appendChild(webix.html.create("DIV",{"class":"webix_area_selection_handle"+(e?" "+e:""),style:"left:"+(a.left+a.width)+"px;top:"+(a.top+a.height)+"px;",webix_area_name:d},"")))},_removeAreaNodes:function(a){if(a){var b=function(b){for(var c=b.childNodes,e=c.length-1;0<=e;e--)c[e].getAttribute("webix_area_name")==
a&&b.removeChild(c[e])};b(this._rselect_box);b(this._rselect_box_left);b(this._rselect_box_right)}},removeSelectArea:function(a){if(a&&this._areaSelStorage[a]){if(this.callEvent("onBeforeAreaRemove",[a])){this._setTabindex(webix.copy(this._areaSelStorage[a]),!0);delete this._areaSelStorage[a];this._removeAreaNodes(a);this._selected_areas=[];for(var b in this._areaSelStorage)this._selected_areas.push(this._areaSelStorage[b]);this.callEvent("onAfterAreaRemove",[a])}}else for(var c in this._areaSelStorage)this.removeSelectArea(c)},
_ars_down:function(a){var b=a.target||a.srcElement,c=webix.html._getClassName(b);if(c&&-1!=c.indexOf("webix_area_selection_handle")){this._activeAreaSName=b=b.getAttribute("webix_area_name");b=this._areaSelStorage[b];c=this._cellPosition(b.start.row,b.start.column);var d=this._cellPosition(b.end.row,b.end.column),e=this._settings.prerender,f=this.getColumnIndex(b.start.column)<this._settings.leftSplit?0:this._left_width,g=this.getColumnIndex(b.end.column)<this._settings.leftSplit?0:this._left_width;
this._bs_ready=[c.left+1+f-this._scrollLeft,c.top+1-(e?this._scrollTop:0),{row:b.start.row,column:b.start.column}];this._bs_position=webix.html.offset(this._body);this._bs_start(a);this._bs_progress=[d.left+1+g-this._scrollLeft,d.top+1-(e?this._scrollTop:0)];this._bs_select(!1,!1);return webix.html.preventEvent(a)}},getSelectArea:function(a){return this._areaSelStorage[a||this._lastDefArea]},getAllSelectAreas:function(){return this._areaSelStorage},_span_correct_range:function(a){if(!this.config.spans)return!0;
var b,c,d,e,f,g=!1;var h=a.start;var k=a.end;var l=b=this.getIndexById(h.row);var m=h=this.getColumnIndex(h.column);var n=d=this.getIndexById(k.row);for(f=k=this.getColumnIndex(k.column);b<=d;b++)for(c=h;c<=k;c++)if(e=this.getSpan(this.getIdByIndex(b),this.columnId(c))){var p=this.getIndexById(e[0]);var q=this.getColumnIndex(e[1]);p<l&&(l=p,g=!0);q<m&&(g=!0,m=q);p+e[3]-1>n&&(g=!0,n=p+e[3]-1);q+e[2]-1>f&&(g=!0,f=q+e[2]-1)}g&&(a.start={row:this.getIdByIndex(l),column:this.columnId(m)},a.end={row:this.getIdByIndex(n),
column:this.columnId(f)},this._span_correct_range(a))},_setTabindex:function(a,b){if(a){var c=this.getIndexById(a.end.row)-this.getIndexById(a.start.row)+1,d=this.getColumnIndex(a.end.column)-this.getColumnIndex(a.start.column)+1;this.mapCells(a.start.row,a.start.column,c,d,webix.bind(function(a,b,c){(a=this.getItemNode({row:b,column:c}))&&a.removeAttribute("tabindex")},this),!0)}!b&&this._selected_areas.length&&this.mapSelection(webix.bind(function(a,b,c){(b=this.getItemNode({row:b,column:c}))&&
b.setAttribute("tabindex","1");return a},this))}});
webix.protoUI({name:"rangechart",$init:function(){this.attachEvent("onAfterRender",this._init_frame);this._set_full_range()},_init_frame:function(){webix.assert(-1===this._settings.type.indexOf("pie")&&"radar"!==this._settings.type&&"donut"!==this._settings.type,"Not suppored chart type");!this._map._areas.length||this._frame?this._setHandle(!0):(this._setMap(),this._item_radius=(this._map._areas[0].points[2]-this._map._areas[0].points[0])/2,this._rHandle=webix.html.create("div",{"class":"webix_chart_resizer right",
tabindex:"0",role:"button","aria-label":webix.i18n.aria.resizeChart}),this._lHandle=webix.html.create("div",{"class":"webix_chart_resizer left",tabindex:"0",role:"button","aria-label":webix.i18n.aria.resizeChart}),this._frame=webix.html.create("div",{"class":"webix_chart_frame"}),this._viewobj.appendChild(this._lHandle),this._viewobj.appendChild(this._frame),this._viewobj.appendChild(this._rHandle),this._setHandle(),webix._event(this._rHandle,webix.env.mouse.down,this._frDown,{bind:this}),webix._event(this._lHandle,
webix.env.mouse.down,this._frDown,{bind:this}),webix._event(this._frame,webix.env.mouse.down,this._frDown,{bind:this}),webix._event(webix.toNode(this._rHandle),"keydown",this._keyShift,{bind:this}),webix._event(webix.toNode(this._lHandle),"keydown",this._keyShift,{bind:this}),this._value&&(this._settings.range=this._set_full_range(this._value)),this._refresh_range(),this.callEvent("onAfterRangeChange",[this._value]),this.data.attachEvent("onStoreUpdated",webix.bind(this._refresh_range,this)))},$setSize:function(a,
b){webix.ui.chart.prototype.$setSize.call(this,a,b)&&(this._setMap(),this._refresh_range())},_setHandle:function(a){this._rHandle&&!this._handle_radius&&(this._handle_radius=this._rHandle.clientWidth/2,a&&this._refresh_range())},_setMap:function(){var a=this._getChartBounds(this._content_width,this._content_height);this._mapStart=a.start;this._mapEnd=a.end},removeAllSeries:function(){this._frame=this._rHandle=this._lHandle=null;webix.ui.chart.prototype.removeAllSeries.apply(this,arguments)},_keyShift:function(a){var b=
a.which||a.keyCode;if(37===b||39===b){webix.html.preventEvent(a);var c=-1!==a.target.className.indexOf("right")?"eindex":"sindex";a=-1!==a.target.className.indexOf("right")?"end":"start";var d=this._value;d[c]+=37===b?-1:1;this._map._areas[d[c]]&&(d[a]=this._get_id_by_index(d[c]),this.setFrameRange(d))}},_frDown:function(a){if(-1!==a.target.className.indexOf("webix_chart_resizer"))this._activeHandle=a.target;else if(this._map._areas.length){var b=this._map._areas[this._value.sindex].points[2]-this._item_radius,
c=this._map._areas[this._value.eindex].points[2]-this._item_radius;this._activeFrame={ex:webix.html.pos(a).x,fx:b+this._mapStart.x,fw:c-b}}webix.html.addCss(this._viewobj,"webix_noselect webix_wresize_cursor");this._frClear();this._resizeHandlerMove=webix.event(document.body,webix.env.mouse.move,this._frMove,{bind:this});this._resizeHandlerUp=webix.event(document.body,webix.env.mouse.up,this._frUp,{bind:this})},_frClear:function(){webix._events[this._resizeHandlerMove]&&(webix.eventRemove(this._resizeHandlerMove),
webix.eventRemove(this._resizeHandlerUp))},_frMove:function(a){if(this._activeHandle)a=webix.html.pos(a).x-webix.html.offset(this.$view).x,a>=this._mapStart.x&&a<=this._mapEnd.x&&(-1!==this._activeHandle.className.indexOf("left")?a<this._rHandle.offsetLeft&&(this._activeHandle.style.left=a-this._handle_radius+"px",this._frame.style.left=a+"px",this._frame.style.width=this._rHandle.offsetLeft-this._lHandle.offsetLeft-1+"px"):a>this._lHandle.offsetLeft+this._handle_radius&&(this._activeHandle.style.left=
a-this._handle_radius+"px",this._frame.style.width=this._rHandle.offsetLeft-this._lHandle.offsetLeft-1+"px"));else if(this._activeFrame){a=webix.html.pos(a).x-this._activeFrame.ex;a=this._activeFrame.fx+a;var b=a+this._activeFrame.fw;this._mapStart.x<=a&&this._mapEnd.x>=b&&(webix.extend(this._activeFrame,{lx:a,rx:b},!0),this._lHandle.style.left=a-this._handle_radius+"px",this._rHandle.style.left=b-this._handle_radius+"px",this._frame.style.left=a+"px")}},_frUp:function(a){this._frClear();webix.html.removeCss(this._viewobj,
"webix_noselect");webix.html.removeCss(this._viewobj,"webix_wresize_cursor");if(this.count()){if(this._activeHandle){a=webix.env.touch?a.changedTouches[0].pageX:webix.html.pos(a).x;a-=webix.html.offset(this.$view).x+this._mapStart.x;a=this._get_index_by_pos(a);var b=this._get_id_by_index(a);this._activeHandle===this._lHandle?(a>=this._value.eindex&&(a=this._value.eindex,b=this._get_id_by_index(a)),this._value.start=b,this._value.sindex=a):(a<=this._value.sindex&&(a=this._value.sindex,b=this._get_id_by_index(a)),
this._value.end=b,this._value.eindex=a);this._activeHandle=null}else this._activeFrame&&this._activeFrame.lx&&(a=this._value.sindex=this._get_index_by_pos(this._activeFrame.lx-this._mapStart.x),b=this._value.eindex=this._get_index_by_pos(this._activeFrame.rx-this._mapStart.x),this._value.start=this._get_id_by_index(a),this._value.end=this._get_id_by_index(b),this._activeFrame=null);this._refresh_range();this.callEvent("onAfterRangeChange",[this._value.start,this._value.end])}},_get_id_by_index:function(a){a>=
this.data.order.length&&(a=this.data.order.length-1);return this.getItem(this.data.order[a])[this._settings.frameId||"id"]},_get_index_by_pos:function(a){for(var b=this._map._areas,c=0;c<b.length;c++)if(a<=b[c].points[2]-this._item_radius)return c;return b.length-1},_get_frame_index:function(a){for(var b=this._settings.frameId||"id",c=0;c<this.data.order.length;c++)if(this.getItem(this.data.order[c])[b]==a)return c;return-1},_set_full_range:function(a){a?(a.start&&(a.sindex=this._get_frame_index(a.start)),
a.end&&(a.eindex=this._get_frame_index(a.end)),a.start=a.start||this._get_id_by_index(a.sindex),a.end=a.end||this._get_id_by_index(a.eindex)):a={start:0,end:0,sindex:0,eindex:0};this._value=a},range_setter:function(a){this._set_full_range(a);return this._value},getFrameData:function(){for(var a=[],b=this._value.sindex;b<=this._value.eindex;b++){var c=this.getItem(this.data.order[b]);c&&a.push(c)}return a},setFrameRange:function(a){this._set_full_range(a);this._refresh_range();this.callEvent("onAfterRangeChange",
[a])},_refresh_range:function(){if(this._map){var a=this._map._areas;if(a.length){var b=a[this._value.sindex].points[0]+this._mapStart.x+this._item_radius-1;a=a[this._value.eindex].points[0]+this._mapStart.x+this._item_radius-1;this._lHandle.style.left=b-this._handle_radius+"px";this._rHandle.style.left=a-this._handle_radius+"px";this._frame.style.left=b+"px";this._frame.style.width=a-b+"px";this._settings.range=this._value}}},getFrameRange:function(){return this._settings.range}},webix.ui.chart);
webix.protoUI({name:"richtext",defaults:{label:"",labelWidth:80,labelPosition:"left"},$init:function(a){this.$ready.unshift(this._setLayout)},getInputNode:function(){return this.$view.querySelector(".webix_richtext_editor")},_button:function(a){return{view:"toggle",type:"iconButton",icon:a,name:a,id:a,label:webix.i18n.richtext[a],autowidth:!0,action:a,click:this._add_data}},_setLayout:function(){var a=this,b={view:"template",css:"webix_richtext_container",borderless:!0,template:"<div class='webix_richtext_editor' contenteditable='true'>"+
this.getValue()+"</div>",on:{onAfterRender:function(){webix._event(a.getInputNode(),"blur",function(){a._updateValue(this.innerHTML)});webix._event(a.getInputNode(),"keyup",function(){a._getselection()})}},onClick:{webix_richtext_editor:function(){a._getselection()}}},c={view:"toolbar",id:"toolbar",elements:[this._button("underline"),this._button("bold"),this._button("italic"),{}]};b=[c,b];"top"!==this.config.labelPosition&&this.config.labelWidth?(this.config.borderless=!0,this.cols_setter([{template:this.config.label||
" ",width:this.config.labelWidth},{rows:b}])):(c.elements.push({view:"label",label:this.config.label,align:"right"}),this.rows_setter(b))},_getselection:function(){this.$$("toolbar").setValues({italic:!1,underline:!1,bold:!1});var a=window.getSelection?window.getSelection():document.selection.createRange();for(var b=0;b<a.rangeCount;++b)a.getRangeAt(b),this.$view.contains(this.getInputNode())&&(document.queryCommandState("bold")&&this.$$("bold").setValue(!0),document.queryCommandState("underline")&&
this.$$("underline").setValue(!0),document.queryCommandState("italic")&&this.$$("italic").setValue(!0))},refresh:function(){this.getInputNode().innerHTML=this.config.value},_execCommandOnElement:function(a,b){if(window.getSelection()){a=window.getSelection();var c=a.toString().length}else a=document.selection.createRange(),c=a.text.length;if(0<c)for(c=0;c<a.rangeCount;++c){var d=a.getRangeAt(c);if(a.isCollapsed){var e=a.focusNode.textContent,f=a.focusNode,g=a.anchorOffset,h=e.substring(0,g).match(/[A-Za-z]*$/)[0];
e=e.substring(g).match(/^[A-Za-z]*/)[0];e=g+e.length;d.setStart(f,g-h.length);d.setEnd(f,e);a.removeAllRanges();window.getSelection().addRange(d)}document.execCommand(b,!1,"")}},_add_data:function(){var a=this.getTopParentView(),b=a.getInputNode();this.$view.contains(this.getInputNode())&&a._execCommandOnElement(b,this.config.action)},focus:function(){this.$view.querySelector(".webix_richtext_editor").focus()},_updateValue:function(a){var b=this.config.value;this.config.value=a||"";b!==a&&this.callEvent("onChange",
[a,b])},setValue:function(a){this._updateValue(a);this.refresh()},getValue:function(){this.getInputNode()&&(this.config.value=this.getInputNode().innerHTML);var a=this.config.value;return a||(0===a?"0":"")}},webix.IdSpace,webix.ui.layout);
webix.protoUI({name:"gage",defaults:{value:0,minRange:0,maxRange:100,minWidth:250,minHeight:200,smoothFlow:!0,scale:3,stroke:7},$init:function(){this.$ready.push(webix.bind(this._setDefaultView,this));this.attachEvent("onDestruct",function(){this._circleGradient=this._gageGradientPoint=this._gage=null})},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&(this._refresh(this.config.value),this._animate(this.config.value))},_refresh:function(){var a=this.$view.querySelector(".webix_gage_curves"),
b=this.$view.querySelector(".webix_gage_info"),c=this.config.scale,d=this.$width;a.setAttribute("r",d/c);a.setAttribute("strokeDasharray",Math.round(Math.PI*d/c));a.style.r=d/c;a.style.strokeDasharray=Math.round(Math.PI*d/c);b.setAttribute("style","width: "+Math.round(d/c*2)+"px;");this._gage.setAttribute("style","height: "+(d/c+20)+"px;");this._circleGradient.setAttribute("r",d/c);this._circleGradient.setAttribute("style","stroke-dasharray: "+Math.round(this.gradientLength*Math.PI*d/c)+", 1900;");
this._draw_line(a.style.r)},_safeValue:function(a){return Math.min(Math.max(a,this._settings.minRange),this._settings.maxRange)},_draw_line:function(a){var b=this.$width,c=this.config.value;c=this._safeValue(c);c=Math.round(180*(c-this.config.minRange)/(this.config.maxRange-this.config.minRange));if(0===c||180===c)this._gage.style.paddingTop="3px";this._gageGradientPoint.style.transformOrigin=b/2-.55+"px 0 0";this._gageGradientPoint.setAttribute("y1","0");this._gageGradientPoint.setAttribute("x1",
Math.round(.55*b));this._gageGradientPoint.setAttribute("y2",0);this._gageGradientPoint.setAttribute("x2",Math.round(.525*b+parseInt(a)))},_animate:function(a){var b=this.$view.querySelector(".webix_gage-value"),c=this._safeValue(a)-this.config.minRange;c=Math.round(180*c/(this.config.maxRange-this.config.minRange));var d=this.$width;d=Math.floor(d/10);this.$view.style.fontSize=d+"px";b.innerHTML=a;this._circleGradient.style.stroke=this.color;this._circleGradient.setAttribute("stroke",this.color);
this._gageGradientPoint.setAttribute("transform","rotate("+c+" "+this.$width/2+" 0)");this._gageGradientPoint.style.transform="rotate("+c+"deg)"},_setDash:function(){webix.assert(this.config.minRange<this.config.maxRange,"Invalid Range Values");this.gradientLength=(this._safeValue(this.config.value)-this.config.minRange)/(this.config.maxRange-this.config.minRange);var a=this.config.color;this.color=a?"function"===typeof a?a.call(this,this.config.value):a:"hsl("+(120-Math.round(120*this.gradientLength))+
", 100%, 50%)";this.defaultColor=!0===this.config.animation?"hsl(125, 100%, 50%)":"hsl("+(120-Math.round(120*this.gradientLength))+", 100%, 50%)"},_setDefaultView:function(){this.gradientLength=0;this._setDash();this.$view.innerHTML='<div class="webix_gage_label"><span>'+(this.config.label||"")+'</span></div><svg class="webix_gage" style="height:300px; position: relative;"><circle class="webix_gage_curves" r="0" cx="50%" cy="0" stroke="#EEEEEE" stroke-width="'+this.config.stroke+'%" fill="none"></circle><circle class="webix_gage_gradient" r="0" stroke="'+
this.defaultColor+'" cx="50%" cy="0" stroke-width="'+this.config.stroke+'%" fill="none" style="stroke-dasharray: 0, 1900;"></circle><line class="webix_gage_gradient_point" x1="0" x2="0" y1="0" y2="0" style="stroke:#B0B0B0; stroke-width:4;"></line></svg><div class="webix_gage_info"><div class="webix_gage_min_range">'+this.config.minRange+'</div><div class="webix_gage_max_range">'+this.config.maxRange+'</div><div class="webix_gage_placeholder"><div class="webix_gage-value">'+this.config.value+'</div><div class="webix_gage_range_info">'+
(this.config.placeholder||"")+"</div></div></div>";this._circleGradient=this.$view.querySelector(".webix_gage_gradient");this._gageGradientPoint=this.$view.querySelector(".webix_gage_gradient_point");this._gage=this.$view.querySelector(".webix_gage");!0===this.isVisible()&&!0===this.config.smoothFlow&&webix.env.svganimation&&!webix.env.isEdge&&(this._circleGradient.setAttribute("class","webix_gage_gradient webix_gage_animated"),this._gageGradientPoint.setAttribute("class","webix_gage_gradient_point webix_gage_gradient_point_animated"))},
setValue:function(a){this.config.value=a;this._setDash();this._refresh();this._animate(a)},getValue:function(){return this.config.value}},webix.EventSystem,webix.ui.view);
webix.protoUI({name:"bullet",defaults:{color:"#394646",marker:!1,layout:"x",barWidth:40,flowTime:500,labelWidth:150,stroke:8,bands:[{value:100,color:"#5be5d6"},{value:80,color:"#fff07e"},{value:60,color:"#fd8b8c"}],scale:{step:10}},label_setter:webix.template,placeholder_setter:webix.template,$init:function(a){a&&(a.layout&&"x"!==a.layout||a.height||(a.height=!1===a.scale?60:90),"y"!==a.layout||a.width||(a.width=!1===a.scale?60:97))},scale_setter:function(a){a.step=a.step||10;a.template=webix.template(a.template||
"#value#");return a},$setSize:function(a,b){webix.ui.view.prototype.$setSize.call(this,a,b)&&(this._setDefaultView("y"===this._settings.layout?b:a),(this._settings.value||0===this._settings.value)&&this._animate(0,this._settings.value))},_safeValue:function(a){return Math.min(Math.max(a,this._settings.minRange),this._settings.maxRange)},_animateFrame:function(a){this._dt=a-(this._time||a);this._time=a;a=this._settings.flowTime>this._dt?this._settings.flowTime/this._dt:this._settings.flowTime;if(1E3<
a||5>a)a=30;a=(this._settings.value-this._prevValue)/a;this._nowValue+=a;Math.abs(this._nowValue-this._settings.value)<Math.abs(a)&&(this._nowValue=this._settings.value);this._nowValue!=this._settings.value?this._requestId=requestAnimationFrame(this._animateFrame.bind(this)):(cancelAnimationFrame(this._requestId),this._requestId=null);this._bulletValue.setAttribute("width",Math.floor(this._nowValue*this._scale))},_animate:function(a,b){this._prevValue=this._nowValue=a;this._settings.value=b;if(a=
this._settings.label)this.$view.querySelector(".webix_bullet_header").textContent=a(this._settings);a=this._settings.placeholder;"function"===typeof a&&(this.$view.querySelector(".webix_bullet_subheader").textContent=a(this._settings));!0===this.isVisible()&&!0===this._settings.smoothFlow&&window.requestAnimationFrame?this._requestId||(this._requestId=requestAnimationFrame(this._animateFrame.bind(this))):this._bulletValue.setAttribute("width",Math.floor(b*this._scale))},_setAttr:function(a,b,c){for(var d=
0;d<b.length;d++)a.setAttribute(b[d],c[d])},_createNS:function(a,b,c){a=document.createElementNS("http://www.w3.org/2000/svg",a);b&&this._setAttr(a,b,c);return a},_dom:function(a){var b=this._createNS(a[0],a[1],a[2]);if(a=a[3])for(var c=0;c<a.length;c++)b.appendChild(this._dom(a[c]));return b},_setView:function(){var a="d"+webix.uid(),b=this._createNS("svg",["class"],["webix_bullet_graph_svg"]),c=this._createNS("g"),d=this._createNS("g"),e=this._createNS("rect","x y width height class style".split(" "),
[this._leftStart,this._topStart,100,this._settings.stroke,"webix_bullet_value","filter:url(#"+a+");fill:"+this._settings.color]),f=this._createNS("rect",["x","y","width","height","fill"],[0,5,3,this._settings.barWidth-10,"rgba(0,0,0,0.5)"]),g=this._createNS("g",["stroke","stroke-width","fill"],["#8b94ac","2","none"]),h=this._createNS("text",["text-anchor","stroke","fill"],["end","none","#8b94ac"]),k="y"==this._settings.layout?"50%":this._leftStart-10,l="y"==this._settings.layout?11:17,m=this._createNS("tspan",
["x","y","class"],[k,l,"webix_bullet_header"]);k=this._createNS("tspan",["x","y","class"],[k,l+17,"webix_bullet_subheader"]);l=this._createNS("text",["text-anchor","stroke","class","fill"],["middle","none","webix_bullet_scale","#8b94ac"]);a=this._dom(["filter",["id","x","y","width","height"],[a,"0","-150%","110%","400%"],[["feOffset",["in","dx","dy"],["SourceAlpha",0,0]],["feGaussianBlur",["stdDeviation"],["2"]],["feComponentTransfer",0,0,[["feFuncA",["type","slope"],["linear","0.5"]]]],["feMerge",
0,0,[["feMergeNode"],["feMergeNode",["in"],["SourceGraphic"]]]]]]);b.appendChild(a);a=document.createElement("div");c.appendChild(d);!1!==this._settings.marker&&(f.setAttribute("x",this._leftStart+this._safeValue(this._settings.marker)*this._scale-2),c.appendChild(f));c.appendChild(e);h.appendChild(m);h.appendChild(k);b.appendChild(h);e="y"===this._settings.layout;if(this._settings.scale){for(f=this._settings.minRange;f<=this._settings.maxRange;f+=this._settings.scale.step){var n=this._settings.labelHeight||
this._settings.labelWidth;k=Math.floor(n+f*this._scale-(f?.1:-1));m=e?-13:this._settings.barWidth+3;n=this._createNS("tspan",["x","y","text-anchor"],[e?(this.$width-this._settings.barWidth)/2+-10:k,e?this._chartWidth-k+n+44:this._settings.barWidth+28,e?"end":"middle"]);k=this._createNS("line",["x1","y1","x2","y2","stroke-width"],[k,m,k,m+10,1]);a.innerHTML=this._settings.scale.template({value:f});n.appendChild(a.childNodes[0]);l.appendChild(n);g.appendChild(k)}c.appendChild(g);b.appendChild(l)}for(f=
0;f<this._settings.bands.length;f++)g=this._settings.bands[f],k=this._createNS("path"),e=this._safeValue(g.value)*this._scale,k.setAttribute("d","M "+this._leftStart+",0 l "+e+",0 l 0,"+this._settings.barWidth+" l -"+e+",0 z"),k.setAttribute("fill",g.color),d.appendChild(k);b.appendChild(c);"y"===this._settings.layout&&(c.setAttribute("transform","translate("+(this._settings.scale?this.$width/2-10:0)+", "+(this.$height+this._leftStart-28)+") rotate(270)"),h.setAttribute("text-anchor","middle"),h.childNodes[0].setAttribute("x",
"55%"),h.childNodes[1].setAttribute("x","55%"),l.setAttribute("text-anchor","right"));b.setAttribute("viewBox","0 0 "+this.$width+" "+this.$height);return b},_setDefaultView:function(a){if(a){webix.assert(this.config.minRange<this.config.maxRange,"Invalid Range Values");var b=this.$view;b.innerHTML="";var c=this._settings.labelHeight||this._settings.labelWidth;this._leftStart=this._settings.label?c:7;this._topStart=Math.floor((this._settings.barWidth-this._settings.stroke)/2);this._chartWidth=a-this._leftStart-
30;this._scale=this._chartWidth/(this._settings.maxRange-this._settings.minRange);a=this._setView();a.setAttribute("height",this.$height);a.setAttribute("width",this.$width);b.appendChild(a);this._bulletValue=b.querySelector(".webix_bullet_value")}},setValue:function(a){this._settings.value!=a&&this._animate(this._settings.value,a)},getValue:function(){return this._settings.value}},webix.ui.gage,webix.ui.view);
